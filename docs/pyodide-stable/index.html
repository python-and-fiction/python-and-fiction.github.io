
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Version 0.27.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_js.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/css/pyodide.css?v=6097e04c" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=2c7439e8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="canonical" href="https://pyodide.org/en/stable/#document-index" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.27.1" />
<script
  defer
  data-domain="pyodide.org"
  src="https://plausible.io/js/plausible.js"
></script>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/pyodide-logo.png" class="logo__image only-light" alt="None - Home"/>
    <img src="_static/pyodide-logo.png" class="logo__image only-dark pst-js-only" alt="None - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">












</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav bd-sidenav">






</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/pyodide/pyodide" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pyodide</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/quickstart">Getting started</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/downloading-and-deploying">Downloading and deploying Pyodide</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/index">Using Pyodide</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/loading-packages">Loading packages</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/accessing-files">Accessing Files Quick Reference</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/wasm-constraints">Pyodide Python compatibility</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/type-conversions">Type translations</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/keyboard-interrupts">Interrupting execution</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/streams">Redirecting standard streams</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/api-reference">API Reference</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/faq">Frequently Asked Questions</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/examples">Community Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/building-from-sources">Building from sources</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/new-packages">Creating a Pyodide package</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/building-and-testing-packages">Building and testing Python packages out of tree</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/contributing">How to Contribute</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/testing">Testing and benchmarking</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/debugging">Debugging tips</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/about">What is Pyodide?</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/roadmap">Roadmap</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/governance">Governance and Decision-making</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/changelog">Change Log</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/related-projects">Related Projects</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyodide">
<h1>Pyodide<a class="headerlink" href="#pyodide" title="Link to this heading">#</a></h1>
<p>Pyodide is a Python distribution for the browser and Node.js based on WebAssembly.</p>
<section id="what-is-pyodide">
<h2>What is Pyodide?<a class="headerlink" href="#what-is-pyodide" title="Link to this heading">#</a></h2>
<p>Pyodide is a port of CPython to WebAssembly/<a class="reference external" href="https://emscripten.org/">Emscripten</a>.</p>
<p>Pyodide makes it possible to install and run Python packages in the browser with
<a class="reference external" href="https://pyodide.org/en/stable/usage/api/micropip-api.html">micropip</a>. Any pure
Python package with a wheel available on PyPI is supported. Many packages with C
extensions have also been ported for use with Pyodide. These include many
general-purpose packages such as regex, pyyaml, lxml and scientific Python
packages including numpy, pandas, scipy, matplotlib, and scikit-learn.</p>
<p>Pyodide comes with a robust Javascript ⟺ Python foreign function interface so
that you can freely mix these two languages in your code with minimal
friction. This includes full support for error handling (throw an error in one
language, catch it in the other), async/await, and much more.</p>
<p>When used inside a browser, Python has full access to the Web APIs.</p>
</section>
<section id="try-pyodide">
<h2>Try Pyodide<a class="headerlink" href="#try-pyodide" title="Link to this heading">#</a></h2>
<p>Try Pyodide in a
<a class="reference external" href="./console.html">REPL</a> directly in
your browser (no installation needed).</p>
</section>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<section id="using-pyodide">
<h3>Using Pyodide<a class="headerlink" href="#using-pyodide" title="Link to this heading">#</a></h3>
<div class="toctree-wrapper compound">
<span id="document-usage/quickstart"></span><section id="getting-started">
<span id="quickstart"></span><h4>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h4>
<section id="try-it-online">
<h5>Try it online<a class="headerlink" href="#try-it-online" title="Link to this heading">#</a></h5>
<p>Try Pyodide in a <a class="external reference" href="../console.html">REPL</a> directly in your browser
(no installation needed).</p>
</section>
<section id="setup">
<h5>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h5>
<p>There is a <a class="reference internal" href="#complete-example"><span class="std std-ref">complete example</span></a> that you can copy &amp; paste
into an html file below. To include Pyodide in your project you can use the
following CDN URL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js
</pre></div>
</div>
<p>You can also download a release from <a class="reference external" href="https://github.com/pyodide/pyodide/releases">GitHub
releases</a> or build Pyodide
yourself. See <a class="reference internal" href="#downloading-deploying"><span class="std std-ref">Downloading and deploying Pyodide</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code> file defines a single async function called
<a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a> which sets up the Python environment
and returns <a class="reference internal" href="#module-pyodide" title="pyodide"><code class="xref js js-mod docutils literal notranslate"><span class="pre">the</span> <span class="pre">Pyodide</span> <span class="pre">top</span> <span class="pre">level</span> <span class="pre">namespace</span></code></a>.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="c1">// Pyodide is now ready to use...</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">version</span>
  <span class="s">`</span><span class="p">));</span>
<span class="p">};</span>
<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="running-python-code">
<h5>Running Python code<a class="headerlink" href="#running-python-code" title="Link to this heading">#</a></h5>
<p>Python code is run using the <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.runPython()</span></code></a> function. It takes as
input a string of Python code. If the code ends in an expression, it returns the
result of the expression, translated to JavaScript objects (see
<a class="reference internal" href="#type-translations"><span class="std std-ref">Type translations</span></a>). For example the following code will return the
version string as a JavaScript string:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">version</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>After importing Pyodide, only packages from the standard library are available.
See <a class="reference internal" href="#loading-packages"><span class="std std-ref">Loading packages</span></a> for information about loading additional packages.</p>
</section>
<section id="complete-example">
<span id="id1"></span><h5>Complete example<a class="headerlink" href="#complete-example" title="Link to this heading">#</a></h5>
<p>Create and save a test <code class="docutils literal notranslate"><span class="pre">index.html</span></code> page with the following contents:</p>
<div class="highlight-html-pyodide notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    Pyodide test page <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    Open your browser console to see Pyodide output
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(){</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">version</span>
        <span class="s">`</span><span class="p">));</span>
<span class="w">        </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="nb">print</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nx">main</span><span class="p">();</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="alternative-example">
<h5>Alternative Example<a class="headerlink" href="#alternative-example" title="Link to this heading">#</a></h5>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
      You can execute any Python code. Just enter something in the box below and
      click the button.
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;code&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;sum([1, 2, 3, 4, 5])&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;evaluatePython()&quot;</span><span class="p">&gt;</span>Run<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Output:<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;output&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 100%;&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;6&quot;</span> <span class="na">disabled</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="kd">function</span><span class="w"> </span><span class="nx">addToOutput</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">output</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&gt;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">code</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">output</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Initializing...\n&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="c1">// init Pyodide</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">        </span><span class="nx">output</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;Ready!\n&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodideReadyPromise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">main</span><span class="p">();</span>

<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">evaluatePython</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodideReadyPromise</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">let</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">          </span><span class="nx">addToOutput</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">addToOutput</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="accessing-python-scope-from-javascript">
<h5>Accessing Python scope from JavaScript<a class="headerlink" href="#accessing-python-scope-from-javascript" title="Link to this heading">#</a></h5>
<p>All functions and variables defined in the Python global scope are accessible
via the <a class="reference internal" href="#pyodide.globals" title="pyodide.globals"><code class="xref js js-attr docutils literal notranslate"><span class="pre">pyodide.globals</span></code></a> object.</p>
<p>For example, if you run the code <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[3,</span> <span class="pre">4]</span></code> in Python global scope,
you can access the global variable <code class="docutils literal notranslate"><span class="pre">x</span></code> from JavaScript in your browser’s
developer console with <code class="docutils literal notranslate"><span class="pre">pyodide.globals.get(&quot;x&quot;)</span></code>. The same goes for functions
and imports. See <a class="reference internal" href="#type-translations"><span class="std std-ref">Type translations</span></a> for more details.</p>
<p>You can try it yourself in the browser console. Go to the <a class="external reference" href="../console.html">Pyodide REPL
URL</a> and type the following into the browser
console:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="s">`</span><span class="p">);</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">).</span><span class="nx">toJs</span><span class="p">();</span>
<span class="c1">// &gt;&gt;&gt; [ 3, 4 ]</span>
</pre></div>
</div>
<p>You can assign new values to Python global variables or create new ones from
Javascript.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="c1">// re-assign a new value to an existing variable</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x will be now string&#39;</span><span class="p">);</span>

<span class="c1">// add the js &quot;alert&quot; function to the Python global scope</span>
<span class="c1">// this will show a browser alert if called from Python</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">alert</span><span class="p">);</span>

<span class="c1">// add a &quot;square&quot; function to Python global scope</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span><span class="p">);</span>

<span class="c1">// Test the new &quot;square&quot; Python function</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="n">square</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="s">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="accessing-javascript-scope-from-python">
<h5>Accessing JavaScript scope from Python<a class="headerlink" href="#accessing-javascript-scope-from-python" title="Link to this heading">#</a></h5>
<p>The JavaScript scope can be accessed from Python using the <code class="docutils literal notranslate"><span class="pre">js</span></code> module (see
<a class="reference internal" href="#type-translations-using-js-obj-from-py"><span class="std std-ref">Importing JavaScript objects into Python</span></a>). We can use it to access global
variables and functions from Python. For instance, we can directly manipulate the DOM:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">js</span>

<span class="n">div</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)</span>
<span class="n">div</span><span class="o">.</span><span class="n">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;&lt;h1&gt;This element was created from Python&lt;/h1&gt;&quot;</span>
<span class="n">js</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">prepend</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/downloading-and-deploying"></span><section id="downloading-and-deploying-pyodide">
<span id="downloading-deploying"></span><h4>Downloading and deploying Pyodide<a class="headerlink" href="#downloading-and-deploying-pyodide" title="Link to this heading">#</a></h4>
<section id="downloading-pyodide">
<h5>Downloading Pyodide<a class="headerlink" href="#downloading-pyodide" title="Link to this heading">#</a></h5>
<section id="cdn">
<h6>CDN<a class="headerlink" href="#cdn" title="Link to this heading">#</a></h6>
<p>Pyodide is available from the JsDelivr CDN</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>channel</p></th>
<th class="head"><p>indexURL</p></th>
<th class="head"><p>Comments</p></th>
<th class="head"><p>REPL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Latest release</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide/v0.27.1/full/</span></code></p></td>
<td><p>Recommended, cached by the browser</p></td>
<td><p><a class="reference external" href="https://pyodide.org/en/stable/console.html">link</a></p></td>
</tr>
<tr class="row-odd"><td><p>Dev (<code class="docutils literal notranslate"><span class="pre">main</span></code> branch)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide/dev/full/</span></code></p></td>
<td><p>Re-deployed for each commit on main, no browser caching, should only be used for testing</p></td>
<td><p><a class="reference external" href="https://pyodide.org/en/latest/console.html">link</a></p></td>
</tr>
</tbody>
</table>
</div>
<p>For a given version, several build variants are also available,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;version&gt;/full/</span></code>: the default full build</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;version&gt;/debug/</span></code>: build with unminified <code class="docutils literal notranslate"><span class="pre">pyodide.asm.js</span></code> useful for debugging</p></li>
</ul>
</section>
<section id="github-releases">
<h6>GitHub releases<a class="headerlink" href="#github-releases" title="Link to this heading">#</a></h6>
<p>You can also download Pyodide packages from <a class="reference external" href="https://github.com/pyodide/pyodide/releases">GitHub
releases</a>. The full distribution
including all vendored packages is available as <code class="docutils literal notranslate"><span class="pre">pyodide-0.27.1.tar.bz2</span></code>.
The full distribution is quite large (200+ megabytes). The minimal set of files
needed to start Pyodide is included as <code class="docutils literal notranslate"><span class="pre">pyodide-core-0.27.1.tar.bz2</span></code>. It is
intended for use with node which will automatically install missing packages
from the cdn – it is the same set of files that are installed if you use <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">install</span> <span class="pre">pyodide</span></code>. It may also be convenient for other purposes.</p>
<p>You will need to serve these files yourself.</p>
</section>
</section>
<section id="serving-pyodide-packages">
<span id="id1"></span><h5>Serving Pyodide packages<a class="headerlink" href="#serving-pyodide-packages" title="Link to this heading">#</a></h5>
<section id="serving-locally">
<h6>Serving locally<a class="headerlink" href="#serving-locally" title="Link to this heading">#</a></h6>
<p>With Python 3.7.5+ you can serve Pyodide files locally with <a class="reference external" href="https://docs.python.org/3.12/library/http.server.html#module-http.server" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span>
</pre></div>
</div>
<p>from the Pyodide distribution folder. Navigate to
<a class="reference external" href="http://localhost:8000/console.html">http://localhost:8000/console.html</a> and
the Pyodide repl should load.</p>
</section>
<section id="remote-deployments">
<h6>Remote deployments<a class="headerlink" href="#remote-deployments" title="Link to this heading">#</a></h6>
<p>Any service that hosts static files and that correctly sets the WASM MIME type
and CORS headers will work. For instance, you can use GitHub Pages or similar
services.</p>
<p>For additional suggestions for optimizing the size and load time for Pyodide,
see the <a class="reference external" href="https://emscripten.org/docs/compiling/Deploying-Pages.html">Emscripten documentation about
deployments</a>.</p>
</section>
</section>
<section id="contents-of-pyodide-github-releases">
<h5>Contents of Pyodide Github releases<a class="headerlink" href="#contents-of-pyodide-github-releases" title="Link to this heading">#</a></h5>
<section id="files-in-pyodide-core-0-27-1-tar-bz2">
<h6>Files in <code class="docutils literal notranslate"><span class="pre">pyodide-core-0.27.1.tar.bz2</span></code><a class="headerlink" href="#files-in-pyodide-core-0-27-1-tar-bz2" title="Link to this heading">#</a></h6>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>File Name</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>pyodide.asm.js</p></td>
<td class="text-left"><p>The JavaScript half of the main “binary”. Direct output from the Emscripten compiler. Contains the Emscripten bootstrap code + all JavaScript libraries used by C + the JavaScript/Wasm runtime interop APIs.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>pyodide.asm.wasm</p></td>
<td class="text-left"><p>The WebAssembly half of the main “binary”. Direct output from the Emscripten compiler. Contains all C library code that is statically linked. Also includes enough of libcxx to support things like exceptions in extension modules that use C++.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>pyodide.js</p></td>
<td class="text-left"><p>Exports loadPyodide on globalThis. Legacy support for people who can’t use es6 modules for whatever reason. Prefer pyodide.mjs.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>pyodide.mjs</p></td>
<td class="text-left"><p>A small JS loader shim which exports loadPyodide. It manages downloading the runtime and handling user settings.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>python_stdlib.zip</p></td>
<td class="text-left"><p>The Python Standard Library for pyodide. A zip file consisting of the Python Lib folder (except a few things we’ve unvendored) and the Pyodide Python runtime libraries. Mounted directly into the Pyodide FS and imported using ZipImporter.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>package.json</p></td>
<td class="text-left"><p>Tells node how to use Pyodide, since pyodide-core was primarily intended for use with node.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>pyodide-lock.json</p></td>
<td class="text-left"><p>Lockfile for Python packages, used by pyodide.loadPackage and micropip.install. Necessary in all cases.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="additional-files-in-pyodide-0-27-1-tar-bz2">
<h6>Additional Files in <code class="docutils literal notranslate"><span class="pre">pyodide-0.27.1.tar.bz2</span></code><a class="headerlink" href="#additional-files-in-pyodide-0-27-1-tar-bz2" title="Link to this heading">#</a></h6>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>File Name</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>fonts/</p></td>
<td class="text-left"><p>Used by matplotlib-pyodide.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ffi.d.ts</p></td>
<td class="text-left"><p>Typescript type definitions, useful if you want to use Pyodide in a typescript project.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>pyodide.d.ts</p></td>
<td class="text-left"><p>Typescript type definitions, useful if you want to use Pyodide in a typescript project.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>*.whl</p></td>
<td class="text-left"><p>Contains various Python Wheels like NumPy, Pandas, SciPy, etc. When downloading and including in a project, these no longer need to be loaded from Pyodide’s online wheel repository during runtime.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>*.metadata</p></td>
<td class="text-left"><p>Information about the included wheels, such as name, author, license, dependencies, etc. Allows more efficient package resolution, specified in <a class="reference external" href="https://peps.python.org/pep-0658/">PEP 658</a>.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>*.zip</p></td>
<td class="text-left"><p>These are shared libraries and unvendored Python standard library modules.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>python</p></td>
<td class="text-left"><p>Bash/node polyglot. Only needed for node &lt; 18.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>pyodide.js.map</p></td>
<td class="text-left"><p>Source maps to improve tracebacks. Not really that useful to people outside of the project, probably should be only included in debug builds.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>pyodide.mjs.map</p></td>
<td class="text-left"><p>Source maps to improve tracebacks. Not really that useful to people outside of the project, probably should be only included in debug builds.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>*-tests.tar</p></td>
<td class="text-left"><p>Unvendored tests from wheels. If a wheel includes a test folder, we take them out and put them here.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>console.html</p></td>
<td class="text-left"><p>The Pyodide repl.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<span id="document-usage/index"></span><section id="using-pyodide">
<h4>Using Pyodide<a class="headerlink" href="#using-pyodide" title="Link to this heading">#</a></h4>
<p>Pyodide may be used in a web browser or a backend JavaScript environment.</p>
<section id="web-browsers">
<h5>Web browsers<a class="headerlink" href="#web-browsers" title="Link to this heading">#</a></h5>
<p>To use Pyodide in a web page you need to load <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code> and initialize
Pyodide with <a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a>.</p>
<div class="highlight-html-pyodide notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(){</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="s">&quot;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nx">main</span><span class="p">();</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="#quickstart"><span class="std std-ref">Getting started</span></a> for a walk-through tutorial as well as
<a class="reference internal" href="#loading-packages"><span class="std std-ref">Loading packages</span></a> and <a class="reference internal" href="#type-translations"><span class="std std-ref">Type translations</span></a> for a more in depth
discussion about existing capabilities.</p>
<p>You can also use the <a class="reference external" href="https://www.npmjs.com/package/pyodide">Pyodide NPM
package</a> to integrate Pyodide into your
application.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To avoid confusion, note that:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cdn.jsdelivr.net/pyodide/</span></code> distributes Python packages built with Pyodide as well as <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cdn.jsdelivr.net/npm/pyodide&#64;0.19.0/</span></code> is a mirror of the Pyodide NPM package, which includes none of the WASM files</p></li>
</ul>
</div>
<section id="supported-browsers">
<h6>Supported browsers<a class="headerlink" href="#supported-browsers" title="Link to this heading">#</a></h6>
<p>Webassembly support in browsers is evolving very rapidly,
and we recommend using the latest browsers whenever possible
to take full advantage of Pyodide and its webassembly features.
If you are using an older browser, some features may not work properly.</p>
<p>Currently, Pyodide is being tested against the following browser versions,
so we recommend using a browser version at least equal to or higher than these.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Browser</p></th>
<th class="head"><p>Version</p></th>
<th class="head"><p>Release date</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Firefox</p></td>
<td><p>112</p></td>
<td><p>11 April 2023</p></td>
</tr>
<tr class="row-odd"><td><p>Chrome</p></td>
<td><p>112</p></td>
<td><p>29 March 2023</p></td>
</tr>
<tr class="row-even"><td><p>Safari</p></td>
<td><p>16.4</p></td>
<td><p>27 March 2023</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="web-workers">
<h5>Web Workers<a class="headerlink" href="#web-workers" title="Link to this heading">#</a></h5>
<p>By default, WebAssembly runs in the main browser thread, and it can make UI
non-responsive for long-running computations.</p>
<p>To avoid this situation, one solution is to run <a class="reference internal" href="#using-from-webworker"><span class="std std-ref">Pyodide in a WebWorker</span></a>.</p>
<p>It’s also possible to run <a class="reference internal" href="#using-from-service-worker"><span class="std std-ref">Pyodide in a Service Worker</span></a>.</p>
<p>If you’re not sure whether you need web workers or service workers, here’s an <a class="reference external" href="https://web.dev/workers-overview/">overview and comparison of the two</a>.</p>
</section>
<section id="node-js">
<h5>Node.js<a class="headerlink" href="#node-js" title="Link to this heading">#</a></h5>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Starting with Pyodide 0.25.0, Node.js &lt; 18 is no longer officially supported.
Older versions of Node.js might still work, but they are not tested or guaranteed to work.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following instructions have been tested with Node.js 18.5.0. To use
Pyodide with older versions of Node, you might need to use  additional command line
arguments, see below.</p>
</div>
<p>It is now possible to install the
<a class="reference external" href="https://www.npmjs.com/package/pyodide">Pyodide npm package</a> in Node.js. To
follow these instructions you need at least Pyodide 0.21.0.
You can explicitly ask npm to use
the alpha version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ npm install &quot;pyodide@&gt;=0.21.0-alpha.2&quot;
</pre></div>
</div>
<p>Once installed, you can run the following simple script:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// hello_python.js</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;pyodide&quot;</span><span class="p">);</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">hello_python</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="s2">&quot;1+1&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">hello_python</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Python says that 1+1 =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ node hello_python.js
Python says that 1+1= 2
</pre></div>
</div>
<p>Or you can use the REPL. To start the Node.js REPL with support for top level
await, use <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">--experimental-repl-await</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ node --experimental-repl-await
Welcome to Node.js v18.5.0.
Type &quot;.help&quot; for more information.
&gt; const { loadPyodide } = require(&quot;pyodide&quot;);
undefined
&gt; let pyodide = await loadPyodide();
undefined
&gt; await pyodide.runPythonAsync(&quot;1+1&quot;);
2
</pre></div>
</div>
<div class="toctree-wrapper compound">
<span id="document-usage/loading-custom-python-code"></span><section id="loading-custom-python-code">
<span id="id1"></span><h6>Loading custom Python code<a class="headerlink" href="#loading-custom-python-code" title="Link to this heading">#</a></h6>
<p>Pyodide provides a simple API <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.runPython()</span></code></a> to run Python code.
However, when your Python code grow bigger, putting hundreds of lines inside <code class="docutils literal notranslate"><span class="pre">runPython</span></code> is not scalable.</p>
<p>For larger projects, the best way to run Python code with Pyodide is:</p>
<ol class="arabic simple">
<li><p>create a Python package</p></li>
<li><p>load your Python package into the Pyodide (Emscripten) virtual file system</p></li>
<li><p>import the package with <code class="docutils literal notranslate"><span class="pre">let</span> <span class="pre">mypkg</span> <span class="pre">=</span> <span class="pre">pyodide.pyimport(&quot;mypkgname&quot;)</span></code></p></li>
<li><p>call into your package with <code class="docutils literal notranslate"><span class="pre">mypkg.some_api(some_args)</span></code>.</p></li>
</ol>
<section id="using-wheels">
<h6 aria-level="7">Using wheels<a class="headerlink" href="#using-wheels" title="Link to this heading">#</a></h6>
<p>The best way of serving custom Python code is making it a package in the wheel (.whl) format.
If the package is built as a <code class="docutils literal notranslate"><span class="pre">wheel</span></code> file, you can use <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> to
install the package. See <a class="reference internal" href="#loading-packages"><span class="std std-ref">Loading packages</span></a> for more information.</p>
<div class="warning admonition">
<p class="admonition-title">Packages with C extensions</p>
<p>If your Python code contains C extensions,
it needs to be built in a specialized way (See <a class="reference internal" href="#new-packages"><span class="std std-ref">Creating a Pyodide package</span></a>).</p>
</div>
</section>
<section id="loading-then-importing-python-code">
<h6 aria-level="7">Loading then importing Python code<a class="headerlink" href="#loading-then-importing-python-code" title="Link to this heading">#</a></h6>
<p>It is also possible to download and import Python code from an external source.
We recommend that you serve all files in an archive, instead of individually downloading each Python script.</p>
<section id="from-python">
<h6 aria-level="8">From Python<a class="headerlink" href="#from-python" title="Link to this heading">#</a></h6>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="c1">// Downloading an archive</span>
<span class="k">await</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPythonAsync</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyfetch</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">pyfetch</span><span class="p">(</span><span class="s2">&quot;https://.../your_package.tar.gz&quot;</span><span class="p">)</span> <span class="c1"># .zip, .whl, ...</span>
    <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">unpack_archive</span><span class="p">()</span> <span class="c1"># by default, unpacks to the current dir</span>
<span class="s">`</span><span class="p">)</span>
<span class="nx">pkg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;your_package&quot;</span><span class="p">);</span>
<span class="nx">pkg</span><span class="p">.</span><span class="nx">do_something</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="c1">// Downloading a single file</span>
<span class="k">await</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPythonAsync</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyfetch</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">pyfetch</span><span class="p">(</span><span class="s2">&quot;https://.../script.py&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;script.py&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">bytes</span><span class="p">())</span>
<span class="s">`</span><span class="p">)</span>
<span class="nx">pkg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>
<span class="nx">pkg</span><span class="p">.</span><span class="nx">do_something</span><span class="p">();</span>
</pre></div>
</div>
<div class="info admonition">
<p class="admonition-title">What is pyfetch?</p>
<p>Pyodide provides <a class="reference internal" href="#pyodide.http.pyfetch" title="pyodide.http.pyfetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyfetch()</span></code></a>,
which is a convenient wrapper of JavaScript <code class="docutils literal notranslate"><span class="pre">fetch</span></code>.
See <a class="reference internal" href="#load-external-files-in-pyodide"><span class="std std-ref">How can I load external files in Pyodide?</span></a> for more information.</p>
</div>
</section>
<section id="from-javascript">
<h6 aria-level="8">From JavaScript<a class="headerlink" href="#from-javascript" title="Link to this heading">#</a></h6>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;https://.../your_package.tar.gz&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// .zip, .whl, ...</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">arrayBuffer</span><span class="p">();</span>
<span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">unpackArchive</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;gztar&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// by default, unpacks to the current dir</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;your_package&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Warning on unpacking a wheel package</p>
<p>Since a wheel package is actually a zip archive,
you can use <a class="reference internal" href="#pyodide.unpackArchive" title="pyodide.unpackArchive"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.unpackArchive()</span></code></a>
to unpack a wheel package, instead of using <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a>.</p>
<p>However, <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a> does dependency resolution when installing packages,
while <a class="reference internal" href="#pyodide.unpackArchive" title="pyodide.unpackArchive"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.unpackArchive()</span></code></a> simply unpacks the archive.
So you must be aware of that each dependencies of a package need to be installed manually
before unpacking a wheel.</p>
<blockquote>
<div><p><em>Future plans:</em> we are planning to support a method for a static dependency resolution
(See: <a class="reference external" href="https://github.com/pyodide/pyodide/issues/2045">pyodide#2045</a>).</p>
</div></blockquote>
</div>
</section>
</section>
<section id="running-external-code-directly">
<h6 aria-level="7">Running external code directly<a class="headerlink" href="#running-external-code-directly" title="Link to this heading">#</a></h6>
<p>If you want to run a single Python script from an external source in a simplest way,
you can:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;https://some_url/.../code.py&quot;</span><span class="p">)).</span><span class="nx">text</span><span class="p">());</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/file-system"></span><section id="dealing-with-the-file-system">
<span id="file-system"></span><h6>Dealing with the file system<a class="headerlink" href="#dealing-with-the-file-system" title="Link to this heading">#</a></h6>
<p>Pyodide includes a file system provided by Emscripten. In JavaScript, the
Pyodide file system can be accessed through <a class="reference internal" href="#pyodide.FS" title="pyodide.FS"><code class="xref js js-attr docutils literal notranslate"><span class="pre">pyodide.FS</span></code></a> which re-exports
the <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api">Emscripten File System
API</a></p>
<p><strong>Example: Reading from the file system</strong></p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

  <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/hello.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;hello world!&quot;</span><span class="p">)</span>
<span class="s">`</span><span class="p">);</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">&quot;/hello.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span><span class="w"> </span><span class="c1">// ==&gt; &quot;hello world!&quot;</span>
</pre></div>
</div>
<p><strong>Example: Writing to the file system</strong></p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;hello world!&quot;</span><span class="p">;</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="s2">&quot;/hello.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">encoding</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;utf8&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

  <span class="nb">print</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/hello.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<section id="mounting-a-file-system">
<h6 aria-level="7">Mounting a file system<a class="headerlink" href="#mounting-a-file-system" title="Link to this heading">#</a></h6>
<p>The default file system used in Pyodide is <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#memfs">MEMFS</a>,
which is a virtual in-memory file system. The data stored in MEMFS will be lost when the page is reloaded.</p>
<p>If you wish for files to persist, you can mount other file systems.
Other file systems provided by Emscripten are <code class="docutils literal notranslate"><span class="pre">IDBFS</span></code>, <code class="docutils literal notranslate"><span class="pre">NODEFS</span></code>, <code class="docutils literal notranslate"><span class="pre">PROXYFS</span></code>, <code class="docutils literal notranslate"><span class="pre">WORKERFS</span></code>.
Note that some filesystems can only be used in specific runtime environments.
See <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api">Emscripten File System API</a> for more details.
For instance, to store data persistently between page reloads, one could mount
a folder with the
<a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api-idbfs">IDBFS file system</a></p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">mountDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/mnt&quot;</span><span class="p">;</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">mkdirTree</span><span class="p">(</span><span class="nx">mountDir</span><span class="p">);</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">filesystems</span><span class="p">.</span><span class="nx">IDBFS</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="nx">mountDir</span><span class="p">);</span>
</pre></div>
</div>
<p>If you are using Node.js you can access the native file system by mounting <code class="docutils literal notranslate"><span class="pre">NODEFS</span></code>.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">mountDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/mnt&quot;</span><span class="p">;</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">mkdirTree</span><span class="p">(</span><span class="nx">mountDir</span><span class="p">);</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">filesystems</span><span class="p">.</span><span class="nx">NODEFS</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">root</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">mountDir</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;/mnt&#39;</span><span class="p">))</span><span class="s">&quot;</span><span class="p">);</span>
<span class="c1">// ==&gt; The list of files in the Node working directory</span>
</pre></div>
</div>
</section>
</section>
<section id="experimental-using-the-native-file-system-in-the-browser">
<span id="nativefs-api"></span><h6>(Experimental) Using the native file system in the browser<a class="headerlink" href="#experimental-using-the-native-file-system-in-the-browser" title="Link to this heading">#</a></h6>
<p>You can access the native file system from the browser using the
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API">File System Access API</a>.</p>
<div class="warning admonition">
<p class="admonition-title">This is experimental</p>
<p>The File System Access API is only supported in Chromium based browsers: Chrome and Edge (as of 2022/08/18).</p>
</div>
<section id="mounting-a-directory">
<h6 aria-level="7">Mounting a directory<a class="headerlink" href="#mounting-a-directory" title="Link to this heading">#</a></h6>
<p>Pyodide provides an API <a class="reference internal" href="#pyodide.mountNativeFS" title="pyodide.mountNativeFS"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.mountNativeFS()</span></code></a> which mounts a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a> into the Pyodide Python file system.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">dirHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">showDirectoryPicker</span><span class="p">();</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">permissionStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">dirHandle</span><span class="p">.</span><span class="nx">requestPermission</span><span class="p">({</span>
<span class="w">  </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;readwrite&quot;</span><span class="p">,</span>
<span class="p">});</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">permissionStatus</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;granted&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;readwrite access to directory not granted&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">nativefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">mountNativeFS</span><span class="p">(</span><span class="s2">&quot;/mount_dir&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">dirHandle</span><span class="p">);</span>

<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;/mount_dir&#39;</span><span class="p">))</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="synchronizing-changes-to-native-file-system">
<h6 aria-level="7">Synchronizing changes to native file system<a class="headerlink" href="#synchronizing-changes-to-native-file-system" title="Link to this heading">#</a></h6>
<p>Due to browser limitations, the changes in the mounted file system
is not synchronized by default. In order to persist any operations
to an native file system, you must call</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="c1">// nativefs is the returned from: await pyodide.mountNativeFS(&#39;/mount_dir&#39;, dirHandle)</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/mount_dir/new_file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
<span class="s">`</span><span class="p">);</span>

<span class="c1">// new_file.txt does not exist in native file system</span>

<span class="k">await</span><span class="w"> </span><span class="nx">nativefs</span><span class="p">.</span><span class="nx">syncfs</span><span class="p">();</span>

<span class="c1">// new_file.txt will now exist in native file system</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">syncfs</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">callback_func</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/accessing-files"></span><section id="accessing-files-quick-reference">
<span id="accessing-files-quickref"></span><h6>Accessing Files Quick Reference<a class="headerlink" href="#accessing-files-quick-reference" title="Link to this heading">#</a></h6>
<p>For development of modules to use in Pyodide, the best experience comes from
using Pyodide in Node and mounting the development directory into Pyodide using
the NodeFS. In the NodeFS, all changes to your native file system are
immediately reflected in Pyodide and vice versa.</p>
<p>If your code is browser-only, you can use the Chrome <code class="docutils literal notranslate"><span class="pre">NativeFS</span></code> for development.
This will not automatically sync up with your native file system, but it is
still quite convenient.</p>
<section id="in-node-js">
<h6 aria-level="7">In Node.js<a class="headerlink" href="#in-node-js" title="Link to this heading">#</a></h6>
<p>It’s recommended to use <a class="reference internal" href="#pyodide.mountNodeFS" title="pyodide.mountNodeFS"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.mountNodeFS()</span></code></a> to mount the host file
system so that it is accessible from inside of Pyodide. For example if you have
a Python package in a folder called <code class="docutils literal notranslate"><span class="pre">my_package</span></code>, you can do:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">mountNodeFS</span><span class="p">(</span><span class="s2">&quot;my_package&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/path/to/my_package&quot;</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">my_package</span>
<span class="c1"># ... use it</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="in-the-browser">
<h6 aria-level="7">In the browser<a class="headerlink" href="#in-the-browser" title="Link to this heading">#</a></h6>
<p>To access local files in Chrome, you can use the File System Access API to
acquire a directory handle and then mount the directory into the Pyodide file
system with <a class="reference internal" href="#pyodide.mountNativeFS" title="pyodide.mountNativeFS"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.mountNativeFS()</span></code></a>. To acquire the directory handle,
you have to fill out a folder picker the first time. The handle can subsequently
be stored in the <code class="docutils literal notranslate"><span class="pre">IndexedDB</span></code>. You will still be prompted for read and write
access, but you don’t have to deal with the folder picker again.</p>
<p>The following code is a good starting point:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">get</span><span class="p">,</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">import</span><span class="p">(</span>
<span class="w">  </span><span class="s2">&quot;https://unpkg.com/idb-keyval@5.0.2/dist/esm/index.js&quot;</span>
<span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * Mount a folder from your native filesystem as the directory</span>
<span class="cm"> * `pyodideDirectory`. If `directoryKey` was used previously, then it will reuse</span>
<span class="cm"> * the same folder as last time. Otherwise, it will show a directory picker.</span>
<span class="cm"> */</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">mountDirectory</span><span class="p">(</span><span class="nx">pyodideDirectory</span><span class="p">,</span><span class="w"> </span><span class="nx">directoryKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">directoryHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">get</span><span class="p">(</span><span class="nx">directoryKey</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mountdirid&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;readwrite&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">directoryHandle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">directoryHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">showDirectoryPicker</span><span class="p">(</span><span class="nx">opts</span><span class="p">);</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">set</span><span class="p">(</span><span class="nx">directoryKey</span><span class="p">,</span><span class="w"> </span><span class="nx">directoryHandle</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">permissionStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">directoryHandle</span><span class="p">.</span><span class="nx">requestPermission</span><span class="p">(</span><span class="nx">opts</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">permissionStatus</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;granted&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;readwrite access to directory not granted&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">syncfs</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">mountNativeFS</span><span class="p">(</span>
<span class="w">    </span><span class="nx">pyodideDirectory</span><span class="p">,</span>
<span class="w">    </span><span class="nx">directoryHandle</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">syncfs</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#nativefs-api"><span class="std std-ref">(Experimental) Using the native file system in the browser</span></a> for more information.</p>
</section>
<section id="downloading-external-archives">
<h6 aria-level="7">Downloading external archives<a class="headerlink" href="#downloading-external-archives" title="Link to this heading">#</a></h6>
<p>If you are using Pyodide in the browser, you should download external files and
save them to the virtual file system. The recommended way to do this is to zip
the files and unpack them into the file system with
<a class="reference internal" href="#pyodide.unpackArchive" title="pyodide.unpackArchive"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.unpackArchive()</span></code></a>:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">zipResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;myfiles.zip&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">zipBinary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">zipResponse</span><span class="p">.</span><span class="nx">arrayBuffer</span><span class="p">();</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">unpackArchive</span><span class="p">(</span><span class="nx">zipBinary</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;zip&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can also download the files from Python using
<a class="reference internal" href="#pyodide.http.pyfetch" title="pyodide.http.pyfetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyfetch()</span></code></a>, which is a convenient wrapper of JavaScript
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">fetch()</span></code></a>:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPythonAsync</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyfetch</span>
  <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">pyfetch</span><span class="p">(</span><span class="s2">&quot;https://some_url/myfiles.zip&quot;</span><span class="p">)</span>
  <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">unpack_archive</span><span class="p">()</span>
<span class="s">`</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/webworker"></span><section id="using-pyodide-in-a-web-worker">
<span id="using-from-webworker"></span><h6>Using Pyodide in a web worker<a class="headerlink" href="#using-pyodide-in-a-web-worker" title="Link to this heading">#</a></h6>
<p>This document includes an example demonstrating how to use Pyodide to execute
Python scripts asynchronously in a web worker.</p>
<p>Let’s start with <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API">the definition of a worker</a>.</p>
<blockquote>
<div><p>A worker is an object created using a constructor (e.g. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Worker/Worker">Worker()</a>)
that runs a named JavaScript file — this file contains the code
that will run in the worker thread; workers run in another global context that
is different from the current window.</p>
</div></blockquote>
<p>A lot of Python programs do long-running synchronous computations. Running them
in the main thread blocks the UI. Using a web worker is advantageous because the
Python code runs in a separate thread from your UI and does not impact your
application’s responsiveness.</p>
<p>On the other hand, since workers run in a separate global context, you cannot
directly share globals between a worker and the main thread. In particular, a
worker cannot directly manipulate the DOM.</p>
<section id="detailed-example">
<h6 aria-level="7">Detailed example<a class="headerlink" href="#detailed-example" title="Link to this heading">#</a></h6>
<p>In this example process we will have three parties involved:</p>
<ul class="simple">
<li><p>The <strong>web worker</strong> is responsible for running scripts in its own separate thread.</p></li>
<li><p>The <strong>worker API</strong> exposes a consumer-to-provider communication interface.</p></li>
<li><p>The <strong>consumer</strong>s want to run some scripts outside the main thread, so they
don’t block the main thread.</p></li>
</ul>
<section id="consumers">
<h6 aria-level="8">Consumers<a class="headerlink" href="#consumers" title="Link to this heading">#</a></h6>
<p>Our goal is to run some Python code in another thread. This other thread will
not have access to the main thread objects. Therefore, we will need an API that
takes as input both the Python <code class="docutils literal notranslate"><span class="pre">script</span></code> we want to run and the <code class="docutils literal notranslate"><span class="pre">context</span></code> on
which it relies (some JavaScript variables that our code needs access to). Let’s
first describe what API we would like to have.</p>
<p>Here is an example of consumer that will exchange with the web worker, via
<code class="docutils literal notranslate"><span class="pre">workerApi.mjs</span></code>. It runs the following Python <code class="docutils literal notranslate"><span class="pre">script</span></code> using the provided
<code class="docutils literal notranslate"><span class="pre">context</span></code> and a function called <code class="docutils literal notranslate"><span class="pre">asyncRun()</span></code>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">asyncRun</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./workerApi.js&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">    import statistics</span>
<span class="sb">    statistics.stdev(A_rank)</span>
<span class="sb">`</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">A_rank</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="mf">3.7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.6</span><span class="p">,</span><span class="w"> </span><span class="mf">5.8</span><span class="p">],</span>
<span class="p">};</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">asyncRun</span><span class="p">(</span><span class="nx">script</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pyodideWorker result:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pyodideWorker error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
<p>Before writing the API, let’s first have a look at how the worker runs the
<code class="docutils literal notranslate"><span class="pre">script</span></code> using a given <code class="docutils literal notranslate"><span class="pre">context</span></code>.</p>
</section>
<section id="web-worker">
<h6 aria-level="8">Web worker<a class="headerlink" href="#web-worker" title="Link to this heading">#</a></h6>
<p>Here is the worker code:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// webworker.mjs</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.mjs&quot;</span><span class="p">;</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">pyodideReadyPromise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>

<span class="nx">self</span><span class="p">.</span><span class="nx">onmessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// make sure loading is done</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodideReadyPromise</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">python</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Now load any packages we need, run the code, and send the result back.</span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackagesFromImports</span><span class="p">(</span><span class="nx">python</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// make a Python dictionary with the data from `context`</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">globals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dict</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">context</span><span class="p">));</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Execute the python code in this context</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="nx">python</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="nx">self</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">self</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="the-worker-api">
<h6 aria-level="8">The worker API<a class="headerlink" href="#the-worker-api" title="Link to this heading">#</a></h6>
<p>Now that we established what the two sides need and how they operate, let’s
connect them using an API that wraps the message passing code into an
asynchronous function.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// workerApi.mjs</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getPromiseAndResolve</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">resolve</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">promise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">resolve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">promise</span><span class="p">,</span><span class="w"> </span><span class="nx">resolve</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Each message needs a unique id to identify the response. In a real example,</span>
<span class="c1">// we might use a real uuid package</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lastId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">lastId</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Add an id to msg, send it to worker, then wait for a response with the same id.</span>
<span class="c1">// When we get such a response, use it to resolve the promise.</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">requestResponse</span><span class="p">(</span><span class="nx">worker</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">promise</span><span class="p">,</span><span class="w"> </span><span class="nx">resolve</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getPromiseAndResolve</span><span class="p">();</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">idWorker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getId</span><span class="p">();</span>
<span class="w">  </span><span class="nx">worker</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">listener</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="o">?</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">idWorker</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// This listener is done so remove it.</span>
<span class="w">    </span><span class="nx">worker</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">listener</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Filter the id out of the result</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">rest</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
<span class="w">    </span><span class="nx">resolve</span><span class="p">(</span><span class="nx">rest</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="nx">worker</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">idWorker</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">msg</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">promise</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">pyodideWorker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Worker</span><span class="p">(</span><span class="s2">&quot;./webworker.mjs&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;module&quot;</span><span class="w"> </span><span class="p">});</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">asyncRun</span><span class="p">(</span><span class="nx">script</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">requestResponse</span><span class="p">(</span><span class="nx">pyodideWorker</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">context</span><span class="p">,</span>
<span class="w">    </span><span class="nx">python</span><span class="o">:</span><span class="w"> </span><span class="nx">script</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-usage/service-worker"></span><section id="using-pyodide-in-a-service-worker">
<span id="using-from-service-worker"></span><h6>Using Pyodide in a service worker<a class="headerlink" href="#using-pyodide-in-a-service-worker" title="Link to this heading">#</a></h6>
<p>This document describes how to use Pyodide to execute Python scripts in a
service worker. Compared to typical web workers, service workers are more
related to acting as a network proxy, handling background tasks, and things like
caching and offline. See <a class="reference external" href="https://web.dev/workers-overview/#use-cases">this
article</a> for more info.</p>
<section id="detailed-example">
<h6 aria-level="7">Detailed example<a class="headerlink" href="#detailed-example" title="Link to this heading">#</a></h6>
<p>For our example, we’ll be talking about how we can use a service worker to
intercept a fetch call for some data and modify the data. We will have two
parties involved:</p>
<ul class="simple">
<li><p>The <strong>service worker</strong> which will be intercepting fetch calls for JSON, and
modifying the data before returning it</p></li>
<li><p>The <strong>consumer</strong> which will be fetching some JSON data</p></li>
</ul>
<p>To keep things simple, all we’ll do is add a field to a fetched JSON object, but
an example of a more interesting use case is transforming fetched tabular data
using numpy, and caching the result before returning it.</p>
<p>Please note that service workers will only work on https and localhost, so you
will require a server to be running for this example.</p>
<section id="setup">
<h6 aria-level="8">Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h6>
<p>Setup your project to serve the service worker script <code class="docutils literal notranslate"><span class="pre">sw.js</span></code>, and a
<code class="docutils literal notranslate"><span class="pre">XMLHttpRequest</span></code> polyfill - one such polyfill that works in service workers is
<a class="reference external" href="https://www.npmjs.com/package/xhr-shim">xhr-shim</a>. You should also serve
<code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code>, and all its associated <code class="docutils literal notranslate"><span class="pre">.asm.js</span></code>, <code class="docutils literal notranslate"><span class="pre">.json</span></code>, and <code class="docutils literal notranslate"><span class="pre">.wasm</span></code>
files as well, though this is not strictly required if <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code> is pointing
to a site serving current versions of these files. The simplest way to serve the
required files is to use a CDN, such as <code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide</span></code>.</p>
<p>Update the <code class="docutils literal notranslate"><span class="pre">sw.js</span></code> sample so that it has a valid URL for <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code>, and sets
<a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">indexURL</span></code></a> to the location of the supporting
files.</p>
<p>You’ll also need to serve <code class="docutils literal notranslate"><span class="pre">data.json</span></code>, a JSON file containing a simple object -
a sample is provided below:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Jem&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="consumer">
<h6 aria-level="8">Consumer<a class="headerlink" href="#consumer" title="Link to this heading">#</a></h6>
<p>In our consumer, we want to register our service worker - in the html below,
we’re registering a classic-type service worker. For convenience, we also
provide a button that fetches data and logs it.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">      </span><span class="cm">/* UPDATE PATHS TO POINT TO YOUR ASSETS */</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">SERVICE_WORKER_PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/sw.js&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">JSON_FILE_PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./data.json&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="cm">/* IF USING MODULE-TYPE SERVICE WORKER, REPLACE THESE OPTIONS */</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">REGISTRATION_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">scope</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="c1">// modified snippet from</span>
<span class="w">      </span><span class="c1">// https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">registerServiceWorker</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;serviceWorker&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">navigator</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">registration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">serviceWorker</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span>
<span class="w">              </span><span class="nx">SERVICE_WORKER_PATH</span><span class="p">,</span>
<span class="w">              </span><span class="nx">REGISTRATION_OPTIONS</span><span class="p">,</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">registration</span><span class="p">.</span><span class="nx">installing</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Service worker installing&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">registration</span><span class="p">.</span><span class="nx">waiting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Service worker installed&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">registration</span><span class="p">.</span><span class="nx">active</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Service worker active&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Registration failed with </span><span class="si">${</span><span class="nx">error</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchAndLogData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">JSON_FILE_PATH</span><span class="p">)).</span><span class="nx">json</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Failed to fetch&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">registerServiceWorker</span><span class="p">();</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;fetchAndLogData()&quot;</span><span class="p">&gt;</span>Fetch and log data<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="service-worker">
<h6 aria-level="8">Service worker<a class="headerlink" href="#service-worker" title="Link to this heading">#</a></h6>
<p>To set up Pyodide in a service worker, you’ll need to do the following:</p>
<ol class="arabic simple">
<li><p>Polyfill <code class="docutils literal notranslate"><span class="pre">XMLHttpRequest</span></code> because it isn’t available in service workers’
global scopes.</p></li>
<li><p>Import Pyodide</p></li>
<li><p>We don’t need it for this example, but if you’re planning on calling
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> after <a class="reference external" href="https://web.dev/service-worker-lifecycle/">installation</a>
of the service worker, import <code class="docutils literal notranslate"><span class="pre">pyodide.asm.js</span></code> too.</p></li>
</ol>
<p>After all the required scripts are imported, we call <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> to set up
Pyodide, then create a Python function called <code class="docutils literal notranslate"><span class="pre">modify_data</span></code>. This function add a
<code class="docutils literal notranslate"><span class="pre">count</span></code> property to an object, where <code class="docutils literal notranslate"><span class="pre">count</span></code> is equal to the number of times
<code class="docutils literal notranslate"><span class="pre">modify_data</span></code> is called. We will access this function via a handle assigned to
the Javascript variable <code class="docutils literal notranslate"><span class="pre">modifyData</span></code>. We also set up a fetch event handler that
intercepts requests for json files so that any JSON object that is fetched is
modified using <code class="docutils literal notranslate"><span class="pre">modifyData</span></code>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="cm">/* sw.js */</span>
<span class="cm">/* MODIFY IMPORT PATHS TO POINT TO YOUR SCRIPTS, REPLACE IF USING MODULE-TYPE WORKER */</span>
<span class="c1">// We&#39;re using the npm package xhr-shim, which assigns self.XMLHttpRequestShim</span>
<span class="nx">importScripts</span><span class="p">(</span><span class="s2">&quot;./node_modules/xhr-shim/src/index.js&quot;</span><span class="p">);</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequestShim</span><span class="p">;</span>
<span class="nx">importScripts</span><span class="p">(</span><span class="s2">&quot;./pyodide.js&quot;</span><span class="p">);</span>
<span class="c1">// importScripts(&quot;./pyodide.asm.js&quot;); // if loading Pyodide after installation phase, you&#39;ll need to import this too</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">modifyData</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">;</span>
<span class="nx">loadPyodide</span><span class="p">({}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">_pyodide</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_pyodide</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)();</span>

<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span>
<span class="w">    </span><span class="sb">`</span>
<span class="sb">    import json</span>

<span class="sb">    counter = 0</span>
<span class="sb">    def modify_data(data):</span>
<span class="sb">        global counter</span>
<span class="sb">        counter += 1</span>
<span class="sb">        dict = data.to_py()</span>
<span class="sb">        dict[&#39;count&#39;] = counter</span>
<span class="sb">        return dict</span>
<span class="sb">    `</span><span class="p">,</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="o">:</span><span class="w"> </span><span class="nx">namespace</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// assign the modify_data function from the Python context to a Javascript variable</span>
<span class="w">  </span><span class="nx">modifyData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">namespace</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;modify_data&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">namespace</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;fetch&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">modifyData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// For this example, throw so it&#39;s clear that the worker isn&#39;t ready to modify responses</span>
<span class="w">      </span><span class="c1">// This is because we don&#39;t want to return a response that isn&#39;t modified yet</span>
<span class="w">      </span><span class="c1">// If your service worker would return the same response as a server (eg. it&#39;s just performing calculations closer to home)</span>
<span class="w">      </span><span class="c1">// then you may want to let the event through without doing anything</span>
<span class="w">      </span><span class="nx">event</span><span class="p">.</span><span class="nx">respondWith</span><span class="p">(</span>
<span class="w">        </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="s2">&quot;Python code isn&#39;t set up yet, try again in a bit&quot;</span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">event</span><span class="p">.</span><span class="nx">respondWith</span><span class="p">(</span>
<span class="w">        </span><span class="c1">// We aren&#39;t using the async await syntax because event.respondWith needs to respond synchronously</span>
<span class="w">        </span><span class="c1">// it can&#39;t be executing after an awaited promise within the fetch event handler, otherwise you&#39;ll get this</span>
<span class="w">        </span><span class="c1">// Uncaught (in promise) DOMException: Failed to execute &#39;respondWith&#39; on &#39;FetchEvent&#39;: The event has already been responded to</span>
<span class="w">        </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">)</span>
<span class="w">          </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">          </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">originalData</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">modifyData</span><span class="p">(</span><span class="nx">originalData</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyproxies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">            </span><span class="c1">// Because toJs gives us a Map, we transform it to a plain Javascript object before changing it to JSON</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span>
<span class="w">              </span><span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span>
<span class="w">                </span><span class="nx">proxy</span><span class="p">.</span><span class="nx">toJs</span><span class="p">({</span>
<span class="w">                  </span><span class="nx">pyproxies</span><span class="p">,</span>
<span class="w">                </span><span class="p">}),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">            </span><span class="c1">// Craft the new JSON response</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Response</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Code below is for easy iteration during development, you may want to remove or modify in a prod environment:</span>

<span class="c1">// Immediately become the active service worker once installed, so we don&#39;t have a stale service worker intercepting requests</span>
<span class="c1">// You can remove this code and achieve a similar thing by enabling &quot;Update on Reload&quot; in devtools, if supported:</span>
<span class="c1">// https://web.dev/service-worker-lifecycle/#update-on-reload</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">self</span><span class="p">.</span><span class="nx">skipWaiting</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// With this, we won&#39;t need to reload the page before the service worker can intercept fetch requests</span>
<span class="c1">// https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim#examples</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;activate&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">event</span><span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">clients</span><span class="p">.</span><span class="nx">claim</span><span class="p">());</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
</section>
<section id="using-module-type-service-workers">
<h6 aria-level="7">Using module-type service workers<a class="headerlink" href="#using-module-type-service-workers" title="Link to this heading">#</a></h6>
<p>While classic-type service workers have better cross-browser compatibility at
the moment, module-type service workers make it easier to include external
libraries in your service workers via ES module imports. There are environments
where we can safely assume ES module support in service workers, such as
Chromium-based browser extensions’ background scripts. With the adjustments
outlined below, you should be able to use our example with a module-type service
worker.</p>
<section id="id1">
<h6 aria-level="8">Setup<a class="headerlink" href="#id1" title="Link to this heading">#</a></h6>
<p>Serve <code class="docutils literal notranslate"><span class="pre">pyodide.mjs</span></code> instead of <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code>, the rest of the setup remains the
same.</p>
</section>
<section id="consumers">
<h6 aria-level="8">Consumers<a class="headerlink" href="#consumers" title="Link to this heading">#</a></h6>
<p>We need to use different registration options on the consumer side. Replace this
section of the script:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="cm">/* IF USING MODULE-TYPE SERVICE WORKER, REPLACE THESE OPTIONS */</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">REGISTRATION_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">scope</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>With the following:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">REGISTRATION_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">scope</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="c1">// Note that specifying the type option can cause errors if the browser doesn&#39;t support module-type service workers</span>
<span class="w">  </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;module&quot;</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="id2">
<h6 aria-level="8">Service worker<a class="headerlink" href="#id2" title="Link to this heading">#</a></h6>
<p>On the service worker side, we need to change the way we import scripts. Replace
the importScripts calls shown below:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="cm">/* sw.js */</span>
<span class="cm">/* MODIFY IMPORT PATHS TO POINT TO YOUR SCRIPTS, REPLACE IF USING MODULE-TYPE WORKER */</span>
<span class="c1">// We&#39;re using the npm package xhr-shim, which assigns self.XMLHttpRequestShim</span>
<span class="nx">importScripts</span><span class="p">(</span><span class="s2">&quot;./node_modules/xhr-shim/src/index.js&quot;</span><span class="p">);</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequestShim</span><span class="p">;</span>
<span class="nx">importScripts</span><span class="p">(</span><span class="s2">&quot;./pyodide.js&quot;</span><span class="p">);</span>
<span class="c1">// importScripts(&quot;./pyodide.asm.js&quot;); // if loading Pyodide after installation phase, you&#39;ll need to import this too</span>
</pre></div>
</div>
<p>With the following imports:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="cm">/* sw.js */</span>
<span class="cm">/* MODIFY IMPORT PATHS TO POINT TO YOUR SCRIPTS */</span>
<span class="c1">// We&#39;re using the npm package xhr-shim, which assigns self.XMLHttpRequestShim</span>
<span class="k">import</span><span class="w"> </span><span class="s2">&quot;./node_modules/xhr-shim/src/index.js&quot;</span><span class="p">;</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">XMLHttpRequestShim</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s2">&quot;./pyodide.asm.js&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// IMPORTANT: This is compulsory in a module-type service worker, which cannot use importScripts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./pyodide.mjs&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Note the .mjs extension</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-usage/working-with-bundlers"></span><section id="working-with-bundlers">
<span id="id1"></span><h6>Working with Bundlers<a class="headerlink" href="#working-with-bundlers" title="Link to this heading">#</a></h6>
<section id="webpack">
<h6 aria-level="7">Webpack<a class="headerlink" href="#webpack" title="Link to this heading">#</a></h6>
<p>There is a <a class="reference external" href="https://github.com/pyodide/pyodide-webpack-plugin">Pyodide Webpack Plugin</a> to load Pyodide from a CDN in a Webpack
project.</p>
</section>
<section id="vite">
<h6 aria-level="7">Vite<a class="headerlink" href="#vite" title="Link to this heading">#</a></h6>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following instructions have been tested with Pyodide 0.26.2, Vite 5.4.9, and
vite-plugin-pyodide 2.0.0.</p>
</div>
<p>First, install the Pyodide and vite-plugin-pyodide npm packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ npm install pyodide vite-plugin-static-copy
</pre></div>
</div>
<p>Then, in your <code class="docutils literal notranslate"><span class="pre">vite.config.mjs</span></code> file, exclude Pyodide from <a class="reference external" href="https://vitejs.dev/guide/dep-pre-bundling.html">Vite’s dependency
pre-bundling</a> by setting <code class="docutils literal notranslate"><span class="pre">optimizeDeps.exclude</span></code> and ensure that
all Pyodide files will be available in <code class="docutils literal notranslate"><span class="pre">dist/assets</span></code> for production builds by
using a Vite plugin:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">defineConfig</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;vite&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">viteStaticCopy</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;vite-plugin-static-copy&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dirname</span><span class="p">,</span><span class="w"> </span><span class="nx">join</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;path&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fileURLToPath</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;url&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">PYODIDE_EXCLUDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="s2">&quot;!**/*.{md,html}&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;!**/*.d.ts&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;!**/*.whl&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;!**/node_modules&quot;</span><span class="p">,</span>
<span class="p">];</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">viteStaticCopyPyodide</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodideDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dirname</span><span class="p">(</span><span class="nx">fileURLToPath</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">&quot;pyodide&quot;</span><span class="p">)));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">viteStaticCopy</span><span class="p">({</span>
<span class="w">    </span><span class="nx">targets</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nx">src</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">join</span><span class="p">(</span><span class="nx">pyodideDir</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">PYODIDE_EXCLUDE</span><span class="p">),</span>
<span class="w">        </span><span class="nx">dest</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;assets&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">defineConfig</span><span class="p">({</span>
<span class="w">  </span><span class="nx">optimizeDeps</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">exclude</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;pyodide&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">viteStaticCopyPyodide</span><span class="p">()],</span>
<span class="p">});</span>
</pre></div>
</div>
<p>You can test your setup with this <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Vite + Pyodide<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;main.mjs&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>And this <code class="docutils literal notranslate"><span class="pre">src/main.mjs</span></code> file:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;pyodide&quot;</span><span class="p">;</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">hello_python</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="s2">&quot;1+1&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">hello_python</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Python says that 1+1 =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Make sure this works both in Vite’s dev mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npx</span> <span class="n">vite</span>
</pre></div>
</div>
<p>And as a production build:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npx</span> <span class="n">vite</span> <span class="n">build</span>
<span class="n">npx</span> <span class="n">vite</span> <span class="n">preview</span>
</pre></div>
</div>
</section>
</section>
</div>
</section>
</section>
<span id="document-usage/loading-packages"></span><section id="loading-packages">
<span id="id1"></span><h4>Loading packages<a class="headerlink" href="#loading-packages" title="Link to this heading">#</a></h4>
<p>Only the Python standard library is available after importing Pyodide.
To use other packages, you’ll need to load them using either:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> (Python) for pure Python packages with wheels as
well as Pyodide packages (including Emscripten/wasm32 binary wheels). It can
install packages from PyPI, the JsDelivr CDN or from other URLs.</p></li>
<li><p><a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> (Javascript) for packages built with Pyodide.
This is a function with less overhead but also more limited functionality.
micropip uses this function to load Pyodide packages. In most cases you should
be using micropip.</p></li>
</ul>
<p>In some cases, and in particular in the REPL, packages are installed implicitly
from imports. The Pyodide REPL uses <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports()</span></code></a>
to automatically download all packages that the code snippet imports. This is
useful since users might import unexpected packages in REPL. At present,
<a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackagesFromImports()</span></code></a> will not download packages from
PyPI, it will only download packages included in the Pyodide distribution. See
<a class="reference internal" href="#packages-in-pyodide"><span class="std std-ref">Packages built in Pyodide</span></a> to check the full list of packages included in
Pyodide.</p>
<section id="how-to-chose-between-micropip-install-and-pyodide-loadpackage">
<h5>How to chose between <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code> and <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>?<a class="headerlink" href="#how-to-chose-between-micropip-install-and-pyodide-loadpackage" title="Link to this heading">#</a></h5>
<p>While <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> is written in Python and
<a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> in Javascript this has no incidence on when to
use each of these functions. Indeed, you can easily switch languages using the
<a class="reference internal" href="#type-translations"><span class="std std-ref">Type translations</span></a> with,</p>
<ul>
<li><p>from Javascript,</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">micropip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="nx">package_name</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>from Python,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyodide_js</span>
<span class="k">await</span> <span class="n">pyodide_js</span><span class="o">.</span><span class="n">loadPackage</span><span class="p">(</span><span class="s1">&#39;package_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Instead, the general advice is to use <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> for everything
except in the following cases where <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> might be more
appropriate,</p>
<ul class="simple">
<li><p>to load micropip itself,</p></li>
<li><p>when you are optimizing for size, do not want to install the <code class="docutils literal notranslate"><span class="pre">micropip</span></code>
package, and do not need to install packages from PyPI with dependency resolution.</p></li>
</ul>
</section>
<section id="micropip">
<h5>Micropip<a class="headerlink" href="#micropip" title="Link to this heading">#</a></h5>
<section id="installing-packages">
<h6>Installing packages<a class="headerlink" href="#installing-packages" title="Link to this heading">#</a></h6>
<p>Pyodide supports installing following types of packages with <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a>,</p>
<ul class="simple">
<li><p>pure Python wheels from PyPI with <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a>.</p></li>
<li><p>pure Python and binary wasm32/emscripten wheels (also informally known as
“Pyodide packages” or “packages built by Pyodide”) from the JsDelivr CDN and
custom URLs.
<a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> is an async Python function which returns a
coroutine, so it need to be called with an <code class="docutils literal notranslate"><span class="pre">await</span></code> clause to run.</p></li>
</ul>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">(</span><span class="s2">&quot;micropip&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">micropip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;micropip&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">micropip</span><span class="p">.</span><span class="nx">install</span><span class="p">(</span><span class="s1">&#39;snowballstemmer&#39;</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">snowballstemmer</span>
  <span class="n">stemmer</span> <span class="o">=</span> <span class="n">snowballstemmer</span><span class="o">.</span><span class="n">stemmer</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stemWords</span><span class="p">(</span><span class="s1">&#39;go goes going gone&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>Micropip implements file integrity validation by checking the hash of the
downloaded wheel against pre-recorded hash digests from the PyPI JSON API.</p>
</section>
<section id="installing-wheels-from-different-indexes">
<span id="micropip-installing-from-other-indexes"></span><h6>Installing wheels from different indexes<a class="headerlink" href="#installing-wheels-from-different-indexes" title="Link to this heading">#</a></h6>
<p>By default micropip will look for wheel on <a class="reference external" href="https://pypi.org">pypi</a>. It is
possible to provide a list of indexes url to the install commands via the
<a class="reference external" href="https://micropip.pyodide.org/en/stable/project/api.html#micropip.install"><code class="docutils literal notranslate"><span class="pre">index_urls</span></code></a>
parameter of the <code class="docutils literal notranslate"><span class="pre">install</span></code> command.</p>
</section>
<section id="installing-wheels-from-arbitrary-urls">
<span id="micropip-installing-from-arbitrary-urls"></span><h6>Installing wheels from arbitrary URLs<a class="headerlink" href="#installing-wheels-from-arbitrary-urls" title="Link to this heading">#</a></h6>
<p>Pure Python wheels can also be installed from any URL with <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a>,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">micropip</span>
<span class="n">micropip</span><span class="o">.</span><span class="n">install</span><span class="p">(</span>
    <span class="s1">&#39;https://example.com/files/snowballstemmer-2.0.0-py2.py3-none-any.whl&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Micropip decides whether a file is a URL based on whether it ends in “.whl” or
not. The wheel name in the URL must follow <a class="reference external" href="https://www.python.org/dev/peps/pep-0427/#file-format">PEP 427 naming
convention</a>, which will
be the case if the wheels is made using standard Python tools (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">wheel</span></code>,
<code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">bdist_wheel</span></code>). Micropip will also install the dependencies of the
wheel. If dependency resolution is not desired, you may pass <code class="docutils literal notranslate"><span class="pre">deps=False</span></code>.</p>
<div class="info admonition">
<p class="admonition-title">Cross-Origin Resource Sharing (CORS)</p>
<p>If the file is on a remote server, the server must set
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing (CORS) headers</a>
to allow access. If the server doesn’t set CORS headers, you can use a CORS proxy.
Note that using third-party CORS proxies has security implications,
particularly since we are not able to check the file integrity, unlike with
installs from PyPI. See <a class="reference external" href="https://stackoverflow.com/questions/43871637/no-access-control-allow-origin-header-is-present-on-the-requested-resource-whe/43881141#43881141">this stack overflow
answer</a>
for more information about CORS.</p>
</div>
</section>
</section>
<section id="example">
<h5>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h5>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">(</span><span class="s2">&quot;micropip&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">micropip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;micropip&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">micropip</span><span class="p">.</span><span class="nx">install</span><span class="p">(</span><span class="s2">&quot;snowballstemmer&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">        import snowballstemmer</span>
<span class="sb">        stemmer = snowballstemmer.stemmer(&#39;english&#39;)</span>
<span class="sb">        print(stemmer.stemWords(&#39;go goes going gone&#39;.split()))</span>
<span class="sb">      `</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nx">main</span><span class="p">();</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="loading-packages-with-pyodide-loadpackage">
<h5>Loading packages with <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a><a class="headerlink" href="#loading-packages-with-pyodide-loadpackage" title="Link to this heading">#</a></h5>
<p>Packages included in the official Pyodide repository can be loaded using
<a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackage()</span></code></a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>It is also possible to load packages from custom URLs:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">(</span>
<span class="w">  </span><span class="s2">&quot;https://foo/bar/numpy-1.22.3-cp310-cp310-emscripten_3_1_13_wasm32.whl&quot;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The file name must be a valid wheel name.</p>
<p>When you request a package from the official repository, all of the package’s
dependencies are also loaded. There is no dependency resolution when loading
packages from custom URLs. If you want dependency resolution for custom URLs,
use <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a>.</p>
<p>In general, loading a package twice is not permitted. However, one can override
a dependency by loading a custom URL with the same package name before loading
the dependent package.</p>
<p>Multiple packages can also be loaded at the same time by passing a list to
<a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackage()</span></code></a>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">([</span><span class="s2">&quot;cycler&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pytz&quot;</span><span class="p">]);</span>
</pre></div>
</div>
<p><a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackage()</span></code></a> returns a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> which resolves when all the
packages are finished loading:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">;</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">loadPackage</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// matplotlib is now available</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
<div class="toctree-wrapper compound" id="id2">
<span id="document-usage/packages-in-pyodide"></span><section id="packages-built-in-pyodide">
<span id="packages-in-pyodide"></span><h6>Packages built in Pyodide<a class="headerlink" href="#packages-built-in-pyodide" title="Link to this heading">#</a></h6>
<p>This is the list of Python packages included with the current version of
Pyodide. These packages can be loaded with <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> or
<a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a>. See <a class="reference internal" href="#loading-packages"><span class="std std-ref">Loading packages</span></a> for information about
loading packages. Pure Python packages with wheels on PyPI can be loaded
directly from PyPI with <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a>.</p>
<div class="pst-scrollable-table-container"><table class="longtable table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>affine</p></td>
<td><p>2.4.0</p></td>
</tr>
<tr class="row-odd"><td><p>aiohttp</p></td>
<td><p>3.9.5</p></td>
</tr>
<tr class="row-even"><td><p>aiosignal</p></td>
<td><p>1.3.1</p></td>
</tr>
<tr class="row-odd"><td><p>altair</p></td>
<td><p>5.4.1</p></td>
</tr>
<tr class="row-even"><td><p>annotated-types</p></td>
<td><p>0.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>argon2-cffi</p></td>
<td><p>23.1.0</p></td>
</tr>
<tr class="row-even"><td><p>argon2-cffi-bindings</p></td>
<td><p>21.2.0</p></td>
</tr>
<tr class="row-odd"><td><p>arro3-compute</p></td>
<td><p>0.4.1</p></td>
</tr>
<tr class="row-even"><td><p>arro3-core</p></td>
<td><p>0.4.1</p></td>
</tr>
<tr class="row-odd"><td><p>arro3-io</p></td>
<td><p>0.4.1</p></td>
</tr>
<tr class="row-even"><td><p>asciitree</p></td>
<td><p>0.3.3</p></td>
</tr>
<tr class="row-odd"><td><p>astropy</p></td>
<td><p>7.0.0</p></td>
</tr>
<tr class="row-even"><td><p>astropy_iers_data</p></td>
<td><p>0.2024.4.22.0.29.50</p></td>
</tr>
<tr class="row-odd"><td><p>asttokens</p></td>
<td><p>2.4.1</p></td>
</tr>
<tr class="row-even"><td><p>async-timeout</p></td>
<td><p>4.0.3</p></td>
</tr>
<tr class="row-odd"><td><p>atomicwrites</p></td>
<td><p>1.4.1</p></td>
</tr>
<tr class="row-even"><td><p>attrs</p></td>
<td><p>23.2.0</p></td>
</tr>
<tr class="row-odd"><td><p>autograd</p></td>
<td><p>1.7.0</p></td>
</tr>
<tr class="row-even"><td><p>awkward-cpp</p></td>
<td><p>43</p></td>
</tr>
<tr class="row-odd"><td><p>b2d</p></td>
<td><p>0.7.4</p></td>
</tr>
<tr class="row-even"><td><p>bcrypt</p></td>
<td><p>4.1.2</p></td>
</tr>
<tr class="row-odd"><td><p>beautifulsoup4</p></td>
<td><p>4.12.3</p></td>
</tr>
<tr class="row-even"><td><p>biopython</p></td>
<td><p>1.84</p></td>
</tr>
<tr class="row-odd"><td><p>bitarray</p></td>
<td><p>2.9.2</p></td>
</tr>
<tr class="row-even"><td><p>bitstring</p></td>
<td><p>4.1.4</p></td>
</tr>
<tr class="row-odd"><td><p>bleach</p></td>
<td><p>6.1.0</p></td>
</tr>
<tr class="row-even"><td><p>bokeh</p></td>
<td><p>3.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>boost-histogram</p></td>
<td><p>1.5.0</p></td>
</tr>
<tr class="row-even"><td><p>brotli</p></td>
<td><p>1.1.0</p></td>
</tr>
<tr class="row-odd"><td><p>cachetools</p></td>
<td><p>5.3.3</p></td>
</tr>
<tr class="row-even"><td><p>Cartopy</p></td>
<td><p>0.24.1</p></td>
</tr>
<tr class="row-odd"><td><p>casadi</p></td>
<td><p>3.6.7</p></td>
</tr>
<tr class="row-even"><td><p>cbor-diag</p></td>
<td><p>1.0.1</p></td>
</tr>
<tr class="row-odd"><td><p>certifi</p></td>
<td><p>2024.12.14</p></td>
</tr>
<tr class="row-even"><td><p>cffi</p></td>
<td><p>1.17.1</p></td>
</tr>
<tr class="row-odd"><td><p>cffi_example</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p>cftime</p></td>
<td><p>1.6.4.post1</p></td>
</tr>
<tr class="row-odd"><td><p>charset-normalizer</p></td>
<td><p>3.3.2</p></td>
</tr>
<tr class="row-even"><td><p>clarabel</p></td>
<td><p>0.9.0</p></td>
</tr>
<tr class="row-odd"><td><p>click</p></td>
<td><p>8.1.7</p></td>
</tr>
<tr class="row-even"><td><p>cligj</p></td>
<td><p>0.7.2</p></td>
</tr>
<tr class="row-odd"><td><p>clingo</p></td>
<td><p>5.7.1</p></td>
</tr>
<tr class="row-even"><td><p>cloudpickle</p></td>
<td><p>3.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>cmyt</p></td>
<td><p>2.0.0</p></td>
</tr>
<tr class="row-even"><td><p>colorspacious</p></td>
<td><p>1.1.2</p></td>
</tr>
<tr class="row-odd"><td><p>contourpy</p></td>
<td><p>1.3.0</p></td>
</tr>
<tr class="row-even"><td><p>coolprop</p></td>
<td><p>6.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>coverage</p></td>
<td><p>7.4.4</p></td>
</tr>
<tr class="row-even"><td><p>cramjam</p></td>
<td><p>2.8.3</p></td>
</tr>
<tr class="row-odd"><td><p>crc32c</p></td>
<td><p>2.7.1</p></td>
</tr>
<tr class="row-even"><td><p>cryptography</p></td>
<td><p>42.0.5</p></td>
</tr>
<tr class="row-odd"><td><p>css-inline</p></td>
<td><p>0.14.6</p></td>
</tr>
<tr class="row-even"><td><p>cssselect</p></td>
<td><p>1.2.0</p></td>
</tr>
<tr class="row-odd"><td><p>cvxpy-base</p></td>
<td><p>1.5.1</p></td>
</tr>
<tr class="row-even"><td><p>cycler</p></td>
<td><p>0.12.1</p></td>
</tr>
<tr class="row-odd"><td><p>cysignals</p></td>
<td><p>1.12.2</p></td>
</tr>
<tr class="row-even"><td><p>cytoolz</p></td>
<td><p>0.12.3</p></td>
</tr>
<tr class="row-odd"><td><p>decorator</p></td>
<td><p>5.1.1</p></td>
</tr>
<tr class="row-even"><td><p>demes</p></td>
<td><p>0.2.3</p></td>
</tr>
<tr class="row-odd"><td><p>deprecation</p></td>
<td><p>2.1.0</p></td>
</tr>
<tr class="row-even"><td><p>distlib</p></td>
<td><p>0.3.8</p></td>
</tr>
<tr class="row-odd"><td><p>docutils</p></td>
<td><p>0.21.1</p></td>
</tr>
<tr class="row-even"><td><p>duckdb</p></td>
<td><p>1.1.2</p></td>
</tr>
<tr class="row-odd"><td><p>ewah_bool_utils</p></td>
<td><p>1.2.2</p></td>
</tr>
<tr class="row-even"><td><p>exceptiongroup</p></td>
<td><p>1.2.1</p></td>
</tr>
<tr class="row-odd"><td><p>executing</p></td>
<td><p>2.0.1</p></td>
</tr>
<tr class="row-even"><td><p>fastparquet</p></td>
<td><p>2024.5.0</p></td>
</tr>
<tr class="row-odd"><td><p>fiona</p></td>
<td><p>1.9.5</p></td>
</tr>
<tr class="row-even"><td><p>fonttools</p></td>
<td><p>4.51.0</p></td>
</tr>
<tr class="row-odd"><td><p>freesasa</p></td>
<td><p>2.2.1</p></td>
</tr>
<tr class="row-even"><td><p>frozenlist</p></td>
<td><p>1.4.1</p></td>
</tr>
<tr class="row-odd"><td><p>fsspec</p></td>
<td><p>2024.3.1</p></td>
</tr>
<tr class="row-even"><td><p>future</p></td>
<td><p>1.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>galpy</p></td>
<td><p>1.10.1</p></td>
</tr>
<tr class="row-even"><td><p>gensim</p></td>
<td><p>4.3.3</p></td>
</tr>
<tr class="row-odd"><td><p>geopandas</p></td>
<td><p>1.0.1</p></td>
</tr>
<tr class="row-even"><td><p>gmpy2</p></td>
<td><p>2.1.5</p></td>
</tr>
<tr class="row-odd"><td><p>gsw</p></td>
<td><p>3.6.19</p></td>
</tr>
<tr class="row-even"><td><p>h5py</p></td>
<td><p>3.12.1</p></td>
</tr>
<tr class="row-odd"><td><p>html5lib</p></td>
<td><p>1.1</p></td>
</tr>
<tr class="row-even"><td><p>idna</p></td>
<td><p>3.7</p></td>
</tr>
<tr class="row-odd"><td><p>igraph</p></td>
<td><p>0.11.4</p></td>
</tr>
<tr class="row-even"><td><p>imageio</p></td>
<td><p>2.36.0</p></td>
</tr>
<tr class="row-odd"><td><p>iminuit</p></td>
<td><p>2.30.1</p></td>
</tr>
<tr class="row-even"><td><p>iniconfig</p></td>
<td><p>2.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>ipython</p></td>
<td><p>8.23.0</p></td>
</tr>
<tr class="row-even"><td><p>jedi</p></td>
<td><p>0.19.1</p></td>
</tr>
<tr class="row-odd"><td><p>Jinja2</p></td>
<td><p>3.1.3</p></td>
</tr>
<tr class="row-even"><td><p>joblib</p></td>
<td><p>1.4.0</p></td>
</tr>
<tr class="row-odd"><td><p>jsonschema</p></td>
<td><p>4.21.1</p></td>
</tr>
<tr class="row-even"><td><p>jsonschema_specifications</p></td>
<td><p>2023.12.1</p></td>
</tr>
<tr class="row-odd"><td><p>kiwisolver</p></td>
<td><p>1.4.5</p></td>
</tr>
<tr class="row-even"><td><p>lakers-python</p></td>
<td><p>0.4.1</p></td>
</tr>
<tr class="row-odd"><td><p>lazy-object-proxy</p></td>
<td><p>1.10.0</p></td>
</tr>
<tr class="row-even"><td><p>lazy_loader</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>libcst</p></td>
<td><p>1.4.0</p></td>
</tr>
<tr class="row-even"><td><p>lightgbm</p></td>
<td><p>4.5.0</p></td>
</tr>
<tr class="row-odd"><td><p>logbook</p></td>
<td><p>1.7.0.post0</p></td>
</tr>
<tr class="row-even"><td><p>lxml</p></td>
<td><p>5.2.1</p></td>
</tr>
<tr class="row-odd"><td><p>MarkupSafe</p></td>
<td><p>2.1.5</p></td>
</tr>
<tr class="row-even"><td><p>matplotlib</p></td>
<td><p>3.8.4</p></td>
</tr>
<tr class="row-odd"><td><p>matplotlib-inline</p></td>
<td><p>0.1.7</p></td>
</tr>
<tr class="row-even"><td><p>matplotlib-pyodide</p></td>
<td><p>0.2.3</p></td>
</tr>
<tr class="row-odd"><td><p>memory-allocator</p></td>
<td><p>0.1.4</p></td>
</tr>
<tr class="row-even"><td><p>micropip</p></td>
<td><p>0.8.0</p></td>
</tr>
<tr class="row-odd"><td><p>mmh3</p></td>
<td><p>4.1.0</p></td>
</tr>
<tr class="row-even"><td><p>mne</p></td>
<td><p>1.8.0</p></td>
</tr>
<tr class="row-odd"><td><p>more-itertools</p></td>
<td><p>10.2.0</p></td>
</tr>
<tr class="row-even"><td><p>mpmath</p></td>
<td><p>1.3.0</p></td>
</tr>
<tr class="row-odd"><td><p>msgpack</p></td>
<td><p>1.1.0</p></td>
</tr>
<tr class="row-even"><td><p>msgspec</p></td>
<td><p>0.18.6</p></td>
</tr>
<tr class="row-odd"><td><p>msprime</p></td>
<td><p>1.3.3</p></td>
</tr>
<tr class="row-even"><td><p>multidict</p></td>
<td><p>6.0.5</p></td>
</tr>
<tr class="row-odd"><td><p>munch</p></td>
<td><p>4.0.0</p></td>
</tr>
<tr class="row-even"><td><p>mypy</p></td>
<td><p>1.9.0</p></td>
</tr>
<tr class="row-odd"><td><p>narwhals</p></td>
<td><p>1.10.0</p></td>
</tr>
<tr class="row-even"><td><p>netcdf4</p></td>
<td><p>1.7.2</p></td>
</tr>
<tr class="row-odd"><td><p>networkx</p></td>
<td><p>3.4.2</p></td>
</tr>
<tr class="row-even"><td><p>newick</p></td>
<td><p>1.9.0</p></td>
</tr>
<tr class="row-odd"><td><p>nh3</p></td>
<td><p>0.2.17</p></td>
</tr>
<tr class="row-even"><td><p>nlopt</p></td>
<td><p>2.9.1</p></td>
</tr>
<tr class="row-odd"><td><p>nltk</p></td>
<td><p>3.8.1</p></td>
</tr>
<tr class="row-even"><td><p>numcodecs</p></td>
<td><p>0.13.1</p></td>
</tr>
<tr class="row-odd"><td><p>numpy</p></td>
<td><p>2.0.2</p></td>
</tr>
<tr class="row-even"><td><p>opencv-python</p></td>
<td><p>4.10.0.84</p></td>
</tr>
<tr class="row-odd"><td><p>optlang</p></td>
<td><p>1.8.1</p></td>
</tr>
<tr class="row-even"><td><p>orjson</p></td>
<td><p>3.10.1</p></td>
</tr>
<tr class="row-odd"><td><p>packaging</p></td>
<td><p>23.2</p></td>
</tr>
<tr class="row-even"><td><p>pandas</p></td>
<td><p>2.2.3</p></td>
</tr>
<tr class="row-odd"><td><p>parso</p></td>
<td><p>0.8.4</p></td>
</tr>
<tr class="row-even"><td><p>patsy</p></td>
<td><p>0.5.6</p></td>
</tr>
<tr class="row-odd"><td><p>peewee</p></td>
<td><p>3.17.3</p></td>
</tr>
<tr class="row-even"><td><p>pi-heif</p></td>
<td><p>0.21.0</p></td>
</tr>
<tr class="row-odd"><td><p>Pillow</p></td>
<td><p>10.2.0</p></td>
</tr>
<tr class="row-even"><td><p>pillow-heif</p></td>
<td><p>0.20.0</p></td>
</tr>
<tr class="row-odd"><td><p>pkgconfig</p></td>
<td><p>1.5.5</p></td>
</tr>
<tr class="row-even"><td><p>pluggy</p></td>
<td><p>1.5.0</p></td>
</tr>
<tr class="row-odd"><td><p>polars</p></td>
<td><p>1.18.0</p></td>
</tr>
<tr class="row-even"><td><p>pplpy</p></td>
<td><p>0.8.10</p></td>
</tr>
<tr class="row-odd"><td><p>primecountpy</p></td>
<td><p>0.1.0</p></td>
</tr>
<tr class="row-even"><td><p>prompt_toolkit</p></td>
<td><p>3.0.43</p></td>
</tr>
<tr class="row-odd"><td><p>protobuf</p></td>
<td><p>5.29.2</p></td>
</tr>
<tr class="row-even"><td><p>pure-eval</p></td>
<td><p>0.2.3</p></td>
</tr>
<tr class="row-odd"><td><p>py</p></td>
<td><p>1.11.0</p></td>
</tr>
<tr class="row-even"><td><p>pyarrow</p></td>
<td><p>18.1.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyclipper</p></td>
<td><p>1.3.0.post5</p></td>
</tr>
<tr class="row-even"><td><p>pycparser</p></td>
<td><p>2.22</p></td>
</tr>
<tr class="row-odd"><td><p>pycryptodome</p></td>
<td><p>3.20.0</p></td>
</tr>
<tr class="row-even"><td><p>pydantic</p></td>
<td><p>2.9.2</p></td>
</tr>
<tr class="row-odd"><td><p>pydantic_core</p></td>
<td><p>2.25.1</p></td>
</tr>
<tr class="row-even"><td><p>pyerfa</p></td>
<td><p>2.0.1.4</p></td>
</tr>
<tr class="row-odd"><td><p>pygame-ce</p></td>
<td><p>2.4.1</p></td>
</tr>
<tr class="row-even"><td><p>Pygments</p></td>
<td><p>2.17.2</p></td>
</tr>
<tr class="row-odd"><td><p>pyheif</p></td>
<td><p>0.8.0</p></td>
</tr>
<tr class="row-even"><td><p>pyiceberg</p></td>
<td><p>0.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyinstrument</p></td>
<td><p>4.4.0</p></td>
</tr>
<tr class="row-even"><td><p>pynacl</p></td>
<td><p>1.5.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyodide-http</p></td>
<td><p>0.2.1</p></td>
</tr>
<tr class="row-even"><td><p>pyodide-unix-timezones</p></td>
<td><p>1.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyparsing</p></td>
<td><p>3.1.2</p></td>
</tr>
<tr class="row-even"><td><p>pyproj</p></td>
<td><p>3.6.1</p></td>
</tr>
<tr class="row-odd"><td><p>pyrsistent</p></td>
<td><p>0.20.0</p></td>
</tr>
<tr class="row-even"><td><p>pysam</p></td>
<td><p>0.22.0</p></td>
</tr>
<tr class="row-odd"><td><p>pyshp</p></td>
<td><p>2.3.1</p></td>
</tr>
<tr class="row-even"><td><p>pytest</p></td>
<td><p>8.1.1</p></td>
</tr>
<tr class="row-odd"><td><p>pytest-asyncio</p></td>
<td><p>0.23.7</p></td>
</tr>
<tr class="row-even"><td><p>pytest-benchmark</p></td>
<td><p>4.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>python-dateutil</p></td>
<td><p>2.9.0.post0</p></td>
</tr>
<tr class="row-even"><td><p>python-flint</p></td>
<td><p>0.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>python-magic</p></td>
<td><p>0.4.27</p></td>
</tr>
<tr class="row-even"><td><p>python-sat</p></td>
<td><p>1.8.dev13</p></td>
</tr>
<tr class="row-odd"><td><p>python-solvespace</p></td>
<td><p>3.0.8</p></td>
</tr>
<tr class="row-even"><td><p>pytz</p></td>
<td><p>2024.1</p></td>
</tr>
<tr class="row-odd"><td><p>pywavelets</p></td>
<td><p>1.7.0</p></td>
</tr>
<tr class="row-even"><td><p>pyxel</p></td>
<td><p>1.9.10</p></td>
</tr>
<tr class="row-odd"><td><p>pyxirr</p></td>
<td><p>0.10.6</p></td>
</tr>
<tr class="row-even"><td><p>pyyaml</p></td>
<td><p>6.0.2</p></td>
</tr>
<tr class="row-odd"><td><p>rasterio</p></td>
<td><p>1.4.2</p></td>
</tr>
<tr class="row-even"><td><p>rateslib</p></td>
<td><p>1.6.0</p></td>
</tr>
<tr class="row-odd"><td><p>rebound</p></td>
<td><p>4.4.3</p></td>
</tr>
<tr class="row-even"><td><p>reboundx</p></td>
<td><p>4.3.0</p></td>
</tr>
<tr class="row-odd"><td><p>referencing</p></td>
<td><p>0.34.0</p></td>
</tr>
<tr class="row-even"><td><p>regex</p></td>
<td><p>2024.9.11</p></td>
</tr>
<tr class="row-odd"><td><p>requests</p></td>
<td><p>2.31.0</p></td>
</tr>
<tr class="row-even"><td><p>retrying</p></td>
<td><p>1.3.4</p></td>
</tr>
<tr class="row-odd"><td><p>rich</p></td>
<td><p>13.7.1</p></td>
</tr>
<tr class="row-even"><td><p>river</p></td>
<td><p>0.22.0</p></td>
</tr>
<tr class="row-odd"><td><p>RobotRaconteur</p></td>
<td><p>1.2.2</p></td>
</tr>
<tr class="row-even"><td><p>rpds-py</p></td>
<td><p>0.18.0</p></td>
</tr>
<tr class="row-odd"><td><p>ruamel.yaml</p></td>
<td><p>0.18.6</p></td>
</tr>
<tr class="row-even"><td><p>rust-abi-test</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>rust-panic-test</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>scikit-image</p></td>
<td><p>0.25.0</p></td>
</tr>
<tr class="row-odd"><td><p>scikit-learn</p></td>
<td><p>1.5.2</p></td>
</tr>
<tr class="row-even"><td><p>scipy</p></td>
<td><p>1.14.1</p></td>
</tr>
<tr class="row-odd"><td><p>screed</p></td>
<td><p>1.1.3</p></td>
</tr>
<tr class="row-even"><td><p>setuptools</p></td>
<td><p>69.5.1</p></td>
</tr>
<tr class="row-odd"><td><p>shapely</p></td>
<td><p>2.0.6</p></td>
</tr>
<tr class="row-even"><td><p>simplejson</p></td>
<td><p>3.19.2</p></td>
</tr>
<tr class="row-odd"><td><p>sisl</p></td>
<td><p>0.15.1</p></td>
</tr>
<tr class="row-even"><td><p>six</p></td>
<td><p>1.16.0</p></td>
</tr>
<tr class="row-odd"><td><p>smart-open</p></td>
<td><p>7.0.4</p></td>
</tr>
<tr class="row-even"><td><p>sortedcontainers</p></td>
<td><p>2.4.0</p></td>
</tr>
<tr class="row-odd"><td><p>soupsieve</p></td>
<td><p>2.5</p></td>
</tr>
<tr class="row-even"><td><p>sourmash</p></td>
<td><p>4.8.11</p></td>
</tr>
<tr class="row-odd"><td><p>soxr</p></td>
<td><p>0.5.0.post1</p></td>
</tr>
<tr class="row-even"><td><p>sparseqr</p></td>
<td><p>1.2</p></td>
</tr>
<tr class="row-odd"><td><p>sqlalchemy</p></td>
<td><p>2.0.29</p></td>
</tr>
<tr class="row-even"><td><p>stack-data</p></td>
<td><p>0.6.3</p></td>
</tr>
<tr class="row-odd"><td><p>statsmodels</p></td>
<td><p>0.14.4</p></td>
</tr>
<tr class="row-even"><td><p>strictyaml</p></td>
<td><p>1.7.3</p></td>
</tr>
<tr class="row-odd"><td><p>svgwrite</p></td>
<td><p>1.4.3</p></td>
</tr>
<tr class="row-even"><td><p>swiglpk</p></td>
<td><p>5.0.10</p></td>
</tr>
<tr class="row-odd"><td><p>sympy</p></td>
<td><p>1.13.3</p></td>
</tr>
<tr class="row-even"><td><p>tblib</p></td>
<td><p>3.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>termcolor</p></td>
<td><p>2.4.0</p></td>
</tr>
<tr class="row-even"><td><p>texttable</p></td>
<td><p>1.7.0</p></td>
</tr>
<tr class="row-odd"><td><p>threadpoolctl</p></td>
<td><p>3.5.0</p></td>
</tr>
<tr class="row-even"><td><p>tiktoken</p></td>
<td><p>0.8.0</p></td>
</tr>
<tr class="row-odd"><td><p>tomli</p></td>
<td><p>2.0.1</p></td>
</tr>
<tr class="row-even"><td><p>tomli-w</p></td>
<td><p>1.0.0</p></td>
</tr>
<tr class="row-odd"><td><p>toolz</p></td>
<td><p>0.12.1</p></td>
</tr>
<tr class="row-even"><td><p>tqdm</p></td>
<td><p>4.66.2</p></td>
</tr>
<tr class="row-odd"><td><p>traitlets</p></td>
<td><p>5.14.3</p></td>
</tr>
<tr class="row-even"><td><p>traits</p></td>
<td><p>6.4.3</p></td>
</tr>
<tr class="row-odd"><td><p>tree-sitter</p></td>
<td><p>0.23.2</p></td>
</tr>
<tr class="row-even"><td><p>tree-sitter-go</p></td>
<td><p>0.23.3</p></td>
</tr>
<tr class="row-odd"><td><p>tree-sitter-java</p></td>
<td><p>0.23.4</p></td>
</tr>
<tr class="row-even"><td><p>tree-sitter-python</p></td>
<td><p>0.23.4</p></td>
</tr>
<tr class="row-odd"><td><p>tskit</p></td>
<td><p>0.6.0</p></td>
</tr>
<tr class="row-even"><td><p>typing-extensions</p></td>
<td><p>4.11.0</p></td>
</tr>
<tr class="row-odd"><td><p>tzdata</p></td>
<td><p>2024.1</p></td>
</tr>
<tr class="row-even"><td><p>uncertainties</p></td>
<td><p>3.1.7</p></td>
</tr>
<tr class="row-odd"><td><p>unyt</p></td>
<td><p>3.0.3</p></td>
</tr>
<tr class="row-even"><td><p>urllib3</p></td>
<td><p>2.2.3</p></td>
</tr>
<tr class="row-odd"><td><p>vega-datasets</p></td>
<td><p>0.9.0</p></td>
</tr>
<tr class="row-even"><td><p>wcwidth</p></td>
<td><p>0.2.13</p></td>
</tr>
<tr class="row-odd"><td><p>webencodings</p></td>
<td><p>0.5.1</p></td>
</tr>
<tr class="row-even"><td><p>wordcloud</p></td>
<td><p>1.9.3</p></td>
</tr>
<tr class="row-odd"><td><p>wrapt</p></td>
<td><p>1.16.0</p></td>
</tr>
<tr class="row-even"><td><p>xarray</p></td>
<td><p>2024.11.0</p></td>
</tr>
<tr class="row-odd"><td><p>xgboost</p></td>
<td><p>2.1.2</p></td>
</tr>
<tr class="row-even"><td><p>xlrd</p></td>
<td><p>2.0.1</p></td>
</tr>
<tr class="row-odd"><td><p>xxhash</p></td>
<td><p>3.4.1</p></td>
</tr>
<tr class="row-even"><td><p>xyzservices</p></td>
<td><p>2024.4.0</p></td>
</tr>
<tr class="row-odd"><td><p>yarl</p></td>
<td><p>1.9.4</p></td>
</tr>
<tr class="row-even"><td><p>yt</p></td>
<td><p>4.3.1</p></td>
</tr>
<tr class="row-odd"><td><p>zarr</p></td>
<td><p>2.18.3</p></td>
</tr>
<tr class="row-even"><td><p>zengl</p></td>
<td><p>2.7.1</p></td>
</tr>
<tr class="row-odd"><td><p>zfpy</p></td>
<td><p>1.0.1</p></td>
</tr>
<tr class="row-even"><td><p>zstandard</p></td>
<td><p>0.22.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<span id="document-usage/sdl"></span><section id="using-sdl-based-packages-in-pyodide">
<span id="using-sdl"></span><h6>Using SDL-based packages in Pyodide<a class="headerlink" href="#using-sdl-based-packages-in-pyodide" title="Link to this heading">#</a></h6>
<div class="warning admonition">
<p class="admonition-title">This is experimental</p>
<p>SDL support in Pyodide is experimental.
Pyodide relies on undocumented behavior of Emscripten and SDL,
so it may break or change in the future.</p>
<p>In addition, this feature requires to enable an opt-in flag,
<code class="docutils literal notranslate"><span class="pre">pyodide._api._skip_unwind_fatal_error</span> <span class="pre">=</span> <span class="pre">true;</span></code>
which can lead to stack unwinding issues (see <a class="reference internal" href="#sdl-known-issues"><span class="std std-ref">Known issues</span></a>).</p>
</div>
<p>Pyodide provides a way to use SDL-based packages in the browser,
This document explains how to use SDL-based packages in Pyodide.</p>
<section id="setting-canvas">
<h6 aria-level="7">Setting canvas<a class="headerlink" href="#setting-canvas" title="Link to this heading">#</a></h6>
<p>Before using SDL-based packages, you need to set the canvas to draw on.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">canvas</span></code> object must be a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement">HTMLCanvasElement</a> object,
with the <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">&quot;canvas&quot;</span></code>.
For example, you can set a canvas like this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">sdl2Canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="nx">sdl2Canvas</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;canvas&quot;</span><span class="p">;</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">setCanvas2D</span><span class="p">(</span><span class="nx">sdl2Canvas</span><span class="p">);</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#js-api-pyodide-canvas"><span class="std std-ref">pyodide.canvas</span></a></p>
</section>
<section id="working-with-infinite-loop">
<h6 aria-level="7">Working with infinite loop<a class="headerlink" href="#working-with-infinite-loop" title="Link to this heading">#</a></h6>
<p>It is common to use an infinite loop to draw animations or game scenes with SDL-based package.</p>
<p>For instance, a common code pattern in <code class="docutils literal notranslate"><span class="pre">pygame</span></code> (a SDL-based Python game library) is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<span class="n">fps</span> <span class="o">=</span> <span class="mi">60</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_game</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">do_something</span><span class="p">()</span>
        <span class="n">draw_canvas</span><span class="p">()</span>
        <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
</pre></div>
</div>
<p>However, in Pyodide, this will not work as expected, because the loop will block the main thread and prevent the browser from updating the canvas.
To work around this, you need to use async functions and yield control to the browser.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_game</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">do_something</span><span class="p">()</span>
        <span class="n">draw_canvas</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">fps</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">asyncio.sleep</span></code> will yield control to the browser and allow the canvas to be updated.</p>
</section>
<section id="known-issues">
<span id="sdl-known-issues"></span><h6 aria-level="7">Known issues<a class="headerlink" href="#known-issues" title="Link to this heading">#</a></h6>
<p>There is a known issue that with,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">_skip_unwind_fatal_error</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p>Python call stacks are not being unwound after calling <code class="docutils literal notranslate"><span class="pre">emscripten_set_main_loop()</span></code>.</p>
<p>see: <a class="reference external" href="https://github.com/pyodide/pyodide/issues/3697">pyodide#3697</a></p>
</section>
</section>
</div>
</section>
</section>
<span id="document-usage/wasm-constraints"></span><section id="pyodide-python-compatibility">
<h4>Pyodide Python compatibility<a class="headerlink" href="#pyodide-python-compatibility" title="Link to this heading">#</a></h4>
<section id="python-standard-library">
<h5>Python Standard library<a class="headerlink" href="#python-standard-library" title="Link to this heading">#</a></h5>
<p>Most of the Python standard library is functional, except for the modules
listed in the sections below. A large part of the CPython test suite passes except for
tests skipped in
<a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/src/tests/python_tests.yaml"><code class="docutils literal notranslate"><span class="pre">src/tests/python_tests.yaml</span></code></a>
or via <a class="reference external" href="https://github.com/pyodide/pyodide/tree/main/cpython/patches">patches</a>.</p>
<section id="optional-modules">
<h6>Optional modules<a class="headerlink" href="#optional-modules" title="Link to this heading">#</a></h6>
<p>The following stdlib modules are unvendored by default,
in order to reduce initial download size of Python distribution.
You can load all unvendored stdlib modules
when initializing Pyodide with, <code class="docutils literal notranslate"><span class="pre">loadPyodide({</span> <span class="pre">fullStdLib</span> <span class="pre">:</span> <span class="pre">true</span> <span class="pre">})</span></code>.
However this has a significant impact on the download size.
Instead, it is better to load individual modules as needed using
<a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> or <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a>.</p>
<ul class="simple">
<li><p>ssl</p></li>
<li><p>lzma</p></li>
<li><p>sqlite3</p></li>
<li><p>test: it is an exception to the above, since it is not loaded even if <code class="docutils literal notranslate"><span class="pre">fullStdLib</span></code> is set to true.</p></li>
</ul>
<section id="modules-with-limited-functionality">
<h6 aria-level="7">Modules with limited functionality<a class="headerlink" href="#modules-with-limited-functionality" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>hashlib: Hash algorithms that are depending on OpenSSL are not available by default.
See Python <a class="reference external" href="https://docs.python.org/3/library/hashlib.html">hashlib documentation</a>
for list of algorithms that are dependent on OpenSSL. If you need those algorithms,
you need to call <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage('hashlib')</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install('hashlib')</span></code>
<strong>before</strong> importing hashlib.</p></li>
<li><p>decimal: The decimal module has C (_decimal) and Python (_pydecimal) implementations
with the same functionality. The Python implementation is not available by default.
If you need a Python implementation of decimal, you need to call
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage('pydecimal')</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install('pydecimal')</span></code>,
then explicitly import <code class="docutils literal notranslate"><span class="pre">_pydecimal</span></code>.</p></li>
<li><p>pydoc: Help messages for Python builtins are not available by default
in order to reduce the initial download size. You need to call
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage('pydoc_data')</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install('pydoc_data')</span></code>
to enable them.</p></li>
<li><p>webbrowser: The original webbrowser module is not available. Instead,
Pyodide includes some method stubs based on browser APIs:
<code class="docutils literal notranslate"><span class="pre">webbrowser.open()</span></code>, <code class="docutils literal notranslate"><span class="pre">webbrowser.open_new()</span></code>, <code class="docutils literal notranslate"><span class="pre">webbrowser.open_new_tab()</span></code>.</p></li>
<li><p>zoneinfo: The zoneinfo package will only work if you install the timezone data using
the tzdata package (i.e. by calling <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage(&quot;tzdata&quot;)</span></code>)</p></li>
</ul>
</section>
</section>
<section id="synchronous-http-requests-support">
<h6>Synchronous HTTP requests support<a class="headerlink" href="#synchronous-http-requests-support" title="Link to this heading">#</a></h6>
<p>Packages for <code class="docutils literal notranslate"><span class="pre">urllib3</span></code> and <code class="docutils literal notranslate"><span class="pre">requests</span></code> are included in pyodide. In browser, these
function <em>roughly</em> the same as on other operating systems with some
limitations. In node.js, they are currently untested, they will require
at least a polyfill for synchronous XMLHttpRequest, and WebWorker.</p>
<p>The first limitation is that streaming download of files only works
in very specific circumstances, which are that pyodide has to be running
in a web-worker, and it has to be on a cross-origin isolated website.
If either of these conditions are not met, it will do a non-streaming
request, i.e. download the full request body before it returns from the
initial request call.</p>
<p>Secondly, all network calls are done via the browser. This means you are
subject to the same limitations as any JavaScript network call. This means
you have very little or no control over certificates, timeouts, proxies and
other network related settings. You also are constrained by browser policies
relating to cross-origin requests, sometimes things will be blocked by CORS
policies if the server doesn’t serve them with the correct headers.</p>
</section>
<section id="removed-modules">
<h6>Removed modules<a class="headerlink" href="#removed-modules" title="Link to this heading">#</a></h6>
<p>The following modules are removed from the standard library to reduce download size and
since they currently wouldn’t work in the WebAssembly VM,</p>
<ul class="simple">
<li><p>curses</p></li>
<li><p>dbm</p></li>
<li><p>ensurepip</p></li>
<li><p>fcntl</p></li>
<li><p>grp</p></li>
<li><p>idlelib</p></li>
<li><p>lib2to3</p></li>
<li><p>msvcrt</p></li>
<li><p>pwd</p></li>
<li><p>resource</p></li>
<li><p>syslog</p></li>
<li><p>termios</p></li>
<li><p>tkinter</p></li>
<li><p>turtle.py</p></li>
<li><p>turtledemo</p></li>
<li><p>venv</p></li>
<li><p>winreg</p></li>
<li><p>winsound</p></li>
</ul>
</section>
<section id="included-but-not-working-modules">
<h6>Included but not working modules<a class="headerlink" href="#included-but-not-working-modules" title="Link to this heading">#</a></h6>
<p>The following modules can be imported, but are not functional due to the limitations of the WebAssembly VM:</p>
<ul class="simple">
<li><p>multiprocessing</p></li>
<li><p>threading</p></li>
<li><p>sockets</p></li>
</ul>
<p>as well as any functionality that requires these.</p>
<p>The following are present but cannot be imported due to a dependency on the termios package which has been removed:</p>
<ul class="simple">
<li><p>pty</p></li>
<li><p>tty</p></li>
</ul>
</section>
</section>
</section>
<span id="document-usage/type-conversions"></span><section id="type-translations">
<span id="id1"></span><h4>Type translations<a class="headerlink" href="#type-translations" title="Link to this heading">#</a></h4>
<p>In order to communicate between Python and JavaScript, we “translate” objects
between the two languages. Depending on the type of the object we either
translate the object by implicitly converting it or by proxying it. By
“converting” an object we mean producing a new object in the target language
which is the equivalent of the object from the source language, for example
converting a Python string to the equivalent a JavaScript string. By “proxying”
an object we mean producing a special object in the target language that
forwards requests to the source language. When we proxy a JavaScript object into
Python, the result is a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> object. When we proxy a
Python object into JavaScript, the result is a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> object. A proxied
object can be explicitly converted using the explicit conversion methods
<a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JsProxy.to_py()</span></code></a> and
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">PyProxy.toJs()</span></code></a>.</p>
<p>Python to JavaScript translations occur:</p>
<ul class="simple">
<li><p>when returning the final expression from a <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.runPython()</span></code></a> call,</p></li>
<li><p>when <a class="reference internal" href="#type-translations-using-py-obj-from-js"><span class="std std-ref">importing Python objects into JavaScript</span></a></p></li>
<li><p>when passing arguments to a JavaScript function called from Python,</p></li>
<li><p>when returning the results of a Python function called from JavaScript,</p></li>
<li><p>when accessing an attribute of a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></p></li>
</ul>
<p>JavaScript to Python translations occur:</p>
<ul class="simple">
<li><p>when <a class="reference internal" href="#type-translations-using-js-obj-from-py"><span class="std std-ref">importing from the <code class="docutils literal notranslate"><span class="pre">js</span></code> module</span></a></p></li>
<li><p>when passing arguments to a Python function called from JavaScript</p></li>
<li><p>when returning the result of a JavaScript function called from Python</p></li>
<li><p>when accessing an attribute of a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></p></li>
</ul>
<div class="warning admonition">
<p class="admonition-title">Memory Leaks and Python to JavaScript translations</p>
<p>Any time a Python to JavaScript translation occurs, it may create a
<a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>. To avoid memory leaks, you must store the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> and
<a class="reference internal" href="#pyodide.ffi.PyProxy.destroy" title="pyodide.ffi.PyProxy.destroy"><code class="xref js js-func docutils literal notranslate"><span class="pre">destroy()</span></code></a> it when you are done with it. See
<a class="reference internal" href="#call-py-from-js"><span class="std std-ref">Calling Python objects from JavaScript</span></a> for more info.</p>
</div>
<section id="round-trip-conversions">
<h5>Round trip conversions<a class="headerlink" href="#round-trip-conversions" title="Link to this heading">#</a></h5>
<p>Translating an object from Python to JavaScript and then back to Python is
guaranteed to give an object that is equal to the original object. Furthermore,
if the object is proxied into JavaScript, then translation back unwraps the
proxy, and the result of the round trip conversion <code class="docutils literal notranslate"><span class="pre">is</span></code> the original object (in
the sense that they live at the same memory address).</p>
<p>Translating an object from JavaScript to Python and then back to JavaScript
gives an object that is <code class="docutils literal notranslate"><span class="pre">===</span></code> to the original object. Furthermore, if the object
is proxied into Python, then translation back unwraps the proxy, and the result
of the round trip conversion is the original object (in the sense that they live
at the same memory address). There are a few exceptions:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NaN</span></code> is converted to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> after a round trip but <code class="docutils literal notranslate"><span class="pre">NaN</span> <span class="pre">!==</span> <span class="pre">NaN</span></code>,</p></li>
<li><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> is converted to <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a> after a round trip, and</p></li>
<li><p>a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a> will be converted to a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a> after a round
trip unless its absolute value is greater than
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number.MAX_SAFE_INTEGER</span></code></a> (i.e., 2^53).</p></li>
</ol>
</section>
<section id="implicit-conversions">
<h5>Implicit conversions<a class="headerlink" href="#implicit-conversions" title="Link to this heading">#</a></h5>
<p>We implicitly convert immutable types but not mutable types. This ensures that
mutable Python objects can be modified from JavaScript and vice-versa. Python
has immutable types such as <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> and <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> that have no
equivalent in JavaScript. In order to ensure that round trip translations yield
an object of the same type as the original object, we proxy <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>
and <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> objects.</p>
<section id="python-to-javascript">
<span id="type-translations-py2js-table"></span><h6>Python to JavaScript<a class="headerlink" href="#python-to-javascript" title="Link to this heading">#</a></h6>
<p>The following immutable types are implicitly converted from Python to
JavaScript:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>JavaScript</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a> or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a>*</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">String</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Boolean</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>* An <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> is converted to a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a> if the absolute value
is less than or equal to <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number.MAX_SAFE_INTEGER</span></code></a> otherwise it is
converted to a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a>. (If the browser does not support
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a> then a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a> will be used instead. In this case,
conversion of large integers from Python to JavaScript is lossy.)</p>
</section>
<section id="javascript-to-python">
<span id="type-translations-js2py-table"></span><h6>JavaScript to Python<a class="headerlink" href="#javascript-to-python" title="Link to this heading">#</a></h6>
<p>The following immutable types are implicitly converted from JavaScript to
Python:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>JavaScript</p></th>
<th class="head"><p>Python</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> as appropriate*</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">String</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Boolean</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>* A <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a> is converted to an <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> if the absolute value
is less than or equal to <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number.MAX_SAFE_INTEGER</span></code></a> and its fractional
part is zero. Otherwise, it is converted to a <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>.</p>
</section>
</section>
<section id="proxying">
<h5>Proxying<a class="headerlink" href="#proxying" title="Link to this heading">#</a></h5>
<p>Any of the types not listed above are shared between languages using proxies
that allow methods and some operations to be called on the object from the other
language.</p>
<section id="proxying-from-javascript-into-python">
<span id="type-translations-jsproxy"></span><h6>Proxying from JavaScript into Python<a class="headerlink" href="#proxying-from-javascript-into-python" title="Link to this heading">#</a></h6>
<p>When most JavaScript objects are translated into Python a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> is
returned. The following operations are currently supported on a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>JavaScript</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.toString()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">repr(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.toString()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">proxy.foo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">x.foo</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hasattr(proxy,</span> <span class="pre">&quot;foo&quot;)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;foo&quot;</span> <span class="pre">in</span> <span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x(...)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo(...)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsProxy.new" title="pyodide.ffi.JsProxy.new"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">proxy.new(...)</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">X(...)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">len(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.length</span></code> or <code class="docutils literal notranslate"><span class="pre">x.size</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">in</span> <span class="pre">proxy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.has(foo)</span></code> or <code class="docutils literal notranslate"><span class="pre">x.includes(foo)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy[foo]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.get(foo)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy[foo]</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.set(foo,</span> <span class="pre">bar)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">proxy[foo]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.delete(foo)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy1</span> <span class="pre">==</span> <span class="pre">proxy2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">===</span> <span class="pre">y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.typeof</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">typeof</span> <span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iter(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[Symbol.iterator]()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">next(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.next()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">proxy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">x</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that each of these operations is only supported if the proxied JavaScript
object supports the corresponding operation. See <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">the</span> <span class="pre">JsProxy</span> <span class="pre">API</span> <span class="pre">docs</span></code></a> for the rest of the methods supported on
<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>. Some other code snippets:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">proxy</span><span class="p">:</span>
    <span class="c1"># do something</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// do something</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#dir" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">dir()</span></code></a> method has been overloaded to return all keys on the
prototype chain of <code class="docutils literal notranslate"><span class="pre">x</span></code>, so <code class="docutils literal notranslate"><span class="pre">dir(x)</span></code> roughly translates to:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">dir</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">x</span><span class="p">)));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As a special case, JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">HTMLCollection</span></code></a>, and
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">NodeList</span></code></a> are container types, but instead of using <code class="docutils literal notranslate"><span class="pre">array.get(7)</span></code> to
get the 7th element, JavaScript uses <code class="docutils literal notranslate"><span class="pre">array[7]</span></code>. For these cases, we translate:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>JavaScript</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy[idx]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">array[idx]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy[idx]</span> <span class="pre">=</span> <span class="pre">val</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">array[idx]</span> <span class="pre">=</span> <span class="pre">val</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">idx</span> <span class="pre">in</span> <span class="pre">proxy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">idx</span> <span class="pre">in</span> <span class="pre">array</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">proxy[idx]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">array.splice(idx)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>If you need to access the fields in a JavaScript object, you must use
<code class="docutils literal notranslate"><span class="pre">obj.field_name</span></code> or if the name of the field is not a valid Python identifier,
<code class="docutils literal notranslate"><span class="pre">getattr(obj,</span> <span class="pre">&quot;field</span> <span class="pre">name&quot;)</span></code>. If you want to access the fields of the object
like <code class="docutils literal notranslate"><span class="pre">obj[&quot;field</span> <span class="pre">name&quot;]</span></code> you can use
<a class="reference internal" href="#pyodide.ffi.JsProxy.as_object_map" title="pyodide.ffi.JsProxy.as_object_map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_object_map()</span></code></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ({</span>
<span class="sd">      a: 7,</span>
<span class="sd">      b: 9,</span>
<span class="sd">      $c: 11</span>
<span class="sd">    })</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">)</span>
<span class="n">obj_map</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">as_object_map</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">obj_map</span><span class="p">[</span><span class="s2">&quot;$c&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">11</span>
</pre></div>
</div>
<p>Another special case comes from the fact that Python reserved words cannot be
used as attributes. For instance, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">Array.from()</span></code></a> and
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Promise.finally()</span></code></a> cannot be directly accessed because they are Python
<code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>s. Instead we access these attributes with <code class="docutils literal notranslate"><span class="pre">Array.from_</span></code> and
<code class="docutils literal notranslate"><span class="pre">Promise.finally_</span></code>. Similarly, to access from Python, <code class="docutils literal notranslate"><span class="pre">o.from_</span></code> you have to use
<code class="docutils literal notranslate"><span class="pre">o.from__</span></code> with two underscores (since a single underscore is used for
<code class="docutils literal notranslate"><span class="pre">o.from</span></code>). This is reflected in the <code class="docutils literal notranslate"><span class="pre">dir</span></code> of a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({finally: 1, return: 2, from: 3, from_: 4})&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;finally_&quot;</span><span class="p">,</span> <span class="s2">&quot;return_&quot;</span><span class="p">,</span> <span class="s2">&quot;from_&quot;</span><span class="p">,</span> <span class="s2">&quot;from__&quot;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="proxying-from-python-into-javascript">
<span id="type-translations-pyproxy"></span><h6>Proxying from Python into JavaScript<a class="headerlink" href="#proxying-from-python-into-javascript" title="Link to this heading">#</a></h6>
<p>When most Python objects are translated to JavaScript a
<a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> is produced.</p>
<p>Fewer operations can be overloaded in JavaScript than in Python, so some
operations are more cumbersome on a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> than on a
<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>. The following operations are supported:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>JavaScript</p></th>
<th class="head"><p>Python</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.toString()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str(x)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">in</span> <span class="pre">proxy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hasattr(x,</span> <span class="pre">'foo')</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">proxy.foo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">x.foo</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Object.getOwnPropertyNames(proxy)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir(x)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x(...)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.foo(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x.foo(...)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.length</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">len(x)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.has(foo)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">in</span> <span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.get(foo)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[foo]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.set(foo,</span> <span class="pre">bar)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x[foo]</span> <span class="pre">=</span> <span class="pre">bar</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.delete(foo)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">x[foo]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">type(x)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">proxy[Symbol.iterator]()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">iter(x)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">proxy.next()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">next(x)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">proxy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">x</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="warning admonition">
<p class="admonition-title">Memory Leaks and PyProxy</p>
<p>Make sure to destroy PyProxies when you are done with them to avoid memory leaks.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="nx">foo</span><span class="p">();</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="nx">foo</span><span class="p">();</span><span class="w"> </span><span class="c1">// throws Error: Object has already been destroyed</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="explicit-conversion-of-proxies">
<h5>Explicit Conversion of Proxies<a class="headerlink" href="#explicit-conversion-of-proxies" title="Link to this heading">#</a></h5>
<section id="type-translations-pyproxy-to-js">
<span id="id2"></span><h6>Python to JavaScript<a class="headerlink" href="#type-translations-pyproxy-to-js" title="Link to this heading">#</a></h6>
<p>Explicit conversion of a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> into a native
JavaScript object is done with the <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method.
You can also perform such a conversion in Python using
<a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_js()</span></code></a> which behaves in much the same way. By default,
the <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method does a recursive “deep”
conversion, to do a shallow conversion use <code class="docutils literal notranslate"><span class="pre">proxy.toJs({depth</span> <span class="pre">:</span> <span class="pre">1})</span></code>. In
addition to <a class="reference internal" href="#type-translations-py2js-table"><span class="std std-ref">the normal type conversion</span></a>, the
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method performs the following explicit
conversions:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>JavaScript</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a></p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Set</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://docs.python.org/3.12/c-api/buffer.html" title="(in Python v3.12)"><span class="xref std std-doc">a buffer</span></a>*</p></td>
<td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>* Examples of buffers include <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> objects and numpy
<a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.html#arrays" title="(in NumPy v2.2)"><span>Array objects</span></a>.</p>
<p>If you need to convert <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> instead to <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Object</span></code></a>, you can
pass <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">Object.fromEntries()</span></code></a> as the <code class="docutils literal notranslate"><span class="pre">dict_converter</span></code> argument:
<code class="docutils literal notranslate"><span class="pre">proxy.toJs({dict_converter</span> <span class="pre">:</span> <span class="pre">Object.fromEntries})</span></code>.</p>
<p>In JavaScript, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a> and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Set</span></code></a> keys are compared using
object identity unless the key is an immutable type (meaning a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">String</span></code></a>, a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a>, a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a>, a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Boolean</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a>, or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a>). On the other
hand, in Python, <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> and <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> keys are compared using
deep equality. If a key is encountered in a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>
that would have different semantics in JavaScript than in Python, then a
<a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConversionError</span></code></a> will be thrown.</p>
<p>See <a class="reference internal" href="#buffer-tojs"><span class="std std-ref">Using Python Buffer objects from JavaScript</span></a> for the behavior of <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> on buffers.</p>
<div class="warning admonition">
<p class="admonition-title">Memory Leaks and toJs</p>
<p>The <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method can create many proxies at arbitrary
depth. It is your responsibility to manually <a class="reference internal" href="#pyodide.ffi.PyProxy.destroy" title="pyodide.ffi.PyProxy.destroy"><code class="xref js js-meth docutils literal notranslate"><span class="pre">destroy()</span></code></a>
these proxies if you wish to avoid memory leaks. The <code class="docutils literal notranslate"><span class="pre">pyproxies</span></code> argument to
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a> is designed to help with this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">pyproxies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="nx">proxy</span><span class="p">.</span><span class="nx">toJs</span><span class="p">({</span><span class="nx">pyproxies</span><span class="p">});</span>
<span class="c1">// Do stuff</span>
<span class="c1">// pyproxies contains the list of proxies created by `toJs`. We can destroy them</span>
<span class="c1">// when we are done with them</span>
<span class="k">for</span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">px</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">pyproxies</span><span class="p">){</span>
<span class="w">    </span><span class="nx">px</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">proxy</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
</div>
<p>As an alternative, if you wish to assert that the object should be fully
converted and no proxies should be created, you can use
<code class="docutils literal notranslate"><span class="pre">proxy.toJs({create_pyproxies</span> <span class="pre">:</span> <span class="pre">false})</span></code>. If a proxy would be created, a
<a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConversionError</span></code></a> is raised instead.</p>
</div>
</section>
<section id="type-translations-jsproxy-to-py">
<span id="id3"></span><h6>JavaScript to Python<a class="headerlink" href="#type-translations-jsproxy-to-py" title="Link to this heading">#</a></h6>
<p>Explicit conversion of a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> into a native Python
object is done with the <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JsProxy.to_py()</span></code></a>
method. By default, the <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a> method does a
recursive “deep” conversion, to do a shallow conversion use
<code class="docutils literal notranslate"><span class="pre">proxy.to_py(depth=1)</span></code>. The <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a> method
performs the following explicit conversions:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>JavaScript</p></th>
<th class="head"><p>Python</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Object</span></code></a>*</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Set</span></code></a></p></td>
<td><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>* <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a> will only convert an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Object</span></code></a>
into a dictionary if its constructor is <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Object</span></code></a>, otherwise the object
will be left alone. Example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Test</span><span class="w"> </span><span class="p">{};</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">};</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">};</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">setPrototypeOf</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">Test</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
    <span class="c1"># x is converted to a dictionary</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">to_py</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
    <span class="c1"># y is not a &quot;Plain Old JavaScript Object&quot;, it&#39;s an instance of type Test so it&#39;s not converted</span>
    <span class="k">assert</span> <span class="n">y</span><span class="o">.</span><span class="n">to_py</span><span class="p">()</span> <span class="o">==</span> <span class="n">y</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>In JavaScript, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a> and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Set</span></code></a> keys are compared using
object identity unless the key is an immutable type (meaning a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">String</span></code></a>, a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Number</span></code></a>, a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BigInt</span></code></a>, a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Boolean</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a>, or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a>). On the other
hand, in Python, <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> and <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> keys are compared using
deep equality. If a key is encountered in a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a> or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Set</span></code></a>
that would have different semantics in Python than in JavaScript, then a
<a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConversionError</span></code></a> will be thrown. Also, in JavaScript,
<code class="docutils literal notranslate"><span class="pre">true</span> <span class="pre">!==</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span> <span class="pre">!==</span> <span class="pre">0</span></code>, but in Python, <code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">==</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span> <span class="pre">==</span> <span class="pre">0</span></code>.
This has the result that a JavaScript map can use <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> as distinct
keys but a Python <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> cannot. If the JavaScript map contains both
<code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> a <a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConversionError</span></code></a> will be thrown.</p>
</section>
</section>
<section id="functions">
<h5>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h5>
<section id="calling-python-objects-from-javascript">
<span id="call-py-from-js"></span><h6>Calling Python objects from JavaScript<a class="headerlink" href="#calling-python-objects-from-javascript" title="Link to this heading">#</a></h6>
<p>If a Python object is callable, the proxy will be callable too. The arguments
will be translated from JavaScript to Python as appropriate, and the return
value will be translated from JavaScript back to Python. If the return value is
a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>, you must explicitly destroy it or else it will be leaked.</p>
<p>An example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">test</span>
<span class="s">`</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result_py</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">]);</span>
<span class="c1">// result_py is a PyProxy of a list.</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result_js</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result_py</span><span class="p">.</span><span class="nx">toJs</span><span class="p">();</span>
<span class="c1">// result_js is the array [1, 4, 9, 16]</span>
<span class="nx">result_py</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
</div>
<p>If a function is intended to be used from JavaScript, you can use
<a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_js()</span></code></a> on the return value. This prevents the return
value from leaking without requiring the JavaScript code to explicitly destroy
it. This is particularly important for callbacks.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_js</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">to_js</span><span class="p">([</span><span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="n">test</span>
<span class="s">`</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">]);</span>
<span class="c1">// result is the array [1, 4, 9, 16], nothing needs to be destroyed.</span>
</pre></div>
</div>
<p>If you need to use a key word argument, use <a class="reference internal" href="#pyodide.ffi.PyCallable.callKwargs" title="pyodide.ffi.PyCallable.callKwargs"><code class="xref js js-func docutils literal notranslate"><span class="pre">callKwargs()</span></code></a>. The
last argument should be a JavaScript object with the key value arguments.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_js</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">to_js</span><span class="p">([</span><span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="n">offset</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="n">to_js</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="s">`</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">.</span><span class="nx">callKwargs</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">offset</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="p">});</span>
<span class="c1">// result is the array [8, 12, 16, 23]</span>
</pre></div>
</div>
</section>
<section id="calling-javascript-functions-from-python">
<span id="call-js-from-py"></span><h6>Calling JavaScript functions from Python<a class="headerlink" href="#calling-javascript-functions-from-python" title="Link to this heading">#</a></h6>
<p>What happens when calling a JavaScript function from Python is a bit more
complicated than calling a Python function from JavaScript. If there are any
keyword arguments, they are combined into a JavaScript object and used as the
final argument. Thus, if you call:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>then the JavaScript function receives one argument which is a JavaScript object
<code class="docutils literal notranslate"><span class="pre">{a</span> <span class="pre">:</span> <span class="pre">2,</span> <span class="pre">b</span> <span class="pre">:</span> <span class="pre">3}</span></code>.</p>
<p>When a JavaScript function is called, if the return value not a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>, a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Generator</span></code></a>, or an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a>,
any arguments that are PyProxies that were created in the process of argument
conversion are also destroyed. If the result is a
<a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> it is also destroyed.</p>
<p>As a result of this, if a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> is persisted to be
used later, then it must either be copied using <a class="reference internal" href="#pyodide.ffi.PyProxy.copy" title="pyodide.ffi.PyProxy.copy"><code class="xref js js-meth docutils literal notranslate"><span class="pre">copy()</span></code></a> in
JavaScript, or it must be created with <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a> or
<a class="reference internal" href="#pyodide.ffi.create_once_callable" title="pyodide.ffi.create_once_callable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_once_callable()</span></code></a>. If it’s only going to be called
once use <a class="reference internal" href="#pyodide.ffi.create_once_callable" title="pyodide.ffi.create_once_callable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_once_callable()</span></code></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_once_callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">setTimeout</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_callback</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hi&quot;</span><span class="p">)</span>
<span class="n">setTimeout</span><span class="p">(</span><span class="n">create_once_callable</span><span class="p">(</span><span class="n">my_callback</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>If it’s going to be called many times use <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_proxy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">document</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_callback</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hi&quot;</span><span class="p">)</span>
<span class="n">proxy</span> <span class="o">=</span> <span class="n">create_proxy</span><span class="p">(</span><span class="n">my_callback</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">proxy</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="c1"># make sure to hold on to proxy</span>
<span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">proxy</span><span class="p">)</span>
<span class="n">proxy</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p>When a JavaScript function returns a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> (for example, if the
function is an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" title="(in MDN docs)"><span class="xref std std-ref">async function</span></a>), it is assumed that the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> is
going to do some work that uses the arguments of the function, so it is not safe
to destroy them until the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> resolves. In this case, the
proxied function returns a Python <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-future.html#asyncio.Future" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> instead of the
original <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>. When the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> resolves, the result
is converted to Python and the converted value is used to resolve the
<a class="reference external" href="https://docs.python.org/3.12/library/asyncio-future.html#asyncio.Future" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a>. Then if the result is a
<a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> it is destroyed. Any PyProxies created in
converting the arguments are also destroyed at this point.</p>
<p>Similarly, if the return value is a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Generator</span></code></a> or
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a>, then the arguments (and all values sent to the
generator) are kept alive until it is exhausted, or until
<a class="reference internal" href="#pyodide.ffi.JsGenerator.close" title="pyodide.ffi.JsGenerator.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> is called.</p>
</section>
</section>
<section id="buffers">
<h5>Buffers<a class="headerlink" href="#buffers" title="Link to this heading">#</a></h5>
<section id="using-javascript-typed-arrays-from-python">
<h6>Using JavaScript Typed Arrays from Python<a class="headerlink" href="#using-javascript-typed-arrays-from-python" title="Link to this heading">#</a></h6>
<p>JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a> and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a> objects are
proxied into Python. Python can’t directly access arrays if they are outside the
WASM heap, so it’s impossible to directly use these proxied buffers as Python
buffers. You can convert such a proxy to a Python <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> using
the <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a> api. This makes it easy to correctly convert the array to a Numpy
array using <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.asarray.html#numpy.asarray" title="(in NumPy v2.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.asarray()</span></code></a>:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">self</span><span class="p">.</span><span class="nx">jsarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">]);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">jsarray</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">jsarray</span><span class="o">.</span><span class="n">to_py</span><span class="p">()</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
    <span class="n">numpy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">)</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>After manipulating <code class="docutils literal notranslate"><span class="pre">numpy_array</span></code> you can assign the value back to
<code class="docutils literal notranslate"><span class="pre">jsarray</span></code> using <a class="reference internal" href="#pyodide.ffi.JsBuffer.assign" title="pyodide.ffi.JsBuffer.assign"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign()</span></code></a>:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="n">numpy_array</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">77</span>
    <span class="n">jsarray</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="s">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsarray</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 2, 3, 4, 77, 6]</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#pyodide.ffi.JsBuffer.assign" title="pyodide.ffi.JsBuffer.assign"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign()</span></code></a> and
<a class="reference internal" href="#pyodide.ffi.JsBuffer.assign_to" title="pyodide.ffi.JsBuffer.assign_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_to()</span></code></a> methods can be used to assign a
JavaScript buffer from / to a Python buffer which is appropriately sized and
contiguous. The assignment methods will only work if the data types match, the
total length of the buffers match, and the Python buffer is contiguous.</p>
</section>
<section id="using-python-buffer-objects-from-javascript">
<span id="buffer-tojs"></span><h6>Using Python Buffer objects from JavaScript<a class="headerlink" href="#using-python-buffer-objects-from-javascript" title="Link to this heading">#</a></h6>
<p>Python objects supporting the <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">Python Buffer
protocol</a> are proxied into
JavaScript. The data inside the buffer can be accessed via the
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method or the
<a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> method. The
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> API copies the buffer into JavaScript,
whereas the <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> method allows low level
access to the WASM memory backing the buffer. The
<a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> API is more powerful but requires
care to use correctly. For simple use cases the
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> API should be preferred.</p>
<p>If the buffer is zero or one-dimensional, then
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> will in most cases convert it to a single
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a>. However, in the case that the format of the buffer is
<code class="docutils literal notranslate"><span class="pre">'s'</span></code>, we will convert the buffer to a string and if the format is <code class="docutils literal notranslate"><span class="pre">'?'</span></code> we will
convert it to an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a> of booleans.</p>
<p>If the dimension is greater than one, we will convert it to a nested JavaScript
array, with the innermost dimension handled in the same way we would handle a 1d
array.</p>
<p>An example of a case where you would not want to use the
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> method is when the buffer is bitmapped
image data. If for instance you have a 3d buffer shaped 1920 x 1080 x 4, then
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> will be extremely slow. In this case you
could use <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">getBuffer()</span></code></a>. On the other hand, if you
have a 3d buffer shaped 1920 x 4 x 1080, the performance of
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-func docutils literal notranslate"><span class="pre">toJs()</span></code></a> will most likely be satisfactory.
Typically, the innermost dimension won’t matter for performance.</p>
<p>The <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> method can be used to retrieve a reference to
a JavaScript typed array that points to the data backing the Python object,
combined with other metadata about the buffer format. The metadata is suitable
for use with a JavaScript ndarray library if one is present. For instance, if
you load the JavaScript <a class="reference external" href="https://github.com/scijs/ndarray">ndarray</a> package, you
can do:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;some_numpy_ndarray&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">proxy</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">();</span>
<span class="nx">proxy</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">readonly</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// We can&#39;t stop you from changing a readonly buffer, but it can cause undefined behavior.</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Uh-oh, we were planning to change the buffer&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ndarray</span><span class="p">(</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">shape</span><span class="p">,</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">strides</span><span class="p">,</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">offset</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="c1">// manipulate array here</span>
<span class="w">  </span><span class="c1">// changes will be reflected in the Python ndarray!</span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">release</span><span class="p">();</span><span class="w"> </span><span class="c1">// Release the memory when we&#39;re done</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="errors">
<span id="type-translations-errors"></span><h5>Errors<a class="headerlink" href="#errors" title="Link to this heading">#</a></h5>
<p>All entrypoints and exit points from Python code are wrapped in JavaScript <code class="docutils literal notranslate"><span class="pre">try</span></code>
blocks. At the boundary between Python and JavaScript, errors are caught,
converted between languages, and rethrown.</p>
<p>JavaScript errors are wrapped in a <a class="reference internal" href="#pyodide.ffi.JsException" title="pyodide.ffi.JsException"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsException</span></code></a>.
Python exceptions are converted to a <a class="reference internal" href="#pyodide.ffi.PythonError" title="pyodide.ffi.PythonError"><code class="xref js js-class docutils literal notranslate"><span class="pre">PythonError</span></code></a>.
At present if an exception crosses between Python and JavaScript several times,
the resulting error message won’t be as useful as one might hope.</p>
<p>In order to reduce memory leaks, the <a class="reference internal" href="#pyodide.ffi.PythonError" title="pyodide.ffi.PythonError"><code class="xref js js-class docutils literal notranslate"><span class="pre">PythonError</span></code></a> has a
formatted traceback, but no reference to the original Python exception. The
original exception has references to the stack frame and leaking it will leak
all the local variables from that stack frame. The actual Python exception will
be stored in <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_value" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_value</span></code></a> so if you need access to it (for instance
to produce a traceback with certain functions filtered out), use that.</p>
<div class="warning admonition">
<p class="admonition-title">Be careful Proxying Stack Frames</p>
<p>If you make a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> of <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_value" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_value</span></code></a>, you should be especially
careful to <a class="reference internal" href="#pyodide.ffi.PyProxy.destroy" title="pyodide.ffi.PyProxy.destroy"><code class="xref js js-meth docutils literal notranslate"><span class="pre">destroy()</span></code></a> it when you are done with it, or
you may leak a large amount of memory if you don’t.</p>
</div>
<p>The easiest way is to only handle the exception in Python:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reformat_exception</span><span class="p">():</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">traceback</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_exception</span>
    <span class="c1"># Format a modified exception here</span>
    <span class="c1"># this just prints it normally but you could for instance filter some frames</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">format_exception</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">last_type</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">last_value</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">last_traceback</span><span class="p">)</span>
    <span class="p">)</span>
<span class="s">`</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">reformat_exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;reformat_exception&quot;</span><span class="p">);</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="nx">some_code</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
<span class="w">    </span><span class="c1">// replace error message</span>
<span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">reformat_exception</span><span class="p">();</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="nx">e</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="importing-objects">
<h5>Importing Objects<a class="headerlink" href="#importing-objects" title="Link to this heading">#</a></h5>
<p>It is possible to access objects in one language from the global scope in the
other language. It is also possible to create custom namespaces and access
objects on the custom namespaces.</p>
<section id="importing-python-objects-into-javascript">
<span id="type-translations-using-py-obj-from-js"></span><h6>Importing Python objects into JavaScript<a class="headerlink" href="#importing-python-objects-into-javascript" title="Link to this heading">#</a></h6>
<p>A Python global variable in the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> global scope can be imported into
JavaScript using the <a class="reference internal" href="#pyodide.ffi.PyProxyWithGet.get" title="pyodide.ffi.PyProxyWithGet.get"><code class="xref js js-meth docutils literal notranslate"><span class="pre">pyodide.globals.get()</span></code></a> method. Given the
name of the Python global variable, it returns the value of the variable
translated to JavaScript.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>As always, if the result is a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> and you care about not leaking the
Python object, you must destroy it when you are done. It’s also possible to set
values in the Python global scope with <a class="reference internal" href="#pyodide.ffi.PyProxyWithSet.set" title="pyodide.ffi.PyProxyWithSet.set"><code class="xref js js-meth docutils literal notranslate"><span class="pre">pyodide.globals.set()</span></code></a>
or remove them with <a class="reference internal" href="#pyodide.ffi.PyProxyWithSet.delete" title="pyodide.ffi.PyProxyWithSet.delete"><code class="xref js js-meth docutils literal notranslate"><span class="pre">pyodide.globals.delete()</span></code></a>:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="s">&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Prints 2</span>
</pre></div>
</div>
<p>If you execute code with a custom globals dictionary, you can use a similar
approach:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">my_py_namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)();</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">my_py_namespace</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">my_py_namespace</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>To access a Python module from JavaScript, use <a class="reference internal" href="#pyodide.pyimport" title="pyodide.pyimport"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyimport()</span></code></a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">sys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;sys&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="importing-javascript-objects-into-python">
<span id="type-translations-using-js-obj-from-py"></span><h6>Importing JavaScript objects into Python<a class="headerlink" href="#importing-javascript-objects-into-python" title="Link to this heading">#</a></h6>
<p>JavaScript objects in the <a class="reference internal" href="#module-globalThis" title="globalThis"><code class="xref js js-data docutils literal notranslate"><span class="pre">globalThis</span></code></a> global scope can be imported
into Python using the <code class="docutils literal notranslate"><span class="pre">js</span></code> module.</p>
<p>When importing a name from the <code class="docutils literal notranslate"><span class="pre">js</span></code> module, the <code class="docutils literal notranslate"><span class="pre">js</span></code> module looks up JavaScript
attributes of the <a class="reference internal" href="#module-globalThis" title="globalThis"><code class="xref js js-data docutils literal notranslate"><span class="pre">globalThis</span></code></a> scope and translates the JavaScript
objects into Python.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">js</span>
<span class="n">js</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;New window title&#39;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js.document.location</span><span class="w"> </span><span class="kn">import</span> <span class="n">reload</span> <span class="k">as</span> <span class="n">reload_page</span>
<span class="n">reload_page</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also assign to JavaScript global variables in this way:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">&quot;</span><span class="n">js</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="s">&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// 2</span>
</pre></div>
</div>
<p>You can create your own custom JavaScript modules using
<a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a> and they will behave like the <code class="docutils literal notranslate"><span class="pre">js</span></code> module except
with a custom scope:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">my_js_namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="p">};</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">registerJsModule</span><span class="p">(</span><span class="s2">&quot;my_js_namespace&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">my_js_namespace</span><span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">my_js_namespace</span><span class="w"> </span><span class="kn">import</span> <span class="n">x</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># 3</span>
    <span class="n">my_js_namespace</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">7</span>
<span class="s">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">my_js_namespace</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span><span class="w"> </span><span class="c1">// 7</span>
</pre></div>
</div>
<p>If the JavaScript object’s name is a reserved Python keyword, the <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#getattr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> function can be used to access the object by name within the js module::</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">};</span>
<span class="c1">//&#39;from js import lambda&#39; will cause a Syntax Error, since &#39;lambda&#39; is a Python reserved keyword. Instead:</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">js</span>
    <span class="n">js_lambda</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">js_lambda</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>If a JavaScript object has a property that is a reserved Python keyword, the <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#setattr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">setattr()</span></code></a> and <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#getattr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> function can be used to access that property by name:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nb">global</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lots and lots&quot;</span><span class="p">};</span>
<span class="c1">//Trying to access &#39;people.global&#39; will raise a Syntax Error, since &#39;global&#39; is a Python reserved keyword. Instead:</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">people</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;even more&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">))</span>
    <span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-usage/keyboard-interrupts"></span><section id="interrupting-execution">
<span id="id1"></span><h4>Interrupting execution<a class="headerlink" href="#interrupting-execution" title="Link to this heading">#</a></h4>
<p>The native Python interrupt system is based on preemptive multitasking but Web
Assembly has no support for preemptive multitasking. Because of this,
interrupting execution in Pyodide must be achieved via a different mechanism
which takes some effort to set up.</p>
<section id="setting-up-interrupts">
<h5>Setting up interrupts<a class="headerlink" href="#setting-up-interrupts" title="Link to this heading">#</a></h5>
<p>In order to use interrupts you must be using Pyodide in a webworker.
You also will need to use a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">SharedArrayBuffer</span></code></a>, which means that your
server
must set appropriate security headers. See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements">the MDN
docs</a>
for more information.</p>
<p>To use the interrupt system, you should create a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">SharedArrayBuffer</span></code></a>
on either the main thread or the worker thread and share it with the other
thread. You should use <a class="reference internal" href="#pyodide.setInterruptBuffer" title="pyodide.setInterruptBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setInterruptBuffer()</span></code></a> to set the
interrupt buffer on the Pyodide thread. When you want to indicate an interrupt,
write a <code class="docutils literal notranslate"><span class="pre">2</span></code> into the interrupt buffer. When the interrupt signal is processed,
Pyodide will set the value of the interrupt buffer back to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>By default, when the interrupt fires, a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> is raised.
Using the <a class="reference external" href="https://docs.python.org/3.12/library/signal.html#module-signal" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">signal</span></code></a> module, it is possible to register a custom Python
function to handle <a class="reference external" href="https://docs.python.org/3.12/library/signal.html#signal.SIGINT" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">SIGINT</span></code></a>. If you register a custom handler
function it will be called instead.</p>
<p>Here is a very basic example. Main thread code:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">pyodideWorker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Worker</span><span class="p">(</span><span class="s2">&quot;pyodideWorker.js&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">interruptBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint8Array</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">SharedArrayBuffer</span><span class="p">(</span><span class="mf">1</span><span class="p">));</span>
<span class="nx">pyodideWorker</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">cmd</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;setInterruptBuffer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">interruptBuffer</span><span class="w"> </span><span class="p">});</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">interruptExecution</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 2 stands for SIGINT.</span>
<span class="w">  </span><span class="nx">interruptBuffer</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// imagine that interruptButton is a button we want to trigger an interrupt.</span>
<span class="nx">interruptButton</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">interruptExecution</span><span class="p">);</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">runCode</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Clear interruptBuffer in case it was accidentally left set after previous code completed.</span>
<span class="w">  </span><span class="nx">interruptBuffer</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pyodideWorker</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">cmd</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;runCode&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Worker code:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">cmd</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;setInterruptBuffer&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setInterruptBuffer</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">interruptBuffer</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">cmd</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;runCode&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">code</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="allowing-javascript-code-to-be-interrupted">
<h5>Allowing JavaScript code to be interrupted<a class="headerlink" href="#allowing-javascript-code-to-be-interrupted" title="Link to this heading">#</a></h5>
<p>The interrupt system above allows interruption of Python code and also of C code
that allows itself to be interrupted by periodically calling
<a class="reference external" href="https://docs.python.org/3.12/c-api/exceptions.html#c.PyErr_CheckSignals" title="(in Python v3.12)"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_CheckSignals()</span></code></a>. There is also a function
<a class="reference internal" href="#pyodide.checkInterrupt" title="pyodide.checkInterrupt"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.checkInterrupt()</span></code></a> that allows JavaScript functions called from
Python to check for an interrupt. As a simple example, we can implement an
interruptible sleep function using <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Atomics/wait" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">Atomics.wait()</span></code></a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">blockingSleepBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Int32Array</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">SharedArrayBuffer</span><span class="p">(</span><span class="mf">4</span><span class="p">));</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">blockingSleep</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// This Atomics.wait call blocks the thread until the buffer changes or a 50ms timeout elapses.</span>
<span class="w">    </span><span class="c1">// Since we won&#39;t change the value in the buffer, this blocks for 50ms.</span>
<span class="w">    </span><span class="nb">Atomics</span><span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="nx">blockingSleepBuffer</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Periodically check for an interrupt to allow a KeyboardInterrupt.</span>
<span class="w">    </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">checkInterrupt</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/streams"></span><section id="redirecting-standard-streams">
<span id="streams"></span><h4>Redirecting standard streams<a class="headerlink" href="#redirecting-standard-streams" title="Link to this heading">#</a></h4>
<p>Pyodide has three functions <a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code></a>,
<a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code></a>, and <a class="reference internal" href="#pyodide.setStderr" title="pyodide.setStderr"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStderr()</span></code></a> that change the
behavior of reading from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdin</span></code></a> and writing to <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdout</span></code></a> and
<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stderr" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stderr</span></code></a> respectively.</p>
<section id="standard-input">
<h5>Standard Input<a class="headerlink" href="#standard-input" title="Link to this heading">#</a></h5>
<p id="streams-stdin"><a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code></a> sets the standard in handler. There are several
different ways to do this depending on the options passed to <code class="docutils literal notranslate"><span class="pre">setStdin</span></code>.</p>
<section id="always-raise-io-error">
<h6>Always raise IO Error<a class="headerlink" href="#always-raise-io-error" title="Link to this heading">#</a></h6>
<p>If we pass <code class="docutils literal notranslate"><span class="pre">{error:</span> <span class="pre">true}</span></code>, any read from stdin raises an I/O error.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">    with pytest.raises(OSError, match=&quot;I/O error&quot;):</span>
<span class="sb">        input()</span>
<span class="sb">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="set-the-default-behavior">
<h6>Set the default behavior<a class="headerlink" href="#set-the-default-behavior" title="Link to this heading">#</a></h6>
<p>You can set the default behavior by calling <code class="docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code> with no
arguments. In Node the default behavior is to read directly from Node’s standard
input. In the browser, the default is the same as
<code class="docutils literal notranslate"><span class="pre">pyodide.setStdin({</span> <span class="pre">stdin:</span> <span class="pre">()</span> <span class="pre">=&gt;</span> <span class="pre">prompt()</span> <span class="pre">})</span></code>.</p>
</section>
<section id="a-stdin-handler">
<h6>A stdin handler<a class="headerlink" href="#a-stdin-handler" title="Link to this heading">#</a></h6>
<p>We can pass the options <code class="docutils literal notranslate"><span class="pre">{stdin,</span> <span class="pre">isatty}</span></code>. <code class="docutils literal notranslate"><span class="pre">stdin</span></code> should be a
zero-argument function which should return one of:</p>
<ol class="arabic simple">
<li><p>A string which represents a full line of text (it will have a newline
appended if it does not already end in one).</p></li>
<li><p>An array buffer or Uint8Array containing utf8 encoded characters</p></li>
<li><p>A number between 0 and 255 which indicates one byte of input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">undefined</span></code> or <code class="docutils literal notranslate"><span class="pre">null</span></code> which indicates EOF.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">isatty</span></code> is a boolean which
indicates whether <code class="docutils literal notranslate"><span class="pre">sys.stdin.isatty()</span></code> should return <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<p>For example, the following class plays back a list of results.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">results</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">stdin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">idx</span><span class="o">++</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here it is in use:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span>
<span class="w">  </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bcd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;efg&quot;</span><span class="p">]),</span>
<span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bcd&quot;</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;efg&quot;</span>
    <span class="c1"># after this, further attempts to read from stdin will return undefined which</span>
    <span class="c1"># indicates end of file</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;EOF when reading a line&quot;</span><span class="p">):</span>
        <span class="nb">input</span><span class="p">()</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">input()</span></code> function automatically reads a line of text and
removes the trailing newline. If we use <code class="docutils literal notranslate"><span class="pre">sys.stdin.read</span></code> we see that newlines
have been appended to strings that don’t end in a newline:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span>
<span class="w">  </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bcd\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;efg&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">undefined</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;i&quot;</span><span class="p">]),</span>
<span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">raw</span><span class="s">`</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;a</span><span class="se">\n</span><span class="s2">bcd</span><span class="se">\n</span><span class="s2">efg</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;h</span><span class="se">\n</span><span class="s2">i</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>Instead of strings we can return the list of utf8 bytes for the input:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span>
<span class="w">  </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="mh">0x61</span><span class="w"> </span><span class="cm">/* a */</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0a</span><span class="w"> </span><span class="cm">/* \n */</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="w"> </span><span class="cm">/* b */</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="w"> </span><span class="cm">/* c */</span><span class="p">],</span>
<span class="w">    </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bc&quot;</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>Or we can return a <code class="docutils literal notranslate"><span class="pre">Uint8Array</span></code> with the utf8-encoded text that we wish to
render:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span>
<span class="w">  </span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">([</span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint8Array</span><span class="p">([</span><span class="mh">0x61</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">])]),</span>
<span class="p">);</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span>
    <span class="k">assert</span> <span class="nb">input</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bc&quot;</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="a-read-handler">
<h6>A read handler<a class="headerlink" href="#a-read-handler" title="Link to this heading">#</a></h6>
<p>A read handler takes a <code class="docutils literal notranslate"><span class="pre">Uint8Array</span></code> as an argument and is supposed to place
the data into this buffer and return the number of bytes read. This is useful in
Node. For example, the following class can be used to read from a Node file
descriptor:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">tty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;tty&quot;</span><span class="p">);</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">NodeReader</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">fd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fd</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isatty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tty</span><span class="p">.</span><span class="nx">isatty</span><span class="p">(</span><span class="nx">fd</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">read</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readSync</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fd</span><span class="p">,</span><span class="w"> </span><span class="nx">buffer</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For instance to set stdin to read from a file called <code class="docutils literal notranslate"><span class="pre">input.txt</span></code>, we can do the
following:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="nx">py</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">NodeReader</span><span class="p">(</span><span class="nx">fd</span><span class="p">));</span>
</pre></div>
</div>
<p>Or we can read from node’s stdin (the default behavior) as follows:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="s2">&quot;/dev/stdin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="nx">py</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">NodeReader</span><span class="p">(</span><span class="nx">fd</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="isatty">
<h6>isatty<a class="headerlink" href="#isatty" title="Link to this heading">#</a></h6>
<p>It is possible to control whether or not <a class="reference external" href="https://docs.python.org/3.12/library/io.html#io.IOBase.isatty" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sys.stdin.isatty()</span></code></a>
returns true with the <code class="docutils literal notranslate"><span class="pre">isatty</span></code> option:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">([],</span><span class="w"> </span><span class="p">{</span><span class="nx">isatty</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}));</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">()</span> <span class="c1"># returns true as we requested</span>
<span class="s">`</span><span class="p">);</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">StdinHandler</span><span class="p">([],</span><span class="w"> </span><span class="p">{</span><span class="nx">isatty</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">}));</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="k">assert</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">()</span> <span class="c1"># returns false as we requested</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>This will change the behavior of cli applications that behave differently in an
interactive terminal, for example pytest does this.</p>
</section>
<section id="raising-io-errors">
<h6>Raising IO errors<a class="headerlink" href="#raising-io-errors" title="Link to this heading">#</a></h6>
<p>To raise an IO error in either a <code class="docutils literal notranslate"><span class="pre">stdin</span></code> or <code class="docutils literal notranslate"><span class="pre">read</span></code> handler, you should throw an
IO error as follows:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">ErrnoError</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">ERRNO_CODES</span><span class="p">.</span><span class="nx">EIO</span><span class="p">);</span>
</pre></div>
</div>
<p>for instance, saying:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">({</span>
<span class="w">  </span><span class="nx">read</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">FS</span><span class="p">.</span><span class="nx">ErrnoError</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">ERRNO_CODES</span><span class="p">.</span><span class="nx">EIO</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>is the same as <code class="docutils literal notranslate"><span class="pre">pyodide.setStdin({error:</span> <span class="pre">true})</span></code>.</p>
</section>
<section id="handling-keyboard-interrupts">
<h6>Handling Keyboard interrupts<a class="headerlink" href="#handling-keyboard-interrupts" title="Link to this heading">#</a></h6>
<p>To handle a keyboard interrupt in an input handler, you should periodically call
<a class="reference internal" href="#pyodide.checkInterrupt" title="pyodide.checkInterrupt"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.checkInterrupt()</span></code></a>. For example, the following stdin handler
always raises a keyboard interrupt:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">interruptBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Int32Array</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">SharedArrayBuffer</span><span class="p">(</span><span class="mf">4</span><span class="p">));</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">setInterruptBuffer</span><span class="p">(</span><span class="nx">interruptBuffer</span><span class="p">);</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">({</span>
<span class="w">  </span><span class="nx">read</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Put signal into interrupt buffer</span>
<span class="w">    </span><span class="nx">interruptBuffer</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Call checkInterrupt to raise an error</span>
<span class="w">    </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">checkInterrupt</span><span class="p">();</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">      </span><span class="s2">&quot;This code won&#39;t ever be executed because pyodide.checkInterrupt raises an error!&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>For a more realistic example that handles reading stdin in a worker and also
keyboard interrupts, you might something like the following code:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdin</span><span class="p">({</span><span class="nx">read</span><span class="p">(</span><span class="nx">buf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeoutMilliseconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="p">(</span><span class="nb">Atomics</span><span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="nx">stdinSharedBuffer</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">timeoutMilliseconds</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;timed-out&quot;</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// 100 ms passed but got no data, check for keyboard interrupt then return to waiting on data.</span>
<span class="w">        </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">checkInterrupt</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;ok&quot;</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// ... handle the data somehow</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}});</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#interrupting-execution"><span class="std std-ref">Interrupting execution</span></a>.</p>
</section>
</section>
<section id="standard-out-standard-error">
<h5>Standard Out / Standard Error<a class="headerlink" href="#standard-out-standard-error" title="Link to this heading">#</a></h5>
<p id="streams-stdout"><a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code></a> and <a class="reference internal" href="#pyodide.setStderr" title="pyodide.setStderr"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStderr()</span></code></a> respectively set
the standard output and standard error handlers. These APIs are identical except
in their defaults, so we will only discuss the <code class="docutils literal notranslate"><span class="pre">pyodide.setStdout</span></code> except in
cases where they differ.</p>
<p>As with <a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code></a>, there are quite a few different ways to set
the standard output handlers.</p>
<section id="id1">
<h6>Set the default behavior<a class="headerlink" href="#id1" title="Link to this heading">#</a></h6>
<p>As with stdin, <code class="docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code> sets the default behavior. In node, this is
to write directly to <code class="docutils literal notranslate"><span class="pre">process.stdout</span></code>. In the browser, the default is as if you
wrote
<code class="docutils literal notranslate"><span class="pre">setStdout({batched:</span> <span class="pre">(str)</span> <span class="pre">=&gt;</span> <span class="pre">console.log(str)})</span></code>
see below.</p>
</section>
<section id="a-batched-handler">
<h6>A batched handler<a class="headerlink" href="#a-batched-handler" title="Link to this heading">#</a></h6>
<p>A batched handler is the easiest standard out handler to implement but it is
also the coarsest. It is intended to use with APIs like <code class="docutils literal notranslate"><span class="pre">console.log</span></code> that don’t
understand partial lines of text or for quick and dirty code.</p>
<p>The batched handler receives a string which is either:</p>
<ol class="arabic simple">
<li><p>a complete line of text with the newline removed or</p></li>
<li><p>a partial line of text that was flushed.</p></li>
</ol>
<p>For instance after:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello!&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;partial line&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>the batched handler is called with <code class="docutils literal notranslate"><span class="pre">&quot;hello!&quot;</span></code> and then with <code class="docutils literal notranslate"><span class="pre">&quot;partial</span> <span class="pre">line&quot;</span></code>.
Note that there is no indication that <code class="docutils literal notranslate"><span class="pre">&quot;hello!&quot;</span></code> was a complete line of text and
<code class="docutils literal notranslate"><span class="pre">&quot;partial</span> <span class="pre">line&quot;</span></code> was not.</p>
</section>
<section id="a-raw-handler">
<h6>A raw handler<a class="headerlink" href="#a-raw-handler" title="Link to this heading">#</a></h6>
<p>A raw handler receives the output one character code at a time. This is neither
very convenient nor very efficient. It is present primarily for backwards
compatibility reasons.</p>
<p>For example, the following code:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>will call the raw handler with the sequence of bytes:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="mh">0x68</span> <span class="o">-</span> <span class="n">h</span>
<span class="mh">0x0A</span> <span class="o">-</span> <span class="n">newline</span>
<span class="mh">0x70</span> <span class="o">-</span> <span class="n">p</span>
<span class="mh">0x20</span> <span class="o">-</span> <span class="n">space</span>
<span class="mh">0x6c</span> <span class="o">-</span> <span class="n">l</span>
</pre></div>
</div>
</section>
<section id="a-write-handler">
<h6>A write handler<a class="headerlink" href="#a-write-handler" title="Link to this heading">#</a></h6>
<p>A write handler takes a <code class="docutils literal notranslate"><span class="pre">Uint8Array</span></code> as an argument and is supposed to write the
data in this buffer to standard output and return the number of bytes written.
For example, the following class can be used to write to a Node file descriptor:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">tty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;tty&quot;</span><span class="p">);</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">NodeWriter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">fd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fd</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isatty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tty</span><span class="p">.</span><span class="nx">isatty</span><span class="p">(</span><span class="nx">fd</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">write</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">writeSync</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fd</span><span class="p">,</span><span class="w"> </span><span class="nx">buffer</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using it as follows redirects output from Pyodide to <code class="docutils literal notranslate"><span class="pre">out.txt</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="s2">&quot;out.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nx">py</span><span class="p">.</span><span class="nx">setStdout</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">NodeWriter</span><span class="p">(</span><span class="nx">fd</span><span class="p">));</span>
</pre></div>
</div>
<p>Or the following gives the default behavior:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="s2">&quot;out.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nx">py</span><span class="p">.</span><span class="nx">setStdout</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">NodeWriter</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">fd</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="id2">
<h6>isatty<a class="headerlink" href="#id2" title="Link to this heading">#</a></h6>
<p>As with <code class="docutils literal notranslate"><span class="pre">stdin</span></code>, is possible to control whether or not
<a class="reference external" href="https://docs.python.org/3.12/library/io.html#io.IOBase.isatty" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sys.stdout.isatty()</span></code></a> returns true with the <code class="docutils literal notranslate"><span class="pre">isatty</span></code>
option. You cannot combine <code class="docutils literal notranslate"><span class="pre">isatty:</span> <span class="pre">true</span></code> with a batched handler.</p>
</section>
</section>
</section>
<span id="document-usage/api-reference"></span><section id="api-reference">
<h4>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">#</a></h4>
<div class="toctree-wrapper compound">
<span id="document-usage/api/js-api"></span><section id="javascript-api">
<h5>JavaScript API<a class="headerlink" href="#javascript-api" title="Link to this heading">#</a></h5>
<p>Backward compatibility of the API is not guaranteed at this point.</p>
<section id="globals">
<h6>Globals<a class="headerlink" href="#globals" title="Link to this heading">#</a></h6>
<div class="jssummarytable functions docutils container">
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><strong>async</strong> <a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref any js js-func docutils literal notranslate"><span class="pre">loadPyodide</span></code></a><strong>(options)</strong></p></td>
<td class="summary"><p>Load the main Pyodide wasm module and initialize it.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<dl class="js function" id="module-globalThis">
<dt class="sig sig-object js" id="globalThis.loadPyodide">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">globalThis</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">loadPyodide</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#globalThis.loadPyodide" title="Link to this definition">#</a></dt>
<dd><p>Load the main Pyodide wasm module and initialize it.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.indexURL</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The URL from which Pyodide will load the main Pyodide runtime and packages. It is recommended that you leave this unchanged, providing an incorrect value can cause broken behavior. Default: The url that Pyodide is loaded from with the file name (<code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code> or <code class="docutils literal notranslate"><span class="pre">pyodide.mjs</span></code>) removed.</p></li>
<li><p><strong>options.packageCacheDir</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The file path where packages will be cached in node. If a package exists in <code class="docutils literal notranslate"><span class="pre">packageCacheDir</span></code> it is loaded from there, otherwise it is downloaded from the JsDelivr CDN and then cached into <code class="docutils literal notranslate"><span class="pre">packageCacheDir</span></code>. Only applies when running in node; ignored in browsers. Default: same as indexURL</p></li>
<li><p><strong>options.lockFileURL</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The URL from which Pyodide will load the Pyodide <code class="docutils literal notranslate"><span class="pre">pyodide-lock.json</span></code> lock file. You can produce custom lock files with <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.freeze" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.freeze()</span></code></a>. Default: <code class="docutils literal notranslate"><span class="pre">`${indexURL}/pyodide-lock.json`</span></code></p></li>
<li><p><strong>options.fullStdLib</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Load the full Python standard library. Setting this to false excludes unvendored modules from the standard library. Default: <code class="docutils literal notranslate"><span class="pre">false</span></code></p></li>
<li><p><strong>options.stdLibURL</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The URL from which to load the standard library <code class="docutils literal notranslate"><span class="pre">python_stdlib.zip</span></code> file. This URL includes the most of the Python standard library. Some stdlib modules were unvendored, and can be loaded separately with <code class="docutils literal notranslate"><span class="pre">fullStdLib:</span> <span class="pre">true</span></code> option or by their package name. Default: <code class="docutils literal notranslate"><span class="pre">`${indexURL}/python_stdlib.zip`</span></code></p></li>
<li><p><strong>options.stdin</strong> (<span class="sphinx_js-type">() =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – Override the standard input callback. Should ask the user for one line of input. The <a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code></a> function is more flexible and should be preferred.</p></li>
<li><p><strong>options.stdout</strong> (<span class="sphinx_js-type">(msg: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – Override the standard output callback. The <a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code></a> function is more flexible and should be preferred in most cases, but depending on the <code class="docutils literal notranslate"><span class="pre">args</span></code> passed to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>, Pyodide may write to stdout on startup, which can only be controlled by passing a custom <code class="docutils literal notranslate"><span class="pre">stdout</span></code> function.</p></li>
<li><p><strong>options.stderr</strong> (<span class="sphinx_js-type">(msg: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – Override the standard error output callback. The <a class="reference internal" href="#pyodide.setStderr" title="pyodide.setStderr"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStderr()</span></code></a> function is more flexible and should be preferred in most cases, but depending on the <code class="docutils literal notranslate"><span class="pre">args</span></code> passed to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>, Pyodide may write to stdout on startup, which can only be controlled by passing a custom <code class="docutils literal notranslate"><span class="pre">stdout</span></code> function.</p></li>
<li><p><strong>options.jsglobals</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">object</span></code></a></span>) – The object that Pyodide will use for the <code class="docutils literal notranslate"><span class="pre">js</span></code> module. Default: <code class="docutils literal notranslate"><span class="pre">globalThis</span></code></p></li>
<li><p><strong>options.args</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>[]</span>) – Command line arguments to pass to Python on startup. See <a class="reference external" href="https://docs.python.org/3.10/using/cmdline.html#interface-options">Python command line interface options</a> for more details. Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p></li>
<li><p><strong>options.env</strong> (<span class="sphinx_js-type">{ [key: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>]: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>; }</span>) – Environment variables to pass to Python. This can be accessed inside of Python at runtime via <a class="reference external" href="https://docs.python.org/3.12/library/os.html#os.environ" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.environ</span></code></a>. Certain environment variables change the way that Python loads: <a class="reference external" href="https://docs.python.org/3.10/using/cmdline.html#environment-variables">https://docs.python.org/3.10/using/cmdline.html#environment-variables</a> Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code>. If <code class="docutils literal notranslate"><span class="pre">env.HOME</span></code> is undefined, it will be set to a default value of <code class="docutils literal notranslate"><span class="pre">&quot;/home/pyodide&quot;</span></code></p></li>
<li><p><strong>options.packages</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>[]</span>) – A list of packages to load as Pyodide is initializing. This is the same as loading the packages with <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> after Pyodide is loaded except using the <code class="docutils literal notranslate"><span class="pre">packages</span></code> option is more efficient because the packages are downloaded while Pyodide bootstraps itself.</p></li>
<li><p><strong>options.pyproxyToStringRepr</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Opt into the old behavior where <a class="reference internal" href="#pyodide.ffi.PyProxy.toString" title="pyodide.ffi.PyProxy.toString"><code class="xref js js-func docutils literal notranslate"><span class="pre">PyProxy.toString()</span></code></a> calls <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#repr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code></a> and not <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str()</span></code></a>.</p></li>
<li><p><strong>options.enableRunUntilComplete</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Make loop.run_until_complete() function correctly using stack switching</p></li>
<li><p><strong>options.checkAPIVersion</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true (default), throw an error if the version of Pyodide core does not match the version of the Pyodide js package.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;typeof <a class="reference internal" href="#js-api-pyodide"><span class="std std-ref">PyodideAPI</span></a>&gt;</span> – The <a class="reference internal" href="#js-api-pyodide"><span class="std std-ref">pyodide</span></a> module.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">({</span>
<span class="w">    </span><span class="nx">fullStdLib</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">stdout</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Pyodide: </span><span class="si">${</span><span class="nx">msg</span><span class="si">}</span><span class="sb">`</span><span class="p">),</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Loaded Pyodide&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<section id="pyodide">
<span id="js-api-pyodide"></span><h6>pyodide<a class="headerlink" href="#pyodide" title="Link to this heading">#</a></h6>
<div class="jssummarytable type_aliases docutils container">
<p><strong>Type Aliases:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.TypedArray" title="pyodide.TypedArray"><code class="xref any js js-typealias docutils literal notranslate"><span class="pre">TypedArray</span></code></a></p></td>
<td class="summary"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="jssummarytable interfaces docutils container">
<p><strong>Interfaces:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.PackageData" title="pyodide.PackageData"><code class="xref any js js-interface docutils literal notranslate"><span class="pre">PackageData</span></code></a></p></td>
<td class="summary"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="jssummarytable attributes docutils container">
<p><strong>Attributes:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ERRNO_CODES" title="pyodide.ERRNO_CODES"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">ERRNO_CODES</span></code></a></p></td>
<td class="summary"><p>A map from posix error names to error codes.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.FS" title="pyodide.FS"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">FS</span></code></a></p></td>
<td class="summary"><p>An alias to the <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html">Emscripten File System API</a>.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.PATH" title="pyodide.PATH"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">PATH</span></code></a></p></td>
<td class="summary"><p>An alias to the <a class="reference external" href="https://github.com/emscripten-core/emscripten/blob/main/src/library_path.js">Emscripten Path API</a>.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#js-api-pyodide-canvas"><span class="std std-ref">canvas</span></a></p></td>
<td class="summary"><p>APIs to set a canvas for rendering graphics.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#js-api-pyodide-ffi"><span class="std std-ref">ffi</span></a></p></td>
<td class="summary"><p>Foreign function interface classes.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.globals" title="pyodide.globals"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">globals</span></code></a></p></td>
<td class="summary"><p>An alias to the global Python namespace.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.loadedPackages" title="pyodide.loadedPackages"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">loadedPackages</span></code></a></p></td>
<td class="summary"><p>An object whose keys are the names of the loaded packages and whose values
are the install sources of the packages.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.pyodide_py" title="pyodide.pyodide_py"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">pyodide_py</span></code></a></p></td>
<td class="summary"><p>An alias to the Python <a class="reference internal" href="#python-api"><span class="std std-ref">pyodide</span></a> package.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.version" title="pyodide.version"><code class="xref any js js-attr docutils literal notranslate"><span class="pre">version</span></code></a></p></td>
<td class="summary"><p>The Pyodide version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="jssummarytable functions docutils container">
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.checkInterrupt" title="pyodide.checkInterrupt"><code class="xref any js js-func docutils literal notranslate"><span class="pre">checkInterrupt</span></code></a><strong>()</strong></p></td>
<td class="summary"><p>Throws a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> error if a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> has
been requested via the interrupt buffer.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><strong>async</strong> <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref any js js-func docutils literal notranslate"><span class="pre">loadPackage</span></code></a><strong>(names, options)</strong></p></td>
<td class="summary"><p>Load packages from the Pyodide distribution or Python wheels by URL.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><strong>async</strong> <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref any js js-func docutils literal notranslate"><span class="pre">loadPackagesFromImports</span></code></a><strong>(code, options)</strong></p></td>
<td class="summary"><p>Inspect a Python code chunk and use <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> to install
any known packages that the code chunk imports.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.makeMemorySnapshot" title="pyodide.makeMemorySnapshot"><code class="xref any js js-func docutils literal notranslate"><span class="pre">makeMemorySnapshot</span></code></a><strong>(param0={})</strong></p></td>
<td class="summary"><p></p></td>
</tr>
<tr class="row-odd"><td class="name"><p><strong>async</strong> <a class="reference internal" href="#pyodide.mountNativeFS" title="pyodide.mountNativeFS"><code class="xref any js js-func docutils literal notranslate"><span class="pre">mountNativeFS</span></code></a><strong>(path, fileSystemHandle)</strong></p></td>
<td class="summary"><p>Mounts a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a> into the target directory.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.mountNodeFS" title="pyodide.mountNodeFS"><code class="xref any js js-func docutils literal notranslate"><span class="pre">mountNodeFS</span></code></a><strong>(emscriptenPath, hostPath)</strong></p></td>
<td class="summary"><p>Mounts a host directory into Pyodide file system.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.pyimport" title="pyodide.pyimport"><code class="xref any js js-func docutils literal notranslate"><span class="pre">pyimport</span></code></a><strong>(mod_name)</strong></p></td>
<td class="summary"><p>Imports a module and returns it.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.registerComlink" title="pyodide.registerComlink"><code class="xref any js js-func docutils literal notranslate"><span class="pre">registerComlink</span></code></a><strong>(Comlink)</strong></p></td>
<td class="summary"><p>Tell Pyodide about Comlink.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref any js js-func docutils literal notranslate"><span class="pre">registerJsModule</span></code></a><strong>(name, module)</strong></p></td>
<td class="summary"><p>Registers the JavaScript object <code class="docutils literal notranslate"><span class="pre">module</span></code> as a JavaScript module named
<code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref any js js-func docutils literal notranslate"><span class="pre">runPython</span></code></a><strong>(code, options)</strong></p></td>
<td class="summary"><p>Runs a string of Python code from JavaScript, using <a class="reference internal" href="#pyodide.code.eval_code" title="pyodide.code.eval_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code()</span></code></a>
to evaluate the code.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><strong>async</strong> <a class="reference internal" href="#pyodide.runPythonAsync" title="pyodide.runPythonAsync"><code class="xref any js js-func docutils literal notranslate"><span class="pre">runPythonAsync</span></code></a><strong>(code, options)</strong></p></td>
<td class="summary"><p>Run a Python code string with top level await using
<a class="reference internal" href="#pyodide.code.eval_code_async" title="pyodide.code.eval_code_async"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code_async()</span></code></a> to evaluate the code.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.scheduleCallback" title="pyodide.scheduleCallback"><code class="xref any js js-func docutils literal notranslate"><span class="pre">scheduleCallback</span></code></a><strong>(callback, timeout=0)</strong></p></td>
<td class="summary"><p>Schedule a callback.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.setDebug" title="pyodide.setDebug"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setDebug</span></code></a><strong>(debug)</strong></p></td>
<td class="summary"><p>Turn on or off debug mode.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.setInterruptBuffer" title="pyodide.setInterruptBuffer"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setInterruptBuffer</span></code></a><strong>(interrupt_buffer)</strong></p></td>
<td class="summary"><p>Sets the interrupt buffer to be <code class="docutils literal notranslate"><span class="pre">interrupt_buffer</span></code>.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.setStderr" title="pyodide.setStderr"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setStderr</span></code></a><strong>(options)</strong></p></td>
<td class="summary"><p>Sets the standard error handler.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setStdin</span></code></a><strong>(options)</strong></p></td>
<td class="summary"><p>Set a stdin handler.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setStdout</span></code></a><strong>(options)</strong></p></td>
<td class="summary"><p>Sets the standard out handler.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.toPy" title="pyodide.toPy"><code class="xref any js js-func docutils literal notranslate"><span class="pre">toPy</span></code></a><strong>(obj, options)</strong></p></td>
<td class="summary"><p>Convert a JavaScript object to a Python object as best as possible.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.unpackArchive" title="pyodide.unpackArchive"><code class="xref any js js-func docutils literal notranslate"><span class="pre">unpackArchive</span></code></a><strong>(buffer, format, options)</strong></p></td>
<td class="summary"><p>Unpack an archive into a target directory.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.unregisterJsModule" title="pyodide.unregisterJsModule"><code class="xref any js js-func docutils literal notranslate"><span class="pre">unregisterJsModule</span></code></a><strong>(name)</strong></p></td>
<td class="summary"><p>Unregisters a JavaScript module with given name that has been previously
registered with <a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a> or
<a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_js_module()</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<dl class="js typealias" id="module-pyodide">
<dt class="sig sig-object js" id="pyodide.TypedArray">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">TypedArray</span></span></span><a class="headerlink" href="#pyodide.TypedArray" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Int8Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Int16Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint16Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Int32Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint32Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8ClampedArray</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Float32Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Float64Array</span></code></a></span></p>
</dd></dl>

<dl class="js interface">
<dt class="sig sig-object js" id="pyodide.PackageData">
<em class="property"><span class="k"><span class="pre">interface</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PackageData</span></span></span><a class="headerlink" href="#pyodide.PackageData" title="Link to this definition">#</a></dt>
<dd><dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.PackageData.fileName">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PackageData</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">fileName</span></span></span><a class="headerlink" href="#pyodide.PackageData.fileName" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.PackageData.name">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PackageData</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">name</span></span></span><a class="headerlink" href="#pyodide.PackageData.name" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.PackageData.packageType">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PackageData</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">packageType</span></span></span><a class="headerlink" href="#pyodide.PackageData.packageType" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type">“package” | “cpython_module” | “shared_library” | “static_library”</span></p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.PackageData.version">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PackageData</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">version</span></span></span><a class="headerlink" href="#pyodide.PackageData.version" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
</dd></dl>

</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ERRNO_CODES">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">ERRNO_CODES</span></span></span><a class="headerlink" href="#pyodide.ERRNO_CODES" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type">{ [code: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>]: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>; }</span></p>
<p>A map from posix error names to error codes.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.FS">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">FS</span></span></span><a class="headerlink" href="#pyodide.FS" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type">FS</span></p>
<p>An alias to the <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html">Emscripten File System API</a>.</p>
<p>This provides a wide range of POSIX-<cite>like</cite> file/device operations, including
<a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#FS.mount">mount</a>
which can be used to extend the in-memory filesystem with features like <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#persistent-data">persistence</a>.</p>
<p>While all the file systems implementations are enabled, only the default
<code class="docutils literal notranslate"><span class="pre">MEMFS</span></code> is guaranteed to work in all runtime settings. The implementations
are available as members of <code class="docutils literal notranslate"><span class="pre">FS.filesystems</span></code>:
<code class="docutils literal notranslate"><span class="pre">IDBFS</span></code>, <code class="docutils literal notranslate"><span class="pre">NODEFS</span></code>, <code class="docutils literal notranslate"><span class="pre">PROXYFS</span></code>, <code class="docutils literal notranslate"><span class="pre">WORKERFS</span></code>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.PATH">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PATH</span></span></span><a class="headerlink" href="#pyodide.PATH" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
<p>An alias to the <a class="reference external" href="https://github.com/emscripten-core/emscripten/blob/main/src/library_path.js">Emscripten Path API</a>.</p>
<p>This provides a variety of operations for working with file system paths, such as
<code class="docutils literal notranslate"><span class="pre">dirname</span></code>, <code class="docutils literal notranslate"><span class="pre">normalize</span></code>, and <code class="docutils literal notranslate"><span class="pre">splitPath</span></code>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.globals">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">globals</span></span></span><a class="headerlink" href="#pyodide.globals" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
<p>An alias to the global Python namespace.</p>
<p>For example, to access a variable called <code class="docutils literal notranslate"><span class="pre">foo</span></code> in the Python global
scope, use <code class="docutils literal notranslate"><span class="pre">pyodide.globals.get(&quot;foo&quot;)</span></code></p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.loadedPackages">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">loadedPackages</span></span></span><a class="headerlink" href="#pyodide.loadedPackages" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/utility-types.html#recordkeys-type" title="(in typescript docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Record</span></code></a>&lt;<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>&gt;</span></p>
<p>An object whose keys are the names of the loaded packages and whose values
are the install sources of the packages. Use
<cite>Object.keys(pyodide.loadedPackages)</cite> to get the list of names of loaded
packages, and <code class="docutils literal notranslate"><span class="pre">pyodide.loadedPackages[package_name]</span></code> to access the install
source for a particular <code class="docutils literal notranslate"><span class="pre">package_name</span></code>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.pyodide_py">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">pyodide_py</span></span></span><a class="headerlink" href="#pyodide.pyodide_py" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
<p>An alias to the Python <a class="reference internal" href="#python-api"><span class="std std-ref">pyodide</span></a> package.</p>
<p>You can use this to call functions defined in the Pyodide Python package
from JavaScript.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.version">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">version</span></span></span><a class="headerlink" href="#pyodide.version" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
<p>The Pyodide version.</p>
<p>The version here is a Python version, following <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0440/"><strong>PEP 440</strong></a>. This is different
from the version in <code class="docutils literal notranslate"><span class="pre">package.json</span></code> which follows the node package manager
version convention.</p>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.checkInterrupt">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">checkInterrupt</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.checkInterrupt" title="Link to this definition">#</a></dt>
<dd><p>Throws a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> error if a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> has
been requested via the interrupt buffer.</p>
<p>This can be used to enable keyboard interrupts during execution of JavaScript
code, just as <a class="reference external" href="https://docs.python.org/3.12/c-api/exceptions.html#c.PyErr_CheckSignals" title="(in Python v3.12)"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_CheckSignals()</span></code></a> is used to enable keyboard interrupts
during execution of C code.</p>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.loadPackage">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">loadPackage</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.loadPackage" title="Link to this definition">#</a></dt>
<dd><p>Load packages from the Pyodide distribution or Python wheels by URL.</p>
<p>This installs packages in the virtual filesystem. Packages
needs to be imported from Python before it can be used.</p>
<p>This function can only install packages included in the Pyodide distribution,
or Python wheels by URL, without dependency resolution. It is significantly
more limited in terms of functionality as compared to <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#module-micropip" title="(in micropip v0.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropip</span></code></a>,
however it has less overhead and can be faster.</p>
<p>When installing binary wheels by URLs it is user’s responsibility to check
that the installed binary wheel is compatible in terms of Python and
Emscripten versions. Compatibility is not checked during installation time
(unlike with micropip). If a wheel for the wrong Python/Emscripten version
is installed it would fail at import time.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>[] | <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span>) – Either a single package name or URL or a list of them. URLs can be absolute or relative. The URLs must correspond to Python wheels: either pure Python wheels, with a file name ending with <code class="docutils literal notranslate"><span class="pre">none-any.whl</span></code> or Emscripten/WASM 32 wheels, with a file name ending with <code class="docutils literal notranslate"><span class="pre">cp&lt;pyversion&gt;_emscripten_&lt;em_version&gt;_wasm32.whl</span></code>. The argument can be a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> of a list, in which case the list will be converted to JavaScript and the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> will be destroyed.</p></li>
<li><p><strong>options.messageCallback</strong> (<span class="sphinx_js-type">(message: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A callback, called with progress messages (optional)</p></li>
<li><p><strong>options.errorCallback</strong> (<span class="sphinx_js-type">(message: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A callback, called with error/warning messages (optional)</p></li>
<li><p><strong>options.checkIntegrity</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, check the integrity of the downloaded packages (default: true)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference internal" href="#pyodide.PackageData" title="pyodide.PackageData"><code class="xref js js-class docutils literal notranslate"><span class="pre">PackageData</span></code></a>[]&gt;</span> – The loaded package data.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.loadPackagesFromImports">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">loadPackagesFromImports</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.loadPackagesFromImports" title="Link to this definition">#</a></dt>
<dd><p>Inspect a Python code chunk and use <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> to install
any known packages that the code chunk imports. Uses the Python API
<a class="reference internal" href="#pyodide.code.find_imports" title="pyodide.code.find_imports"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.code.find_imports()</span></code></a> to inspect the code.</p>
<p>For example, given the following code as input</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p><a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackagesFromImports()</span></code></a> will call
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage(['numpy'])</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The code to inspect.</p></li>
<li><p><strong>options.messageCallback</strong> (<span class="sphinx_js-type">(message: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A callback, called with progress messages (optional)</p></li>
<li><p><strong>options.errorCallback</strong> (<span class="sphinx_js-type">(message: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A callback, called with error/warning messages (optional)</p></li>
<li><p><strong>options.checkIntegrity</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, check the integrity of the downloaded packages (default: true)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference internal" href="#pyodide.PackageData" title="pyodide.PackageData"><code class="xref js js-class docutils literal notranslate"><span class="pre">PackageData</span></code></a>[]&gt;</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.makeMemorySnapshot">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">makeMemorySnapshot</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param0={}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.makeMemorySnapshot" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param0</strong> (<span class="sphinx_js-type">{ serializer?: (obj: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>; }</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.mountNativeFS">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">mountNativeFS</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileSystemHandle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.mountNativeFS" title="Link to this definition">#</a></dt>
<dd><p>Mounts a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a> into the target directory.
Currently it’s only possible to acquire a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a> in Chrome.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The absolute path in the Emscripten file system to mount the native directory. If the directory does not exist, it will be created. If it does exist, it must be empty.</p></li>
<li><p><strong>fileSystemHandle</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a></span>) – A handle returned by <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/getDirectory" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">navigator.storage.getDirectory()</span></code></a> or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/showDirectoryPicker" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">window.showDirectoryPicker()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;{ syncfs: () =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a>&gt;; }&gt;</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.mountNodeFS">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">mountNodeFS</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emscriptenPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostPath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.mountNodeFS" title="Link to this definition">#</a></dt>
<dd><p>Mounts a host directory into Pyodide file system. Only works in node.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emscriptenPath</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The absolute path in the Emscripten file system to mount the native directory. If the directory does not exist, it will be created. If it does exist, it must be empty.</p></li>
<li><p><strong>hostPath</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The host path to mount. It must be a directory that exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.pyimport">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">pyimport</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.pyimport" title="Link to this definition">#</a></dt>
<dd><p>Imports a module and returns it.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">name</span></code> has no dot in it, then <code class="docutils literal notranslate"><span class="pre">pyimport(name)</span></code> is approximately
equivalent to:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="sb">`import </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">; </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</pre></div>
</div>
<p>except that <code class="docutils literal notranslate"><span class="pre">name</span></code> is not introduced into the Python global namespace. If
the name has one or more dots in it, say it is of the form <code class="docutils literal notranslate"><span class="pre">path.name</span></code>
where <code class="docutils literal notranslate"><span class="pre">name</span></code> has no dots but path may have zero or more dots. Then it is
approximately the same as:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="sb">`from </span><span class="si">${</span><span class="nx">path</span><span class="si">}</span><span class="sb"> import </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">; </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod_name</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The name of the module to import</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;math.comb&quot;</span><span class="p">)(</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="c1">// returns 4 choose 2 = 6</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.registerComlink">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">registerComlink</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Comlink</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.registerComlink" title="Link to this definition">#</a></dt>
<dd><p>Tell Pyodide about Comlink.
Necessary to enable importing Comlink proxies into Python.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Comlink</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.registerJsModule">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">registerJsModule</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.registerJsModule" title="Link to this definition">#</a></dt>
<dd><p>Registers the JavaScript object <code class="docutils literal notranslate"><span class="pre">module</span></code> as a JavaScript module named
<code class="docutils literal notranslate"><span class="pre">name</span></code>. This module can then be imported from Python using the standard
Python import system. If another module by the same name has already been
imported, this won’t have much effect unless you also delete the imported
module from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.modules" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>. This calls
<a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_js_module()</span></code></a>.</p>
<p>Any attributes of the JavaScript objects which are themselves objects will
be treated as submodules:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">registerJsModule</span><span class="p">(</span><span class="s2">&quot;mymodule&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">submodule</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mymodule.submodule</span><span class="w"> </span><span class="kn">import</span> <span class="n">value</span>
    <span class="k">assert</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">7</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>If you wish to prevent this, try the following instead:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">sys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyimport</span><span class="p">(</span><span class="s2">&quot;sys&quot;</span><span class="p">);</span>
<span class="nx">sys</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;mymodule&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">obj</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mymodule</span><span class="w"> </span><span class="kn">import</span> <span class="n">obj</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">7</span>
    <span class="c1"># attempting to treat obj as a submodule raises ModuleNotFoundError:</span>
    <span class="c1"># &quot;No module named &#39;mymodule.obj&#39;; &#39;mymodule&#39; is not a package&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mymodule.obj</span><span class="w"> </span><span class="kn">import</span> <span class="n">value</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – Name of the JavaScript module to add</p></li>
<li><p><strong>module</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">object</span></code></a></span>) – JavaScript object backing the module</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.runPython">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">runPython</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.runPython" title="Link to this definition">#</a></dt>
<dd><p>Runs a string of Python code from JavaScript, using <a class="reference internal" href="#pyodide.code.eval_code" title="pyodide.code.eval_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code()</span></code></a>
to evaluate the code. If the last statement in the Python code is an
expression (and the code doesn’t end with a semicolon), the value of the
expression is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The Python code to run</p></li>
<li><p><strong>options.globals</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span>) – An optional Python dictionary to use as the globals. Defaults to <a class="reference internal" href="#pyodide.globals" title="pyodide.globals"><code class="xref js js-attr docutils literal notranslate"><span class="pre">pyodide.globals</span></code></a>.</p></li>
<li><p><strong>options.locals</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span>) – An optional Python dictionary to use as the locals. Defaults to the same as <code class="docutils literal notranslate"><span class="pre">globals</span></code>.</p></li>
<li><p><strong>options.filename</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – An optional string to use as the file name. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&lt;exec&gt;&quot;</span></code>. If a custom file name is given, the traceback for any exception that is thrown will show source lines (unless the given file name starts with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and ends with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The result of the Python code translated to JavaScript. See the documentation for <a class="reference internal" href="#pyodide.code.eval_code" title="pyodide.code.eval_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code()</span></code></a> for more info.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(){</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;1 + 2&quot;</span><span class="p">));</span>
<span class="w">  </span><span class="c1">// 3</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">globals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">toPy</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="w"> </span><span class="p">}));</span>
<span class="w">  </span><span class="c1">// 4</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">locals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">toPy</span><span class="p">({</span><span class="w"> </span><span class="nx">arr</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;sum(arr)&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">locals</span><span class="w"> </span><span class="p">}));</span>
<span class="w">  </span><span class="c1">// 6</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.runPythonAsync">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">runPythonAsync</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.runPythonAsync" title="Link to this definition">#</a></dt>
<dd><p>Run a Python code string with top level await using
<a class="reference internal" href="#pyodide.code.eval_code_async" title="pyodide.code.eval_code_async"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code_async()</span></code></a> to evaluate the code. Returns a promise which
resolves when execution completes. If the last statement in the Python code
is an expression (and the code doesn’t end with a semicolon), the returned
promise will resolve to the value of this expression.</p>
<p>For example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPythonAsync</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;./pyodide-lock.json&quot;</span><span class="p">)</span>
    <span class="n">packages</span> <span class="o">=</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1"># If final statement is an expression, its value is returned to JavaScript</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">packages</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">object_keys</span><span class="p">())</span>
<span class="s">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span><span class="w"> </span><span class="c1">// 79</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Python imports</p>
<p>Since pyodide 0.18.0, you must call <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPackagesFromImports()</span></code></a> to
import any python packages referenced via <code class="docutils literal notranslate"><span class="pre">import</span></code> statements in your
code. This function will no longer do it for you.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The Python code to run</p></li>
<li><p><strong>options.globals</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span>) – An optional Python dictionary to use as the globals. Defaults to <a class="reference internal" href="#pyodide.globals" title="pyodide.globals"><code class="xref js js-attr docutils literal notranslate"><span class="pre">pyodide.globals</span></code></a>.</p></li>
<li><p><strong>options.locals</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span>) – An optional Python dictionary to use as the locals. Defaults to the same as <code class="docutils literal notranslate"><span class="pre">globals</span></code>.</p></li>
<li><p><strong>options.filename</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – An optional string to use as the file name. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&lt;exec&gt;&quot;</span></code>. If a custom file name is given, the traceback for any exception that is thrown will show source lines (unless the given file name starts with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and ends with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – The result of the Python code translated to JavaScript.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.scheduleCallback">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">scheduleCallback</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout=0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.scheduleCallback" title="Link to this definition">#</a></dt>
<dd><p>Schedule a callback. Supports both immediate and delayed callbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> (<span class="sphinx_js-type">() =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – The callback to be scheduled</p></li>
<li><p><strong>timeout</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – The delay in milliseconds before the callback is called</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.setDebug">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setDebug</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.setDebug" title="Link to this definition">#</a></dt>
<dd><p>Turn on or off debug mode. In debug mode, some error messages are improved
at a performance cost.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>debug</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, turn debug mode on. If false, turn debug mode off.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span> – The old value of the debug flag.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.setInterruptBuffer">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setInterruptBuffer</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interrupt_buffer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.setInterruptBuffer" title="Link to this definition">#</a></dt>
<dd><p>Sets the interrupt buffer to be <code class="docutils literal notranslate"><span class="pre">interrupt_buffer</span></code>. This is only useful
when Pyodide is used in a webworker. The buffer should be a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">SharedArrayBuffer</span></code></a> shared with the main browser thread (or another
worker). In that case, signal <code class="docutils literal notranslate"><span class="pre">signum</span></code> may be sent by writing <code class="docutils literal notranslate"><span class="pre">signum</span></code>
into the interrupt buffer. If <code class="docutils literal notranslate"><span class="pre">signum</span></code> does not satisfy 0 &lt; <code class="docutils literal notranslate"><span class="pre">signum</span></code> &lt; 65
it will be silently ignored.</p>
<p>You can disable interrupts by calling <code class="docutils literal notranslate"><span class="pre">setInterruptBuffer(undefined)</span></code>.</p>
<p>If you wish to trigger a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a>, write <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> (a 2)
into the interrupt buffer.</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyboardInterrupt" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code></a> and all other signals
are ignored. You can install custom signal handlers with the signal module.
Even signals that normally have special meaning and can’t be overridden like
<code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGSEGV</span></code> are ignored by default and can be used for any
purpose you like.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interrupt_buffer</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.TypedArray" title="pyodide.TypedArray"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.setStderr">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setStderr</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.setStderr" title="Link to this definition">#</a></dt>
<dd><p>Sets the standard error handler. See the documentation for
<a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.batched</strong> (<span class="sphinx_js-type">(output: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>)</p></li>
<li><p><strong>options.raw</strong> (<span class="sphinx_js-type">(charCode: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>)</p></li>
<li><p><strong>options.write</strong> (<span class="sphinx_js-type">(buffer: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a>) =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>)</p></li>
<li><p><strong>options.isatty</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.setStdin">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setStdin</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.setStdin" title="Link to this definition">#</a></dt>
<dd><p>Set a stdin handler. See <a class="reference internal" href="#streams-stdin"><span class="std std-ref">redirecting standard streams</span></a>
for a more detailed explanation. There are two different possible interfaces
to implement a handler. It’s also possible to select either the default
handler or an error handler that always returns an IO error.</p>
<ol class="arabic simple">
<li><p>passing a <code class="docutils literal notranslate"><span class="pre">read</span></code> function (see below),</p></li>
<li><p>passing a <code class="docutils literal notranslate"><span class="pre">stdin</span></code> function (see below),</p></li>
<li><p>passing <code class="docutils literal notranslate"><span class="pre">error:</span> <span class="pre">true</span></code> indicates that attempting to read from stdin
should always raise an IO error.</p></li>
<li><p>passing none of these sets the default behavior. In node, the default is
to read from stdin. In the browser, the default is to raise an error.</p></li>
</ol>
<p>The functions on the <code class="docutils literal notranslate"><span class="pre">options</span></code> argument will be called with <code class="docutils literal notranslate"><span class="pre">options</span></code>
bound to <code class="docutils literal notranslate"><span class="pre">this</span></code> so passing an instance of a class as the <code class="docutils literal notranslate"><span class="pre">options</span></code> object
works as expected.</p>
<p>The interfaces that the handlers implement are as follows:</p>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">read</span></code> function is called with a <code class="docutils literal notranslate"><span class="pre">Uint8Array</span></code> argument. The
function should place the utf8-encoded input into this buffer and return
the number of bytes written. For instance, if the buffer was completely
filled with input, then return <code class="docutils literal notranslate"><span class="pre">buffer.length</span></code>. If a <code class="docutils literal notranslate"><span class="pre">read</span></code> function is
passed you may optionally also pass an <code class="docutils literal notranslate"><span class="pre">fsync</span></code> function which is called
when stdin is flushed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">stdin</span></code> function is called with zero arguments. It should return one
of:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a>: these are interpreted as end of
file.</p></li>
<li><p>a number</p></li>
<li><p>a string</p></li>
<li><p>an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a> or <a class="reference internal" href="#pyodide.TypedArray" title="pyodide.TypedArray"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a> with
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/BYTES_PER_ELEMENT" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">BYTES_PER_ELEMENT</span></code></a> equal to 1. The buffer should
contain utf8 encoded text.</p></li>
</ul>
<p>If a number is returned, it is interpreted as a single character code. The
number should be between 0 and 255.</p>
<p>If a string is returned, it is encoded into a buffer using
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TextEncoder" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TextEncoder</span></code></a>. By default, an EOF is appended after each string
or buffer returned. If this behavior is not desired, pass <code class="docutils literal notranslate"><span class="pre">autoEOF:</span> <span class="pre">false</span></code>.</p>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.stdin</strong> (<span class="sphinx_js-type">() =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – A stdin handler</p></li>
<li><p><strong>options.read</strong> (<span class="sphinx_js-type">(buffer: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a>) =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – A read handler</p></li>
<li><p><strong>options.error</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If this is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, attempts to read from stdin will always set an IO error.</p></li>
<li><p><strong>options.isatty</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Should <a class="reference external" href="https://docs.python.org/3.12/library/os.html#os.isatty" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">isatty(stdin)</span></code></a> be <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code> (default <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p></li>
<li><p><strong>options.autoEOF</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Insert an EOF automatically after each string or buffer? (default <code class="docutils literal notranslate"><span class="pre">true</span></code>). This option can only be used with the stdin handler.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.setStdout">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setStdout</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.setStdout" title="Link to this definition">#</a></dt>
<dd><p>Sets the standard out handler. A batched handler, a raw handler, or a write
function can be provided. If no handler is provided, we restore the default
handler.</p>
<p>The functions on the <code class="docutils literal notranslate"><span class="pre">options</span></code> argument will be called with <code class="docutils literal notranslate"><span class="pre">options</span></code>
bound to <code class="docutils literal notranslate"><span class="pre">this</span></code> so passing an instance of a class as the <code class="docutils literal notranslate"><span class="pre">options</span></code> object
works as expected.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.batched</strong> (<span class="sphinx_js-type">(output: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A batched handler is called with a string whenever a newline character is written or stdout is flushed. In the former case, the received line will end with a newline, in the latter case it will not.</p></li>
<li><p><strong>options.raw</strong> (<span class="sphinx_js-type">(charCode: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A raw handler is called with the handler is called with a <cite>number</cite> for each byte of the output to stdout.</p></li>
<li><p><strong>options.write</strong> (<span class="sphinx_js-type">(buffer: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a>) =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – A write handler is called with a buffer that contains the utf8 encoded binary data</p></li>
<li><p><strong>options.isatty</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – Should <a class="reference external" href="https://docs.python.org/3.12/library/os.html#os.isatty" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">isatty(stdout)</span></code></a> return <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>. Must be <code class="docutils literal notranslate"><span class="pre">false</span></code> if a batched handler is used. (default <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(){</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdout</span><span class="p">({</span><span class="w"> </span><span class="nx">batched</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;print(&#39;ABC&#39;)&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// &#39;ABC&#39;</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">setStdout</span><span class="p">({</span><span class="w"> </span><span class="nx">raw</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kr">byte</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kr">byte</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;print(&#39;ABC&#39;)&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// 65</span>
<span class="w">  </span><span class="c1">// 66</span>
<span class="w">  </span><span class="c1">// 67</span>
<span class="w">  </span><span class="c1">// 10 (the ascii values for &#39;ABC&#39; including a new line character)</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.toPy">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">toPy</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.toPy" title="Link to this definition">#</a></dt>
<dd><p>Convert a JavaScript object to a Python object as best as possible.</p>
<p>This is similar to <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a> but for use from
JavaScript. If the object is immutable or a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>,
it will be returned unchanged. If the object cannot be converted into Python,
it will be returned unchanged.</p>
<p>See <a class="reference internal" href="#type-translations-jsproxy-to-py"><span class="std std-ref">JavaScript to Python</span></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The object to convert.</p></li>
<li><p><strong>options.depth</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Optional argument to limit the depth of the conversion.</p></li>
<li><p><strong>options.defaultConverter</strong> (<span class="sphinx_js-type">(value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, converter: (value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, cacheConversion: (input: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, output: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Optional argument to convert objects with no default conversion. See the documentation of <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The object converted to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.unpackArchive">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">unpackArchive</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.unpackArchive" title="Link to this definition">#</a></dt>
<dd><p>Unpack an archive into a target directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buffer</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a> | <a class="reference internal" href="#pyodide.TypedArray" title="pyodide.TypedArray"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></span>) – The archive as an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a> or <a class="reference internal" href="#pyodide.TypedArray" title="pyodide.TypedArray"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a>.</p></li>
<li><p><strong>format</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The format of the archive. Should be one of the formats recognized by <a class="reference external" href="https://docs.python.org/3.12/library/shutil.html#shutil.unpack_archive" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.unpack_archive()</span></code></a>. By default the options are <code class="docutils literal notranslate"><span class="pre">'bztar'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gztar'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'wheel'</span></code>. Several synonyms are accepted for each format, e.g., for <code class="docutils literal notranslate"><span class="pre">'gztar'</span></code> any of <code class="docutils literal notranslate"><span class="pre">'.gztar'</span></code>, <code class="docutils literal notranslate"><span class="pre">'.tar.gz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'.tgz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar.gz'</span></code> or <code class="docutils literal notranslate"><span class="pre">'tgz'</span></code> are considered to be synonyms.</p></li>
<li><p><strong>options.extractDir</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The directory to unpack the archive into. Defaults to the working directory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.unregisterJsModule">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">unregisterJsModule</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.unregisterJsModule" title="Link to this definition">#</a></dt>
<dd><p>Unregisters a JavaScript module with given name that has been previously
registered with <a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a> or
<a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_js_module()</span></code></a>. If a JavaScript module with that
name does not already exist, will throw an error. Note that if the module has
already been imported, this won’t have much effect unless you also delete the
imported module from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.modules" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>. This calls
<a class="reference internal" href="#pyodide.ffi.unregister_js_module" title="pyodide.ffi.unregister_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">unregister_js_module()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – Name of the JavaScript module to remove</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="pyodide-ffi">
<span id="js-api-pyodide-ffi"></span><h6>pyodide.ffi<a class="headerlink" href="#pyodide-ffi" title="Link to this heading">#</a></h6>
<p>Foreign function interface classes. Can be used for typescript type annotations
or at runtime for <code class="docutils literal notranslate"><span class="pre">instanceof</span></code> checks.</p>
<p>To import types from <code class="docutils literal notranslate"><span class="pre">pyodide.ffi</span></code> you can use for example</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">PyProxy</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;pyodide/ffi&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>If you want to do an instance check, you’ll need to access the type via the
Pyodide API returned from <a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">pyodide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">loadPyodide</span><span class="p">();</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">runPython</span><span class="p">(</span><span class="s2">&quot;... code here&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">ffi</span><span class="p">.</span><span class="nx">PyProxy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="jssummarytable classes docutils container">
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyAsyncGenerator" title="pyodide.ffi.PyAsyncGenerator"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyAsyncGenerator</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-generator" title="(in Python v3.12)"><span class="xref std std-term">asynchronous generator</span></a> (i.e., it is an instance of
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.AsyncGenerator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyAsyncIterable" title="pyodide.ffi.PyAsyncIterable"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyAsyncIterable</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-iterable" title="(in Python v3.12)"><span class="xref std std-term">asynchronous
iterable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__aiter__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__aiter__()</span></code></a> method).</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyAsyncIterator" title="pyodide.ffi.PyAsyncIterator"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyAsyncIterator</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-iterator" title="(in Python v3.12)"><span class="xref std std-term">asynchronous iterator</span></a></p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyAwaitable" title="pyodide.ffi.PyAwaitable"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyAwaitable</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-task.html#asyncio-awaitables" title="(in Python v3.12)"><span class="xref std std-ref">awaitable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__await__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__await__()</span></code></a> method).</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyBuffer" title="pyodide.ffi.PyBuffer"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyBuffer</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object supports the
Python <a class="reference external" href="https://docs.python.org/3.12/c-api/buffer.html" title="(in Python v3.12)"><span>Buffer Protocol</span></a>.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyBufferView" title="pyodide.ffi.PyBufferView"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyBufferView</span></code></a></p></td>
<td class="summary"><p>A class to allow access to Python data buffers from JavaScript.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyCallable" title="pyodide.ffi.PyCallable"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyCallable</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-callable" title="(in Python v3.12)"><span class="xref std std-term">callable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__call__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> method).</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyDict" title="pyodide.ffi.PyDict"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyDict</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyGenerator" title="pyodide.ffi.PyGenerator"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyGenerator</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is a <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-generator" title="(in Python v3.12)"><span class="xref std std-term">generator</span></a>
(i.e., it is an instance of <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyIterable" title="pyodide.ffi.PyIterable"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyIterable</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-iterable" title="(in Python v3.12)"><span class="xref std std-term">iterable</span></a>
(i.e., it has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__iter__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a> method).</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyIterator" title="pyodide.ffi.PyIterator"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyIterator</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-iterator" title="(in Python v3.12)"><span class="xref std std-term">iterator</span></a>
(i.e., has a <a class="reference external" href="https://docs.python.org/3.12/reference/expressions.html#generator.send" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send()</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#iterator.__next__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__next__()</span></code></a> method).</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.MutableSequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></a> (i.e., a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> is an object that allows idiomatic use of a Python object from
JavaScript.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyProxyWithGet" title="pyodide.ffi.PyProxyWithGet"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyProxyWithGet</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> method.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyProxyWithHas" title="pyodide.ffi.PyProxyWithHas"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyProxyWithHas</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__contains__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__contains__()</span></code></a> method.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyProxyWithLength" title="pyodide.ffi.PyProxyWithLength"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyProxyWithLength</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__len__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a>
method.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PyProxyWithSet" title="pyodide.ffi.PyProxyWithSet"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PyProxyWithSet</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__setitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__delitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a> method.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PySequence" title="pyodide.ffi.PySequence"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PySequence</span></code></a></p></td>
<td class="summary"><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> (i.e., a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.ffi.PythonError" title="pyodide.ffi.PythonError"><code class="xref any js js-class docutils literal notranslate"><span class="pre">PythonError</span></code></a></p></td>
<td class="summary"><p>A JavaScript error caused by a Python exception.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<dl class="js class" id="module-pyodide.ffi">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncGenerator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyAsyncGenerator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncGenerator" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-generator" title="(in Python v3.12)"><span class="xref std std-term">asynchronous generator</span></a> (i.e., it is an instance of
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.AsyncGenerator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a>)</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncGenerator.return">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAsyncGenerator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">return</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncGenerator.return" title="Link to this definition">#</a></dt>
<dd><p>Throws a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> into the generator and if the
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> is not caught returns the argument value <code class="docutils literal notranslate"><span class="pre">{done:</span>
<span class="pre">true,</span> <span class="pre">value:</span> <span class="pre">v}</span></code>. If the generator catches the <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> and
returns or yields another value the next value of the generator this is
returned in the normal way. If it throws some error other than
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopAsyncIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopAsyncIteration</span></code></a>, that error is
propagated. See the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator/throw" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">AsyncGenerator.throw()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to return from the generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the generator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the generator raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopAsyncIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopAsyncIteration</span></code></a> exception, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">result_value}</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncGenerator.throw">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAsyncGenerator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">throw</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncGenerator.throw" title="Link to this definition">#</a></dt>
<dd><p>Throws an exception into the Generator.</p>
<p>See the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator/throw" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">AsyncGenerator.throw()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exc</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Error The error to throw into the generator. Must be an instanceof <code class="docutils literal notranslate"><span class="pre">Error</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the generator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the generator raises a <code class="docutils literal notranslate"><span class="pre">StopIteration(result_value)</span></code> exception, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">result_value}</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncIterable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyAsyncIterable</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncIterable" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-iterable" title="(in Python v3.12)"><span class="xref std std-term">asynchronous
iterable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__aiter__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__aiter__()</span></code></a> method).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncIterable.-Symbol.asyncIterator">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyAsyncIterable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">[Symbol․asyncIterator]</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncIterable.-Symbol.asyncIterator" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">aiter(obj)</span></code>. Return an async iterator
associated to the proxy. See the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/asyncIterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.asyncIterator</span></code></a>.</p>
<p>This will be used implicitly by <code class="docutils literal notranslate"><span class="pre">for(await</span> <span class="pre">let</span> <span class="pre">x</span> <span class="pre">of</span> <span class="pre">proxy){}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_async_iterator_and_async_iterable_protocols" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">AsyncIterator</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncIterator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyAsyncIterator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncIterator" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-asynchronous-iterator" title="(in Python v3.12)"><span class="xref std std-term">asynchronous iterator</span></a></p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAsyncIterator.next">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAsyncIterator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">next</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg=undefined</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAsyncIterator.next" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">anext(obj)</span></code>. Returns the next value
of the asynchronous iterator. The argument will be sent to the Python
iterator (if it’s a generator for instance).</p>
<p>This will be used implicitly by <code class="docutils literal notranslate"><span class="pre">for(let</span> <span class="pre">x</span> <span class="pre">of</span> <span class="pre">proxy){}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to send to a generator. The value will be assigned as a result of a yield expression.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the iterator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">next</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the giterator is done, <code class="docutils literal notranslate"><span class="pre">next</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true</span> <span class="pre">}</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyAwaitable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyAwaitable</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAwaitable" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-task.html#asyncio-awaitables" title="(in Python v3.12)"><span class="xref std std-ref">awaitable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__await__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__await__()</span></code></a> method).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAwaitable.catch">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAwaitable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">catch</span></span></span><span class="sig-paren"><</span><em class="sig-param"><span class="n"><span class="pre">TResult</span></span></em><span class="sig-paren">></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onrejected</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAwaitable.catch" title="Link to this definition">#</a></dt>
<dd><p>Attaches a callback for only the rejection of the Promise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TResult</strong> – </p>
</dd>
<dt class="field-even">Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>onrejected</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> | (reason: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; TResult | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">PromiseLike</span></code></a>&lt;TResult&gt;</span>) – The callback to execute when the Promise is rejected.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – A Promise for the completion of the callback.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAwaitable.finally">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAwaitable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">finally</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfinally</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAwaitable.finally" title="Link to this definition">#</a></dt>
<dd><p>Attaches a callback that is invoked when the Promise is settled (fulfilled or rejected). The
resolved value cannot be modified from the callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onfinally</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> | () =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – The callback to execute when the Promise is settled (fulfilled or rejected).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – A Promise for the completion of the callback.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyAwaitable.then">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyAwaitable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">then</span></span></span><span class="sig-paren"><</span><em class="sig-param"><span class="n"><span class="pre">TResult1</span></span></em>, <em class="sig-param"><span class="n"> <span class="pre">TResult2</span></span></em><span class="sig-paren">></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfulfilled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onrejected</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyAwaitable.then" title="Link to this definition">#</a></dt>
<dd><p>Attaches callbacks for the resolution and/or rejection of the Promise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TResult1</strong> – </p></li>
<li><p><strong>TResult2</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>onfulfilled</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> | (value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; TResult1 | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">PromiseLike</span></code></a>&lt;TResult1&gt;</span>) – The callback to execute when the Promise is resolved.</p></li>
<li><p><strong>onrejected</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">null</span></code></a> | (reason: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; TResult2 | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">PromiseLike</span></code></a>&lt;TResult2&gt;</span>) – The callback to execute when the Promise is rejected.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;TResult1 | TResult2&gt;</span> – A Promise for the completion of which ever callback is executed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyBuffer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyBuffer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyBuffer" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object supports the
Python <a class="reference external" href="https://docs.python.org/3.12/c-api/buffer.html" title="(in Python v3.12)"><span>Buffer Protocol</span></a>.</p>
<p>Examples of buffers include {py:class}`bytes` objects and numpy
{external+numpy:ref}`arrays`.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyBuffer.getBuffer">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBuffer</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">getBuffer</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyBuffer.getBuffer" title="Link to this definition">#</a></dt>
<dd><p>Get a view of the buffer data which is usable from JavaScript. No copy is
ever performed.</p>
<p>We do not support suboffsets, if the buffer requires suboffsets we will
throw an error. JavaScript nd array libraries can’t handle suboffsets
anyways. In this case, you should use the <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a> api or
copy the buffer to one that doesn’t use suboffsets (using e.g.,
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ascontiguousarray.html#numpy.ascontiguousarray" title="(in NumPy v2.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.ascontiguousarray()</span></code></a>).</p>
<p>If the buffer stores big endian data or half floats, this function will
fail without an explicit type argument. For big endian data you can use
<a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a>. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">DataView</span></code></a> has support for big endian
data, so you might want to pass <code class="docutils literal notranslate"><span class="pre">'dataview'</span></code> as the type argument in that
case.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The type of the <a class="reference internal" href="#pyodide.ffi.PyBufferView.data" title="pyodide.ffi.PyBufferView.data"><code class="xref js js-attr docutils literal notranslate"><span class="pre">data</span></code></a> field in the output. Should be one of: <code class="docutils literal notranslate"><span class="pre">&quot;i8&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u8&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u8clamped&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;i16&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u16&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;i32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;i32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;i64&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;u64&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;f32&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;f64&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;dataview&quot;</span></code>. This argument is optional, if absent <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-meth docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> will try to determine the appropriate output type based on the buffer format string (see <a class="reference external" href="https://docs.python.org/3.12/library/struct.html#struct-format-strings" title="(in Python v3.12)"><span>Format Strings</span></a>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyBufferView" title="pyodide.ffi.PyBufferView"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyBufferView</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyBufferView</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyBufferView" title="Link to this definition">#</a></dt>
<dd><p>A class to allow access to Python data buffers from JavaScript. These are
produced by <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-meth docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> and cannot be constructed directly.
When you are done, release it with the <a class="reference internal" href="#pyodide.ffi.PyBufferView.release" title="pyodide.ffi.PyBufferView.release"><code class="xref js js-func docutils literal notranslate"><span class="pre">release()</span></code></a> method.
See the Python <a class="reference external" href="https://docs.python.org/3.12/c-api/buffer.html" title="(in Python v3.12)"><span>Buffer Protocol</span></a> documentation for more
information.</p>
<p>To find the element <code class="docutils literal notranslate"><span class="pre">x[a_1,</span> <span class="pre">...,</span> <span class="pre">a_n]</span></code>, you could use the following code:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">multiIndexToIndex</span><span class="p">(</span><span class="nx">pybuff</span><span class="p">,</span><span class="w"> </span><span class="nx">multiIndex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">multindex</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">ndim</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Wrong length index&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">offset</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">ndim</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Index out of range&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">idx</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">stride</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">idx</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;entry is&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pybuff</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">multiIndexToIndex</span><span class="p">(</span><span class="nx">pybuff</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">])]);</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Converting between TypedArray types</p>
<p>The following naive code to change the type of a typed array does not
work:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Incorrectly convert a TypedArray.</span>
<span class="c1">// Produces a Uint16Array that points to the entire WASM memory!</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">myarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint16Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
</pre></div>
</div>
<p>Instead, if you want to convert the output TypedArray, you need to say:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Correctly convert a TypedArray.</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">myarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint16Array</span><span class="p">(</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">buffer</span><span class="p">,</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">byteOffset</span><span class="p">,</span>
<span class="w">    </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">byteLength</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.c_contiguous">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">c_contiguous</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.c_contiguous" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span></p>
<p>Is it C contiguous? See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.c_contiguous" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.c_contiguous</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.data">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.data" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></span></p>
<p>The actual data. A typed array of an appropriate size backed by a segment
of the WASM memory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> argument of <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-meth docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> determines
which sort of <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a> or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">DataView</span></code></a> to return. By
default <a class="reference internal" href="#pyodide.ffi.PyBuffer.getBuffer" title="pyodide.ffi.PyBuffer.getBuffer"><code class="xref js js-meth docutils literal notranslate"><span class="pre">getBuffer()</span></code></a> will look at the format string
to determine the most appropriate option. Most often the result is a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Uint8Array</span></code></a>.</p>
<div class="warning admonition">
<p class="admonition-title">Contiguity</p>
<p>If the buffer is not contiguous, the <a class="reference internal" href="#pyodide.ffi.PyBufferView.readonly" title="pyodide.ffi.PyBufferView.readonly"><code class="xref js js-attr docutils literal notranslate"><span class="pre">readonly</span></code></a>
TypedArray will contain data that is not part of the buffer. Modifying
this data leads to undefined behavior.</p>
</div>
<div class="warning admonition">
<p class="admonition-title">Read only buffers</p>
<p>If <a class="reference internal" href="#pyodide.ffi.PyBufferView.readonly" title="pyodide.ffi.PyBufferView.readonly"><code class="xref js js-attr docutils literal notranslate"><span class="pre">buffer.readonly</span></code></a> is <code class="docutils literal notranslate"><span class="pre">true</span></code>, you
should not modify the buffer. Modifying a read only buffer leads to
undefined behavior.</p>
</div>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.f_contiguous">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">f_contiguous</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.f_contiguous" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span></p>
<p>Is it Fortran contiguous? See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.f_contiguous" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.f_contiguous</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.format">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">format</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.format" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
<p>The format string for the buffer. See <a class="reference external" href="https://docs.python.org/3.12/library/struct.html#struct-format-strings" title="(in Python v3.12)"><span>Format Strings</span></a>
and <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.format" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.format</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.itemsize">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">itemsize</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.itemsize" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span></p>
<p>How large is each entry in bytes? See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.itemsize" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.itemsize</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.nbytes">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">nbytes</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.nbytes" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span></p>
<p>The total number of bytes the buffer takes up. This is equal to
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/byteLength" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">buff.data.byteLength</span></code></a>. See
<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.nbytes" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.nbytes</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.ndim">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">ndim</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.ndim" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span></p>
<p>The number of dimensions of the buffer. If <code class="docutils literal notranslate"><span class="pre">ndim</span></code> is 0, the buffer
represents a single scalar or struct. Otherwise, it represents an
array. See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.ndim" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.ndim</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.offset">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">offset</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.offset" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span></p>
<p>The offset of the first entry of the array. For instance if our array
is 3d, then you will find <code class="docutils literal notranslate"><span class="pre">array[0,0,0]</span></code> at
<code class="docutils literal notranslate"><span class="pre">pybuf.data[pybuf.offset]</span></code></p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.readonly">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">readonly</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.readonly" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span></p>
<p>If the data is read only, you should not modify it. There is no way for us
to enforce this, but it may cause very weird behavior. See
<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.readonly" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.readonly</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.shape">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">shape</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.shape" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>[]</span></p>
<p>The shape of the buffer, that is how long it is in each dimension.
The length will be equal to <code class="docutils literal notranslate"><span class="pre">ndim</span></code>. For instance, a 2x3x4 array
would have shape <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">3,</span> <span class="pre">4]</span></code>. See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.shape" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.shape</span></code></a>.</p>
</dd></dl>

<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.strides">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">strides</span></span></span><a class="headerlink" href="#pyodide.ffi.PyBufferView.strides" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>[]</span></p>
<p>An array of of length <code class="docutils literal notranslate"><span class="pre">ndim</span></code> giving the number of elements to skip
to get to a new element in each dimension. See the example definition
of a <code class="docutils literal notranslate"><span class="pre">multiIndexToIndex</span></code> function above. See <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview.strides" title="(in Python v3.12)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">memoryview.strides</span></code></a>.</p>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyBufferView.release">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyBufferView</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">release</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyBufferView.release" title="Link to this definition">#</a></dt>
<dd><p>Release the buffer. This allows the memory to be reclaimed.</p>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyCallable</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is
<a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-callable" title="(in Python v3.12)"><span class="xref std std-term">callable</span></a> (i.e., has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__call__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> method).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.apply">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">apply</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.apply" title="Link to this definition">#</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method calls the specified function with a given this
value, and arguments provided as an array (or an array-like object). Like
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Function.apply()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The <code class="docutils literal notranslate"><span class="pre">this</span></code> argument. Has no effect unless the <a class="reference internal" href="#pyodide.ffi.PyCallable" title="pyodide.ffi.PyCallable"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyCallable</span></code></a> has <a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> set. If <a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> is set, it will be passed as the first argument to the Python function.</p></li>
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The array of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The result from the function call.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.bind">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">bind</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.bind" title="Link to this definition">#</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">bind()</span></code> method creates a new function that, when called, has its
<code class="docutils literal notranslate"><span class="pre">this</span></code> keyword set to the provided value, with a given sequence of
arguments preceding any provided when the new function is called. See
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Function.bind()</span></code></a>.</p>
<p>If the <a class="reference internal" href="#pyodide.ffi.PyCallable" title="pyodide.ffi.PyCallable"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyCallable</span></code></a> does not have
<a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> set, the <code class="docutils literal notranslate"><span class="pre">this</span></code> parameter will be discarded. If it
does have <a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> set, <code class="docutils literal notranslate"><span class="pre">thisArg</span></code> will be set to the first
argument of the Python function. The returned proxy and the original proxy
have the same lifetime so destroying either destroys both.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to be passed as the <code class="docutils literal notranslate"><span class="pre">this</span></code> parameter to the target function <code class="docutils literal notranslate"><span class="pre">func</span></code> when the bound function is called.</p></li>
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Extra arguments to prepend to arguments provided to the bound function when invoking <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.call">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">call</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.call" title="Link to this definition">#</a></dt>
<dd><p>Calls the function with a given this value and arguments provided
individually. See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Function.call()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The <code class="docutils literal notranslate"><span class="pre">this</span></code> argument. Has no effect unless the <a class="reference internal" href="#pyodide.ffi.PyCallable" title="pyodide.ffi.PyCallable"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyCallable</span></code></a> has <a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> set. If <a class="reference internal" href="#pyodide.ffi.PyCallable.captureThis" title="pyodide.ffi.PyCallable.captureThis"><code class="xref js js-meth docutils literal notranslate"><span class="pre">captureThis()</span></code></a> is set, it will be passed as the first argument to the Python function.</p></li>
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The result from the function call.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callKwargs">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callKwargs</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callKwargs" title="Link to this definition">#</a></dt>
<dd><p>Call the function with keyword arguments. The last argument must be an
object with the keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callKwargsRelaxed">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callKwargsRelaxed</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callKwargsRelaxed" title="Link to this definition">#</a></dt>
<dd><p>Call the function with keyword arguments in a “relaxed” manner. The last
argument must be an object with the keyword arguments. Any extra arguments
will be ignored. This matches the behavior of JavaScript functions more
accurately.</p>
<p>Missing arguments are <strong>NOT</strong> filled with <code class="docutils literal notranslate"><span class="pre">None</span></code>. If too few arguments are
passed, this will still raise a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#TypeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>. Also, if the same argument is
passed as both a keyword argument and a positional argument, it will raise
an error.</p>
<p>This uses <a class="reference internal" href="#pyodide.code.relaxed_call" title="pyodide.code.relaxed_call"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.code.relaxed_call()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callPromising">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callPromising</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callPromising" title="Link to this definition">#</a></dt>
<dd><p>Call the function with stack switching enabled. The last argument must be
an object with the keyword arguments. Functions called this way can use
<a class="reference internal" href="#pyodide.ffi.run_sync" title="pyodide.ffi.run_sync"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sync()</span></code></a> to block until an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a> is resolved. Only works in runtimes
with JS Promise integration.</p>
<div class="warning admonition">
<p class="admonition-title">Experimental</p>
<p>This feature is not yet stable.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callPromisingKwargs">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callPromisingKwargs</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callPromisingKwargs" title="Link to this definition">#</a></dt>
<dd><p>Call the function with stack switching enabled. The last argument must be
an object with the keyword arguments. Functions called this way can use
<a class="reference internal" href="#pyodide.ffi.run_sync" title="pyodide.ffi.run_sync"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sync()</span></code></a> to block until an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a> is resolved. Only works in runtimes
with JS Promise integration.</p>
<div class="warning admonition">
<p class="admonition-title">Experimental</p>
<p>This feature is not yet stable.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callRelaxed">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callRelaxed</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callRelaxed" title="Link to this definition">#</a></dt>
<dd><p>Call the function in a “relaxed” manner. Any extra arguments will be
ignored. This matches the behavior of JavaScript functions more accurately.</p>
<p>Any extra arguments will be ignored. This matches the behavior of
JavaScript functions more accurately. Missing arguments are <strong>NOT</strong> filled
with <code class="docutils literal notranslate"><span class="pre">None</span></code>. If too few arguments are passed, this will still raise a
TypeError.</p>
<p>This uses <a class="reference internal" href="#pyodide.code.relaxed_call" title="pyodide.code.relaxed_call"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.code.relaxed_call()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.callWithOptions">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">callWithOptions</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...jsargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.callWithOptions" title="Link to this definition">#</a></dt>
<dd><p>Call the Python function. The first parameter controls various parameters
that change the way the call is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.relaxed</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, extra arguments are ignored instead of raising a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#TypeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>.</p></li>
<li><p><strong>options.kwargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, the last argument is treated as a collection of keyword arguments.</p></li>
<li><p><strong>options.promising</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If true, the call is made with stack switching enabled. Not needed if the callee is an async Python function.</p></li>
<li><p><strong>jsargs</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Arguments to the Python function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyCallable.captureThis">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyCallable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">captureThis</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyCallable.captureThis" title="Link to this definition">#</a></dt>
<dd><p>Returns a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> that passes <code class="docutils literal notranslate"><span class="pre">this</span></code> as the first argument to the
Python function. The returned <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> has the internal <code class="docutils literal notranslate"><span class="pre">captureThis</span></code>
property set.</p>
<p>It can then be used as a method on a JavaScript object. The returned proxy
and the original proxy have the same lifetime so destroying either destroys
both.</p>
<p>For example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">};</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
<span class="s">`</span><span class="p">);</span>
<span class="c1">// Without captureThis, it doesn&#39;t work to use f as a method for obj:</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">);</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// raises &quot;TypeError: f() missing 1 required positional argument: &#39;self&#39;&quot;</span>
<span class="c1">// With captureThis, it works fine:</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">).</span><span class="nx">captureThis</span><span class="p">();</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// returns 7</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span> – The resulting <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>. It has the same lifetime as the original <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> but passes <code class="docutils literal notranslate"><span class="pre">this</span></code> to the wrapped function.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyDict">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyDict</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyDict" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxyWithGet" title="pyodide.ffi.PyProxyWithGet"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxyWithGet</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxyWithSet" title="pyodide.ffi.PyProxyWithSet"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxyWithSet</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxyWithHas" title="pyodide.ffi.PyProxyWithHas"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxyWithHas</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxyWithLength" title="pyodide.ffi.PyProxyWithLength"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxyWithLength</span></code></a></span></p></li>
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyIterable" title="pyodide.ffi.PyIterable"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyIterable</span></code></a></span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyGenerator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyGenerator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyGenerator" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is a <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-generator" title="(in Python v3.12)"><span class="xref std std-term">generator</span></a>
(i.e., it is an instance of <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyGenerator.return">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyGenerator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">return</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyGenerator.return" title="Link to this definition">#</a></dt>
<dd><p>Throws a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> into the generator and if the
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> is not caught returns the argument value <code class="docutils literal notranslate"><span class="pre">{done:</span>
<span class="pre">true,</span> <span class="pre">value:</span> <span class="pre">v}</span></code>. If the generator catches the <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> and
returns or yields another value the next value of the generator this is
returned in the normal way. If it throws some error other than
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopIteration</span></code></a>, that error is propagated. See
the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/return" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Generator.return()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to return from the generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the generator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the generator raises a <code class="docutils literal notranslate"><span class="pre">StopIteration(result_value)</span></code> exception, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">result_value}</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyGenerator.throw">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyGenerator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">throw</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyGenerator.throw" title="Link to this definition">#</a></dt>
<dd><p>Throws an exception into the Generator.</p>
<p>See the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/throw" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Generator.throw()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exc</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Error The error to throw into the generator. Must be an instanceof <code class="docutils literal notranslate"><span class="pre">Error</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the generator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the generator raises a <code class="docutils literal notranslate"><span class="pre">StopIteration(result_value)</span></code> exception, <code class="docutils literal notranslate"><span class="pre">return</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">result_value}</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyIterable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyIterable</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyIterable" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-iterable" title="(in Python v3.12)"><span class="xref std std-term">iterable</span></a>
(i.e., it has an <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__iter__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a> method).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyIterable.-Symbol.iterator">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyIterable</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">[Symbol․iterator]</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyIterable.-Symbol.iterator" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">iter(obj)</span></code>. Return an iterator
associated to the proxy. See the documentation for
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.iterator</span></code></a>.</p>
<p>This will be used implicitly by <code class="docutils literal notranslate"><span class="pre">for(let</span> <span class="pre">x</span> <span class="pre">of</span> <span class="pre">proxy){}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_iterator_protocol" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Iterator</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyIterator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyIterator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyIterator" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an <a class="reference external" href="https://docs.python.org/3.12/glossary.html#term-iterator" title="(in Python v3.12)"><span class="xref std std-term">iterator</span></a>
(i.e., has a <a class="reference external" href="https://docs.python.org/3.12/reference/expressions.html#generator.send" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send()</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#iterator.__next__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__next__()</span></code></a> method).</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyIterator.next">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyIterator</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">next</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg=undefined</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyIterator.next" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">next(obj)</span></code>. Returns the next value of
the generator. See the documentation for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/next" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Generator.next()</span></code></a> The
argument will be sent to the Python generator.</p>
<p>This will be used implicitly by <code class="docutils literal notranslate"><span class="pre">for(let</span> <span class="pre">x</span> <span class="pre">of</span> <span class="pre">proxy){}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to send to the generator. The value will be assigned as a result of a yield expression.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">IteratorResult</span></code></a>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;</span> – An Object with two properties: <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>. When the generator yields <code class="docutils literal notranslate"><span class="pre">some_value</span></code>, <code class="docutils literal notranslate"><span class="pre">next</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">false,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">some_value}</span></code>. When the generator raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopIteration</span></code></a> exception, <code class="docutils literal notranslate"><span class="pre">next</span></code> returns <code class="docutils literal notranslate"><span class="pre">{done</span> <span class="pre">:</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">:</span> <span class="pre">result_value}</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyMutableSequence</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.MutableSequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></a> (i.e., a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>)</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.copyWithin">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">copyWithin</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.copyWithin" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/copyWithin" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.copyWithin()</span></code></a> method shallow copies part of a
<a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> to another location in the same <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>
without modifying its length.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to copy the sequence to.</p></li>
<li><p><strong>start</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start copying elements from.</p></li>
<li><p><strong>end</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to end copying elements from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The modified <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.fill">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">fill</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.fill" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/fill" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.fill()</span></code></a> method changes all elements in an array to a
static value, from a start index to an end index.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Value to fill the array with.</p></li>
<li><p><strong>start</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start filling. Default 0.</p></li>
<li><p><strong>end</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to end filling. Default <code class="docutils literal notranslate"><span class="pre">list.length</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.pop">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">pop</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.pop" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.pop()</span></code></a> method removes the last element from a
<a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The removed element from the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>; undefined if the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> is empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.push">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">push</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...elts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.push" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.push()</span></code></a> method adds the specified elements to the end of
a <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elts</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span>) – The element(s) to add to the end of the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The new length property of the object upon which the method was called.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.reverse">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">reverse</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.reverse" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.reverse()</span></code></a> method reverses a <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> in
place.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a></span> – A reference to the same <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.shift">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">shift</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.shift" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/shift" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.shift()</span></code></a> method removes the first element from a
<a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The removed element from the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>; undefined if the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> is empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.sort">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">sort</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compareFn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.sort" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.sort()</span></code></a> method sorts the elements of a
<a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compareFn</strong> (<span class="sphinx_js-type">(a: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, b: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – A function that defines the sort order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a></span> – A reference to the same <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.splice">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">splice</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deleteCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.splice" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.splice()</span></code></a> method changes the contents of a
<a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> by removing or replacing existing elements and/or
adding new elements in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start changing the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p></li>
<li><p><strong>deleteCount</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – An integer indicating the number of elements in the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a> to remove from <code class="docutils literal notranslate"><span class="pre">start</span></code>.</p></li>
<li><p><strong>items</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span>) – The elements to add to the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>, beginning from <code class="docutils literal notranslate"><span class="pre">start</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span> – An array containing the deleted elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyMutableSequence.unshift">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyMutableSequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">unshift</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...elts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyMutableSequence.unshift" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/unshift" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.unshift()</span></code></a> method adds the specified elements to the
beginning of a <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elts</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span>) – The elements to add to the front of the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The new length of the <a class="reference internal" href="#pyodide.ffi.PyMutableSequence" title="pyodide.ffi.PyMutableSequence"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyMutableSequence</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyProxy</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxy" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> is an object that allows idiomatic use of a Python object from
JavaScript. See <a class="reference internal" href="#type-translations-pyproxy"><span class="std std-ref">Proxying from Python into JavaScript</span></a>.</p>
<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy.type">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxy</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">type</span></span></span><a class="headerlink" href="#pyodide.ffi.PyProxy.type" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: readonly <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
<p>The name of the type of the object.</p>
<p>Usually the value is <code class="docutils literal notranslate"><span class="pre">&quot;module.name&quot;</span></code> but for builtins or
interpreter-defined types it is just <code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code>. As pseudocode this is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ty</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">if</span> <span class="n">ty</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">==</span> <span class="s1">&#39;builtins&#39;</span> <span class="ow">or</span> <span class="n">ty</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">ty</span><span class="o">.</span><span class="vm">__name__</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ty</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ty</span><span class="o">.</span><span class="vm">__name__</span>
</pre></div>
</div>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy.copy">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxy</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">copy</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxy.copy" title="Link to this definition">#</a></dt>
<dd><p>Make a new <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> pointing to the same Python object.
Useful if the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> is destroyed somewhere else.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy.destroy">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxy</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">destroy</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxy.destroy" title="Link to this definition">#</a></dt>
<dd><p>Destroy the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>. This will release the memory. Any further attempt
to use the object will raise an error.</p>
<p>In a browser supporting <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">FinalizationRegistry</span></code></a>, Pyodide will
automatically destroy the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> when it is garbage collected, however
there is no guarantee that the finalizer will be run in a timely manner so
it is better to destroy the proxy explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.message</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – The error message to print if use is attempted after destroying. Defaults to “Object has already been destroyed”.</p></li>
<li><p><strong>options.destroyRoundtrip</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy.toJs">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxy</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">toJs</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxy.toJs" title="Link to this definition">#</a></dt>
<dd><p>Converts the <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> into a JavaScript object as best as possible. By
default does a deep conversion, if a shallow conversion is desired, you can
use <code class="docutils literal notranslate"><span class="pre">proxy.toJs({depth</span> <span class="pre">:</span> <span class="pre">1})</span></code>. See <a class="reference internal" href="#type-translations-pyproxy-to-js"><span class="std std-ref">Explicit Conversion of PyProxy</span></a> for more info.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options.depth</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – How many layers deep to perform the conversion. Defaults to infinite</p></li>
<li><p><strong>options.pyproxies</strong> (<span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>[]</span>) – If provided, <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a> will store all PyProxies created in this list. This allows you to easily destroy all the PyProxies by iterating the list without having to recurse over the generated structure. The most common use case is to create a new empty list, pass the list as <code class="docutils literal notranslate"><span class="pre">pyproxies</span></code>, and then later iterate over <code class="docutils literal notranslate"><span class="pre">pyproxies</span></code> to destroy all of created proxies.</p></li>
<li><p><strong>options.create_pyproxies</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – If false, <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a> will throw a <a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConversionError</span></code></a> rather than producing a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>.</p></li>
<li><p><strong>options.dict_converter</strong> (<span class="sphinx_js-type">(array: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_iterable_protocol" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Iterable</span></code></a>&lt;[key: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a>, value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>]&gt;) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A function to be called on an iterable of pairs <code class="docutils literal notranslate"><span class="pre">[key,</span> <span class="pre">value]</span></code>. Convert this iterable of pairs to the desired output. For instance, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">Object.fromEntries()</span></code></a> would convert the dict to an object, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">Array.from()</span></code></a> converts it to an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a> of pairs, and <code class="docutils literal notranslate"><span class="pre">(it)</span> <span class="pre">=&gt;</span> <span class="pre">new</span> <span class="pre">Map(it)</span></code> converts it to a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a> (which is the default behavior).</p></li>
<li><p><strong>options.default_converter</strong> (<span class="sphinx_js-type">(obj: <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>, convert: (obj: <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, cacheConversion: (obj: <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>, result: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Optional argument to convert objects with no default conversion. See the documentation of <a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_js()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The JavaScript object resulting from the conversion.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxy.toString">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxy</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">toString</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxy.toString" title="Link to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">str(o)</span></code> (unless <code class="docutils literal notranslate"><span class="pre">pyproxyToStringRepr:</span> <span class="pre">true</span></code> was passed to
<a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a> in which case it will return <code class="docutils literal notranslate"><span class="pre">repr(o)</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithGet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyProxyWithGet</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithGet" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> method.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithGet.asJsJson">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithGet</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">asJsJson</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithGet.asJsJson" title="Link to this definition">#</a></dt>
<dd><p>Returns the object treated as a json adaptor.</p>
<dl class="simple">
<dt>With a JsonAdaptor:</dt><dd><ol class="arabic simple">
<li><p>property access / modification / deletion is implemented with
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__setitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>, and
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__delitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a> respectively.</p></li>
<li><p>If an attribute is accessed and the result implements
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> then the result will also be a json
adaptor.</p></li>
</ol>
</dd>
</dl>
<p>For instance, <code class="docutils literal notranslate"><span class="pre">JSON.stringify(proxy.asJsJson())</span></code> acts like an
inverse to Python’s <a class="reference external" href="https://docs.python.org/3.12/library/json.html#json.loads" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithGet.get">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithGet</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithGet.get" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">obj[key]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The key to look up.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The corresponding value.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithHas">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyProxyWithHas</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithHas" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__contains__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__contains__()</span></code></a> method.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithHas.has">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithHas</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">has</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithHas.has" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">in</span> <span class="pre">obj</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The key to check for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span> – Is <code class="docutils literal notranslate"><span class="pre">key</span></code> present?</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithLength">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyProxyWithLength</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithLength" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__len__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a>
method.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithLength.length">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithLength</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">length</span></span></span><a class="headerlink" href="#pyodide.ffi.PyProxyWithLength.length" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: readonly <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span></p>
<p>The length of the object.</p>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithSet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PyProxyWithSet</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithSet" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object has a
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__setitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a> or <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__delitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a> method.</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithSet.delete">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithSet</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">delete</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithSet.delete" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">obj[key]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The key to delete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PyProxyWithSet.set">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PyProxyWithSet</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PyProxyWithSet.set" title="Link to this definition">#</a></dt>
<dd><p>This translates to the Python code <code class="docutils literal notranslate"><span class="pre">obj[key]</span> <span class="pre">=</span> <span class="pre">value</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The key to set.</p></li>
<li><p><strong>value</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – The value to set it to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PySequence</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> whose proxied Python object is an
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> (i.e., a <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>)</p>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.asJsJson">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">asJsJson</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.asJsJson" title="Link to this definition">#</a></dt>
<dd><p>Returns the object treated as a json adaptor.</p>
<dl class="simple">
<dt>With a JsonAdaptor:</dt><dd><ol class="arabic simple">
<li><p>property access / modification / deletion is implemented with
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__setitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>, and
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__delitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a> respectively.</p></li>
<li><p>If an attribute is accessed and the result implements
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__getitem__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> then the result will also be a json
adaptor.</p></li>
</ol>
</dd>
</dl>
<p>For instance, <code class="docutils literal notranslate"><span class="pre">JSON.stringify(proxy.asJsJson())</span></code> acts like an
inverse to Python’s <a class="reference external" href="https://docs.python.org/3.12/library/json.html#json.loads" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.at">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">at</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.at" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/at" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.at()</span></code></a>. Takes an integer value and returns the item at
that index.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index of the Sequence element to be returned, converted to an integer. Negative index counts back from the end of the Sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The element in the Sequence matching the given index.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.concat">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">concat</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...rest</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.concat" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/concat" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.concat()</span></code></a> method is used to merge two or more arrays.
This method does not change the existing arrays, but instead returns a new
array.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rest</strong> (<span class="sphinx_js-type"><code class="docutils literal notranslate"><span class="pre">ConcatArray</span></code>&lt;<a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>&gt;[]</span>) – Arrays and/or values to concatenate into a new array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span> – A new Array instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.entries">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">entries</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.entries" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/entries" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.entries()</span></code></a> method returns a new iterator object that
contains the key/value pairs for each index in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><code class="docutils literal notranslate"><span class="pre">IterableIterator</span></code>&lt;[<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>]&gt;</span> – A new iterator object.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.every">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">every</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.every" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/every" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.every()</span></code></a>. Tests whether every element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>
passes the test implemented by the provided function.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicate</strong> (<span class="sphinx_js-type">(value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]) =&gt; <code class="docutils literal notranslate"><span class="pre">unknown</span></code></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. It should return a truthy value to indicate the element passes the test, and a falsy value otherwise.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">predicate</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.filter">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">filter</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.filter" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.filter()</span></code></a>. Creates a shallow copy of a portion of a given
<code class="docutils literal notranslate"><span class="pre">Sequence</span></code>, filtered down to just the elements from the given array that pass
the test implemented by the provided function.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicate</strong> (<span class="sphinx_js-type">(elt: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span>) – A function to execute for each element in the array. It should return a truthy value to keep the element in the resulting array, and a falsy value otherwise.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">predicate</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.find">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">find</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.find" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.find()</span></code></a> method returns the first element in the provided
array that satisfies the provided testing function.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicate</strong> (<span class="sphinx_js-type">(value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, obj: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. It should return a truthy value to indicate a matching element has been found, and a falsy value otherwise.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">predicate</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – The first element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code> that satisfies the provided testing function.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.findIndex">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">findIndex</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.findIndex" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.findIndex()</span></code></a> method returns the index of the first
element in the provided array that satisfies the provided testing function.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicate</strong> (<span class="sphinx_js-type">(value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, obj: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. It should return a truthy value to indicate a matching element has been found, and a falsy value otherwise.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">predicate</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span> – The index of the first element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code> that satisfies the provided testing function.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.forEach">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">forEach</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbackfn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.forEach" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.forEach()</span></code></a>. Executes a provided function once for each
<code class="docutils literal notranslate"><span class="pre">Sequence</span></code> element.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callbackfn</strong> (<span class="sphinx_js-type">(elt: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/functions.html#void" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">void</span></code></a></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. Its return value is discarded.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">callbackFn</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.includes">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">includes</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.includes" title="Link to this definition">#</a></dt>
<dd><p>The  <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.includes()</span></code></a> method determines whether a Sequence
includes a certain value among its entries, returning true or false as
appropriate.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elt</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.indexOf">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">indexOf</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromIndex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.indexOf" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.indexOf()</span></code></a>. Returns the first index at which a given
element can be found in the Sequence, or -1 if it is not present.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elt</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Element to locate in the Sequence.</p></li>
<li><p><strong>fromIndex</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start searching, converted to an integer. Negative index counts back from the end of the Sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span> – The first index of the element in the Sequence; -1 if not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.join">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">join</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.join" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.join()</span></code></a>. The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.join()</span></code></a> method creates and
returns a new string by concatenating all of the elements in the
<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span>) – A string to separate each pair of adjacent elements of the Sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span> – A string with all Sequence elements joined.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.keys">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">keys</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.keys" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/keys" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.keys()</span></code></a> method returns a new iterator object that
contains the keys for each index in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><code class="docutils literal notranslate"><span class="pre">IterableIterator</span></code>&lt;<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>&gt;</span> – A new iterator object.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.lastIndexOf">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">lastIndexOf</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromIndex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.lastIndexOf" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.lastIndexOf()</span></code></a>. Returns the last index at which a given
element can be found in the Sequence, or -1 if it is not present.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elt</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – Element to locate in the Sequence.</p></li>
<li><p><strong>fromIndex</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start searching backwards, converted to an integer. Negative index counts back from the end of the Sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span> – The last index of the element in the Sequence; -1 if not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.map">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">map</span></span></span><span class="sig-paren"><</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em><span class="sig-paren">></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbackfn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.map" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.map()</span></code></a>. Creates a new array populated with the results of
calling a provided function on every element in the calling <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>U</strong> – </p>
</dd>
<dt class="field-even">Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>callbackfn</strong> (<span class="sphinx_js-type">(elt: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; U</span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. Its return value is added as a single element in the new array.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">callbackFn</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type">U[]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.reduce">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">reduce</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbackfn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialValue</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.reduce" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.reduce()</span></code></a>. Executes a user-supplied “reducer” callback
function on each element of the Sequence, in order, passing in the return
value from the calculation on the preceding element. The final result of
running the reducer across all elements of the Sequence is a single value.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callbackfn</strong> (<span class="sphinx_js-type">(previousValue: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, currentValue: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, currentIndex: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. Its return value is discarded.</p></li>
<li><p><strong>initialValue</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.reduceRight">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">reduceRight</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbackfn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialValue</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.reduceRight" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.reduceRight()</span></code></a>. Applies a function against an accumulator
and each value of the Sequence (from right to left) to reduce it to a
single value.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callbackfn</strong> (<span class="sphinx_js-type">(previousValue: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, currentValue: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, currentIndex: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>) =&gt; <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A function to execute for each element in the Sequence. Its return value is discarded.</p></li>
<li><p><strong>initialValue</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.slice">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">slice</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.slice" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.slice()</span></code></a>. The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.slice()</span></code></a> method returns a
shallow copy of a portion of a <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> into a
new array object selected from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">stop</span></code> (<cite>stop</cite> not included)</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to start extraction. Negative index counts back from the end of the Sequence.</p></li>
<li><p><strong>stop</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a></span>) – Zero-based index at which to end extraction. Negative index counts back from the end of the Sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span> – A new array containing the extracted elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.some">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">some</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisArg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.some" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.some()</span></code></a>. Tests whether at least one element in the
<code class="docutils literal notranslate"><span class="pre">Sequence</span></code> passes the test implemented by the provided function.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicate</strong> (<span class="sphinx_js-type">(value: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>, index: <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">number</span></code></a>, array: <a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a>[]) =&gt; <code class="docutils literal notranslate"><span class="pre">unknown</span></code></span>) – A function to execute for each element in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>. It should return a truthy value to indicate the element passes the test, and a falsy value otherwise.</p></li>
<li><p><strong>thisArg</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>) – A value to use as <code class="docutils literal notranslate"><span class="pre">this</span></code> when executing <code class="docutils literal notranslate"><span class="pre">predicate</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">boolean</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.toJSON">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">toJSON</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.toJSON" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any" title="(in typescript docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_js-type"><code class="docutils literal notranslate"><span class="pre">unknown</span></code>[]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.ffi.PySequence.values">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PySequence</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PySequence.values" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/values" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Array.values()</span></code></a> method returns a new iterator object that
contains the values for each index in the <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><code class="docutils literal notranslate"><span class="pre">IterableIterator</span></code></span> – A new iterator object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="js class">
<dt class="sig sig-object js" id="pyodide.ffi.PythonError">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">ffi</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">PythonError</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.PythonError" title="Link to this definition">#</a></dt>
<dd><p>A JavaScript error caused by a Python exception.</p>
<p>In order to reduce the risk of large memory leaks, the <a class="reference internal" href="#pyodide.ffi.PythonError" title="pyodide.ffi.PythonError"><code class="xref js js-class docutils literal notranslate"><span class="pre">PythonError</span></code></a>
contains no reference to the Python exception that caused it. You can find
the actual Python exception that caused this error as
<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_exc" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_exc</span></code></a>.</p>
<p>See <a class="reference internal" href="#type-translations-errors"><span class="std std-ref">type translations of errors</span></a> for more
information.</p>
<div class="warning admonition">
<p class="admonition-title">Avoid leaking stack Frames</p>
<p>If you make a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> of
<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_exc" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_exc</span></code></a>, you should be especially careful to
<a class="reference internal" href="#pyodide.ffi.PyProxy.destroy" title="pyodide.ffi.PyProxy.destroy"><code class="xref js js-meth docutils literal notranslate"><span class="pre">destroy()</span></code></a> it when you are done. You may leak a large
amount of memory including the local variables of all the stack frames in
the traceback if you don’t. The easiest way is to only handle the
exception in Python.</p>
</div>
<dl class="simple">
<dt><strong>Extends:</strong></dt><dd><ul class="simple">
<li><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Error</span></code></a></span></p></li>
</ul>
</dd>
</dl>
<dl class="js attribute">
<dt class="sig sig-object js" id="pyodide.ffi.PythonError.type">
<span class="sig-prename descclassname"><span class="n"><span class="pre">PythonError</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">type</span></span></span><a class="headerlink" href="#pyodide.ffi.PythonError.type" title="Link to this definition">#</a></dt>
<dd><p class="js attribute type">type: <span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">string</span></code></a></span></p>
<p>The name of the Python error class, e.g, <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> or
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#KeyError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="pyodide-canvas">
<span id="js-api-pyodide-canvas"></span><h6>pyodide.canvas<a class="headerlink" href="#pyodide-canvas" title="Link to this heading">#</a></h6>
<p>This provides APIs to set a canvas for rendering graphics.</p>
<p>For example, you need to set a canvas if you want to use the SDL library. See
<a class="reference internal" href="#using-sdl"><span class="std std-ref">Using SDL-based packages in Pyodide</span></a> for more information.</p>
<div class="jssummarytable functions docutils container">
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="longtable table autosummary">
<tbody>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.canvas.getCanvas2D" title="pyodide.canvas.getCanvas2D"><code class="xref any js js-func docutils literal notranslate"><span class="pre">getCanvas2D</span></code></a><strong>()</strong></p></td>
<td class="summary"><p>Get the HTML5 canvas element used for 2D rendering.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.canvas.getCanvas3D" title="pyodide.canvas.getCanvas3D"><code class="xref any js js-func docutils literal notranslate"><span class="pre">getCanvas3D</span></code></a><strong>()</strong></p></td>
<td class="summary"><p>Get the HTML5 canvas element used for 3D rendering.</p></td>
</tr>
<tr class="row-odd"><td class="name"><p><a class="reference internal" href="#pyodide.canvas.setCanvas2D" title="pyodide.canvas.setCanvas2D"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setCanvas2D</span></code></a><strong>(canvas)</strong></p></td>
<td class="summary"><p>Set the HTML5 canvas element to use for 2D rendering.</p></td>
</tr>
<tr class="row-even"><td class="name"><p><a class="reference internal" href="#pyodide.canvas.setCanvas3D" title="pyodide.canvas.setCanvas3D"><code class="xref any js js-func docutils literal notranslate"><span class="pre">setCanvas3D</span></code></a><strong>(canvas)</strong></p></td>
<td class="summary"><p>Set the HTML5 canvas element to use for 3D rendering.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<dl class="js function" id="module-pyodide.canvas">
<dt class="sig sig-object js" id="pyodide.canvas.getCanvas2D">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">canvas</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">getCanvas2D</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.canvas.getCanvas2D" title="Link to this definition">#</a></dt>
<dd><p>Get the HTML5 canvas element used for 2D rendering. For now,
Emscripten only supports one canvas element, so getCanvas2D and getCanvas3D
are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">HTMLCanvasElement</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.canvas.getCanvas3D">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">canvas</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">getCanvas3D</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.canvas.getCanvas3D" title="Link to this definition">#</a></dt>
<dd><p>Get the HTML5 canvas element used for 3D rendering. For now,
Emscripten only supports one canvas element, so getCanvas2D and getCanvas3D
are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">HTMLCanvasElement</span></code></a> | <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">undefined</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.canvas.setCanvas2D">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">canvas</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setCanvas2D</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">canvas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.canvas.setCanvas2D" title="Link to this definition">#</a></dt>
<dd><p>Set the HTML5 canvas element to use for 2D rendering. For now,
Emscripten only supports one canvas element, so setCanvas2D and setCanvas3D
are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>canvas</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">HTMLCanvasElement</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="js function">
<dt class="sig sig-object js" id="pyodide.canvas.setCanvas3D">
<span class="sig-prename descclassname"><span class="n"><span class="pre">pyodide</span></span><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">canvas</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">setCanvas3D</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">canvas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.canvas.setCanvas3D" title="Link to this definition">#</a></dt>
<dd><p>Set the HTML5 canvas element to use for 3D rendering. For now,
Emscripten only supports one canvas element, so setCanvas2D and setCanvas3D
are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>canvas</strong> (<span class="sphinx_js-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">HTMLCanvasElement</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<span id="document-usage/api/python-api"></span><section id="python-api">
<span id="id1"></span><h5>Python API<a class="headerlink" href="#python-api" title="Link to this heading">#</a></h5>
<p>Backward compatibility of the API is not guaranteed at this point.</p>
<p><strong>JavaScript Modules</strong></p>
<p>By default there are two JavaScript modules. More can be added with
<a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a>. You can import these modules using the Python
<code class="docutils literal notranslate"><span class="pre">import</span></code> statement in the normal way.</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">js</span></code></p></td>
<td><p>The global JavaScript scope.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyodide" title="pyodide"><code class="xref js js-mod docutils literal notranslate"><span class="pre">pyodide_js</span></code></a></p></td>
<td><p>The JavaScript Pyodide module.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Python Modules</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyodide.code" title="pyodide.code"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyodide.code</span></code></a></p></td>
<td><p>Utilities for evaluating Python and JavaScript code.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyodide.console" title="pyodide.console"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyodide.console</span></code></a></p></td>
<td><p>Similar to the builtin <a class="reference external" href="https://docs.python.org/3.12/library/code.html#module-code" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">code</span></code></a> module but handles top level await. Used
for implementing the Pyodide console.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyodide.ffi" title="pyodide.ffi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyodide.ffi</span></code></a></p></td>
<td><p>The <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> class and utilities to help interact with JavaScript code.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyodide.http" title="pyodide.http"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyodide.http</span></code></a></p></td>
<td><p>Defines <a class="reference internal" href="#pyodide.http.pyfetch" title="pyodide.http.pyfetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyfetch()</span></code></a> and other functions for making network requests.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyodide.webloop" title="pyodide.webloop"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyodide.webloop</span></code></a></p></td>
<td><p>The Pyodide event loop implementation. This is automatically configured
correctly for most use cases it is unlikely you will need it outside of niche
use cases.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
<span id="document-usage/api/python-api/code"></span><section id="module-pyodide.code">
<span id="pyodide-code"></span><h6>pyodide.code<a class="headerlink" href="#module-pyodide.code" title="Link to this heading">#</a></h6>
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.code.CodeRunner" title="pyodide.code.CodeRunner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CodeRunner</span></code></a>(source, *[, return_mode, mode, ...])</p></td>
<td><p>This class allows fine control over the execution of a code block.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.code.eval_code" title="pyodide.code.eval_code"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval_code</span></code></a>(source[, globals, locals, ...])</p></td>
<td><p>Runs a string as Python source code.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.code.eval_code_async" title="pyodide.code.eval_code_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval_code_async</span></code></a>(source[, globals, locals, ...])</p></td>
<td><p>Runs a code string asynchronously.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.code.find_imports" title="pyodide.code.find_imports"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_imports</span></code></a>(source)</p></td>
<td><p>Finds the imports in a Python source code string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.code.relaxed_call" title="pyodide.code.relaxed_call"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relaxed_call</span></code></a>(func, *args, **kwargs)</p></td>
<td><p>Call the function ignoring extra arguments</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.code.relaxed_wrap" title="pyodide.code.relaxed_wrap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relaxed_wrap</span></code></a>(func)</p></td>
<td><p>Decorator which creates a function that ignores extra arguments</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.code.run_js" title="pyodide.code.run_js"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_js</span></code></a>(code, /)</p></td>
<td><p>A wrapper for the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">eval()</span></code></a> function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.code.should_quiet" title="pyodide.code.should_quiet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">should_quiet</span></code></a>(source, /)</p></td>
<td><p>Should we suppress output?</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">CodeRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'last_expr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet_trailing_semicolon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;exec&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_inherit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.CodeRunner" title="Link to this definition">#</a></dt>
<dd><p>This class allows fine control over the execution of a code block.</p>
<p>It is primarily intended for REPLs and other sophisticated consumers that
may wish to add their own AST transformations, separately signal to the user
when parsing is complete, etc. The simpler <a class="reference internal" href="#pyodide.code.eval_code" title="pyodide.code.eval_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code()</span></code></a> and
<a class="reference internal" href="#pyodide.code.eval_code_async" title="pyodide.code.eval_code_async"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_code_async()</span></code></a> apis should be preferred when their flexibility
suffices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The Python source code to run.</p></li>
<li><p><strong>return_mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'last_expr'</span></code>, <code class="docutils literal notranslate"><span class="pre">'last_expr_or_assign'</span></code>, <code class="docutils literal notranslate"><span class="pre">'none'</span></code>]</span>) – <p>Specifies what should be returned. The options are:</p>
<dl class="field-list simple">
<dt class="field-odd">’last_expr’<span class="colon">:</span></dt>
<dd class="field-odd"><p>return the last expression</p>
</dd>
<dt class="field-even">’last_expr_or_assign’<span class="colon">:</span></dt>
<dd class="field-even"><p>return the last expression or the last
assignment.</p>
</dd>
<dt class="field-odd">’none’<span class="colon">:</span></dt>
<dd class="field-odd"><p>always return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</p></li>
<li><p><strong>quiet_trailing_semicolon</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Specifies whether a trailing semicolon should suppress the result or
not. When this is <code class="docutils literal notranslate"><span class="pre">True</span></code> executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1;&quot;</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, when
it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1;&quot;</span></code> return <code class="docutils literal notranslate"><span class="pre">2</span></code>. <code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The file name to use in error messages and stack traces. <code class="docutils literal notranslate"><span class="pre">'&lt;exec&gt;'</span></code> by
default.</p></li>
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The “mode” to compile in. One of <code class="docutils literal notranslate"><span class="pre">&quot;exec&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;single&quot;</span></code>, or
<code class="docutils literal notranslate"><span class="pre">&quot;eval&quot;</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;exec&quot;</span></code>. For most purposes it’s unnecessary
to use this argument. See the documentation for the built-in
<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
<li><p><strong>flags</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The flags to compile with. See the documentation for the built-in
<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
<li><p><strong>dont_inherit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to inherit <code class="docutils literal notranslate"><span class="pre">__future__</span></code> imports from the outer code.
See the documentation for the built-in <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
<li><p><strong>optimize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Specifies the optimization level of the compiler. See the documentation
for the built-in <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;1 + 1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span> <span class="o">=</span> <span class="n">CodeRunner</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span> 
<span class="go">&lt;_pyodide._base.CodeRunner object at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_globals</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_locals</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;x + y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span> <span class="o">=</span> <span class="n">CodeRunner</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span> 
<span class="go">&lt;_pyodide._base.CodeRunner object at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">globals</span><span class="o">=</span><span class="n">my_globals</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="n">my_locals</span><span class="p">)</span>
<span class="go">25</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner.ast">
<span class="sig-name descname"><span class="pre">ast</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/ast.html#module-ast"><span class="pre">Module</span></a></em><a class="headerlink" href="#pyodide.code.CodeRunner.ast" title="Link to this definition">#</a></dt>
<dd><p>The ast from parsing <code class="docutils literal notranslate"><span class="pre">source</span></code>. If you wish to do an ast transform,
modify this variable before calling <a class="reference internal" href="#pyodide.code.CodeRunner.compile" title="pyodide.code.CodeRunner.compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CodeRunner.compile()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner.code">
<span class="sig-name descname"><span class="pre">code</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/types.html#types.CodeType" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CodeType</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#pyodide.code.CodeRunner.code" title="Link to this definition">#</a></dt>
<dd><p>Once you call <a class="reference internal" href="#pyodide.code.CodeRunner.compile" title="pyodide.code.CodeRunner.compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CodeRunner.compile()</span></code></a> the compiled code will
be available in the code field. You can modify this variable
before calling <a class="reference internal" href="#pyodide.code.CodeRunner.run" title="pyodide.code.CodeRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CodeRunner.run()</span></code></a> to do a code transform.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.CodeRunner.compile" title="Link to this definition">#</a></dt>
<dd><p>Compile the current value of <code class="docutils literal notranslate"><span class="pre">self.ast</span></code> and store the result in <code class="docutils literal notranslate"><span class="pre">self.code</span></code>.</p>
<p>Can only be used once. Returns <code class="docutils literal notranslate"><span class="pre">self</span></code> (chainable).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.code.CodeRunner" title="_pyodide._base.CodeRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">CodeRunner</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.CodeRunner.run" title="Link to this definition">#</a></dt>
<dd><p>Executes <code class="docutils literal notranslate"><span class="pre">self.code</span></code>.</p>
<p>Can only be used after calling compile. The code may not use top level
await, use <a class="reference internal" href="#pyodide.code.CodeRunner.run_async" title="pyodide.code.CodeRunner.run_async"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CodeRunner.run_async()</span></code></a> for code that uses top level
await.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The global scope in which to execute code. This is used as the <code class="docutils literal notranslate"><span class="pre">globals</span></code>
parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">globals</span></code> is absent, a new empty dictionary is used.</p></li>
<li><p><strong>locals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The local scope in which to execute code. This is used as the <code class="docutils literal notranslate"><span class="pre">locals</span></code>
parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">locals</span></code> is absent, the value of <code class="docutils literal notranslate"><span class="pre">globals</span></code> is
used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the last nonwhitespace character of <code class="docutils literal notranslate"><span class="pre">source</span></code> is a semicolon,
return <code class="docutils literal notranslate"><span class="pre">None</span></code>. If the last statement is an expression, return the
result of the expression. Use the <code class="docutils literal notranslate"><span class="pre">return_mode</span></code> and
<code class="docutils literal notranslate"><span class="pre">quiet_trailing_semicolon</span></code> parameters to modify this default
behavior.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.code.CodeRunner.run_async">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.CodeRunner.run_async" title="Link to this definition">#</a></dt>
<dd><p>Runs <code class="docutils literal notranslate"><span class="pre">self.code</span></code> which may use top level await.</p>
<p>Can only be used after calling <a class="reference internal" href="#pyodide.code.CodeRunner.compile" title="pyodide.code.CodeRunner.compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CodeRunner.compile()</span></code></a>. If
<code class="docutils literal notranslate"><span class="pre">self.code</span></code> uses top level await, automatically awaits the resulting
coroutine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The global scope in which to execute code. This is used as the <code class="docutils literal notranslate"><span class="pre">globals</span></code>
parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">globals</span></code> is absent, a new empty dictionary is used.</p></li>
<li><p><strong>locals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The local scope in which to execute code. This is used as the
<code class="docutils literal notranslate"><span class="pre">locals</span></code> parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">locals</span></code> is absent, the
value of <code class="docutils literal notranslate"><span class="pre">globals</span></code> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the last nonwhitespace character of <code class="docutils literal notranslate"><span class="pre">source</span></code> is a semicolon,
return <code class="docutils literal notranslate"><span class="pre">None</span></code>. If the last statement is an expression, return the
result of the expression. Use the <code class="docutils literal notranslate"><span class="pre">return_mode</span></code> and
<code class="docutils literal notranslate"><span class="pre">quiet_trailing_semicolon</span></code> parameters to modify this default
behavior.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.eval_code">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">eval_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'last_expr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet_trailing_semicolon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;exec&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_inherit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.eval_code" title="Link to this definition">#</a></dt>
<dd><p>Runs a string as Python source code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The Python source code to run.</p></li>
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The global scope in which to execute code. This is used as the
<code class="docutils literal notranslate"><span class="pre">globals</span></code> parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">globals</span></code> is absent, a new
empty dictionary is used.</p></li>
<li><p><strong>locals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The local scope in which to execute code. This is used as the <code class="docutils literal notranslate"><span class="pre">locals</span></code>
parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">locals</span></code> is absent, the value of
<code class="docutils literal notranslate"><span class="pre">globals</span></code> is used.</p></li>
<li><p><strong>return_mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'last_expr'</span></code>, <code class="docutils literal notranslate"><span class="pre">'last_expr_or_assign'</span></code>, <code class="docutils literal notranslate"><span class="pre">'none'</span></code>]</span>) – <p>Specifies what should be returned. The options are:</p>
<dl class="field-list simple">
<dt class="field-odd">’last_expr’<span class="colon">:</span></dt>
<dd class="field-odd"><p>return the last expression</p>
</dd>
<dt class="field-even">’last_expr_or_assign’<span class="colon">:</span></dt>
<dd class="field-even"><p>return the last expression or the last
assignment.</p>
</dd>
<dt class="field-odd">’none’<span class="colon">:</span></dt>
<dd class="field-odd"><p>always return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</p></li>
<li><p><strong>quiet_trailing_semicolon</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Specifies whether a trailing semicolon should suppress the result or
not. When this is <code class="docutils literal notranslate"><span class="pre">True</span></code> executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1</span> <span class="pre">;&quot;</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, when
it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1</span> <span class="pre">;&quot;</span></code> return <code class="docutils literal notranslate"><span class="pre">2</span></code>. <code class="docutils literal notranslate"><span class="pre">True</span></code> by
default.</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The file name to use in error messages and stack traces. <code class="docutils literal notranslate"><span class="pre">'&lt;exec&gt;'</span></code> by
default.</p></li>
<li><p><strong>flags</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The flags to compile with. See the documentation for the built-in
<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the last nonwhitespace character of <code class="docutils literal notranslate"><span class="pre">source</span></code> is a semicolon, return
<code class="docutils literal notranslate"><span class="pre">None</span></code>. If the last statement is an expression, return the result of the
expression. Use the <code class="docutils literal notranslate"><span class="pre">return_mode</span></code> and <code class="docutils literal notranslate"><span class="pre">quiet_trailing_semicolon</span></code>
parameters to modify this default behavior.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;1 + 1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;1 + 1;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">quiet_trailing_semicolon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">quiet_trailing_semicolon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_globals</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span> <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_locals</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span> <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;print(locals()[&#39;y&#39;], globals()[&#39;y&#39;])&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="n">my_globals</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="n">my_locals</span><span class="p">)</span>
<span class="go">200 100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;test = 1 + 1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">return_mode</span><span class="o">=</span><span class="s2">&quot;last_expr_or_assign&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">return_mode</span><span class="o">=</span><span class="s2">&quot;last_expr&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">return_mode</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;print(pyodide)&quot;</span> <span class="c1"># Pretend this is open(&#39;example_of_filename.py&#39;, &#39;r&#39;).read()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_code</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example_of_filename.py&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;example_of_filename.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span>    <span class="nb">print</span><span class="p">(</span><span class="n">pyodide</span><span class="p">)</span>
<span class="w">              </span><span class="pm">^^^^^^^</span>
<span class="gr">NameError</span>: <span class="n">name &#39;pyodide&#39; is not defined</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dont_inherit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>)</p></li>
<li><p><strong>optimize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.eval_code_async">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">eval_code_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'last_expr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet_trailing_semicolon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;exec&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_inherit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.eval_code_async" title="Link to this definition">#</a></dt>
<dd><p>Runs a code string asynchronously.</p>
<p>Uses <a class="reference external" href="https://docs.python.org/3.12/library/ast.html#ast.PyCF_ALLOW_TOP_LEVEL_AWAIT" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">ast.PyCF_ALLOW_TOP_LEVEL_AWAIT</span></code></a> to compile the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The Python source code to run.</p></li>
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The global scope in which to execute code. This is used as the
<code class="docutils literal notranslate"><span class="pre">globals</span></code> parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">globals</span></code> is absent, a new
empty dictionary is used.</p></li>
<li><p><strong>locals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The local scope in which to execute code. This is used as the <code class="docutils literal notranslate"><span class="pre">locals</span></code>
parameter for <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#exec" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">locals</span></code> is absent, the value of
<code class="docutils literal notranslate"><span class="pre">globals</span></code> is used.</p></li>
<li><p><strong>return_mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'last_expr'</span></code>, <code class="docutils literal notranslate"><span class="pre">'last_expr_or_assign'</span></code>, <code class="docutils literal notranslate"><span class="pre">'none'</span></code>]</span>) – <p>Specifies what should be returned. The options are:</p>
<dl class="field-list simple">
<dt class="field-odd">’last_expr’<span class="colon">:</span></dt>
<dd class="field-odd"><p>return the last expression</p>
</dd>
<dt class="field-even">’last_expr_or_assign’<span class="colon">:</span></dt>
<dd class="field-even"><p>return the last expression or the last
assignment.</p>
</dd>
<dt class="field-odd">’none’<span class="colon">:</span></dt>
<dd class="field-odd"><p>always return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</p></li>
<li><p><strong>quiet_trailing_semicolon</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Specifies whether a trailing semicolon should suppress the result or
not. When this is <code class="docutils literal notranslate"><span class="pre">True</span></code> executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1</span> <span class="pre">;&quot;</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, when
it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, executing <code class="docutils literal notranslate"><span class="pre">&quot;1+1</span> <span class="pre">;&quot;</span></code> return <code class="docutils literal notranslate"><span class="pre">2</span></code>. <code class="docutils literal notranslate"><span class="pre">True</span></code> by
default.</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The file name to use in error messages and stack traces. <code class="docutils literal notranslate"><span class="pre">'&lt;exec&gt;'</span></code> by
default.</p></li>
<li><p><strong>flags</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The flags to compile with. See the documentation for the built-in
<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
<li><p><strong>dont_inherit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>)</p></li>
<li><p><strong>optimize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the last nonwhitespace character of <code class="docutils literal notranslate"><span class="pre">source</span></code> is a semicolon, return
<code class="docutils literal notranslate"><span class="pre">None</span></code>. If the last statement is an expression, return the result of
the expression. Use the <code class="docutils literal notranslate"><span class="pre">return_mode</span></code> and <code class="docutils literal notranslate"><span class="pre">quiet_trailing_semicolon</span></code>
parameters to modify this default behavior.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.find_imports">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">find_imports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.find_imports" title="Link to this definition">#</a></dt>
<dd><p>Finds the imports in a Python source code string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The Python source code to inspect for imports.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A list of module names that are imported in <code class="docutils literal notranslate"><span class="pre">source</span></code>. If <code class="docutils literal notranslate"><span class="pre">source</span></code> is
not syntactically correct Python code (after dedenting), returns an
empty list.</p>
<p>Given <cite>import package.module</cite>, <cite>find_imports</cite> will include both
<cite>“package”</cite> and <cite>“package.module”</cite> in the result.</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;import numpy as np; import scipy.stats&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_imports</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="go">[&#39;numpy&#39;, &#39;scipy&#39;, &#39;scipy.stats&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.relaxed_call">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">relaxed_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.relaxed_call" title="Link to this definition">#</a></dt>
<dd><p>Call the function ignoring extra arguments</p>
<p>If extra positional or keyword arguments are provided they will be
discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/constants.html#Ellipsis" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>, <code class="docutils literal notranslate"><span class="pre">RetType</span></code>]</span>)</p></li>
<li><p><strong>args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p></li>
<li><p><strong>kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">RetType</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.relaxed_wrap">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">relaxed_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.relaxed_wrap" title="Link to this definition">#</a></dt>
<dd><p>Decorator which creates a function that ignores extra arguments</p>
<p>If extra positional or keyword arguments are provided they will be
discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.ParamSpec" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamSpec</span></code></a>(<code class="docutils literal notranslate"><span class="pre">Param</span></code>, bound= <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)], <code class="docutils literal notranslate"><span class="pre">RetType</span></code>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/constants.html#Ellipsis" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>, <code class="docutils literal notranslate"><span class="pre">RetType</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.run_js">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">run_js</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.run_js" title="Link to this definition">#</a></dt>
<dd><p>A wrapper for the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">eval()</span></code></a> function.</p>
<p>Runs <code class="docutils literal notranslate"><span class="pre">code</span></code> as a Javascript code string and returns the result. Unlike
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">eval()</span></code></a>, if <code class="docutils literal notranslate"><span class="pre">code</span></code> is not a string we raise a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#TypeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>code</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.code.should_quiet">
<span class="sig-prename descclassname"><span class="pre">pyodide.code.</span></span><span class="sig-name descname"><span class="pre">should_quiet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.code.should_quiet" title="Link to this definition">#</a></dt>
<dd><p>Should we suppress output?</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the last nonwhitespace character of <code class="docutils literal notranslate"><span class="pre">source</span></code> is a semicolon.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">should_quiet</span><span class="p">(</span><span class="s1">&#39;1 + 1&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">should_quiet</span><span class="p">(</span><span class="s1">&#39;1 + 1 ;&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">should_quiet</span><span class="p">(</span><span class="s1">&#39;1 + 1 # comment ;&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-usage/api/python-api/console"></span><section id="module-pyodide.console">
<span id="pyodide-console"></span><h6>pyodide.console<a class="headerlink" href="#module-pyodide.console" title="Link to this heading">#</a></h6>
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.console.Console" title="pyodide.console.Console"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Console</span></code></a>([globals, stdin_callback, ...])</p></td>
<td><p>Interactive Pyodide console</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.console.ConsoleFuture" title="pyodide.console.ConsoleFuture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConsoleFuture</span></code></a>(syntax_check)</p></td>
<td><p>A future with extra fields used as the return value for <a class="reference internal" href="#pyodide.console.Console" title="pyodide.console.Console"><code class="xref py py-class docutils literal notranslate"><span class="pre">Console</span></code></a> apis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.console.PyodideConsole" title="pyodide.console.PyodideConsole"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyodideConsole</span></code></a>([globals, stdin_callback, ...])</p></td>
<td><p>A subclass of <a class="reference internal" href="#pyodide.console.Console" title="pyodide.console.Console"><code class="xref py py-class docutils literal notranslate"><span class="pre">Console</span></code></a> that uses <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports()</span></code></a> before running the code.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.console.repr_shorten" title="pyodide.console.repr_shorten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repr_shorten</span></code></a>(value[, limit, split, separator])</p></td>
<td><p>Compute the string representation of <code class="docutils literal notranslate"><span class="pre">value</span></code> and shorten it if necessary.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyodide.console.Console">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.console.</span></span><span class="sig-name descname"><span class="pre">Console</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdin_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderr_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistent_stream_redirection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;console&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_inherit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console" title="Link to this definition">#</a></dt>
<dd><p>Interactive Pyodide console</p>
<p>An interactive console based on the Python standard library
<a class="reference external" href="https://docs.python.org/3.12/library/code.html#code.InteractiveConsole" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">InteractiveConsole</span></code></a> that manages stream redirections and
asynchronous execution of the code.</p>
<p>The stream callbacks can be modified directly by assigning to
<a class="reference internal" href="#pyodide.console.Console.stdin_callback" title="pyodide.console.Console.stdin_callback"><code class="xref py py-attr docutils literal notranslate"><span class="pre">stdin_callback</span></code></a> (for example) as long as
<code class="docutils literal notranslate"><span class="pre">persistent_stream_redirection</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The global namespace in which to evaluate the code. Defaults to a new
empty dictionary.</p></li>
<li><p><strong>stdin_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Function to call at each read from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdin</span></code></a>. Defaults to <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>stdout_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Function to call at each write to <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdout</span></code></a>. Defaults to <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>stderr_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Function to call at each write to <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stderr" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>. Defaults to <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>persistent_stream_redirection</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Should redirection of standard streams be kept between calls to
<a class="reference internal" href="#pyodide.console.Console.runcode" title="pyodide.console.Console.runcode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">runcode()</span></code></a>? Defaults to <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The file name to report in error messages. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&lt;console&gt;&quot;</span></code>.</p></li>
<li><p><strong>dont_inherit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to inherit <code class="docutils literal notranslate"><span class="pre">__future__</span></code> imports from the outer code.
See the documentation for the built-in <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
<li><p><strong>optimize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Specifies the optimization level of the compiler. See the documentation
for the built-in <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#compile" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> function.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.buffer">
<span class="sig-name descname"><span class="pre">buffer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#pyodide.console.Console.buffer" title="Link to this definition">#</a></dt>
<dd><p>The list of lines of code that have been the argument to
<a class="reference internal" href="#pyodide.console.Console.push" title="pyodide.console.Console.push"><code class="xref py py-meth docutils literal notranslate"><span class="pre">push()</span></code></a>.</p>
<p>This is emptied whenever the code is executed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.complete">
<span class="sig-name descname"><span class="pre">complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.complete" title="Link to this definition">#</a></dt>
<dd><p>Use Python’s <a class="reference external" href="https://docs.python.org/3.12/library/rlcompleter.html#module-rlcompleter" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rlcompleter</span></code></a> to complete the source string
using the <a class="reference internal" href="#pyodide.console.Console.globals" title="pyodide.console.Console.globals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Console.globals</span></code></a> namespace.</p>
<p>Finds the last “word” in the source string and completes it with
rlcompleter. Word breaks are determined by the set of characters in
<a class="reference internal" href="#pyodide.console.Console.completer_word_break_characters" title="pyodide.console.Console.completer_word_break_characters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">completer_word_break_characters</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The source string to complete at the end.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>completions</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A list of completion strings.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The index where completion starts.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="s2">&quot;str.isa&quot;</span><span class="p">)</span>
<span class="go">([&#39;str.isalnum(&#39;, &#39;str.isalpha(&#39;, &#39;str.isascii(&#39;], 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="s2">&quot;a = 5 ; str.isa&quot;</span><span class="p">)</span>
<span class="go">([&#39;str.isalnum(&#39;, &#39;str.isalpha(&#39;, &#39;str.isascii(&#39;], 8)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.completer_word_break_characters">
<span class="sig-name descname"><span class="pre">completer_word_break_characters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#pyodide.console.Console.completer_word_break_characters" title="Link to this definition">#</a></dt>
<dd><p>The set of characters considered by <a class="reference internal" href="#pyodide.console.Console.complete" title="pyodide.console.Console.complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complete()</span></code></a> to be word breaks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.formatsyntaxerror">
<span class="sig-name descname"><span class="pre">formatsyntaxerror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.formatsyntaxerror" title="Link to this definition">#</a></dt>
<dd><p>Format the syntax error that just occurred.</p>
<p>This doesn’t include a stack trace because there isn’t one. The actual
error object is stored into <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_value" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_value</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>e</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#Exception" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.formattraceback">
<span class="sig-name descname"><span class="pre">formattraceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.formattraceback" title="Link to this definition">#</a></dt>
<dd><p>Format the exception that just occurred.</p>
<p>The actual error object is stored into <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.last_value" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_value</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>e</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.globals">
<span class="sig-name descname"><span class="pre">globals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#pyodide.console.Console.globals" title="Link to this definition">#</a></dt>
<dd><p>The namespace used as the globals</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.persistent_redirect_streams">
<span class="sig-name descname"><span class="pre">persistent_redirect_streams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.persistent_redirect_streams" title="Link to this definition">#</a></dt>
<dd><p>Redirect <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdin</span></code></a>/<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdout</span></code></a>/<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdout</span></code></a> persistently</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.persistent_restore_streams">
<span class="sig-name descname"><span class="pre">persistent_restore_streams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.persistent_restore_streams" title="Link to this definition">#</a></dt>
<dd><p>Restore <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdin</span></code></a>/<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdout</span></code></a>/<a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">stdout</span></code></a> if they have been persistently redirected</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.push" title="Link to this definition">#</a></dt>
<dd><p>Push a line to the interpreter.</p>
<p>The line should not have a trailing newline; it may have internal
newlines.  The line is appended to a buffer and the interpreter’s
<a class="reference internal" href="#pyodide.console.Console.runsource" title="pyodide.console.Console.runsource"><code class="xref py py-meth docutils literal notranslate"><span class="pre">runsource()</span></code></a> method is called with the concatenated contents of the
buffer as source.  If this indicates that the command was executed or
invalid, the buffer is reset; otherwise, the command is incomplete, and
the buffer is left as it was after the line was appended.</p>
<p>The return value is the result of calling <a class="reference internal" href="#pyodide.console.Console.runsource" title="pyodide.console.Console.runsource"><code class="xref py py-meth docutils literal notranslate"><span class="pre">runsource()</span></code></a> on the current buffer
contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.console.ConsoleFuture" title="pyodide.console.ConsoleFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConsoleFuture</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.redirect_streams">
<span class="sig-name descname"><span class="pre">redirect_streams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.redirect_streams" title="Link to this definition">#</a></dt>
<dd><p>A context manager to redirect standard streams.</p>
<p>This supports nesting.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.runcode">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">runcode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.runcode" title="Link to this definition">#</a></dt>
<dd><p>Execute a code object and return the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
<li><p><strong>code</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.code.CodeRunner" title="_pyodide._base.CodeRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">CodeRunner</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.console.Console.runsource">
<span class="sig-name descname"><span class="pre">runsource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;console&gt;'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.Console.runsource" title="Link to this definition">#</a></dt>
<dd><p>Compile and run source code in the interpreter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.console.ConsoleFuture" title="pyodide.console.ConsoleFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConsoleFuture</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.stderr_callback">
<span class="sig-name descname"><span class="pre">stderr_callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a><span class="pre">[[</span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">],</span> <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#pyodide.console.Console.stderr_callback" title="Link to this definition">#</a></dt>
<dd><p>Function to call at each write to <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stderr" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.stdin_callback">
<span class="sig-name descname"><span class="pre">stdin_callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a><span class="pre">[[</span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">],</span> <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#pyodide.console.Console.stdin_callback" title="Link to this definition">#</a></dt>
<dd><p>The function to call at each read from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdin</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.Console.stdout_callback">
<span class="sig-name descname"><span class="pre">stdout_callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a><span class="pre">[[</span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">],</span> <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#pyodide.console.Console.stdout_callback" title="Link to this definition">#</a></dt>
<dd><p>Function to call at each write to <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdout</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.console.ConsoleFuture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.console.</span></span><span class="sig-name descname"><span class="pre">ConsoleFuture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syntax_check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.ConsoleFuture" title="Link to this definition">#</a></dt>
<dd><p>A future with extra fields used as the return value for <a class="reference internal" href="#pyodide.console.Console" title="pyodide.console.Console"><code class="xref py py-class docutils literal notranslate"><span class="pre">Console</span></code></a> apis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>syntax_check</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'incomplete'</span></code>, <code class="docutils literal notranslate"><span class="pre">'syntax-error'</span></code>, <code class="docutils literal notranslate"><span class="pre">'complete'</span></code>]</span>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.ConsoleFuture.formatted_error">
<span class="sig-name descname"><span class="pre">formatted_error</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#pyodide.console.ConsoleFuture.formatted_error" title="Link to this definition">#</a></dt>
<dd><p>If the <code class="docutils literal notranslate"><span class="pre">Future</span></code> is rejected, this will be filled with a formatted version of
the code. This is a convenience that simplifies code and helps to avoid large
memory leaks when using from JavaScript.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.console.ConsoleFuture.syntax_check">
<span class="sig-name descname"><span class="pre">syntax_check</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'incomplete'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'syntax-error'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'complete'</span></code><span class="pre">]</span></em><a class="headerlink" href="#pyodide.console.ConsoleFuture.syntax_check" title="Link to this definition">#</a></dt>
<dd><p>The status of the future. The values mean the following:</p>
<dl class="field-list simple">
<dt class="field-odd">‘incomplete’<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input is incomplete. The future has already been resolved
with result <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">‘syntax-error’<span class="colon">:</span></dt>
<dd class="field-even"><p>Input contained a syntax error. The future has been
rejected with a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>.</p>
</dd>
<dt class="field-odd">‘complete’<span class="colon">:</span></dt>
<dd class="field-odd"><p>The input complete and syntactically correct and asynchronous
execution has begun. When the execution is done, the Future will
be resolved with the result or rejected with an exception.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.console.PyodideConsole">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.console.</span></span><span class="sig-name descname"><span class="pre">PyodideConsole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">globals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdin_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderr_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistent_stream_redirection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;console&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_inherit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.PyodideConsole" title="Link to this definition">#</a></dt>
<dd><p>A subclass of <a class="reference internal" href="#pyodide.console.Console" title="pyodide.console.Console"><code class="xref py py-class docutils literal notranslate"><span class="pre">Console</span></code></a> that uses <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports()</span></code></a> before running the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>globals</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>stdin_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>stdout_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>stderr_callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>persistent_stream_redirection</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>)</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
<li><p><strong>dont_inherit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>)</p></li>
<li><p><strong>optimize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.console.repr_shorten">
<span class="sig-prename descclassname"><span class="pre">pyodide.console.</span></span><span class="sig-name descname"><span class="pre">repr_shorten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'...'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.console.repr_shorten" title="Link to this definition">#</a></dt>
<dd><p>Compute the string representation of <code class="docutils literal notranslate"><span class="pre">value</span></code> and shorten it
if necessary.</p>
<p>This is equivalent to <code class="docutils literal notranslate"><span class="pre">shorten(repr(value),</span> <span class="pre">limit,</span> <span class="pre">split,</span> <span class="pre">separator)</span></code>, but
a value error is raised if <code class="docutils literal notranslate"><span class="pre">limit</span></code> is less than <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">repr_shorten</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">repr_shorten</span><span class="p">(</span><span class="s2">&quot;abcdefg&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<span class="go">&quot;&#39;abc_efg&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">repr_shorten</span><span class="p">(</span><span class="s2">&quot;abcdefg&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<span class="go">&quot;&#39;abcdefg&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">repr_shorten</span><span class="p">(</span><span class="mi">123456789</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
<span class="go">&#39;12_89&#39;</span>
<span class="go">&#39;12_89&#39;</span>
<span class="go">&#39;123_789&#39;</span>
<span class="go">&#39;123_789&#39;</span>
<span class="go">&#39;1234_6789&#39;</span>
<span class="go">&#39;123456789&#39;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p></li>
<li><p><strong>limit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
<li><p><strong>split</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>separator</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-usage/api/python-api/ffi"></span><section id="module-pyodide.ffi">
<span id="pyodide-ffi"></span><h6>pyodide.ffi<a class="headerlink" href="#module-pyodide.ffi" title="Link to this heading">#</a></h6>
<p><strong>Exceptions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.ConversionError" title="pyodide.ffi.ConversionError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConversionError</span></code></a></p></td>
<td><p>An error thrown when conversion between JavaScript and Python fails.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsException" title="pyodide.ffi.JsException"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsException</span></code></a>(*args, **kwargs)</p></td>
<td><p>A JavaScript Error.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsArray</span></code></a>()</p></td>
<td><p>A JsProxy of an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">NodeList</span></code></a>, or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsAsyncGenerator" title="pyodide.ffi.JsAsyncGenerator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsAsyncGenerator</span></code></a>()</p></td>
<td><p>A JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsAsyncIterable" title="pyodide.ffi.JsAsyncIterable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsAsyncIterable</span></code></a>()</p></td>
<td><p>A JavaScript async iterable object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsAsyncIterator" title="pyodide.ffi.JsAsyncIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsAsyncIterator</span></code></a>()</p></td>
<td><p>A JsProxy of a JavaScript async iterator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsBuffer" title="pyodide.ffi.JsBuffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsBuffer</span></code></a>()</p></td>
<td><p>A JsProxy of an array buffer or array buffer view</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsCallable" title="pyodide.ffi.JsCallable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsCallable</span></code></a>()</p></td>
<td><p>A JavaScript callable</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsDomElement" title="pyodide.ffi.JsDomElement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsDomElement</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsDoubleProxy" title="pyodide.ffi.JsDoubleProxy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsDoubleProxy</span></code></a>()</p></td>
<td><p>A double proxy created with <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsFetchResponse" title="pyodide.ffi.JsFetchResponse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsFetchResponse</span></code></a>()</p></td>
<td><p>A <a class="reference internal" href="#pyodide.ffi.JsFetchResponse" title="pyodide.ffi.JsFetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsFetchResponse</span></code></a> object represents a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Response</span></code></a> to a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">fetch()</span></code></a> request.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsGenerator" title="pyodide.ffi.JsGenerator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsGenerator</span></code></a>()</p></td>
<td><p>A JavaScript generator</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsIterable" title="pyodide.ffi.JsIterable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsIterable</span></code></a>()</p></td>
<td><p>A JavaScript iterable object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsIterator" title="pyodide.ffi.JsIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsIterator</span></code></a>()</p></td>
<td><p>A JsProxy of a JavaScript iterator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsMap" title="pyodide.ffi.JsMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsMap</span></code></a>()</p></td>
<td><p>A JavaScript Map</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsMutableMap" title="pyodide.ffi.JsMutableMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsMutableMap</span></code></a>()</p></td>
<td><p>A JavaScript mutable map</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsOnceCallable" title="pyodide.ffi.JsOnceCallable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsOnceCallable</span></code></a>()</p></td>
<td><p>A JavaScript handle for a Python function which can be called at most once.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsPromise" title="pyodide.ffi.JsPromise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsPromise</span></code></a>()</p></td>
<td><p>A <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> or some other <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables">thenable</a> JavaScript object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsProxy</span></code></a>()</p></td>
<td><p>A proxy to make a JavaScript object behave like a Python object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.JsTypedArray" title="pyodide.ffi.JsTypedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JsTypedArray</span></code></a>()</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.create_once_callable" title="pyodide.ffi.create_once_callable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_once_callable</span></code></a>(obj, /)</p></td>
<td><p>Wrap a Python Callable in a JavaScript function that can be called once.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_proxy</span></code></a>(obj, /, *[, capture_this, ...])</p></td>
<td><p>Create a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.destroy_proxies" title="pyodide.ffi.destroy_proxies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">destroy_proxies</span></code></a>(pyproxies, /)</p></td>
<td><p>Destroy all PyProxies in a JavaScript array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_js_module</span></code></a>(name, jsproxy)</p></td>
<td><p>Registers <code class="docutils literal notranslate"><span class="pre">jsproxy</span></code> as a JavaScript module named <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.run_sync" title="pyodide.ffi.run_sync"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_sync</span></code></a>(x)</p></td>
<td><p>Block until an awaitable is resolved.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_js</span></code></a>(obj, /, *[, depth, pyproxies, ...])</p></td>
<td><p>Convert the object to JavaScript.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.unregister_js_module" title="pyodide.ffi.unregister_js_module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unregister_js_module</span></code></a>(name)</p></td>
<td><p>Unregisters a JavaScript module with given name that has been previously registered with <a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a> or <a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.ffi.register_js_module()</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py exception">
<dt class="sig sig-object py" id="pyodide.ffi.ConversionError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">ConversionError</span></span><a class="headerlink" href="#pyodide.ffi.ConversionError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#Exception" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>An error thrown when conversion between JavaScript and Python fails.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsArray</span></span><a class="headerlink" href="#pyodide.ffi.JsArray" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsIterable" title="pyodide.ffi.JsIterable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsIterable</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.MutableSequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A JsProxy of an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">NodeList</span></code></a>, or <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TypedArray</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.append" title="Link to this definition">#</a></dt>
<dd><p>Append object to the end of the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>object</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.count" title="Link to this definition">#</a></dt>
<dd><p>Return the number of times x appears in the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.extend">
<span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.extend" title="Link to this definition">#</a></dt>
<dd><p>Extend array by appending elements from the iterable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T</span></code>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.index" title="Link to this definition">#</a></dt>
<dd><p>Return first <code class="docutils literal notranslate"><span class="pre">index</span></code> at which <code class="docutils literal notranslate"><span class="pre">value</span></code> appears in the <code class="docutils literal notranslate"><span class="pre">Array</span></code>.</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> if the value is not present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p></li>
<li><p><strong>start</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
<li><p><strong>stop</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.insert" title="Link to this definition">#</a></dt>
<dd><p>Insert an item at a given position.</p>
<p>The first argument is the index of the element before which to insert,
so <code class="docutils literal notranslate"><span class="pre">a.insert(0,</span> <span class="pre">x)</span></code> inserts at the front of the list, and
<code class="docutils literal notranslate"><span class="pre">a.insert(len(a),</span> <span class="pre">x)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">a.append(x)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.pop" title="Link to this definition">#</a></dt>
<dd><p>Remove and return the <code class="docutils literal notranslate"><span class="pre">item</span></code> at <code class="docutils literal notranslate"><span class="pre">index</span></code> (default last).</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#IndexError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IndexError</span></code></a> if list is empty or index is out of range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.remove" title="Link to this definition">#</a></dt>
<dd><p>Remove the first item from the list whose value is equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>It raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> if there is no such item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.reverse">
<span class="sig-name descname"><span class="pre">reverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.reverse" title="Link to this definition">#</a></dt>
<dd><p>Reverse the array in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsArray.to_py">
<span class="sig-name descname"><span class="pre">to_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_converter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsArray.to_py" title="Link to this definition">#</a></dt>
<dd><p>Convert the <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> to a native Python object as best as
possible.</p>
<p>See <a class="reference internal" href="#type-translations-jsproxy-to-py"><span class="std std-ref">JavaScript to Python</span></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Limit the depth of the conversion. If a shallow conversion is
desired, set <code class="docutils literal notranslate"><span class="pre">depth</span></code> to 1.</p></li>
<li><p><strong>default_converter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – If present, this will be invoked whenever Pyodide does not have some
built in conversion for the object. If <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> raises
an error, the error will be allowed to propagate. Otherwise, the
object returned will be used as the conversion.
<code class="docutils literal notranslate"><span class="pre">default_converter</span></code> takes three arguments. The first argument is
the value to be converted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Here are a couple examples of converter functions. In addition to the
normal conversions, convert <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Date</span></code></a> to <a class="reference external" href="https://docs.python.org/3.12/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Date&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">valueOf</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
<p>Don’t create any JsProxies, require a complete conversion or raise an error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">_value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to completely convert object&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second and third arguments are only needed for converting
containers. The second argument is a conversion function which is used
to convert the elements of the container with the same settings. The
third argument is a “cache” function which is needed to handle self
referential containers. Consider the following example. Suppose we have
a Javascript <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Pair</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span><span class="w"> </span><span class="nx">second</span><span class="p">){</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">first</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">second</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">second</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can use the following <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> to convert <code class="docutils literal notranslate"><span class="pre">Pair</span></code> to <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Pair&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cache</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">first</span><span class="p">))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">second</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Note that we have to cache the conversion of <code class="docutils literal notranslate"><span class="pre">value</span></code> before converting
<code class="docutils literal notranslate"><span class="pre">value.first</span></code> and <code class="docutils literal notranslate"><span class="pre">value.second</span></code>. To see why, consider a self
referential pair:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Pair</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">;</span>
</pre></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">cache(value,</span> <span class="pre">result);</span></code>, converting <code class="docutils literal notranslate"><span class="pre">p</span></code> would lead to an
infinite recurse. With it, we can successfully convert <code class="docutils literal notranslate"><span class="pre">p</span></code> to a list
such that <code class="docutils literal notranslate"><span class="pre">l[0]</span> <span class="pre">is</span> <span class="pre">l</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsAsyncGenerator</span></span><a class="headerlink" href="#pyodide.ffi.JsAsyncGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsAsyncIterable" title="pyodide.ffi.JsAsyncIterable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsAsyncIterable</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">T_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">V_co</span></code>]</p>
<p>A JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AsyncGenerator</span></code></a></p>
<p>A JavaScript object is treated as an async generator if it’s
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.toStringTag</span></code></a> is <code class="docutils literal notranslate"><span class="pre">&quot;AsyncGenerator&quot;</span></code>. Most likely this will
be because it is a true async generator produced by the JavaScript runtime,
but it may be a custom object trying hard to pretend to be an async
generator. It should have <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator/next" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">next()</span></code></a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator/return" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">return()</span></code></a>, and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator/throw" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">throw()</span></code></a>
methods.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncGenerator.aclose">
<span class="sig-name descname"><span class="pre">aclose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsAsyncGenerator.aclose" title="Link to this definition">#</a></dt>
<dd><p>Raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> at the point where the generator
function was paused.</p>
<p>If the generator function then exits gracefully, is already closed, or
raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> (by not catching the exception),
<code class="docutils literal notranslate"><span class="pre">aclose()</span></code> returns to its caller. If the generator yields a value, a
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> is raised. If the generator raises any other
exception, it is propagated to the caller. <code class="docutils literal notranslate"><span class="pre">aclose()</span></code> does nothing if
the generator has already exited due to an exception or normal exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncGenerator.asend">
<span class="sig-name descname"><span class="pre">asend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsAsyncGenerator.asend" title="Link to this definition">#</a></dt>
<dd><p>Resumes the execution and “sends” a value into the async generator
function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> argument becomes the result of the current yield
expression. The awaitable returned by the <code class="docutils literal notranslate"><span class="pre">asend()</span></code> method will return
the next value yielded by the generator or raises
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopAsyncIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopAsyncIteration</span></code></a> if the asynchronous generator returns. If the
generator returned a value, this value is discarded (because in Python
async generators cannot return a value).</p>
<p>When <code class="docutils literal notranslate"><span class="pre">asend()</span></code> is called to start the generator, the argument will be
ignored. Unlike in Python, we cannot detect that the generator hasn’t
started yet, and no error will be thrown if the argument of a
not-started generator is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T_contra</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T_co</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncGenerator.athrow">
<span class="sig-name descname"><span class="pre">athrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsAsyncGenerator.athrow" title="Link to this definition">#</a></dt>
<dd><p>Resumes the execution and raises an exception at the point where the
generator was paused.</p>
<p>The awaitable returned by <code class="docutils literal notranslate"><span class="pre">athrow()</span></code> method will return the next value
yielded by the generator or raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopAsyncIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopAsyncIteration</span></code></a> if the
asynchronous generator returns. If the generator returned a value, this
value is discarded (because in Python async generators cannot return a
value). If the generator function does not catch the passed-in
exception, or raises a different exception, then that exception
propagates to the caller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>error</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T_co</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncIterable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsAsyncIterable</span></span><a class="headerlink" href="#pyodide.ffi.JsAsyncIterable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>A JavaScript async iterable object</p>
<p>A JavaScript object is async iterable if it has a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/asyncIterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.asyncIterator</span></code></a>
method.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsAsyncIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsAsyncIterator</span></span><a class="headerlink" href="#pyodide.ffi.JsAsyncIterator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>A JsProxy of a JavaScript async iterator.</p>
<p>An object is a <a class="reference internal" href="#pyodide.ffi.JsAsyncIterator" title="pyodide.ffi.JsAsyncIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsAsyncIterator</span></code></a> if it has a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next_2" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">next()</span></code></a> method and either has a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/asyncIterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.asyncIterator</span></code></a> or has no <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.iterator</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsBuffer</span></span><a class="headerlink" href="#pyodide.ffi.JsBuffer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></p>
<p>A JsProxy of an array buffer or array buffer view</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.assign" title="Link to this definition">#</a></dt>
<dd><p>Assign from a Python buffer into the JavaScript buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rhs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.assign_to">
<span class="sig-name descname"><span class="pre">assign_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.assign_to" title="Link to this definition">#</a></dt>
<dd><p>Assign to a Python buffer from the JavaScript buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.from_file" title="Link to this definition">#</a></dt>
<dd><p>Reads from a file into a buffer.</p>
<p>Will try to read a chunk of data the same size as the buffer from
the current position of the file.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;file.bin&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc</span><span class="se">\x00</span><span class="s2">123ttt&quot;</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Uint8Array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the JsProxy need to be pre-allocated</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Uint8Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">x</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
<p>which is equivalent to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Uint8Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">chunk</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">byteLength</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">x</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</pre></div>
</div>
<p>but the latter copies the data twice whereas the former only copies the
data once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.IO" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IO</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.IO" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IO</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.to_bytes">
<span class="sig-name descname"><span class="pre">to_bytes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.to_bytes" title="Link to this definition">#</a></dt>
<dd><p>Convert a buffer to a bytes object.</p>
<p>Copies the data once.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.to_file" title="Link to this definition">#</a></dt>
<dd><p>Writes a buffer to a file.</p>
<p>Will write the entire contents of the buffer to the current position of
the file.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Uint8Array</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;file.bin&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc</span><span class="se">\x00</span><span class="s2">123ttt&quot;</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Uint8Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">x</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
<p>This is equivalent to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">data</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
<p>but the latter copies the data twice whereas the former only copies the
data once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.IO" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IO</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.IO" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IO</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.to_memoryview">
<span class="sig-name descname"><span class="pre">to_memoryview</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.to_memoryview" title="Link to this definition">#</a></dt>
<dd><p>Convert a buffer to a memoryview.</p>
<p>Copies the data once. This currently has the same effect as
<a class="reference internal" href="#pyodide.ffi.JsArray.to_py" title="pyodide.ffi.JsArray.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_py()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#memoryview" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsBuffer.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsBuffer.to_string" title="Link to this definition">#</a></dt>
<dd><p>Convert a buffer to a string object.</p>
<p>Copies the data twice.</p>
<p>The encoding argument will be passed to the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TextDecoder" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">TextDecoder</span></code></a>
constructor. It should be one of the encodings listed in <a class="reference external" href="https://encoding.spec.whatwg.org/#names-and-labels">the table here</a>. The default
encoding is utf8.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>encoding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsCallable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsCallable</span></span><a class="headerlink" href="#pyodide.ffi.JsCallable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">P</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A JavaScript callable</p>
<p>A JavaScript object is treated as a callable if <cite>typeof x</cite> returns
<cite>“function”</cite>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsDomElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsDomElement</span></span><a class="headerlink" href="#pyodide.ffi.JsDomElement" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsDoubleProxy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsDoubleProxy</span></span><a class="headerlink" href="#pyodide.ffi.JsDoubleProxy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A double proxy created with <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsDoubleProxy.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsDoubleProxy.destroy" title="Link to this definition">#</a></dt>
<dd><p>Destroy the proxy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsDoubleProxy.unwrap">
<span class="sig-name descname"><span class="pre">unwrap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsDoubleProxy.unwrap" title="Link to this definition">#</a></dt>
<dd><p>Unwrap a double proxy created with <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a> into the
wrapped Python object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyodide.ffi.JsException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsException" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#Exception" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>A JavaScript Error.</p>
<p>These are pickleable unlike other JsProxies.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.ffi.JsException.message">
<span class="sig-name descname"><span class="pre">message</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#pyodide.ffi.JsException.message" title="Link to this definition">#</a></dt>
<dd><p>The error message</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.ffi.JsException.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#pyodide.ffi.JsException.name" title="Link to this definition">#</a></dt>
<dd><p>The name of the error type</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsException.new">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsException.new" title="Link to this definition">#</a></dt>
<dd><p>Construct a new instance of the JavaScript object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsException" title="pyodide.ffi.JsException"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsException</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyodide.ffi.JsException.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#pyodide.ffi.JsException.stack" title="Link to this definition">#</a></dt>
<dd><p>The JavaScript stack trace</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsFetchResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsFetchResponse</span></span><a class="headerlink" href="#pyodide.ffi.JsFetchResponse" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></p>
<p>A <a class="reference internal" href="#pyodide.ffi.JsFetchResponse" title="pyodide.ffi.JsFetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsFetchResponse</span></code></a> object represents a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Response</span></code></a> to a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">fetch()</span></code></a> request.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsGenerator</span></span><a class="headerlink" href="#pyodide.ffi.JsGenerator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsIterable" title="pyodide.ffi.JsIterable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsIterable</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">T_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">V_co</span></code>]</p>
<p>A JavaScript generator</p>
<p>A JavaScript object is treated as a generator if its
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.toStringTag</span></code></a> is <code class="docutils literal notranslate"><span class="pre">&quot;Generator&quot;</span></code>. Most likely this will be
because it is a true <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Generator</span></code></a> produced by the JavaScript
runtime, but it may be a custom object trying hard to pretend to be a
generator. It should have <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/next" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">next()</span></code></a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/return" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">return()</span></code></a> and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator/throw" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">throw()</span></code></a> methods.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsGenerator.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsGenerator.close" title="Link to this definition">#</a></dt>
<dd><p>Raises a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> at the point where the generator
function was paused.</p>
<p>If the generator function then exits gracefully, is already closed, or
raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#GeneratorExit" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">GeneratorExit</span></code></a> (by not catching the exception), <code class="docutils literal notranslate"><span class="pre">close()</span></code>
returns to its caller. If the generator yields a value, a
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> is raised. If the generator raises any other
exception, it is propagated to the caller. <code class="docutils literal notranslate"><span class="pre">close()</span></code> does nothing if
the generator has already exited due to an exception or normal exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsGenerator.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsGenerator.send" title="Link to this definition">#</a></dt>
<dd><p>Resumes the execution and “sends” a value into the generator function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> argument becomes the result of the current yield
expression. The <code class="docutils literal notranslate"><span class="pre">send()</span></code> method returns the next value yielded by the
generator, or raises <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopIteration</span></code></a> if the generator exits without
yielding another value. When <code class="docutils literal notranslate"><span class="pre">send()</span></code> is called to start the
generator, the argument will be ignored. Unlike in Python, we cannot
detect that the generator hasn’t started yet, and no error will be
thrown if the argument of a not-started generator is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T_contra</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T_co</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsGenerator.throw">
<span class="sig-name descname"><span class="pre">throw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsGenerator.throw" title="Link to this definition">#</a></dt>
<dd><p>Raises an exception at the point where the generator was paused, and
returns the next value yielded by the generator function.</p>
<p>If the generator exits without yielding another value, a
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#StopIteration" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StopIteration</span></code></a> exception is raised. If the generator function does
not catch the passed-in exception, or raises a different exception, then
that exception propagates to the caller.</p>
<p>In typical use, this is called with a single exception instance similar
to the way the raise keyword is used.</p>
<p>For backwards compatibility, however, a second signature is supported,
following a convention from older versions of Python. The type argument
should be an exception class, and value should be an exception instance.
If the value is not provided, the type constructor is called to get an
instance. If traceback is provided, it is set on the exception,
otherwise any existing <code class="docutils literal notranslate"><span class="pre">__traceback__</span></code> attribute stored in value may
be cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>error</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T_co</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsIterable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsIterable</span></span><a class="headerlink" href="#pyodide.ffi.JsIterable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>A JavaScript iterable object</p>
<p>A JavaScript object is iterable if it has a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.iterator</span></code></a> method.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsIterator</span></span><a class="headerlink" href="#pyodide.ffi.JsIterator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>A JsProxy of a JavaScript iterator.</p>
<p>An object is a <a class="reference internal" href="#pyodide.ffi.JsAsyncIterator" title="pyodide.ffi.JsAsyncIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsAsyncIterator</span></code></a> if it has a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#next" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">next()</span></code></a> method and either has a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.iterator</span></code></a> or has no <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/asyncIterator" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Symbol.asyncIterator</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsMap</span></span><a class="headerlink" href="#pyodide.ffi.JsMap" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsIterable" title="pyodide.ffi.JsIterable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsIterable</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VT_co</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VT_co</span></code>]</p>
<p>A JavaScript Map</p>
<p>To be considered a map, a JavaScript object must have a <code class="docutils literal notranslate"><span class="pre">get</span></code> method, it
must have a <code class="docutils literal notranslate"><span class="pre">size</span></code> or a <code class="docutils literal notranslate"><span class="pre">length</span></code> property which is a number
(idiomatically it should be called <code class="docutils literal notranslate"><span class="pre">size</span></code>) and it must be iterable.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMap.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMap.get" title="Link to this definition">#</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">in</span> <span class="pre">self</span></code>, returns <code class="docutils literal notranslate"><span class="pre">self[key]</span></code>. Otherwise returns <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">KT</span></code></span>)</p></li>
<li><p><strong>default</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="docutils literal notranslate"><span class="pre">VT_co</span></code>]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">VT_co</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMap.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMap.items" title="Link to this definition">#</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.ItemsView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ItemsView</span></code></a> for the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.ItemsView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ItemsView</span></code></a>[<code class="docutils literal notranslate"><span class="pre">KT</span></code>, <code class="docutils literal notranslate"><span class="pre">VT_co</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMap.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMap.keys" title="Link to this definition">#</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.KeysView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">KeysView</span></code></a> for the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.KeysView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">KeysView</span></code></a>[<code class="docutils literal notranslate"><span class="pre">KT</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMap.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMap.values" title="Link to this definition">#</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.ValuesView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValuesView</span></code></a> for the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.ValuesView" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValuesView</span></code></a>[<code class="docutils literal notranslate"><span class="pre">VT_co</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsMutableMap</span></span><a class="headerlink" href="#pyodide.ffi.JsMutableMap" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsMap" title="pyodide.ffi.JsMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsMap</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VT</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VT</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.MutableMapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableMapping</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">KT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VT</span></code>]</p>
<p>A JavaScript mutable map</p>
<p>To be considered a mutable map, a JavaScript object must have a <code class="docutils literal notranslate"><span class="pre">get</span></code>
method, a <code class="docutils literal notranslate"><span class="pre">has</span></code> method, a <code class="docutils literal notranslate"><span class="pre">size</span></code> or a <code class="docutils literal notranslate"><span class="pre">length</span></code> property which is a
number (idiomatically it should be called <code class="docutils literal notranslate"><span class="pre">size</span></code>) and it must be iterable.</p>
<p>Instances of the JavaScript builtin <code class="docutils literal notranslate"><span class="pre">Map</span></code> class are <code class="docutils literal notranslate"><span class="pre">JsMutableMap</span></code> s.
Also proxies returned by <a class="reference internal" href="#pyodide.ffi.JsProxy.as_object_map" title="pyodide.ffi.JsProxy.as_object_map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JsProxy.as_object_map()</span></code></a> are instances of
<code class="docutils literal notranslate"><span class="pre">JsMap</span></code> .</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMutableMap.clear" title="Link to this definition">#</a></dt>
<dd><p>Empty out the map entirely.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMutableMap.pop" title="Link to this definition">#</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">in</span> <span class="pre">self</span></code>, return <code class="docutils literal notranslate"><span class="pre">self[key]</span></code> and remove key from <code class="docutils literal notranslate"><span class="pre">self</span></code>. Otherwise
returns <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">KT</span></code></span>)</p></li>
<li><p><strong>default</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="docutils literal notranslate"><span class="pre">VT</span></code>]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">VT</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap.popitem">
<span class="sig-name descname"><span class="pre">popitem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMutableMap.popitem" title="Link to this definition">#</a></dt>
<dd><p>Remove some arbitrary <code class="docutils literal notranslate"><span class="pre">key,</span> <span class="pre">value</span></code> pair from the map and returns the
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<code class="docutils literal notranslate"><span class="pre">KT</span></code>, <code class="docutils literal notranslate"><span class="pre">VT</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap.setdefault">
<span class="sig-name descname"><span class="pre">setdefault</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMutableMap.setdefault" title="Link to this definition">#</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">in</span> <span class="pre">self</span></code>, return <code class="docutils literal notranslate"><span class="pre">self[key]</span></code>. Otherwise
sets <code class="docutils literal notranslate"><span class="pre">self[key]</span> <span class="pre">=</span> <span class="pre">default</span></code> and returns <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">KT</span></code></span>)</p></li>
<li><p><strong>default</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="docutils literal notranslate"><span class="pre">VT</span></code>]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">VT</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsMutableMap.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsMutableMap.update" title="Link to this definition">#</a></dt>
<dd><p>Updates <code class="docutils literal notranslate"><span class="pre">self</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> and <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<code class="docutils literal notranslate"><span class="pre">KT</span></code>, <code class="docutils literal notranslate"><span class="pre">VT</span></code>] | <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<code class="docutils literal notranslate"><span class="pre">KT</span></code>, <code class="docutils literal notranslate"><span class="pre">VT</span></code>]]</span>) – Either a mapping or an iterable of pairs. This can be left out.</p></li>
<li><p><strong>kwargs</strong> (<code class="docutils literal notranslate"><span class="pre">VT</span></code>) – Extra key-values pairs to insert into the map. Only usable for
inserting extra strings.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">other</span></code> is present and is a <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a> or has a <code class="docutils literal notranslate"><span class="pre">keys</span></code>
method, does</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">other</span></code> is present and lacks a <code class="docutils literal notranslate"><span class="pre">keys</span></code> method, does</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</pre></div>
</div>
<p>In all cases this is followed by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsOnceCallable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsOnceCallable</span></span><a class="headerlink" href="#pyodide.ffi.JsOnceCallable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsCallable" title="pyodide.ffi.JsCallable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsCallable</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">P</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">P</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A JavaScript handle for a Python function which can be called at most
once.</p>
<p>After it is called, the reference to the underlying Python object is
released and attempting to call it again will raise an <cite>Error</cite>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsPromise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsPromise</span></span><a class="headerlink" href="#pyodide.ffi.JsPromise" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> or some other <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables">thenable</a>
JavaScript object.</p>
<p>A JavaScript object is considered to be a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Promise</span></code></a> if it has a <code class="docutils literal notranslate"><span class="pre">then</span></code> method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsPromise.catch">
<span class="sig-name descname"><span class="pre">catch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onrejected</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsPromise.catch" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Promise.catch()</span></code></a> API, wrapped to manage the lifetimes of the
handler.</p>
<p>Pyodide will automatically release the references to the handler
when the promise resolves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onrejected</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>], <code class="docutils literal notranslate"><span class="pre">S</span></code>]]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsPromise" title="pyodide.ffi.JsPromise"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsPromise</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsPromise.finally_">
<span class="sig-name descname"><span class="pre">finally_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfinally</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsPromise.finally_" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Promise.finally()</span></code></a> API, wrapped to manage the lifetimes of
the handler.</p>
<p>Pyodide will automatically release the references to the handler
when the promise resolves. Note the trailing underscore in the name;
this is needed because <code class="docutils literal notranslate"><span class="pre">finally</span></code> is a reserved keyword in Python.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onfinally</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsPromise" title="pyodide.ffi.JsPromise"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsPromise</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsPromise.then">
<span class="sig-name descname"><span class="pre">then</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfulfilled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onrejected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsPromise.then" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Promise.then()</span></code></a> API, wrapped to manage the lifetimes of the
handlers.
Pyodide will automatically release the references to the handlers
when the promise resolves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onfulfilled</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="docutils literal notranslate"><span class="pre">T</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>], <code class="docutils literal notranslate"><span class="pre">S</span></code>]] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
<li><p><strong>onrejected</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>], <code class="docutils literal notranslate"><span class="pre">S</span></code>]] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsPromise" title="pyodide.ffi.JsPromise"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsPromise</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsProxy</span></span><a class="headerlink" href="#pyodide.ffi.JsProxy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A proxy to make a JavaScript object behave like a Python object</p>
<p>For more information see the <a class="reference internal" href="#type-translations"><span class="std std-ref">Type translations</span></a> documentation. In
particular, see
<a class="reference internal" href="#type-translations-jsproxy"><span class="std std-ref">the list of __dunder__ methods</span></a>
that are (conditionally) implemented on <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.as_object_map">
<span class="sig-name descname"><span class="pre">as_object_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hereditary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.as_object_map" title="Link to this definition">#</a></dt>
<dd><p>Returns a new JsProxy that treats the object as a map.</p>
<p>The methods <a class="reference external" href="https://docs.python.org/3.12/library/operator.html#operator.__getitem__" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">__getitem__()</span></code></a>,
<a class="reference external" href="https://docs.python.org/3.12/library/operator.html#operator.__setitem__" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/operator.html#operator.__contains__" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">__contains__()</span></code></a>,
<a class="reference external" href="https://docs.python.org/3.12/reference/datamodel.html#object.__len__" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a>, etc will perform lookups via <code class="docutils literal notranslate"><span class="pre">object[key]</span></code>
or similar.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">len(x.as_object_map())</span></code> evaluates in O(n) time (it iterates
over the object and counts how many <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect/ownKeys" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">ownKeys()</span></code></a> it has).
If you need to compute the length in O(1) time, use a real
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Map</span></code></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hereditary</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, any “plain old objects” stored as values in the object
will be wrapped in <cite>as_object_map</cite> themselves.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsMutableMap" title="pyodide.ffi.JsMutableMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsMutableMap</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({x : </span><span class="si">{y: 2}</span><span class="s2">})&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Normally you have to access the properties of <code class="docutils literal notranslate"><span class="pre">o</span></code> as attributes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="c1"># is not subscriptable</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">TypeError</span>: <span class="n">&#39;pyodide.ffi.JsProxy&#39; object is not subscriptable</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">as_object_map</span></code> allows us to access the property with <code class="docutils literal notranslate"><span class="pre">getitem</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">as_object_map</span><span class="p">()[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The inner object is not subscriptable because <code class="docutils literal notranslate"><span class="pre">hereditary</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">as_object_map</span><span class="p">()[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">TypeError</span>: <span class="n">&#39;pyodide.ffi.JsProxy&#39; object is not subscriptable</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">hereditary</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the inner object is also subscriptable:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">as_object_map</span><span class="p">(</span><span class="n">hereditary</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.as_py_json">
<span class="sig-name descname"><span class="pre">as_py_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.as_py_json" title="Link to this definition">#</a></dt>
<dd><p>Returns a new JsProxy that treats a JavaScript object as Python json.</p>
<p>It allows one to treat a JavaScript object that is a mixture of
JavaScript arrays and objects as a mixture of Python lists and dicts.</p>
<p>This method is not present on typed arrays, array buffers, functions,
and errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference internal" href="#pyodide.ffi.JsMutableMap" title="pyodide.ffi.JsMutableMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsMutableMap</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">o1</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({x : </span><span class="si">{y: 2}</span><span class="s2">})&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o1</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">()[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o2</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">{x: 2}</span><span class="s2">, </span><span class="si">{x: 7}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">o2</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">()]</span>
<span class="go">[2, 7]</span>
</pre></div>
</div>
<p>You can use the following converter as the <cite>default</cite> argument to
<a class="reference external" href="https://docs.python.org/3.12/library/json.html#json.dumps" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.dumps()</span></code></a> to serialize a JavaScript object with</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsProxy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">JsProxy</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Array&quot;</span><span class="p">:</span>
<span class="gp">... </span>      <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">o1</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
<span class="go">&#39;{&quot;x&quot;: {&quot;y&quot;: 2}}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">o2</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
<span class="go">&#39;[{&quot;x&quot;: 2}, {&quot;x&quot;: 7}]&#39;</span>
</pre></div>
</div>
<p>If you load the resulting json back into Python, the result is the same
as calling <a class="reference internal" href="#pyodide.ffi.JsProxy.to_py" title="pyodide.ffi.JsProxy.to_py"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JsProxy.to_py()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">o1</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">))</span> <span class="o">==</span> <span class="n">o1</span><span class="o">.</span><span class="n">to_py</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">o2</span><span class="o">.</span><span class="n">as_py_json</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">))</span> <span class="o">==</span> <span class="n">o2</span><span class="o">.</span><span class="n">to_py</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.bind_sig">
<span class="sig-name descname"><span class="pre">bind_sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.bind_sig" title="Link to this definition">#</a></dt>
<dd><p>Creates a copy of the JsProxy with a signature bound to it.</p>
<div class="warning admonition">
<p class="admonition-title">Experimental</p>
<p>This feature is not yet stable, nor really documented.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>signature</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.js_id">
<span class="sig-name descname"><span class="pre">js_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#pyodide.ffi.JsProxy.js_id" title="Link to this definition">#</a></dt>
<dd><p>An id number which can be used as a dictionary/set key if you want to
key on JavaScript object identity.</p>
<p>If two <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> are made with the same backing JavaScript object, they
will have the same <code class="docutils literal notranslate"><span class="pre">js_id</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.new">
<span class="sig-name descname"><span class="pre">new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.new" title="Link to this definition">#</a></dt>
<dd><p>Construct a new instance of the JavaScript object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p></li>
<li><p><strong>kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.object_entries">
<span class="sig-name descname"><span class="pre">object_entries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.object_entries" title="Link to this definition">#</a></dt>
<dd><p>The JavaScript API <code class="docutils literal notranslate"><span class="pre">Object.entries(object)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_obj</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({first: &#39;aa&#39;, second: 22})&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entries</span> <span class="o">=</span> <span class="n">js_obj</span><span class="o">.</span><span class="n">object_entries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">]</span>
<span class="go">[(&#39;first&#39;, &#39;aa&#39;), (&#39;second&#39;, 22)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.object_keys">
<span class="sig-name descname"><span class="pre">object_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.object_keys" title="Link to this definition">#</a></dt>
<dd><p>The JavaScript API <code class="docutils literal notranslate"><span class="pre">Object.keys(object)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_obj</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({first: 1, second: 2, third: 3})&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="n">js_obj</span><span class="o">.</span><span class="n">object_keys</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
<span class="go">[&#39;first&#39;, &#39;second&#39;, &#39;third&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.object_values">
<span class="sig-name descname"><span class="pre">object_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.object_values" title="Link to this definition">#</a></dt>
<dd><p>The JavaScript API <code class="docutils literal notranslate"><span class="pre">Object.values(object)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_obj</span> <span class="o">=</span> <span class="n">run_js</span><span class="p">(</span><span class="s2">&quot;({first: 1, second: 2, third: 3})&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">js_obj</span><span class="o">.</span><span class="n">object_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.to_py">
<span class="sig-name descname"><span class="pre">to_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_converter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.JsProxy.to_py" title="Link to this definition">#</a></dt>
<dd><p>Convert the <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> to a native Python object as best as
possible.</p>
<p>See <a class="reference internal" href="#type-translations-jsproxy-to-py"><span class="std std-ref">JavaScript to Python</span></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Limit the depth of the conversion. If a shallow conversion is
desired, set <code class="docutils literal notranslate"><span class="pre">depth</span></code> to 1.</p></li>
<li><p><strong>default_converter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – If present, this will be invoked whenever Pyodide does not have some
built in conversion for the object. If <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> raises
an error, the error will be allowed to propagate. Otherwise, the
object returned will be used as the conversion.
<code class="docutils literal notranslate"><span class="pre">default_converter</span></code> takes three arguments. The first argument is
the value to be converted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Here are a couple examples of converter functions. In addition to the
normal conversions, convert <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Date</span></code></a> to <a class="reference external" href="https://docs.python.org/3.12/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Date&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">valueOf</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
<p>Don’t create any JsProxies, require a complete conversion or raise an error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">_value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to completely convert object&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second and third arguments are only needed for converting
containers. The second argument is a conversion function which is used
to convert the elements of the container with the same settings. The
third argument is a “cache” function which is needed to handle self
referential containers. Consider the following example. Suppose we have
a Javascript <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Pair</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span><span class="w"> </span><span class="nx">second</span><span class="p">){</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">first</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">second</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">second</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can use the following <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> to convert <code class="docutils literal notranslate"><span class="pre">Pair</span></code> to <a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Pair&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cache</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">first</span><span class="p">))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">second</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Note that we have to cache the conversion of <code class="docutils literal notranslate"><span class="pre">value</span></code> before converting
<code class="docutils literal notranslate"><span class="pre">value.first</span></code> and <code class="docutils literal notranslate"><span class="pre">value.second</span></code>. To see why, consider a self
referential pair:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Pair</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">;</span>
</pre></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">cache(value,</span> <span class="pre">result);</span></code>, converting <code class="docutils literal notranslate"><span class="pre">p</span></code> would lead to an
infinite recurse. With it, we can successfully convert <code class="docutils literal notranslate"><span class="pre">p</span></code> to a list
such that <code class="docutils literal notranslate"><span class="pre">l[0]</span> <span class="pre">is</span> <span class="pre">l</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.ffi.JsProxy.typeof">
<span class="sig-name descname"><span class="pre">typeof</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyodide.ffi.JsProxy.typeof" title="Link to this definition">#</a></dt>
<dd><p>Returns the JavaScript type of the <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code>.</p>
<p>Corresponds to <cite>typeof obj;</cite> in JavaScript. You may also be interested
in the <cite>constructor</cite> attribute which returns the type as an object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.ffi.JsTypedArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">JsTypedArray</span></span><a class="headerlink" href="#pyodide.ffi.JsTypedArray" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyodide.ffi.JsBuffer" title="pyodide.ffi.JsBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsBuffer</span></code></a>, <a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.create_once_callable">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">create_once_callable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.create_once_callable" title="Link to this definition">#</a></dt>
<dd><p>Wrap a Python Callable in a JavaScript function that can be called once.</p>
<p>After being called the proxy will decrement the reference count
of the Callable. The JavaScript function also has a <code class="docutils literal notranslate"><span class="pre">destroy</span></code> API that
can be used to release the proxy without calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/constants.html#Ellipsis" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsOnceCallable" title="pyodide.ffi.JsOnceCallable"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsOnceCallable</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.create_proxy">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">create_proxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capture_this</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roundtrip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.create_proxy" title="Link to this definition">#</a></dt>
<dd><p>Create a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>.</p>
<p>This allows explicit control over the lifetime of the
<a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a> from Python: call the
<a class="reference internal" href="#pyodide.ffi.JsDoubleProxy.destroy" title="pyodide.ffi.JsDoubleProxy.destroy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">destroy()</span></code></a> API when done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span>) – The object to wrap.</p></li>
<li><p><strong>capture_this</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If the object is callable, should <code class="docutils literal notranslate"><span class="pre">this</span></code> be passed as the first
argument when calling it from JavaScript.</p></li>
<li><p><strong>roundtrip</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – <p>When the proxy is converted back from JavaScript to Python, if this is
<code class="docutils literal notranslate"><span class="pre">True</span></code> it is converted into a double proxy. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, it is
unwrapped into a Python object. In the case that <code class="docutils literal notranslate"><span class="pre">roundtrip</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code> it is possible to unwrap a double proxy with the
<a class="reference internal" href="#pyodide.ffi.JsDoubleProxy.unwrap" title="pyodide.ffi.JsDoubleProxy.unwrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JsDoubleProxy.unwrap()</span></code></a> method. This is useful to allow easier
control of lifetimes from Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">o</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">o</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">create_proxy</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">roundtrip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">o</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span> <span class="c1"># Destroys the proxy created with create_proxy</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">roundtrip=False</span></code> this would be an error.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsDoubleProxy" title="pyodide.ffi.JsDoubleProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsDoubleProxy</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.destroy_proxies">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">destroy_proxies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyproxies</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.destroy_proxies" title="Link to this definition">#</a></dt>
<dd><p>Destroy all PyProxies in a JavaScript array.</p>
<p>pyproxies must be a JavaScript Array of PyProxies. Intended for use
with the arrays created from the “pyproxies” argument of <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a>
and <a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_js()</span></code></a>. This method is necessary because indexing the Array from
Python automatically unwraps the PyProxy into the wrapped Python object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pyproxies</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.register_js_module">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">register_js_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jsproxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.register_js_module" title="Link to this definition">#</a></dt>
<dd><p>Registers <code class="docutils literal notranslate"><span class="pre">jsproxy</span></code> as a JavaScript module named <code class="docutils literal notranslate"><span class="pre">name</span></code>. The module
can then be imported from Python using the standard Python import
system. If another module by the same name has already been imported,
this won’t have much effect unless you also delete the imported module
from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.modules" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>. This is called by the JavaScript API
<a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of js module</p></li>
<li><p><strong>jsproxy</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – JavaScript object backing the module</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.run_sync">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">run_sync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.run_sync" title="Link to this definition">#</a></dt>
<dd><p>Block until an awaitable is resolved.</p>
<p>Only works if JS Promise integration is enabled in the runtime and the
current Python call stack was entered via <a class="reference internal" href="#pyodide.runPythonAsync" title="pyodide.runPythonAsync"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.runPythonAsync()</span></code></a>,
by calling an async Python function, or via
<a class="reference internal" href="#pyodide.ffi.PyCallable.callPromising" title="pyodide.ffi.PyCallable.callPromising"><code class="xref js js-func docutils literal notranslate"><span class="pre">callPromising()</span></code></a>.</p>
<div class="warning admonition">
<p class="admonition-title">Experimental</p>
<p>This feature is not yet stable.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T</span></code>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="docutils literal notranslate"><span class="pre">T</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.to_js">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">to_js</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyproxies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_pyproxies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_converter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_converter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.to_js" title="Link to this definition">#</a></dt>
<dd><p>Convert the object to JavaScript.</p>
<p>This is similar to <a class="reference internal" href="#pyodide.ffi.PyProxy.toJs" title="pyodide.ffi.PyProxy.toJs"><code class="xref js js-meth docutils literal notranslate"><span class="pre">toJs()</span></code></a>, but for use from Python. If the
object can be implicitly translated to JavaScript, it will be returned
unchanged. If the object cannot be converted into JavaScript, this method
will return a <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of a <a class="reference internal" href="#pyodide.ffi.PyProxy" title="pyodide.ffi.PyProxy"><code class="xref js js-class docutils literal notranslate"><span class="pre">PyProxy</span></code></a>, as if you had used
<a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a>.</p>
<p>See <a class="reference internal" href="#type-translations-pyproxy-to-js"><span class="std std-ref">Python to JavaScript</span></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – The Python object to convert</p></li>
<li><p><strong>depth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The maximum depth to do the conversion. Negative numbers are treated as
infinite. Set this to 1 to do a shallow conversion.</p></li>
<li><p><strong>pyproxies</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Should be a JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a>. If provided, any <code class="docutils literal notranslate"><span class="pre">PyProxies</span></code>
generated will be stored here. You can later use <a class="reference internal" href="#pyodide.ffi.destroy_proxies" title="pyodide.ffi.destroy_proxies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">destroy_proxies()</span></code></a>
if you want to destroy the proxies from Python (or from JavaScript you
can just iterate over the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a> and destroy the proxies).</p></li>
<li><p><strong>create_pyproxies</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If you set this to <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, <a class="reference internal" href="#pyodide.ffi.to_js" title="pyodide.ffi.to_js"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_js()</span></code></a> will raise an error rather
than creating any pyproxies.</p></li>
<li><p><strong>dict_converter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference internal" href="#pyodide.ffi.JsArray" title="pyodide.ffi.JsArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsArray</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]], <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – <p>This converter if provided receives a (JavaScript) iterable of
(JavaScript) pairs [key, value]. It is expected to return the desired
result of the dict conversion. Some suggested values for this argument:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">js.Map.new</span></code> – similar to the default behavior</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">js.Array.from</span></code> – convert to an array of entries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">js.Object.fromEntries</span></code> – convert to a JavaScript object</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>default_converter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]], <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a>] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – If present will be invoked whenever Pyodide does not have some built in
conversion for the object. If <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> raises an error, the
error will be allowed to propagate. Otherwise, the object returned will
be used as the conversion. <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> takes three arguments.
The first argument is the value to be converted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Object</span><span class="p">,</span> <span class="n">Map</span><span class="p">,</span> <span class="n">Array</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_js</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span> <span class="o">=</span> <span class="n">to_js</span><span class="p">({</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;john&#39;</span><span class="p">})</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span> 
<span class="go">[object Map]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">js_object</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> 
<span class="go">KeysView([object Map]) ValuesView([object Map]) </span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">js_object</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">js_object</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span> 
<span class="go">[(&#39;age&#39;, 20), (&#39;name&#39;, &#39;john&#39;)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span> <span class="o">=</span> <span class="n">to_js</span><span class="p">({</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;john&#39;</span><span class="p">},</span> <span class="n">dict_converter</span><span class="o">=</span><span class="n">Object</span><span class="o">.</span><span class="n">fromEntries</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">20</span> 
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;john&#39;</span> 
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span> 
<span class="go">[object Object]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span> 
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span> 
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span> <span class="o">=</span> <span class="n">to_js</span><span class="p">({</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;john&#39;</span><span class="p">},</span> <span class="n">dict_converter</span><span class="o">=</span><span class="n">Array</span><span class="o">.</span><span class="n">from_</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">js_object</span><span class="p">]</span> 
<span class="go">[age,20, name,john]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_object</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span> 
<span class="go">age,20,name,john</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">Bird</span><span class="p">:</span> <span class="k">pass</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">converter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">value</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="n">Object</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bird</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">js_nest</span> <span class="o">=</span> <span class="n">to_js</span><span class="p">([</span><span class="n">Bird</span><span class="p">(),</span> <span class="n">Bird</span><span class="p">()],</span> <span class="n">default_converter</span><span class="o">=</span><span class="n">converter</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">bird</span> <span class="k">for</span> <span class="n">bird</span> <span class="ow">in</span> <span class="n">js_nest</span><span class="p">]</span> 
<span class="go">[[object Object], [object Object]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">bird</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">bird</span><span class="o">.</span><span class="n">color</span><span class="p">)</span> <span class="k">for</span> <span class="n">bird</span> <span class="ow">in</span> <span class="n">js_nest</span><span class="p">]</span> 
<span class="go">[(1, &#39;red&#39;), (1, &#39;red&#39;)]</span>
</pre></div>
</div>
<p>Here are some examples demonstrating the usage of the <code class="docutils literal notranslate"><span class="pre">default_converter</span></code>
argument.</p>
<p>In addition to the normal conversions, convert JavaScript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Date</span></code></a>
objects to <a class="reference external" href="https://docs.python.org/3.12/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Date</span>
<span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
<p>Don’t create any PyProxies, require a complete conversion or raise an error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">_value</span><span class="p">,</span> <span class="n">_ignored1</span><span class="p">,</span> <span class="n">_ignored2</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to completely convert object&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second and third arguments are only needed for converting containers.
The second argument is a conversion function which is used to convert the
elements of the container with the same settings. The third argument is a
“cache” function which is needed to handle self referential containers.
Consider the following example. Suppose we have a Python <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Pair</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">second</span>
</pre></div>
</div>
<p>We can use the following <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> to convert <code class="docutils literal notranslate"><span class="pre">Pair</span></code> to
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Array</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span>

<span class="k">def</span><span class="w"> </span><span class="nf">default_converter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">Array</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">cache</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">first</span><span class="p">))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">second</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Note that we have to cache the conversion of <code class="docutils literal notranslate"><span class="pre">value</span></code> before converting
<code class="docutils literal notranslate"><span class="pre">value.first</span></code> and <code class="docutils literal notranslate"><span class="pre">value.second</span></code>. To see why, consider a self
referential pair:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Pair</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">;</span>
</pre></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">cache(value,</span> <span class="pre">result);</span></code>, converting <code class="docutils literal notranslate"><span class="pre">p</span></code> would lead to an
infinite recurse. With it, we can successfully convert <code class="docutils literal notranslate"><span class="pre">p</span></code> to an Array
such that <code class="docutils literal notranslate"><span class="pre">l[0]</span> <span class="pre">===</span> <span class="pre">l</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.unregister_js_module">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.</span></span><span class="sig-name descname"><span class="pre">unregister_js_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.unregister_js_module" title="Link to this definition">#</a></dt>
<dd><p>Unregisters a JavaScript module with given name that has been previously
registered with <a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a> or
<a class="reference internal" href="#pyodide.ffi.register_js_module" title="pyodide.ffi.register_js_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.ffi.register_js_module()</span></code></a>. If a JavaScript module with that name
does not already exist, will raise an error. If the module has already
been imported, this won’t have much effect unless you also delete the
imported module from <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.modules" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>. This is called by the JavaScript
API <a class="reference internal" href="#pyodide.unregisterJsModule" title="pyodide.unregisterJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.unregisterJsModule()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the module to unregister</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<p id="module-pyodide.ffi.wrappers"><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.add_event_listener" title="pyodide.ffi.wrappers.add_event_listener"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_event_listener</span></code></a>(elt, event, listener)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">addEventListener()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">listener</span></code> parameter.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.clear_interval" title="pyodide.ffi.wrappers.clear_interval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_interval</span></code></a>(interval_retval)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/clearInterval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">clearInterval()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.clear_timeout" title="pyodide.ffi.wrappers.clear_timeout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_timeout</span></code></a>(timeout_retval)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/clearTimeout" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">clearTimeout()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.remove_event_listener" title="pyodide.ffi.wrappers.remove_event_listener"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_event_listener</span></code></a>(elt, event, listener)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">removeEventListener()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">listener</span></code> parameter.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.set_interval" title="pyodide.ffi.wrappers.set_interval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_interval</span></code></a>(callback, interval)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/setInterval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">setInterval()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.ffi.wrappers.set_timeout" title="pyodide.ffi.wrappers.set_timeout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_timeout</span></code></a>(callback, timeout)</p></td>
<td><p>Wrapper for JavaScript's <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/setTimeout" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">setTimeout()</span></code></a> which automatically manages the lifetime of a JsProxy corresponding to the callback param.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.add_event_listener">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">add_event_listener</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listener</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.add_event_listener" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">addEventListener()</span></code></a> which automatically manages the lifetime of a
JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">listener</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elt</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsDomElement" title="pyodide.ffi.JsDomElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsDomElement</span></code></a></span>)</p></li>
<li><p><strong>event</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
<li><p><strong>listener</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.clear_interval">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">clear_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_retval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.clear_interval" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/clearInterval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">clearInterval()</span></code></a>
which automatically manages the lifetime of a JsProxy corresponding to
the <code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_retval</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.clear_timeout">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">clear_timeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout_retval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.clear_timeout" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/clearTimeout" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">clearTimeout()</span></code></a> which
automatically manages the lifetime of a JsProxy corresponding to the
<code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timeout_retval</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.remove_event_listener">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">remove_event_listener</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listener</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.remove_event_listener" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">removeEventListener()</span></code></a> which automatically manages the
lifetime of a JsProxy corresponding to the <code class="docutils literal notranslate"><span class="pre">listener</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elt</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsDomElement" title="pyodide.ffi.JsDomElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsDomElement</span></code></a></span>)</p></li>
<li><p><strong>event</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>)</p></li>
<li><p><strong>listener</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.set_interval">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">set_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.set_interval" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/setInterval" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">setInterval()</span></code></a> which
automatically manages the lifetime of a JsProxy corresponding to the
<code class="docutils literal notranslate"><span class="pre">callback</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>)</p></li>
<li><p><strong>interval</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.ffi.wrappers.set_timeout">
<span class="sig-prename descclassname"><span class="pre">pyodide.ffi.wrappers.</span></span><span class="sig-name descname"><span class="pre">set_timeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.ffi.wrappers.set_timeout" title="Link to this definition">#</a></dt>
<dd><p>Wrapper for JavaScript’s <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/setTimeout" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">setTimeout()</span></code></a> which
automatically manages the lifetime of a JsProxy corresponding to the
callback param.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[], <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>)</p></li>
<li><p><strong>timeout</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-usage/api/python-api/http"></span><section id="module-pyodide.http">
<span id="pyodide-http"></span><h6>pyodide.http<a class="headerlink" href="#module-pyodide.http" title="Link to this heading">#</a></h6>
<p><strong>Exceptions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.http.AbortError" title="pyodide.http.AbortError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbortError</span></code></a>(reason)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.http.BodyUsedError" title="pyodide.http.BodyUsedError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BodyUsedError</span></code></a>(*args)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.http.HttpStatusError" title="pyodide.http.HttpStatusError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HttpStatusError</span></code></a>(status, status_text, url)</p></td>
<td><p>A subclass of <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#OSError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> raised by <a class="reference internal" href="#pyodide.http.FetchResponse.raise_for_status" title="pyodide.http.FetchResponse.raise_for_status"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchResponse.raise_for_status()</span></code></a> if the response status is 4XX or 5XX.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FetchResponse</span></code></a>(url, js_response[, ...])</p></td>
<td><p>A wrapper for a Javascript fetch <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Response</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Functions:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.http.open_url" title="pyodide.http.open_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">open_url</span></code></a>(url)</p></td>
<td><p>Fetches a given URL synchronously.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.http.pyfetch" title="pyodide.http.pyfetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyfetch</span></code></a>(url, **kwargs)</p></td>
<td><p>Fetch the url and return the response.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py exception">
<dt class="sig sig-object py" id="pyodide.http.AbortError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">AbortError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reason</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.AbortError" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reason</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsException" title="pyodide.ffi.JsException"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsException</span></code></a></span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyodide.http.BodyUsedError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">BodyUsedError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.BodyUsedError" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">FetchResponse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">js_response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abort_controller</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abort_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse" title="Link to this definition">#</a></dt>
<dd><p>A wrapper for a Javascript fetch <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" title="(in MDN docs)"><code class="xref js js-data docutils literal notranslate"><span class="pre">Response</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – URL that was fetched</p></li>
<li><p><strong>js_response</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsFetchResponse" title="pyodide.ffi.JsFetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsFetchResponse</span></code></a></span>) – A <a class="reference internal" href="#pyodide.ffi.JsProxy" title="pyodide.ffi.JsProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsProxy</span></code></a> of the fetch <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">Response</span></code></a>.</p></li>
<li><p><strong>abort_controller</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AbortController</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The abort controller that may be used to cancel the fetch request.</p></li>
<li><p><strong>abort_signal</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">AbortSignal</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The abort signal that was used for the fetch request.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.abort">
<span class="sig-name descname"><span class="pre">abort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.abort" title="Link to this definition">#</a></dt>
<dd><p>Abort the fetch request.</p>
<p>In case <code class="docutils literal notranslate"><span class="pre">abort_controller</span></code> is not set, a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reason</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.body_used">
<span class="sig-name descname"><span class="pre">body_used</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.body_used" title="Link to this definition">#</a></dt>
<dd><p>Has the response been used yet?</p>
<p>If so, attempting to retrieve the body again will raise an
<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#OSError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a>. Use <a class="reference internal" href="#pyodide.http.FetchResponse.clone" title="pyodide.http.FetchResponse.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> first to avoid this.
See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/bodyUsed" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.bodyUsed</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.buffer">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.buffer" title="Link to this definition">#</a></dt>
<dd><p>Return the response body as a Javascript <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">ArrayBuffer</span></code></a>.</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/arrayBuffer" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Response.arrayBuffer()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.ffi.JsBuffer" title="pyodide.ffi.JsBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsBuffer</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.bytes">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bytes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.bytes" title="Link to this definition">#</a></dt>
<dd><p>Return the response body as a bytes object</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.http.FetchResponse.bytes" title="pyodide.http.FetchResponse.bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.clone" title="Link to this definition">#</a></dt>
<dd><p>Return an identical copy of the <a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchResponse</span></code></a>.</p>
<p>This method exists to allow multiple uses of <a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchResponse</span></code></a>
objects. See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/clone" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">Response.clone()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchResponse</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.headers">
<span class="sig-name descname"><span class="pre">headers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyodide.http.FetchResponse.headers" title="Link to this definition">#</a></dt>
<dd><p>Response headers as dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.json">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.json" title="Link to this definition">#</a></dt>
<dd><p>Treat the response body as a JSON string and use
<a class="reference external" href="https://docs.python.org/3.12/library/json.html#json.loads" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a> to parse it into a Python object.</p>
<p>Any keyword arguments are passed to <a class="reference external" href="https://docs.python.org/3.12/library/json.html#json.loads" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.memoryview">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">memoryview</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.memoryview" title="Link to this definition">#</a></dt>
<dd><p>Return the response body as a <a class="reference internal" href="#pyodide.http.FetchResponse.memoryview" title="pyodide.http.FetchResponse.memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.http.FetchResponse.memoryview" title="pyodide.http.FetchResponse.memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.ok">
<span class="sig-name descname"><span class="pre">ok</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.ok" title="Link to this definition">#</a></dt>
<dd><p>Was the request successful?</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/ok" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.ok</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.raise_for_status">
<span class="sig-name descname"><span class="pre">raise_for_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.raise_for_status" title="Link to this definition">#</a></dt>
<dd><p>Raise an <a class="reference internal" href="#pyodide.http.HttpStatusError" title="pyodide.http.HttpStatusError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">HttpStatusError</span></code></a> if the status of the response is an error (4xx or 5xx)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.redirected">
<span class="sig-name descname"><span class="pre">redirected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.redirected" title="Link to this definition">#</a></dt>
<dd><p>Was the request redirected?</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/redirected" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.redirected</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.status">
<span class="sig-name descname"><span class="pre">status</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.status" title="Link to this definition">#</a></dt>
<dd><p>Response status code</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/status" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.status</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.status_text">
<span class="sig-name descname"><span class="pre">status_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.status_text" title="Link to this definition">#</a></dt>
<dd><p>Response status text</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/statusText" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.statusText</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.string">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.string" title="Link to this definition">#</a></dt>
<dd><p>Return the response body as a string</p>
<p>Does the same thing as <a class="reference internal" href="#pyodide.http.FetchResponse.text" title="pyodide.http.FetchResponse.text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchResponse.text()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.24.0: </span>Use <a class="reference internal" href="#pyodide.http.FetchResponse.text" title="pyodide.http.FetchResponse.text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchResponse.text()</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.text">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">text</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.text" title="Link to this definition">#</a></dt>
<dd><p>Return the response body as a string</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.type" title="Link to this definition">#</a></dt>
<dd><p>The type of the response.</p>
<p>See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/type" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.type</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.unpack_archive">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unpack_archive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.FetchResponse.unpack_archive" title="Link to this definition">#</a></dt>
<dd><p>Treat the data as an archive and unpack it into target directory.</p>
<p>Assumes that the file is an archive in a format that <a class="reference external" href="https://docs.python.org/3.12/library/shutil.html#module-shutil" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a> has
an unpacker for. The arguments <code class="docutils literal notranslate"><span class="pre">extract_dir</span></code> and <code class="docutils literal notranslate"><span class="pre">format</span></code> are passed
directly on to <a class="reference external" href="https://docs.python.org/3.12/library/shutil.html#shutil.unpack_archive" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.unpack_archive()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extract_dir</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Directory to extract the archive into. If not provided, the current
working directory is used.</p></li>
<li><p><strong>format</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – The archive format: one of <code class="docutils literal notranslate"><span class="pre">&quot;zip&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;tar&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;gztar&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;bztar&quot;</span></code>. Or any other format registered with
<a class="reference external" href="https://docs.python.org/3.12/library/shutil.html#shutil.register_unpack_format" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.register_unpack_format()</span></code></a>. If not provided,
<a class="reference internal" href="#pyodide.http.FetchResponse.unpack_archive" title="pyodide.http.FetchResponse.unpack_archive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unpack_archive()</span></code></a> will use the archive file name extension and
see if an unpacker was registered for that extension. In case none
is found, a <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> is raised.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyodide.http.FetchResponse.url">
<span class="sig-name descname"><span class="pre">url</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyodide.http.FetchResponse.url" title="Link to this definition">#</a></dt>
<dd><p>The url of the response.</p>
<p>The value may be different than the url passed to fetch.
See <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/url" title="(in MDN docs)"><code class="xref js js-attr docutils literal notranslate"><span class="pre">Response.url</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyodide.http.HttpStatusError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">HttpStatusError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.HttpStatusError" title="Link to this definition">#</a></dt>
<dd><p>A subclass of <a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#OSError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> raised by <a class="reference internal" href="#pyodide.http.FetchResponse.raise_for_status" title="pyodide.http.FetchResponse.raise_for_status"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchResponse.raise_for_status()</span></code></a>
if the response status is 4XX or 5XX.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The http status code of the request</p></li>
<li><p><strong>status_text</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The http status text of the request</p></li>
<li><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The url that was requested</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.http.open_url">
<span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">open_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.open_url" title="Link to this definition">#</a></dt>
<dd><p>Fetches a given URL synchronously.</p>
<p>The download of binary files is not supported. To download binary files use
<a class="reference internal" href="#pyodide.http.pyfetch" title="pyodide.http.pyfetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.http.pyfetch()</span></code></a> which is asynchronous.</p>
<p>It will not work in Node unless you include an polyfill for <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">XMLHttpRequest</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – URL to fetch</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/io.html#io.StringIO" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">StringIO</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The contents of the URL.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span><span class="p">;</span> <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;TODO: Figure out how to skip this only in node&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide-lock.json&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_contents</span> <span class="o">=</span> <span class="n">open_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">url_contents</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<span class="go">[(&#39;arch&#39;, &#39;wasm32&#39;), (&#39;platform&#39;, &#39;emscripten_3_1_45&#39;), (&#39;python&#39;, &#39;3.11.3&#39;), (&#39;version&#39;, &#39;0.24.1&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyodide.http.pyfetch">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.http.</span></span><span class="sig-name descname"><span class="pre">pyfetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.http.pyfetch" title="Link to this definition">#</a></dt>
<dd><p>Fetch the url and return the response.</p>
<p>This functions provides a similar API to <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">fetch()</span></code></a> however it is
designed to be convenient to use from Python. The
<a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchResponse</span></code></a> has methods with the output types
already converted to Python objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – URL to fetch.</p></li>
<li><p><strong>**kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – keyword arguments are passed along as <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch#options">optional parameters to the fetch API</a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.http.FetchResponse" title="pyodide.http.FetchResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchResponse</span></code></a></span></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span><span class="p">;</span> <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Can&#39;t use top level await in doctests&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">pyfetch</span><span class="p">(</span><span class="s2">&quot;https://cdn.jsdelivr.net/pyodide/v0.23.4/full/repodata.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">ok</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status</span>
<span class="go">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">{&#39;info&#39;: {&#39;arch&#39;: &#39;wasm32&#39;, &#39;platform&#39;: &#39;emscripten_3_1_32&#39;,</span>
<span class="go">&#39;version&#39;: &#39;0.23.4&#39;, &#39;python&#39;: &#39;3.11.2&#39;}, ... # long output truncated</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-usage/api/python-api/webloop"></span><section id="module-pyodide.webloop">
<span id="pyodide-webloop"></span><h6>pyodide.webloop<a class="headerlink" href="#module-pyodide.webloop" title="Link to this heading">#</a></h6>
<p><strong>Classes:</strong></p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a>(*[, loop])</p></td>
<td><p>A <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-future.html#asyncio.Future" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> with extra <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">then()</span></code></a>, <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">catch()</span></code></a>, and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">finally_()</span></code></a> methods based on the Javascript promise API.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.webloop.PyodideTask" title="pyodide.webloop.PyodideTask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyodideTask</span></code></a>(coro, *[, loop, name, context, ...])</p></td>
<td><p>Inherits from both <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-task.html#asyncio.Task" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> and <a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyodide.webloop.WebLoop" title="pyodide.webloop.WebLoop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WebLoop</span></code></a>()</p></td>
<td><p>A custom event loop for use in Pyodide.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyodide.webloop.WebLoopPolicy" title="pyodide.webloop.WebLoopPolicy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WebLoopPolicy</span></code></a>()</p></td>
<td><p>A simple event loop policy for managing <a class="reference internal" href="#pyodide.webloop.WebLoop" title="pyodide.webloop.WebLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">WebLoop</span></code></a>-based event loops.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyodide.webloop.PyodideFuture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.webloop.</span></span><span class="sig-name descname"><span class="pre">PyodideFuture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.webloop.PyodideFuture" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-future.html#asyncio.Future" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> with extra <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">then()</span></code></a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">catch()</span></code></a>, and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally" title="(in MDN docs)"><code class="xref js js-meth docutils literal notranslate"><span class="pre">finally_()</span></code></a> methods
based on the Javascript promise API. <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-eventloop.html#asyncio.loop.create_future" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_future()</span></code></a>
returns these so in practice all futures encountered in Pyodide should be an
instance of <a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyodide.webloop.PyodideFuture.catch">
<span class="sig-name descname"><span class="pre">catch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onrejected</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.webloop.PyodideFuture.catch" title="Link to this definition">#</a></dt>
<dd><p>Equivalent to <code class="docutils literal notranslate"><span class="pre">then(None,</span> <span class="pre">onrejected)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onrejected</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a>[<a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.webloop.PyodideFuture.finally_">
<span class="sig-name descname"><span class="pre">finally_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfinally</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.webloop.PyodideFuture.finally_" title="Link to this definition">#</a></dt>
<dd><p>When the future is either resolved or rejected, call <code class="docutils literal notranslate"><span class="pre">onfinally</span></code> with
no arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onfinally</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a>[<code class="docutils literal notranslate"><span class="pre">T</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyodide.webloop.PyodideFuture.then">
<span class="sig-name descname"><span class="pre">then</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onfulfilled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onrejected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.webloop.PyodideFuture.then" title="Link to this definition">#</a></dt>
<dd><p>When the Future is done, either execute onfulfilled with the result
or execute onrejected with the exception.</p>
<p>Returns a new Future which will be marked done when either the
onfulfilled or onrejected callback is completed. If the return value of
the executed callback is awaitable it will be awaited repeatedly until a
nonawaitable value is received. The returned Future will be resolved
with that value. If an error is raised, the returned Future will be
rejected with the error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onfulfilled</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="docutils literal notranslate"><span class="pre">T</span></code>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>, <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>]]] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – A function called if the Future is fulfilled. This function receives
one argument, the fulfillment value.</p></li>
<li><p><strong>onrejected</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#BaseException" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseException</span></code></a>], <a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>, <a class="reference external" href="https://docs.python.org/3.12/library/collections.abc.html#collections.abc.Awaitable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Awaitable</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>]]] | <a class="reference external" href="https://docs.python.org/3.12/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – A function called if the Future is rejected. This function receives
one argument, the rejection value.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a>[<code class="docutils literal notranslate"><span class="pre">S</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new future to be resolved when the original future is done and the
appropriate callback is also done.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.webloop.PyodideTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.webloop.</span></span><span class="sig-name descname"><span class="pre">PyodideTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coro</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eager_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodide.webloop.PyodideTask" title="Link to this definition">#</a></dt>
<dd><p>Inherits from both <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-task.html#asyncio.Task" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> and
<a class="reference internal" href="#pyodide.webloop.PyodideFuture" title="pyodide.webloop.PyodideFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyodideFuture</span></code></a></p>
<p>Instantiation is discouraged unless you are writing your own event loop.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.webloop.WebLoop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.webloop.</span></span><span class="sig-name descname"><span class="pre">WebLoop</span></span><a class="headerlink" href="#pyodide.webloop.WebLoop" title="Link to this definition">#</a></dt>
<dd><p>A custom event loop for use in Pyodide.</p>
<p>Schedules tasks on the browser event loop. Does no lifecycle management and
runs forever.</p>
<p><a class="reference external" href="https://docs.python.org/3.12/library/asyncio-eventloop.html#asyncio.loop.run_forever" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_forever()</span></code></a> and
<a class="reference external" href="https://docs.python.org/3.12/library/asyncio-eventloop.html#asyncio.loop.run_until_complete" title="(in Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_until_complete()</span></code></a> cannot block like a normal event
loop would because we only have one thread so blocking would stall the
browser event loop and prevent anything from ever happening.</p>
<p>We defer all work to the browser event loop using the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/setTimeout" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">setTimeout()</span></code></a>
function. To ensure that this event loop doesn’t stall out UI and other
browser handling, we want to make sure that each task is scheduled on the
browser event loop as a task not as a microtask. <code class="docutils literal notranslate"><span class="pre">setTimeout(callback,</span> <span class="pre">0)</span></code>
enqueues the callback as a task so it works well for our purposes.</p>
<p>See the Python <a class="reference external" href="https://docs.python.org/3.12/library/asyncio-eventloop.html" title="(in Python v3.12)"><span>Event Loop</span></a> documentation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyodide.webloop.WebLoopPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyodide.webloop.</span></span><span class="sig-name descname"><span class="pre">WebLoopPolicy</span></span><a class="headerlink" href="#pyodide.webloop.WebLoopPolicy" title="Link to this definition">#</a></dt>
<dd><p>A simple event loop policy for managing <a class="reference internal" href="#pyodide.webloop.WebLoop" title="pyodide.webloop.WebLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">WebLoop</span></code></a>-based event loops.</p>
</dd></dl>

</section>
</div>
</section>
<span id="document-usage/api/pyodide-cli"></span><section id="pyodide-cli">
<span id="id1"></span><h5>pyodide CLI<a class="headerlink" href="#pyodide-cli" title="Link to this heading">#</a></h5>
<p>This page documents the Pyodide Command Line Interface (CLI) interface. In addition to the commands defined by <code class="docutils literal notranslate"><span class="pre">pyodide-build</span></code>, documented below, other subcommands are defined in external packages (which can be installed with pip):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">pack</span></code>, defined in <a class="reference external" href="https://github.com/pyodide/pyodide-pack">pyodide-pack</a> is a package bundler for Pyodide</p></li>
</ul>
<section id="pyodide">
<h6>pyodide<a class="headerlink" href="#pyodide" title="Link to this heading">#</a></h6>
<p>A command line interface for Pyodide.</p>
<p>Other CLI subcommands are registered via the plugin system by installing
Pyodide compatible packages (e.g. pyodide-build).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-version">
<span class="sig-name descname"><span class="pre">--version</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-version" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<section id="pyodide-auditwheel">
<h6 aria-level="7">auditwheel<a class="headerlink" href="#pyodide-auditwheel" title="Link to this heading">#</a></h6>
<p>Auditwheel-like tool for emscripten wheels and shared libraries.</p>
<p>Registered by: auditwheel_emscripten</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<section id="pyodide-auditwheel-copy">
<h6 aria-level="8">copy<a class="headerlink" href="#pyodide-auditwheel-copy" title="Link to this heading">#</a></h6>
<p>[Deprecated] Copy shared libraries to the wheel directory. Works same as <cite>repair</cite>. Use <cite>repair</cite> instead.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span>copy<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEEL_FILE
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-copy-libdir">
<span class="sig-name descname"><span class="pre">--libdir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;libdir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-copy-libdir" title="Link to this definition">#</a></dt>
<dd><p>Path to the directory containing the shared libraries.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'lib'</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-copy-output-dir">
<span class="sig-name descname"><span class="pre">--output-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-copy-output-dir" title="Link to this definition">#</a></dt>
<dd><p>Directory to output repaired wheel or shared library. (default: overwrite the input file)</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-copy-arg-WHEEL_FILE">
<span class="sig-name descname"><span class="pre">WHEEL_FILE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-copy-arg-WHEEL_FILE" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to wheel file.</p>
</dd></dl>

</section>
<section id="pyodide-auditwheel-exports">
<h6 aria-level="8">exports<a class="headerlink" href="#pyodide-auditwheel-exports" title="Link to this heading">#</a></h6>
<p>Show exports of a wheel or a shared library file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span>exports<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEEL_OR_SO_FILE
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-exports-show-type">
<span id="cmdoption-pyodide-auditwheel-exports-no-show-type"></span><span class="sig-name descname"><span class="pre">--show-type</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-show-type</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-exports-show-type" title="Link to this definition">#</a></dt>
<dd><p>Show function type.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-exports-arg-WHEEL_OR_SO_FILE">
<span class="sig-name descname"><span class="pre">WHEEL_OR_SO_FILE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-exports-arg-WHEEL_OR_SO_FILE" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to wheel or a shared library file.</p>
</dd></dl>

</section>
<section id="pyodide-auditwheel-imports">
<h6 aria-level="8">imports<a class="headerlink" href="#pyodide-auditwheel-imports" title="Link to this heading">#</a></h6>
<p>Show imports of a wheel or a shared library file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span>imports<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEEL_OR_SO_FILE
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-imports-show-type">
<span id="cmdoption-pyodide-auditwheel-imports-no-show-type"></span><span class="sig-name descname"><span class="pre">--show-type</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-show-type</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-imports-show-type" title="Link to this definition">#</a></dt>
<dd><p>Show function type.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-imports-arg-WHEEL_OR_SO_FILE">
<span class="sig-name descname"><span class="pre">WHEEL_OR_SO_FILE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-imports-arg-WHEEL_OR_SO_FILE" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to wheel or a shared library file.</p>
</dd></dl>

</section>
<section id="pyodide-auditwheel-repair">
<h6 aria-level="8">repair<a class="headerlink" href="#pyodide-auditwheel-repair" title="Link to this heading">#</a></h6>
<p>Repair a wheel file: copy shared libraries to the wheel directory.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span>repair<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEEL_FILE
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-repair-libdir">
<span class="sig-name descname"><span class="pre">--libdir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;libdir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-repair-libdir" title="Link to this definition">#</a></dt>
<dd><p>Path to the directory containing the shared libraries.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'lib'</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-repair-output-dir">
<span class="sig-name descname"><span class="pre">--output-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-repair-output-dir" title="Link to this definition">#</a></dt>
<dd><p>Directory to output repaired wheel or shared library. (default: overwrite the input file)</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-repair-arg-WHEEL_FILE">
<span class="sig-name descname"><span class="pre">WHEEL_FILE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-repair-arg-WHEEL_FILE" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to wheel file.</p>
</dd></dl>

</section>
<section id="pyodide-auditwheel-show">
<h6 aria-level="8">show<a class="headerlink" href="#pyodide-auditwheel-show" title="Link to this heading">#</a></h6>
<p>Show shared library dependencies of a wheel or a shared library file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>auditwheel<span class="w"> </span>show<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEEL_OR_SO_FILE
</pre></div>
</div>
<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-auditwheel-show-arg-WHEEL_OR_SO_FILE">
<span class="sig-name descname"><span class="pre">WHEEL_OR_SO_FILE</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-auditwheel-show-arg-WHEEL_OR_SO_FILE" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to wheel or a shared library file.</p>
</dd></dl>

</section>
</section>
<section id="pyodide-build">
<h6 aria-level="7">build<a class="headerlink" href="#pyodide-build" title="Link to this heading">#</a></h6>
<p>Use pypa/build to build a Python package from source, pypi or url.</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>SOURCE_LOCATION<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-o">
<span id="cmdoption-pyodide-build-outdir"></span><span class="sig-name descname"><span class="pre">-o</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--outdir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output_directory&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-o" title="Link to this definition">#</a></dt>
<dd><p>which directory should the output be placed into?</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-r">
<span id="cmdoption-pyodide-build-requirements"></span><span class="sig-name descname"><span class="pre">-r</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--requirements</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;requirements_txt&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-r" title="Link to this definition">#</a></dt>
<dd><p>Build a list of package requirements from a requirements.txt file</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-exports">
<span class="sig-name descname"><span class="pre">--exports</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;exports&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-exports" title="Link to this definition">#</a></dt>
<dd><p>Which symbols should be exported when linking .so files?</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'requested'</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-build-dependencies">
<span id="cmdoption-pyodide-build-no-build-dependencies"></span><span class="sig-name descname"><span class="pre">--build-dependencies</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-build-dependencies</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-build-dependencies" title="Link to this definition">#</a></dt>
<dd><p>Fetch dependencies from pypi and build them too.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-output-lockfile">
<span class="sig-name descname"><span class="pre">--output-lockfile</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output_lockfile&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-output-lockfile" title="Link to this definition">#</a></dt>
<dd><p>Output list of resolved dependencies to a file in requirements.txt format</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-skip-dependency">
<span class="sig-name descname"><span class="pre">--skip-dependency</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;skip_dependency&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-skip-dependency" title="Link to this definition">#</a></dt>
<dd><p>Skip building or resolving a single dependency, or a pyodide-lock.json file. Use multiple times or provide a comma separated list to skip multiple dependencies.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-skip-built-in-packages">
<span id="cmdoption-pyodide-build-no-skip-built-in-packages"></span><span class="sig-name descname"><span class="pre">--skip-built-in-packages</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-skip-built-in-packages</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-skip-built-in-packages" title="Link to this definition">#</a></dt>
<dd><p>Don’t build dependencies that are built into the pyodide distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-compression-level">
<span class="sig-name descname"><span class="pre">--compression-level</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;compression_level&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-compression-level" title="Link to this definition">#</a></dt>
<dd><p>Compression level to use for the created zip file</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-C">
<span id="cmdoption-pyodide-build-config-setting"></span><span class="sig-name descname"><span class="pre">-C</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--config-setting</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;KEY[=VALUE&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-C" title="Link to this definition">#</a></dt>
<dd><p>Settings to pass to the backend. Works same as the –config-setting option of pypa/build.</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-arg-SOURCE_LOCATION">
<span class="sig-name descname"><span class="pre">SOURCE_LOCATION</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-arg-SOURCE_LOCATION" title="Link to this definition">#</a></dt>
<dd><p>Optional argument</p>
<p>Build source, can be source folder, pypi version specification, or url to a source dist archive or wheel file. If this is blank, it will build the current directory.</p>
</dd></dl>

<p class="rubric">Environment variables</p>
<dl class="std envvar" id="pyodide-build-exports-pyodide-build-exports">
<dt class="sig sig-object std">
<span class="sig-name descname"><span class="pre">PYODIDE_BUILD_EXPORTS</span></span></dt>
<dd><blockquote>
<div><p>Provide a default for <a class="reference internal" href="#cmdoption-pyodide-build-exports"><code class="xref std std-option docutils literal notranslate"><span class="pre">--exports</span></code></a></p>
</div></blockquote>
</dd></dl>

</section>
<section id="pyodide-build-recipes">
<h6 aria-level="7">build-recipes<a class="headerlink" href="#pyodide-build-recipes" title="Link to this heading">#</a></h6>
<p>None</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build-recipes<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>PACKAGES...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-recipe-dir">
<span class="sig-name descname"><span class="pre">--recipe-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;recipe_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-recipe-dir" title="Link to this definition">#</a></dt>
<dd><p>The directory containing the recipe of packages. If not specified, the default is <code class="docutils literal notranslate"><span class="pre">./packages</span></code></p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-build-dir">
<span class="sig-name descname"><span class="pre">--build-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;build_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-build-dir" title="Link to this definition">#</a></dt>
<dd><p>The directory where build directories for packages are created. Default: recipe_dir.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-install">
<span id="cmdoption-pyodide-build-recipes-no-install"></span><span class="sig-name descname"><span class="pre">--install</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-install</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-install" title="Link to this definition">#</a></dt>
<dd><p>If true, install the built packages into the install_dir. If false, build packages without installing.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-install-dir">
<span class="sig-name descname"><span class="pre">--install-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;install_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-install-dir" title="Link to this definition">#</a></dt>
<dd><p>Path to install built packages and pyodide-lock.json. If not specified, the default is <code class="docutils literal notranslate"><span class="pre">./dist</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-metadata-files">
<span id="cmdoption-pyodide-build-recipes-no-metadata-files"></span><span class="sig-name descname"><span class="pre">--metadata-files</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-metadata-files</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-metadata-files" title="Link to this definition">#</a></dt>
<dd><p>If true, extract the METADATA file from the built wheels to a matching <code class="docutils literal notranslate"><span class="pre">*.whl.metadata</span></code> file. If false, no <code class="docutils literal notranslate"><span class="pre">*.whl.metadata</span></code> file is produced.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps">
<span id="cmdoption-pyodide-build-recipes-no-no-deps"></span><span class="sig-name descname"><span class="pre">--no-deps</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-no-deps</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps" title="Link to this definition">#</a></dt>
<dd><p>Removed, use <cite>pyodide build-recipes-no-deps</cite> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-cflags">
<span class="sig-name descname"><span class="pre">--cflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;cflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-cflags" title="Link to this definition">#</a></dt>
<dd><p>Extra compiling flags. Default: SIDE_MODULE_CFLAGS</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-cxxflags">
<span class="sig-name descname"><span class="pre">--cxxflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;cxxflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-cxxflags" title="Link to this definition">#</a></dt>
<dd><p>Extra compiling flags. Default: SIDE_MODULE_CXXFLAGS</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-ldflags">
<span class="sig-name descname"><span class="pre">--ldflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;ldflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-ldflags" title="Link to this definition">#</a></dt>
<dd><p>Extra linking flags. Default: SIDE_MODULE_LDFLAGS</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-target-install-dir">
<span class="sig-name descname"><span class="pre">--target-install-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;target_install_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-target-install-dir" title="Link to this definition">#</a></dt>
<dd><p>The path to the target Python installation. Default: TARGETINSTALLDIR</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-host-install-dir">
<span class="sig-name descname"><span class="pre">--host-install-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;host_install_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-host-install-dir" title="Link to this definition">#</a></dt>
<dd><p>Directory for installing built host packages. Default: HOSTINSTALLDIR</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-log-dir">
<span class="sig-name descname"><span class="pre">--log-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;log_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-log-dir" title="Link to this definition">#</a></dt>
<dd><p>Directory to place log files</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-force-rebuild">
<span id="cmdoption-pyodide-build-recipes-no-force-rebuild"></span><span class="sig-name descname"><span class="pre">--force-rebuild</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-force-rebuild</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-force-rebuild" title="Link to this definition">#</a></dt>
<dd><p>Force rebuild of all packages regardless of whether they appear to have been updated</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-n-jobs">
<span class="sig-name descname"><span class="pre">--n-jobs</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;n_jobs&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-n-jobs" title="Link to this definition">#</a></dt>
<dd><p>Number of packages to build in parallel  (default: # of cores in the system)</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-compression-level">
<span class="sig-name descname"><span class="pre">--compression-level</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;compression_level&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-compression-level" title="Link to this definition">#</a></dt>
<dd><p>Level of zip compression to apply when installing. 0 means no compression.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-arg-PACKAGES">
<span class="sig-name descname"><span class="pre">PACKAGES</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-arg-PACKAGES" title="Link to this definition">#</a></dt>
<dd><p>Required argument(s)</p>
<p>Packages to build, or <code class="docutils literal notranslate"><span class="pre">*</span></code> for all packages in recipe directory</p>
</dd></dl>

<p class="rubric">Environment variables</p>
<dl class="std envvar" id="pyodide-build-recipes-build-dir-pyodide-recipe-build-dir">
<dt class="sig sig-object std">
<span class="sig-name descname"><span class="pre">PYODIDE_RECIPE_BUILD_DIR</span></span></dt>
<dd><blockquote>
<div><p>Provide a default for <a class="reference internal" href="#cmdoption-pyodide-build-recipes-build-dir"><code class="xref std std-option docutils literal notranslate"><span class="pre">--build-dir</span></code></a></p>
</div></blockquote>
</dd></dl>

<dl class="std envvar" id="pyodide-build-recipes-compression-level-pyodide-zip-compression-level">
<dt class="sig sig-object std">
<span class="sig-name descname"><span class="pre">PYODIDE_ZIP_COMPRESSION_LEVEL</span></span></dt>
<dd><blockquote>
<div><p>Provide a default for <a class="reference internal" href="#cmdoption-pyodide-build-recipes-compression-level"><code class="xref std std-option docutils literal notranslate"><span class="pre">--compression-level</span></code></a></p>
</div></blockquote>
</dd></dl>

</section>
<section id="pyodide-build-recipes-no-deps">
<h6 aria-level="7">build-recipes-no-deps<a class="headerlink" href="#pyodide-build-recipes-no-deps" title="Link to this heading">#</a></h6>
<p>Build packages using yaml recipes but don’t try to resolve dependencies</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build-recipes-no-deps<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>PACKAGES...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-recipe-dir">
<span class="sig-name descname"><span class="pre">--recipe-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;recipe_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-recipe-dir" title="Link to this definition">#</a></dt>
<dd><p>The directory containing the recipe of packages. If not specified, the default is <code class="docutils literal notranslate"><span class="pre">./packages</span></code></p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-build-dir">
<span class="sig-name descname"><span class="pre">--build-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;build_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-build-dir" title="Link to this definition">#</a></dt>
<dd><p>The directory where build directories for packages are created. Default: recipe_dir.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-cflags">
<span class="sig-name descname"><span class="pre">--cflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;cflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-cflags" title="Link to this definition">#</a></dt>
<dd><p>Extra compiling flags. Default: SIDE_MODULE_CFLAGS</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-cxxflags">
<span class="sig-name descname"><span class="pre">--cxxflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;cxxflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-cxxflags" title="Link to this definition">#</a></dt>
<dd><p>Extra compiling flags. Default: SIDE_MODULE_CXXFLAGS</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-ldflags">
<span class="sig-name descname"><span class="pre">--ldflags</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;ldflags&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-ldflags" title="Link to this definition">#</a></dt>
<dd><p>Extra linking flags. Default: SIDE_MODULE_LDFLAGS</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-target-install-dir">
<span class="sig-name descname"><span class="pre">--target-install-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;target_install_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-target-install-dir" title="Link to this definition">#</a></dt>
<dd><p>The path to the target Python installation. Default: TARGETINSTALLDIR</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-host-install-dir">
<span class="sig-name descname"><span class="pre">--host-install-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;host_install_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-host-install-dir" title="Link to this definition">#</a></dt>
<dd><p>Directory for installing built host packages. Default: HOSTINSTALLDIR</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-force-rebuild">
<span id="cmdoption-pyodide-build-recipes-no-deps-no-force-rebuild"></span><span class="sig-name descname"><span class="pre">--force-rebuild</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-force-rebuild</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-force-rebuild" title="Link to this definition">#</a></dt>
<dd><p>Force rebuild of all packages regardless of whether they appear to have been updated</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-continue">
<span class="sig-name descname"><span class="pre">--continue</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-continue" title="Link to this definition">#</a></dt>
<dd><p>Continue a build from the middle. For debugging. Implies ‘–force-rebuild’</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-build-recipes-no-deps-arg-PACKAGES">
<span class="sig-name descname"><span class="pre">PACKAGES</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-build-recipes-no-deps-arg-PACKAGES" title="Link to this definition">#</a></dt>
<dd><p>Required argument(s)</p>
<p>Packages to build, or <code class="docutils literal notranslate"><span class="pre">*</span></code> for all packages in recipe directory</p>
</dd></dl>

<p class="rubric">Environment variables</p>
<dl class="std envvar" id="pyodide-build-recipes-no-deps-build-dir-pyodide-recipe-build-dir">
<dt class="sig sig-object std">
<span class="sig-name descname"><span class="pre">PYODIDE_RECIPE_BUILD_DIR</span></span></dt>
<dd><blockquote>
<div><p>Provide a default for <a class="reference internal" href="#cmdoption-pyodide-build-recipes-no-deps-build-dir"><code class="xref std std-option docutils literal notranslate"><span class="pre">--build-dir</span></code></a></p>
</div></blockquote>
</dd></dl>

</section>
<section id="pyodide-config">
<h6 aria-level="7">config<a class="headerlink" href="#pyodide-config" title="Link to this heading">#</a></h6>
<p>Manage config variables used in pyodide</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>config<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<section id="pyodide-config-get">
<h6 aria-level="8">get<a class="headerlink" href="#pyodide-config-get" title="Link to this heading">#</a></h6>
<p>Get a value of a single config variable used in pyodide</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>config<span class="w"> </span>get<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>CONFIG_VAR
</pre></div>
</div>
<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-config-get-arg-CONFIG_VAR">
<span class="sig-name descname"><span class="pre">CONFIG_VAR</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-config-get-arg-CONFIG_VAR" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>A config variable to get. Use <cite>list</cite> to see all possible values.</p>
</dd></dl>

</section>
<section id="pyodide-config-list">
<h6 aria-level="8">list<a class="headerlink" href="#pyodide-config-list" title="Link to this heading">#</a></h6>
<p>List config variables used in pyodide</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>config<span class="w"> </span>list<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
</section>
</section>
<section id="pyodide-lockfile">
<h6 aria-level="7">lockfile<a class="headerlink" href="#pyodide-lockfile" title="Link to this heading">#</a></h6>
<p>manipulate pyodide-lock.json lockfiles.</p>
<p>Registered by: pyodide-lock</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>lockfile<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<section id="pyodide-lockfile-add-wheels">
<h6 aria-level="8">add-wheels<a class="headerlink" href="#pyodide-lockfile-add-wheels" title="Link to this heading">#</a></h6>
<p>Add a set of package wheels to an existing pyodide-lock.json and
write it out to pyodide-lock-new.json</p>
<p>Each package in the wheel will be added to the output lockfile,
including resolution of dependencies in the lock file. By default
this will fail if a dependency isn’t available in either the
existing lock file, or in the set of new wheels.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>lockfile<span class="w"> </span>add-wheels<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>WHEELS...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-ignore-missing-dependencies">
<span id="cmdoption-pyodide-lockfile-add-wheels-no-ignore-missing-dependencies"></span><span class="sig-name descname"><span class="pre">--ignore-missing-dependencies</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-ignore-missing-dependencies</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-ignore-missing-dependencies" title="Link to this definition">#</a></dt>
<dd><p>If this is true, dependencies which are not in the original lockfile or the added wheels will be added to the lockfile. Warning: This will allow a broken lockfile to be created.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-input">
<span class="sig-name descname"><span class="pre">--input</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;input&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-input" title="Link to this definition">#</a></dt>
<dd><p>Source lockfile</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">PosixPath('pyodide-lock.json')</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-output">
<span class="sig-name descname"><span class="pre">--output</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-output" title="Link to this definition">#</a></dt>
<dd><p>Updated lockfile</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">PosixPath('pyodide-lock-new.json')</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-base-path">
<span class="sig-name descname"><span class="pre">--base-path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;base_path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-base-path" title="Link to this definition">#</a></dt>
<dd><p>Base path for wheels - wheel file names will be created relative to this path.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-wheel-url">
<span class="sig-name descname"><span class="pre">--wheel-url</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;wheel_url&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-wheel-url" title="Link to this definition">#</a></dt>
<dd><p>Base url which will be appended to the wheel location.Use this if you are hosting these wheels on a different server to core pyodide packages</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-lockfile-add-wheels-arg-WHEELS">
<span class="sig-name descname"><span class="pre">WHEELS</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-lockfile-add-wheels-arg-WHEELS" title="Link to this definition">#</a></dt>
<dd><p>Required argument(s)</p>
</dd></dl>

</section>
</section>
<section id="pyodide-py-compile">
<h6 aria-level="7">py-compile<a class="headerlink" href="#pyodide-py-compile" title="Link to this heading">#</a></h6>
<p>Compile .py files to .pyc in a wheel, a zip file, or a folder with wheels or zip files.</p>
<blockquote>
<div><p>If the provided folder contains the <cite>pyodide-lock.json</cite> file, it will be
rewritten with the updated wheel / zip file paths and sha256 checksums.</p>
</div></blockquote>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>py-compile<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>PATH
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-py-compile-silent">
<span id="cmdoption-pyodide-py-compile-no-silent"></span><span class="sig-name descname"><span class="pre">--silent</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-silent</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-py-compile-silent" title="Link to this definition">#</a></dt>
<dd><p>Silent mode, do not print anything.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-py-compile-keep">
<span id="cmdoption-pyodide-py-compile-no-keep"></span><span class="sig-name descname"><span class="pre">--keep</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-keep</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-py-compile-keep" title="Link to this definition">#</a></dt>
<dd><p>Keep the original wheel / zip file.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-py-compile-compression-level">
<span class="sig-name descname"><span class="pre">--compression-level</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;compression_level&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-py-compile-compression-level" title="Link to this definition">#</a></dt>
<dd><p>Compression level to use for the created zip file</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-py-compile-exclude">
<span class="sig-name descname"><span class="pre">--exclude</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;exclude&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-py-compile-exclude" title="Link to this definition">#</a></dt>
<dd><p>List of files to exclude from compilation, works only for directories. Defaults to no files.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">''</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-py-compile-arg-PATH">
<span class="sig-name descname"><span class="pre">PATH</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-py-compile-arg-PATH" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>Path to the input wheel or a folder with wheels or zip files.</p>
</dd></dl>

</section>
<section id="pyodide-skeleton">
<h6 aria-level="7">skeleton<a class="headerlink" href="#pyodide-skeleton" title="Link to this heading">#</a></h6>
<p>Add a new package build recipe or update an existing recipe</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>skeleton<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<section id="pyodide-skeleton-pypi">
<h6 aria-level="8">pypi<a class="headerlink" href="#pyodide-skeleton-pypi" title="Link to this heading">#</a></h6>
<p>Create a new package recipe from PyPI or update an existing recipe.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>skeleton<span class="w"> </span>pypi<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>NAME
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-u">
<span id="cmdoption-pyodide-skeleton-pypi-update"></span><span class="sig-name descname"><span class="pre">-u</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--update</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-u" title="Link to this definition">#</a></dt>
<dd><p>Update an existing recipe instead of creating a new one</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-update-patched">
<span class="sig-name descname"><span class="pre">--update-patched</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-update-patched" title="Link to this definition">#</a></dt>
<dd><p>Force update the package even if it contains patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-version">
<span class="sig-name descname"><span class="pre">--version</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;version&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-version" title="Link to this definition">#</a></dt>
<dd><p>The version of the package, if not specified, latest version will be used.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-source-format">
<span class="sig-name descname"><span class="pre">--source-format</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;source_format&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-source-format" title="Link to this definition">#</a></dt>
<dd><p>Which source format is preferred. Options are wheel or sdist. If not specified, then either a wheel or an sdist will be used.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-recipe-dir">
<span class="sig-name descname"><span class="pre">--recipe-dir</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;recipe_dir&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-recipe-dir" title="Link to this definition">#</a></dt>
<dd><p>The directory containing the recipe of packages.If not specified, the default is <code class="docutils literal notranslate"><span class="pre">&lt;cwd&gt;/packages</span></code>.</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-skeleton-pypi-arg-NAME">
<span class="sig-name descname"><span class="pre">NAME</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-skeleton-pypi-arg-NAME" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
</dd></dl>

</section>
</section>
<section id="pyodide-venv">
<h6 aria-level="7">venv<a class="headerlink" href="#pyodide-venv" title="Link to this heading">#</a></h6>
<p>Create a Pyodide virtual environment</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>venv<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>DEST
</pre></div>
</div>
<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-venv-arg-DEST">
<span class="sig-name descname"><span class="pre">DEST</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-venv-arg-DEST" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>directory to create virtualenv at</p>
</dd></dl>

</section>
<section id="pyodide-xbuildenv">
<h6 aria-level="7">xbuildenv<a class="headerlink" href="#pyodide-xbuildenv" title="Link to this heading">#</a></h6>
<p>Manage cross-build environment for building packages for Pyodide.</p>
<p>Registered by: pyodide-build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<section id="pyodide-xbuildenv-install">
<h6 aria-level="8">install<a class="headerlink" href="#pyodide-xbuildenv-install" title="Link to this heading">#</a></h6>
<p>Install cross-build environment.</p>
<p>The installed environment is the same as the one that would result from
<cite>PYODIDE_PACKAGES=’scipy’ make</cite> except that it is much faster.
The goal is to enable out-of-tree builds for binary packages that depend
on numpy or scipy.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>install<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>VERSION<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-install-path">
<span class="sig-name descname"><span class="pre">--path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-install-path" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment directory</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'.pyodide-xbuildenv-0.29.2'</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-install-url">
<span class="sig-name descname"><span class="pre">--url</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;url&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-install-url" title="Link to this definition">#</a></dt>
<dd><p>URL to download cross-build environment from</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-install-f">
<span id="cmdoption-pyodide-xbuildenv-install-force"></span><span class="sig-name descname"><span class="pre">-f</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--force</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-install-f" title="Link to this definition">#</a></dt>
<dd><p>force installation even if the version is not compatible</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-install-arg-VERSION">
<span class="sig-name descname"><span class="pre">VERSION</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-install-arg-VERSION" title="Link to this definition">#</a></dt>
<dd><p>Optional argument</p>
<p>version of cross-build environment to install</p>
</dd></dl>

</section>
<section id="pyodide-xbuildenv-search">
<h6 aria-level="8">search<a class="headerlink" href="#pyodide-xbuildenv-search" title="Link to this heading">#</a></h6>
<p>Search for available versions of cross-build environment.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>search<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-search-metadata">
<span class="sig-name descname"><span class="pre">--metadata</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;metadata_path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-search-metadata" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment metadata file. It can be a URL or a local file. If not given, the default metadata file is used.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-search-a">
<span id="cmdoption-pyodide-xbuildenv-search-all"></span><span class="sig-name descname"><span class="pre">-a</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--all</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-search-a" title="Link to this definition">#</a></dt>
<dd><p>search all versions, without filtering out incompatible ones</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-search-json">
<span class="sig-name descname"><span class="pre">--json</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-search-json" title="Link to this definition">#</a></dt>
<dd><p>output results in JSON format</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pyodide-xbuildenv-uninstall">
<h6 aria-level="8">uninstall<a class="headerlink" href="#pyodide-xbuildenv-uninstall" title="Link to this heading">#</a></h6>
<p>Uninstall cross-build environment.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>uninstall<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>VERSION<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-uninstall-path">
<span class="sig-name descname"><span class="pre">--path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-uninstall-path" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment directory</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'.pyodide-xbuildenv-0.29.2'</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-uninstall-arg-VERSION">
<span class="sig-name descname"><span class="pre">VERSION</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-uninstall-arg-VERSION" title="Link to this definition">#</a></dt>
<dd><p>Optional argument</p>
<p>version of cross-build environment to uninstall</p>
</dd></dl>

</section>
<section id="pyodide-xbuildenv-use">
<h6 aria-level="8">use<a class="headerlink" href="#pyodide-xbuildenv-use" title="Link to this heading">#</a></h6>
<p>Select a version of cross-build environment to use.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>use<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>VERSION
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-use-path">
<span class="sig-name descname"><span class="pre">--path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-use-path" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment directory</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'.pyodide-xbuildenv-0.29.2'</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-use-arg-VERSION">
<span class="sig-name descname"><span class="pre">VERSION</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-use-arg-VERSION" title="Link to this definition">#</a></dt>
<dd><p>Required argument</p>
<p>version of cross-build environment to use</p>
</dd></dl>

</section>
<section id="pyodide-xbuildenv-version">
<h6 aria-level="8">version<a class="headerlink" href="#pyodide-xbuildenv-version" title="Link to this heading">#</a></h6>
<p>Print current version of cross-build environment.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>version<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-version-path">
<span class="sig-name descname"><span class="pre">--path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-version-path" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment directory</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'.pyodide-xbuildenv-0.29.2'</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pyodide-xbuildenv-versions">
<h6 aria-level="8">versions<a class="headerlink" href="#pyodide-xbuildenv-versions" title="Link to this heading">#</a></h6>
<p>Print all installed versions of cross-build environment.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>xbuildenv<span class="w"> </span>versions<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-pyodide-xbuildenv-versions-path">
<span class="sig-name descname"><span class="pre">--path</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-pyodide-xbuildenv-versions-path" title="Link to this definition">#</a></dt>
<dd><p>path to cross-build environment directory</p>
<dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">'.pyodide-xbuildenv-0.29.2'</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
</section>
</div>
</section>
<span id="document-usage/faq"></span><section id="frequently-asked-questions">
<h4>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Link to this heading">#</a></h4>
<section id="how-can-i-load-external-files-in-pyodide">
<span id="load-external-files-in-pyodide"></span><h5>How can I load external files in Pyodide?<a class="headerlink" href="#how-can-i-load-external-files-in-pyodide" title="Link to this heading">#</a></h5>
<p>See <a class="reference internal" href="#accessing-files-quickref"><span class="std std-ref">Accessing Files Quick Reference</span></a>.</p>
</section>
<section id="why-can-t-i-load-files-from-the-local-file-system">
<h5>Why can’t I load files from the local file system?<a class="headerlink" href="#why-can-t-i-load-files-from-the-local-file-system" title="Link to this heading">#</a></h5>
<p>For security reasons JavaScript in the browser is not allowed to load local data files
(for example, <code class="docutils literal notranslate"><span class="pre">file:///path/to/local/file.data</span></code>).
You will run into Network Errors, due to the <a class="reference external" href="https://en.wikipedia.org/wiki/Same-origin_policy">Same Origin Policy</a>.
There is a
<a class="reference external" href="https://wicg.github.io/file-system-access/">File System API</a> supported in Chrome
but not in Firefox or Safari. See <a class="reference internal" href="#nativefs-api"><span class="std std-ref">(Experimental) Using the native file system in the browser</span></a> for experimental local file system
support.</p>
<p>For development purposes, you can serve your files with a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server">web server</a>.</p>
</section>
<section id="how-can-i-execute-code-in-a-custom-namespace">
<h5>How can I execute code in a custom namespace?<a class="headerlink" href="#how-can-i-execute-code-in-a-custom-namespace" title="Link to this heading">#</a></h5>
<p>The second argument to <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.runPython()</span></code></a> is an options object which may
include a <code class="docutils literal notranslate"><span class="pre">globals</span></code> element which is a namespace for code to read from and write
to. The provided namespace must be a Python dictionary.</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">my_namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)();</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="s">`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="o">:</span><span class="w"> </span><span class="nx">my_namespace</span><span class="w"> </span><span class="p">});</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">**</span> <span class="n">x</span><span class="s">`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="o">:</span><span class="w"> </span><span class="nx">my_namespace</span><span class="w"> </span><span class="p">});</span>
<span class="nx">my_namespace</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// ==&gt; 4</span>
</pre></div>
</div>
<p>You can also use this approach to inject variables from JavaScript into the
Python namespace, for example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">my_namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">toPy</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="p">});</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span>
<span class="w">  </span><span class="sb">`</span>
<span class="sb">  assert x == y[1]</span>
<span class="sb">  z = x ** x</span>
<span class="sb">  `</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">globals</span><span class="o">:</span><span class="w"> </span><span class="nx">my_namespace</span><span class="w"> </span><span class="p">}</span>
<span class="p">);</span>
<span class="nx">my_namespace</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// ==&gt; 4</span>
</pre></div>
</div>
</section>
<section id="how-to-detect-that-code-is-run-with-pyodide">
<h5>How to detect that code is run with Pyodide?<a class="headerlink" href="#how-to-detect-that-code-is-run-with-pyodide" title="Link to this heading">#</a></h5>
<p><strong>At run time</strong>, you can check if Python is built with Emscripten (which is the
case for Pyodide) with,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;emscripten&#39;</span><span class="p">:</span>
    <span class="c1"># running in Pyodide or other Emscripten based build</span>
</pre></div>
</div>
<p>To detect that a code is running with Pyodide specifically, you can check
for the loaded <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> module,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="k">if</span> <span class="s2">&quot;pyodide&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
   <span class="c1"># running in Pyodide</span>
</pre></div>
</div>
<p>This however will not work at build time (i.e. in a <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>) due to the way
the Pyodide build system works. It first compiles packages with the host compiler
(e.g. gcc) and then re-runs the compilation commands with emsdk. So the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> is
never run inside the Pyodide environment.</p>
<p>To detect Pyodide, <strong>at build time</strong> use,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="k">if</span> <span class="s2">&quot;PYODIDE&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="c1"># building for Pyodide</span>
</pre></div>
</div>
</section>
<section id="how-do-i-create-custom-python-packages-from-javascript">
<h5>How do I create custom Python packages from JavaScript?<a class="headerlink" href="#how-do-i-create-custom-python-packages-from-javascript" title="Link to this heading">#</a></h5>
<p>Put a collection of functions into a JavaScript object and use
<a class="reference internal" href="#pyodide.registerJsModule" title="pyodide.registerJsModule"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.registerJsModule()</span></code></a>:
JavaScript:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">my_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">f</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">g</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Calling g on argument </span><span class="si">${</span><span class="nx">x</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">submodule</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">h</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">c</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">};</span>
<span class="nx">pyodide</span><span class="p">.</span><span class="nx">registerJsModule</span><span class="p">(</span><span class="s2">&quot;my_js_module&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">my_module</span><span class="p">);</span>
</pre></div>
</div>
<p>You can import your package like a normal Python package:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">my_js_module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">my_js_module.submodule</span><span class="w"> </span><span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span>
<span class="k">assert</span> <span class="n">my_js_module</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50</span>
<span class="k">assert</span> <span class="n">h</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="mi">80</span>
<span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="how-can-i-send-a-python-object-from-my-server-to-pyodide">
<h5>How can I send a Python object from my server to Pyodide?<a class="headerlink" href="#how-can-i-send-a-python-object-from-my-server-to-pyodide" title="Link to this heading">#</a></h5>
<p>The best way to do this is with pickle. If the version of Python used in the
server exactly matches the version of Python used in the client, then objects
that can be successfully pickled can be sent to the client and unpickled in
Pyodide. If the versions of Python are different then for instance sending AST
is unlikely to work since there are breaking changes to Python AST in most
Python minor versions.</p>
<p>Similarly when pickling Python objects defined in a Python package, the package
version needs to match exactly between the server and pyodide.</p>
<p>Generally, pickles are portable between architectures (here amd64 and wasm32).
The rare cases when they are not portable, for instance currently tree based
models in scikit-learn, can be considered as a bug in the upstream library.</p>
<div class="warning admonition">
<p class="admonition-title">Security Issues with pickle</p>
<p>Unpickling data is similar to <code class="docutils literal notranslate"><span class="pre">eval</span></code>. On any public-facing server it is a really
bad idea to unpickle any data sent from the client. For sending data from client
to server, try some other serialization format like JSON.</p>
</div>
</section>
<section id="how-can-i-use-a-python-function-as-an-event-handler">
<h5>How can I use a Python function as an event handler?<a class="headerlink" href="#how-can-i-use-a-python-function-as-an-event-handler" title="Link to this heading">#</a></h5>
<p>Note that the most straight forward way of doing this will not work:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">document</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s2">&quot;h1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">innerHTML</span> <span class="o">+=</span> <span class="s2">&quot;(&gt;.&lt;)&quot;</span>

<span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>Now every time you click, an error will be raised (see <a class="reference internal" href="#call-js-from-py"><span class="std std-ref">Calling JavaScript functions from Python</span></a>).</p>
<p>To do this correctly use <a class="reference internal" href="#pyodide.ffi.create_proxy" title="pyodide.ffi.create_proxy"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_proxy()</span></code></a> as follows:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">document</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_proxy</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s2">&quot;h1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">innerHTML</span> <span class="o">+=</span> <span class="s2">&quot;(&gt;.&lt;)&quot;</span>

<span class="n">proxy_f</span> <span class="o">=</span> <span class="n">create_proxy</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="n">proxy_f</span><span class="p">)</span>
<span class="c1"># Store proxy_f in Python then later:</span>
<span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="n">proxy_f</span><span class="p">)</span>
<span class="n">proxy_f</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="how-can-i-use-fetch-with-optional-arguments-from-python">
<h5>How can I use fetch with optional arguments from Python?<a class="headerlink" href="#how-can-i-use-fetch-with-optional-arguments-from-python" title="Link to this heading">#</a></h5>
<p>The most obvious translation of the JavaScript code won’t work:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="n">resp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">js</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/someurl&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s2">&quot;some&quot;</span> <span class="p">:</span> <span class="s2">&quot;json&quot;</span> <span class="p">}),</span>
  <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;same-origin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span> <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch" title="(in MDN docs)"><code class="xref js js-func docutils literal notranslate"><span class="pre">fetch()</span></code></a> API ignores the options that we attempted to provide. You can do
this correctly in one of two ways:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_js</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Object</span>
<span class="n">resp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">js</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;example.com/some_api&#39;</span><span class="p">,</span>
  <span class="n">method</span><span class="o">=</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
  <span class="n">body</span><span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s2">&quot;some&quot;</span> <span class="p">:</span> <span class="s2">&quot;json&quot;</span> <span class="p">}),</span>
  <span class="n">credentials</span><span class="o">=</span> <span class="s2">&quot;same-origin&quot;</span><span class="p">,</span>
  <span class="n">headers</span><span class="o">=</span> <span class="n">Object</span><span class="o">.</span><span class="n">fromEntries</span><span class="p">(</span><span class="n">to_js</span><span class="p">({</span> <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span> <span class="p">})),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.ffi</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_js</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Object</span>
<span class="n">resp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">js</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;example.com/some_api&#39;</span><span class="p">,</span> <span class="n">to_js</span><span class="p">({</span>
  <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s2">&quot;some&quot;</span> <span class="p">:</span> <span class="s2">&quot;json&quot;</span> <span class="p">}),</span>
  <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;same-origin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span> <span class="p">}</span>
<span class="p">},</span> <span class="n">dict_converter</span><span class="o">=</span><span class="n">Object</span><span class="o">.</span><span class="n">fromEntries</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-can-i-control-the-behavior-of-stdin-stdout-stderr">
<h5>How can I control the behavior of stdin / stdout / stderr?<a class="headerlink" href="#how-can-i-control-the-behavior-of-stdin-stdout-stderr" title="Link to this heading">#</a></h5>
<p>If you wish to override <code class="docutils literal notranslate"><span class="pre">stdin</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code> or <code class="docutils literal notranslate"><span class="pre">stderr</span></code> for the entire Pyodide
runtime, you can pass options to <a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a>: If
you say</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">loadPyodide</span><span class="p">({</span>
<span class="w">  </span><span class="nx">stdin</span><span class="o">:</span><span class="w"> </span><span class="nx">stdin_func</span><span class="p">,</span>
<span class="w">  </span><span class="nx">stdout</span><span class="o">:</span><span class="w"> </span><span class="nx">stdout_func</span><span class="p">,</span>
<span class="w">  </span><span class="nx">stderr</span><span class="o">:</span><span class="w"> </span><span class="nx">stderr_func</span><span class="p">,</span>
<span class="p">});</span>
</pre></div>
</div>
<p>then every time a line is written to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> (resp. <code class="docutils literal notranslate"><span class="pre">stderr</span></code>), <code class="docutils literal notranslate"><span class="pre">stdout_func</span></code>
(resp <code class="docutils literal notranslate"><span class="pre">stderr_func</span></code>) will be called on the line. Every time <code class="docutils literal notranslate"><span class="pre">stdin</span></code> is read,
<code class="docutils literal notranslate"><span class="pre">stdin_func</span></code> will be called with zero arguments. It is expected to return a
string which is interpreted as a line of text.</p>
<p>You can also use the functions <a class="reference internal" href="#pyodide.setStdin" title="pyodide.setStdin"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdin()</span></code></a>,
<a class="reference internal" href="#pyodide.setStdout" title="pyodide.setStdout"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStdout()</span></code></a>, and <a class="reference internal" href="#pyodide.setStderr" title="pyodide.setStderr"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.setStderr()</span></code></a>.</p>
<p>Temporary redirection works much the same as it does in native Python: you can
overwrite <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdin" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdin</span></code></a>, <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stdout" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdout</span></code></a>, and <a class="reference external" href="https://docs.python.org/3.12/library/sys.html#sys.stderr" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>
respectively. If you want to do it temporarily, it’s recommended to use
<a class="reference external" href="https://docs.python.org/3.12/library/contextlib.html#contextlib.redirect_stdout" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">contextlib.redirect_stdout()</span></code></a> and <a class="reference external" href="https://docs.python.org/3.12/library/contextlib.html#contextlib.redirect_stderr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">contextlib.redirect_stderr()</span></code></a>
There is no <code class="docutils literal notranslate"><span class="pre">contextlib.redirect_stdin()</span></code> but it is easy to make your own as
follows:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_RedirectStream</span>
<span class="k">class</span><span class="w"> </span><span class="nc">redirect_stdin</span><span class="p">(</span><span class="n">_RedirectStream</span><span class="p">):</span>
    <span class="n">_stream</span> <span class="o">=</span> <span class="s2">&quot;stdin&quot;</span>
</pre></div>
</div>
<p>For example, if you do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>
<span class="k">with</span> <span class="n">redirect_stdin</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;eval&quot;</span><span class="p">,</span> <span class="s2">&quot;asyncio.ensure_future&quot;</span><span class="p">,</span> <span class="s2">&quot;functools.reduce&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">]))):</span>
  <span class="n">help</span><span class="p">()</span>
</pre></div>
</div>
<p>it will print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">Python</span> <span class="mf">3.10</span><span class="s1">&#39;s help utility!</span>
<span class="o">&lt;...</span><span class="n">OMITTED</span> <span class="n">LINES</span><span class="o">&gt;</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">eval</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">builtins</span><span class="p">:</span>
<span class="nb">eval</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span>
    <span class="n">Evaluate</span> <span class="n">the</span> <span class="n">given</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">context</span> <span class="n">of</span> <span class="nb">globals</span> <span class="ow">and</span> <span class="nb">locals</span><span class="o">.</span>
<span class="o">&lt;...</span><span class="n">OMITTED</span> <span class="n">LINES</span><span class="o">&gt;</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">ensure_future</span> <span class="ow">in</span> <span class="n">asyncio</span><span class="p">:</span>
<span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span> <span class="o">=</span> <span class="n">ensure_future</span><span class="p">(</span><span class="n">coro_or_future</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Wrap</span> <span class="n">a</span> <span class="n">coroutine</span> <span class="ow">or</span> <span class="n">an</span> <span class="n">awaitable</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">future</span><span class="o">.</span>
<span class="o">&lt;...</span><span class="n">OMITTED</span> <span class="n">LINES</span><span class="o">&gt;</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">reduce</span> <span class="ow">in</span> <span class="n">functools</span><span class="p">:</span>
<span class="n">functools</span><span class="o">.</span><span class="n">reduce</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">reduce</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">sequence</span><span class="p">[,</span> <span class="n">initial</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">value</span>
    <span class="n">Apply</span> <span class="n">a</span> <span class="n">function</span> <span class="n">of</span> <span class="n">two</span> <span class="n">arguments</span> <span class="n">cumulatively</span> <span class="n">to</span> <span class="n">the</span> <span class="n">items</span> <span class="n">of</span> <span class="n">a</span> <span class="n">sequence</span><span class="p">,</span>
<span class="o">&lt;...</span><span class="n">OMITTED</span> <span class="n">LINES</span><span class="o">&gt;</span>
<span class="n">You</span> <span class="n">are</span> <span class="n">now</span> <span class="n">leaving</span> <span class="n">help</span> <span class="ow">and</span> <span class="n">returning</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Python</span> <span class="n">interpreter</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="why-can-t-micropip-find-a-pure-python-wheel-for-a-package">
<h5>Why can’t Micropip find a “pure Python wheel” for a package?<a class="headerlink" href="#why-can-t-micropip-find-a-pure-python-wheel-for-a-package" title="Link to this heading">#</a></h5>
<p>When installing a Python package from PyPI, micropip will produce an error if
it cannot find a pure Python wheel. To determine if a package has a pure
Python wheel manually, you can open its PyPi page (for instance
https://pypi.org/project/snowballstemmer/) and go to the “Download files” tab.
If this tab doesn’t contain a file <code class="docutils literal notranslate"><span class="pre">*py3-none-any.whl</span></code> then the pure Python
wheel is missing.</p>
<p>This can happen for two reasons,</p>
<ol class="arabic simple">
<li><p>either the package is pure Python (you can check language composition for a
package on Github), and its maintainers didn’t upload a wheel.
In this case, you can report this issue to the package issue tracker. As a
temporary solution, you can also <a class="reference external" href="https://packaging.python.org/en/latest/tutorials/packaging-projects/#generating-distribution-archives">build the
wheel</a>
yourself, upload it to some temporary location and install it with micropip
from the corresponding URL.</p></li>
<li><p>or the package has binary extensions (e.g. C, Fortran or Rust), in which
case it needs to be packaged in Pyodide. Please open <a class="reference external" href="https://github.com/pyodide/pyodide/issues">an
issue</a> after checking that an
issue for this package doesn’t exist already. Then follow
<a class="reference internal" href="#new-packages"><span class="std std-ref">Creating a Pyodide package</span></a>.</p></li>
</ol>
</section>
<section id="how-can-i-change-the-behavior-of-runpython-and-runpythonasync">
<h5>How can I change the behavior of <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">runPython()</span></code></a> and <a class="reference internal" href="#pyodide.runPythonAsync" title="pyodide.runPythonAsync"><code class="xref js js-func docutils literal notranslate"><span class="pre">runPythonAsync()</span></code></a>?<a class="headerlink" href="#how-can-i-change-the-behavior-of-runpython-and-runpythonasync" title="Link to this heading">#</a></h5>
<p>You can directly call Python functions from JavaScript. For most purposes it
makes sense to make your own Python function as an entrypoint and call that
instead of redefining <code class="docutils literal notranslate"><span class="pre">runPython</span></code>. The definitions of
<a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">runPython()</span></code></a> and <a class="reference internal" href="#pyodide.runPythonAsync" title="pyodide.runPythonAsync"><code class="xref js js-func docutils literal notranslate"><span class="pre">runPythonAsync()</span></code></a> are very
simple:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">runPython</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyodide_py</span><span class="p">.</span><span class="nx">code</span><span class="p">.</span><span class="nx">eval_code</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">pyodide_py</span><span class="p">.</span><span class="nx">code</span><span class="p">.</span><span class="nx">eval_code_async</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To make your own version of <a class="reference internal" href="#pyodide.runPython" title="pyodide.runPython"><code class="xref js js-func docutils literal notranslate"><span class="pre">runPython()</span></code></a> you could do:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">my_eval_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
  <span class="kn">from</span><span class="w"> </span><span class="nn">pyodide.code</span><span class="w"> </span><span class="kn">import</span> <span class="n">eval_code</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">my_eval_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">extra_info</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">eval_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">globals</span><span class="p">,</span> <span class="nb">locals</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">globals</span><span class="p">[</span><span class="s2">&quot;extra_info&quot;</span><span class="p">],</span> <span class="n">result</span>
  <span class="n">my_eval_code</span>
<span class="s">`</span><span class="p">)</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">myRunPython</span><span class="p">(</span><span class="nx">code</span><span class="p">){</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">my_eval_code</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">globals</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then <code class="docutils literal notranslate"><span class="pre">myRunPython(&quot;2+7&quot;)</span></code> returns <code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">9]</span></code> and
<code class="docutils literal notranslate"><span class="pre">myRunPython(&quot;extra_info='hello'</span> <span class="pre">;</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">2&quot;)</span></code> returns <code class="docutils literal notranslate"><span class="pre">['hello',</span> <span class="pre">4]</span></code>. If you want
to change which packages <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports()</span></code></a> loads, you
can monkey patch <a class="reference internal" href="#pyodide.code.find_imports" title="pyodide.code.find_imports"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyodide.code.find_imports()</span></code></a> which takes <code class="docutils literal notranslate"><span class="pre">code</span></code> as an
argument and returns a list of packages imported.</p>
</section>
<section id="why-can-t-i-import-a-file-i-just-wrote-to-the-file-system">
<h5>Why can’t I import a file I just wrote to the file system?<a class="headerlink" href="#why-can-t-i-import-a-file-i-just-wrote-to-the-file-system" title="Link to this heading">#</a></h5>
<p>For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">Path</span><span class="p">(</span><span class="s2">&quot;mymodule.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">def hello():</span>
<span class="s2">  print(&quot;hello world!&quot;)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mymodule</span><span class="w"> </span><span class="kn">import</span> <span class="n">hello</span> <span class="c1"># may raise &quot;ModuleNotFoundError: No module named &#39;mymodule&#39;&quot;</span>
<span class="n">hello</span><span class="p">()</span>
</pre></div>
</div>
<p>If you see this error, call <a class="reference external" href="https://docs.python.org/3.12/library/importlib.html#importlib.invalidate_caches" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.invalidate_caches()</span></code></a> before
importing the module:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">Path</span><span class="p">(</span><span class="s2">&quot;mymodule.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">def hello():</span>
<span class="s2">  print(&quot;hello world!&quot;)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">invalidate_caches</span><span class="p">()</span> <span class="c1"># Make sure Python notices the new .py file</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mymodule</span><span class="w"> </span><span class="kn">import</span> <span class="n">hello</span>
<span class="n">hello</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="why-changes-made-to-indexeddb-don-t-persist">
<h5>Why changes made to IndexedDB don’t persist?<a class="headerlink" href="#why-changes-made-to-indexeddb-don-t-persist" title="Link to this heading">#</a></h5>
<p>Unlike other filesystems, IndexedDB (pyodide.FS.filesystem.IDBFS) is an asynchronous filesystem.
This is because browsers offer only asynchronous interfaces for IndexedDB.
So in order to persist changes, you have to call
<a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#FS.syncfs"><code class="docutils literal notranslate"><span class="pre">pyodide.FS.syncfs()</span></code></a>.
See <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#persistent-data">Emscripten File System API</a>
for more details.</p>
</section>
<section id="how-can-i-access-javascript-objects-attributes-in-python-if-their-names-are-python-keywords">
<h5>How can I access JavaScript objects/attributes in Python if their names are Python keywords?<a class="headerlink" href="#how-can-i-access-javascript-objects-attributes-in-python-if-their-names-are-python-keywords" title="Link to this heading">#</a></h5>
<p>Some JavaScript objects may have names or attributes which are also <a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#keywords">Python Keywords</a>, making them difficult to interact with when importing them into Python. For example, all three of the following uses of <code class="docutils literal notranslate"><span class="pre">runPython</span></code> will throw a SyntaxError:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="c1">//The built-in method Array.from() overlaps with Python&#39;s &quot;from&quot;</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">Array</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span><span class="s">`</span><span class="p">);</span>

<span class="c1">//&quot;global&quot; is a valid attribute name in JS, but a reserved keyword in Python</span>
<span class="nx">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nb">global</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lots and lots&quot;</span><span class="p">};</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">people</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="k">global</span><span class="p">)</span><span class="s">`</span><span class="p">);</span>

<span class="c1">//&quot;lambda&quot; is a valid object name in JS, but a reserved keyword in Python</span>
<span class="nx">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">};</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span><span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="k">lambda</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="k">lambda</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>If you try to access a Python reserved word followed by one or more underscores
on a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code>, Pyodide will remove a single underscore:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Array</span><span class="o">.</span><span class="n">from_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>If you meant to access the keyword with an underscore at the end, you’ll have to
add an extra one:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span>
<span class="nb">globalThis</span><span class="p">.</span><span class="nx">lambda_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8</span><span class="p">;</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">lambda__</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lambda_</span><span class="p">,</span> <span class="n">lambda__</span><span class="p">)</span> <span class="c1"># 7, 8</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nx">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nb">global</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lots and lots&quot;</span><span class="p">};</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">people</span>
    <span class="c1"># the dir contains global_ but not global:</span>
    <span class="k">assert</span> <span class="s2">&quot;global_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">people</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;global&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">people</span><span class="p">)</span>
    <span class="n">people</span><span class="o">.</span><span class="n">global_</span> <span class="o">=</span> <span class="s1">&#39;even more&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">global_</span><span class="p">)</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">getattr</span></code>, <code class="docutils literal notranslate"><span class="pre">setattr</span></code>, and <code class="docutils literal notranslate"><span class="pre">delattr</span></code> to access the attribute:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span>
    <span class="n">fromFunc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fromFunc</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="s">`</span><span class="p">);</span>

<span class="nx">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nb">global</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lots and lots&quot;</span><span class="p">};</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">js</span><span class="w"> </span><span class="kn">import</span> <span class="n">people</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;even more&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">))</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
<p>For JavaScript globals whose names are keywords, one can similarly use
<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#getattr" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> on the <code class="docutils literal notranslate"><span class="pre">js</span></code> module itself:</p>
<div class="highlight-pyodide notranslate"><div class="highlight"><pre><span></span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span>
<span class="nb">globalThis</span><span class="p">.</span><span class="nx">lambda_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8</span><span class="p">;</span>
<span class="n">pyodide</span><span class="o">.</span><span class="n">runPython</span><span class="p">(</span><span class="s">`</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">js</span>
    <span class="n">js_lambda</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
    <span class="n">js_lambda_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="s1">&#39;lambda_&#39;</span><span class="p">)</span>
    <span class="n">js_lambda__</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="s1">&#39;lambda__&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">js_lambda</span><span class="p">,</span> <span class="n">js_lambda_</span><span class="p">,</span> <span class="n">js_lambda__</span><span class="p">)</span> <span class="c1"># 7, 7, 8</span>
<span class="s">`</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="can-i-use-threading-multiprocessing-subprocess">
<h5>Can I use threading/multiprocessing/subprocess?<a class="headerlink" href="#can-i-use-threading-multiprocessing-subprocess" title="Link to this heading">#</a></h5>
<p>No, fork and pthreads do not work in Pyodide (see more <a class="reference external" href="https://pyodide.org/en/stable/usage/wasm-constraints.html">here</a>).
Attempts to use <code class="docutils literal notranslate"><span class="pre">threading</span></code>, <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code>, or <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> will raise a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>.
You may be able to work around this by setting the number of threads to 1:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_can_start_thread</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;emscripten&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">_emscripten_info</span><span class="o">.</span><span class="n">pthreads</span>
    <span class="k">return</span> <span class="n">platform</span><span class="o">.</span><span class="n">machine</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;wasm32&quot;</span><span class="p">,</span> <span class="s2">&quot;wasm64&quot;</span><span class="p">)</span>

<span class="n">can_start_thread</span> <span class="o">=</span> <span class="n">_can_start_thread</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">can_start_thread</span><span class="p">:</span>
  <span class="n">n_threads</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>You can still import the packages and use the general info API, but you cannot
start any asynchronous work without receiving a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">current</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">current</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;MainThread&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">current</span><span class="o">.</span><span class="n">daemon</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">current</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">target</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;console&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/lib/python312.zip/threading.py&quot;</span>, line <span class="m">994</span>, in <span class="n">start</span>
<span class="w">    </span><span class="n">_start_new_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bootstrap</span><span class="p">,</span> <span class="p">())</span>
<span class="gr">RuntimeError</span>: <span class="n">can&#39;t start new thread</span>
</pre></div>
</div>
</section>
</section>
<span id="document-usage/examples"></span><section id="community-examples">
<h4>Community Examples<a class="headerlink" href="#community-examples" title="Link to this heading">#</a></h4>
<p id="examples">This section contains a collection of examples using Pyodide, contributed by the community.</p>
<section id="id1">
<h5>Examples<a class="headerlink" href="#id1" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="external reference" href="../examples/black.html">Black formatter</a> - by <a class="reference external" href="https://github.com/ryanking13">&#64;ryanking13</a></p></li>
<li><p><a class="external reference" href="../examples/console_webworker.html">Run a console which communicates with pyodide in a WebWorker</a> - by <a class="reference external" href="https://github.com/joemarshall">&#64;joemarshall</a></p></li>
</ul>
<!-- Contribution Guide -->
<!--
We welcome contributions to this section.
If you have an example you would like to share, please submit a pull request in the Pyodide repository.

To add an example, create a new file in the `examples` directory, we expect the example is a single HTML file
that contains everything needed to run the example, so people can easily download and run it locally. If it needs a web-worker, put that in a file with the same name but extension .js

You can start with copying the template file (`examples/examples.html.tmpl`). Note that the template file contains
a placeholder URL {{ PYODIDE_BASE_URL }} that will be replaced by the actual URL when the documentation is built.
So please do not remove it.

After you have added the example, please add a link to it in the list above.
Feel free to add some description to the example if you like and add your name as the author.
-->
</section>
</section>
</div>
</section>
<section id="development">
<h3>Development<a class="headerlink" href="#development" title="Link to this heading">#</a></h3>
<p>The Development section helps Pyodide contributors to find information about the
development process including making packages to support third party libraries.</p>
<div class="toctree-wrapper compound">
<span id="document-development/building-from-sources"></span><section id="building-from-sources">
<span id="id1"></span><h4>Building from sources<a class="headerlink" href="#building-from-sources" title="Link to this heading">#</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are building the latest development version of Pyodide from the <code class="docutils literal notranslate"><span class="pre">main</span></code>
branch, please make sure to follow the build instructions from the dev
version of the documentation at
<a class="reference external" href="https://pyodide.org/en/latest/development/building-from-sources.html">pyodide.org/en/latest/</a></p>
</div>
<p>Pyodide can be built from sources on different platforms,</p>
<ul class="simple">
<li><p>on <strong>Linux</strong> it is easiest using the Pyodide Docker image. This approach
works with any native operating system as long as Docker is installed. You
can also build on your native Linux OS if the correct build prerequisites
are installed.</p></li>
<li><p>on <strong>MacOS</strong> it is recommended to install dependencies via conda-forge or
using Homebrew, particularly with the M1 ARM CPU. Building with Docker is
possible but very slow.</p></li>
<li><p>It is not possible to build on <strong>Windows</strong>, but you can use <a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem
for Linux</a> to
create a Linux build environment.</p></li>
</ul>
<section id="build-instructions">
<h5>Build instructions<a class="headerlink" href="#build-instructions" title="Link to this heading">#</a></h5>
<p>The Pyodide repository has a git submodule called <code class="docutils literal notranslate"><span class="pre">pyodide-build</span></code>. Make sure to
do a recursive clone:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/pyodide/pyodide
</pre></div>
</div>
<p>or if you have already cloned the Pyodide repository without the <code class="docutils literal notranslate"><span class="pre">--recursive</span></code>
flag, you may initialize the submodule with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
</pre></div>
</div>
<p>If you change git branches, make sure you update <code class="docutils literal notranslate"><span class="pre">pyodide-build</span></code> with
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code>.</p>
<section id="using-docker">
<h6>Using Docker<a class="headerlink" href="#using-docker" title="Link to this heading">#</a></h6>
<p>We provide a Debian-based x86_64 Docker image
(<a class="reference external" href="https://hub.docker.com/r/pyodide/pyodide-env"><code class="docutils literal notranslate"><span class="pre">pyodide/pyodide-env</span></code></a>) on
Docker Hub with the dependencies already installed to make it easier to build
Pyodide.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These Docker images are also available from the Github packages at
<a class="reference external" href="https://github.com/orgs/pyodide/packages"><code class="docutils literal notranslate"><span class="pre">github.com/orgs/pyodide/packages</span></code></a>.</p>
</div>
<ol class="arabic simple">
<li><p>Install Docker</p></li>
<li><p>From a git checkout of Pyodide, run <code class="docutils literal notranslate"><span class="pre">./run_docker</span></code></p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span></code> to build.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">make</span></code> is failing with <code class="docutils literal notranslate"><span class="pre">Permission</span> <span class="pre">denied</span></code>, you can run <code class="docutils literal notranslate"><span class="pre">./run_docker</span></code> with root permissions: <code class="docutils literal notranslate"><span class="pre">./run_docker</span> <span class="pre">--root</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can control the resources allocated to the build by setting the env
vars <code class="docutils literal notranslate"><span class="pre">EMSDK_NUM_CORE</span></code>, <code class="docutils literal notranslate"><span class="pre">EMCC_CORES</span></code> and <code class="docutils literal notranslate"><span class="pre">PYODIDE_JOBS</span></code> (the default for each is
4).</p>
</div>
<p>If running <code class="docutils literal notranslate"><span class="pre">make</span></code> deterministically stops at some point,
increasing the maximum RAM usage available to the docker container might help.
(The RAM available to the container is different from the physical RAM capacity of the machine.)
Ideally,
at least 3 GB of RAM should be available to the docker container to build
Pyodide smoothly. These settings can be changed via Docker preferences (see
<a class="reference external" href="https://stackoverflow.com/questions/44533319/how-to-assign-more-memory-to-docker-container">here</a>).</p>
<p>You can edit the files in the shared <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> source folder on your host
machine (outside of Docker), and then repeatedly run <code class="docutils literal notranslate"><span class="pre">make</span></code> inside the Docker
environment to test your changes.</p>
</section>
<section id="using-the-docker-dev-container">
<h6>Using the “Docker” dev container<a class="headerlink" href="#using-the-docker-dev-container" title="Link to this heading">#</a></h6>
<p>We provide a dev container configuration that is equivalent to the use of
<code class="docutils literal notranslate"><span class="pre">./run_docker</span></code> script. It can be used in <a class="reference external" href="https://code.visualstudio.com/docs/devcontainers/containers">Visual Studio Code</a> and
on <a class="reference external" href="https://docs.github.com/en/codespaces/overview">GitHub Codespaces</a>.
When prompted, select “Docker”.</p>
</section>
<section id="using-the-conda-dev-container">
<h6>Using the “Conda” dev container<a class="headerlink" href="#using-the-conda-dev-container" title="Link to this heading">#</a></h6>
<p>We provide another dev container configuration that corresponds to
the “Linux with conda” method described below. When <a class="reference external" href="https://code.visualstudio.com/docs/devcontainers/containers">Visual Studio Code</a> or
<a class="reference external" href="https://docs.github.com/en/codespaces/overview">GitHub Codespaces</a>
prompts for the dev container configuration, select “Conda”.</p>
</section>
</section>
<section id="using-make">
<h5>Using <code class="docutils literal notranslate"><span class="pre">make</span></code><a class="headerlink" href="#using-make" title="Link to this heading">#</a></h5>
<p>Make sure the prerequisites for
<a class="reference external" href="https://github.com/emscripten-core/emsdk">emsdk</a> are installed. Pyodide will
build a custom, patched version of emsdk, so there is no need to build it
yourself prior.</p>
<p>You need Python 3.11.2 to run the build scripts. To make sure that the correct
Python is used during the build it is recommended to use a <a class="reference external" href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/#creating-a-virtual-environment">virtual
environment</a>
or a conda environment.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Linux</label><div class="sd-tab-content docutils">
<p>To build on Linux, you need:</p>
<ul class="simple">
<li><p>A working native compiler toolchain, enough to build
<a class="reference external" href="https://devguide.python.org/getting-started/setup-building/index.html#linux">CPython</a>.</p></li>
<li><p>CMake (required to install Emscripten)</p></li>
</ul>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Linux with conda</label><div class="sd-tab-content docutils">
<p>You would need a working native compiler toolchain, enough to build
<a class="reference external" href="https://devguide.python.org/getting-started/setup-building/index.html#linux">CPython</a>, for example,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apt</span> <span class="pre">install</span> <span class="pre">build-essential</span></code> on Debian based systems.</p></li>
<li><p>Conda which can be installed from <a class="reference external" href="https://github.com/conda-forge/miniforge">MiniForge</a></p></li>
</ul>
<p>Then install the required Python version and other build dependencies in a separate conda environment,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda env create -f environment.yml
conda activate pyodide-env
</pre></div>
</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
MacOS with conda</label><div class="sd-tab-content docutils">
<p>You would need,</p>
<ul class="simple">
<li><p>System libraries in the root directory:
<code class="docutils literal notranslate"><span class="pre">xcode-select</span> <span class="pre">--install</span></code></p></li>
<li><p>Conda which can be installed using <a class="reference external" href="https://github.com/conda-forge/miniforge">Miniforge</a> (both for Intel and M1 CPU)</p></li>
</ul>
<p>Then install the required Python version and other build dependencies in a separate conda environment,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda env create -f environment.yml
conda activate pyodide-env
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
MacOS with Homebrew</label><div class="sd-tab-content docutils">
<p>To build on MacOS with Homebrew, you need:</p>
<ul class="simple">
<li><p>System command line tools
<code class="docutils literal notranslate"><span class="pre">xcode-select</span> <span class="pre">--install</span></code></p></li>
<li><p><a class="reference external" href="https://brew.sh/">Homebrew</a> for installing dependencies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">coreutils</span> <span class="pre">cmake</span> <span class="pre">autoconf</span> <span class="pre">automake</span> <span class="pre">libtool</span> <span class="pre">libffi</span> <span class="pre">ccache</span></code></p></li>
<li><p>It is also recommended installing the GNU patch and
GNU sed (<code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">gpatch</span> <span class="pre">gnu-sed</span></code>)
and <a class="reference external" href="https://formulae.brew.sh/formula/gnu-sed">re-defining them temporarily as <code class="docutils literal notranslate"><span class="pre">patch</span></code> and
<code class="docutils literal notranslate"><span class="pre">sed</span></code></a>.</p></li>
</ul>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you encounter issues with the requirements, it is useful to check the exact
list in the
<a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/Dockerfile">Dockerfile</a> which is
tested in the CI.</p>
</div>
<p>You can install the Python dependencies from the requirement file at the root of Pyodide folder:
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p>
<p>After installing the build prerequisites, run from the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make
</pre></div>
</div>
</section>
<section id="partial-builds">
<span id="id2"></span><h5>Partial builds<a class="headerlink" href="#partial-builds" title="Link to this heading">#</a></h5>
<p>To build a subset of available packages in Pyodide, set the environment variable
<code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES</span></code> to a comma separated list of packages. For instance,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PYODIDE_PACKAGES</span><span class="o">=</span><span class="s2">&quot;toolz,attrs&quot;</span> <span class="n">make</span>
</pre></div>
</div>
<p>Dependencies of the listed packages will be built automatically as well. The
package names must match the folder names in <code class="docutils literal notranslate"><span class="pre">packages/</span></code> exactly; in particular
they are case-sensitive.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES</span></code> is not set, a minimal set of packages necessary to run
the core test suite is installed, including “micropip”, “pyparsing”, “pytz”,
“packaging”, “Jinja2”, “regex”. This is equivalent to setting
<code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES='tag:core'</span></code>
meta-package. Other supported meta-packages are,</p>
<ul class="simple">
<li><p>“tag:min-scipy-stack”: includes the “core” meta-package as well as some
core packages from the scientific python stack and their dependencies:
“numpy”, “scipy”, “pandas”, “matplotlib”, “scikit-learn”, “joblib”,
“pytest”. This option is non exhaustive and is mainly intended to make build
faster while testing a diverse set of scientific packages.</p></li>
<li><p>“*” builds all packages</p></li>
<li><p>You can exclude a package by prefixing it with “!”.</p></li>
</ul>
<p>micropip is always automatically included.</p>
</section>
<section id="environment-variables">
<h5>Environment variables<a class="headerlink" href="#environment-variables" title="Link to this heading">#</a></h5>
<p>The following environment variables additionally impact the build:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PYODIDE_JOBS</span></code>: the <code class="docutils literal notranslate"><span class="pre">-j</span></code> option passed to the <code class="docutils literal notranslate"><span class="pre">emmake</span> <span class="pre">make</span></code> command when
applicable for parallel compilation. Default: 3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PYODIDE_BASE_URL</span></code>: Base URL where Pyodide packages are deployed. It must end
with a trailing <code class="docutils literal notranslate"><span class="pre">/</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">./</span></code> to load Pyodide packages from the same
base URL path as where <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code> is located. Example:
<code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide/v0.27.1/full/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTRA_CFLAGS</span></code>: Add extra compilation flags.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTRA_LDFLAGS</span></code>: Add extra linker flags.</p></li>
</ul>
<p>Setting <code class="docutils literal notranslate"><span class="pre">EXTRA_CFLAGS=&quot;-D</span> <span class="pre">DEBUG_F&quot;</span></code> provides detailed diagnostic information
whenever error branches are taken inside the Pyodide core code. These error
messages are frequently helpful even when the problem is a fatal configuration
problem and Pyodide cannot even be initialized. These error branches occur also
in correctly working code, but they are relatively uncommon so in practice the
amount of noise generated isn’t too large. The shorthand <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">debug</span></code>
automatically sets this flag.</p>
<p>In certain cases, setting <code class="docutils literal notranslate"><span class="pre">EXTRA_LDFLAGS=&quot;-s</span> <span class="pre">ASSERTIONS=1</span></code> or <code class="docutils literal notranslate"><span class="pre">ASSERTIONS=2</span></code> can
also be helpful, but this slows down the linking and the runtime speed of
Pyodide a lot and generates a large amount of noise in the console.</p>
</section>
</section>
<span id="document-development/new-packages"></span><section id="creating-a-pyodide-package">
<span id="new-packages"></span><h4>Creating a Pyodide package<a class="headerlink" href="#creating-a-pyodide-package" title="Link to this heading">#</a></h4>
<p>It is recommended to look into how other similar packages are built in Pyodide.
If you encounter difficulties in building your package after trying the steps
listed here, open a <a class="reference external" href="https://github.com/pyodide/pyodide/issues">new Pyodide issue</a>.</p>
<section id="determining-if-creating-a-pyodide-package-is-necessary">
<h5>Determining if creating a Pyodide package is necessary<a class="headerlink" href="#determining-if-creating-a-pyodide-package-is-necessary" title="Link to this heading">#</a></h5>
<p>If you wish to use a package in Pyodide that is not already included in the
<a class="reference external" href="https://github.com/pyodide/pyodide/tree/main/packages"><code class="docutils literal notranslate"><span class="pre">packages</span></code> folder</a>, first you
need to determine whether it is necessary to package it for Pyodide. Ideally,
you should start this process with package dependencies.</p>
<p>Most pure Python packages can be installed directly from PyPI with
<a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> if they have a pure Python wheel. Check if this is the
case by trying <code class="docutils literal notranslate"><span class="pre">micropip.install(&quot;package-name&quot;)</span></code>.</p>
<p>Because Pyodide <a class="reference external" href="https://pyodide.org/en/stable/usage/wasm-constraints.html">does not support threading or multiprocessing</a>,
packages that use threading or multiprocessing will not work without a patch to disable it. For example,
the following snippet will determine if the platform supports creating new threads.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_can_start_thread</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;emscripten&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">_emscripten_info</span><span class="o">.</span><span class="n">pthreads</span>
    <span class="k">return</span> <span class="n">platform</span><span class="o">.</span><span class="n">machine</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;wasm32&quot;</span><span class="p">,</span> <span class="s2">&quot;wasm64&quot;</span><span class="p">)</span>

<span class="n">can_start_thread</span> <span class="o">=</span> <span class="n">_can_start_thread</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">can_start_thread</span><span class="p">:</span>
  <span class="n">n_threads</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>If there is no wheel on PyPI, but you believe there is nothing preventing it (it
is a Python package without C extensions):</p>
<ul>
<li><p>you can create the wheel yourself by running</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>build
python<span class="w"> </span>-m<span class="w"> </span>build
</pre></div>
</div>
<p>from within the package folder where the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> are located. See the
<a class="reference external" href="https://packaging.python.org/tutorials/packaging-projects/#generating-distribution-archives">Python packaging guide</a>
for more details. Then upload the wheel file somewhere (not to PyPI) and
install it with micropip via its URL.</p>
</li>
<li><p>please open an issue in the package repository asking the authors to upload
the wheel.</p></li>
</ul>
<p>If however the package has C extensions or its code requires patching, then
continue to the next steps.</p>
<p>If you are on Windows, you will need to use WSL 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To determine if a package has C extensions, check if its <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> contains
any compilation commands.</p>
</div>
</section>
<section id="building-python-wheels-out-of-tree">
<h5>Building Python wheels (out of tree)<a class="headerlink" href="#building-python-wheels-out-of-tree" title="Link to this heading">#</a></h5>
<p>Starting with Pyodide 0.22.0, it is now possible to build Python wheels for Pyodide
for many packages separately from the Pyodide package tree. See <a class="reference internal" href="#building-and-testing-packages-out-of-tree"><span class="std std-ref">Building and testing Python packages out of tree</span></a> for more details.</p>
</section>
<section id="building-a-python-package-in-tree">
<h5>Building a Python package (in tree)<a class="headerlink" href="#building-a-python-package-in-tree" title="Link to this heading">#</a></h5>
<p>This section documents how to add a new package to the Pyodide distribution.</p>
<p>As a starting point, you may want to look at the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> files for some
other Pyodide packages in the <a class="reference external" href="https://github.com/pyodide/pyodide/tree/main/packages"><code class="docutils literal notranslate"><span class="pre">packages/</span></code>
folder</a>.</p>
<section id="prerequisites">
<h6>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h6>
<p>First clone the Pyodide git repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/pyodide/pyodide
<span class="nb">cd</span><span class="w"> </span>pyodide
</pre></div>
</div>
<p>If you have trouble with missing dependencies (or are not running linux) you can
use the <code class="docutils literal notranslate"><span class="pre">pyodide-env</span></code> docker container with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run_docker
</pre></div>
</div>
<p>This will mount the current working directory as <code class="docutils literal notranslate"><span class="pre">/src</span></code> within the container so
if you build the package within the container the files created will persist in
the directory after you exit the container.</p>
<p>If you want to build the package, you will need to build Python which you can do
as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>emsdk
make<span class="w"> </span>-C<span class="w"> </span>cpython
make<span class="w"> </span>pyodide_build
</pre></div>
</div>
<p>This also builds the appropriate version of Emscripten.</p>
</section>
<section id="creating-the-meta-yaml-file">
<h6>Creating the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file<a class="headerlink" href="#creating-the-meta-yaml-file" title="Link to this heading">#</a></h6>
<p>To build a Python package in tree, you need to create a <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file that
defines a “recipe” which may include build commands and “patches” (source code
edits), amongst other things.</p>
<p>If your package is on PyPI, the easiest place to start is with the
<code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">skeleton</span> <span class="pre">pypi</span></code> command. Run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span> <span class="n">skeleton</span> <span class="n">pypi</span> <span class="o">&lt;</span><span class="n">package</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will generate a <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file under <code class="docutils literal notranslate"><span class="pre">packages/&lt;package-name&gt;/</span></code> (see
<a class="reference internal" href="#meta-yaml-spec"><span class="std std-ref">The meta.yaml specification</span></a>). The <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> cli tool will populate the latest version,
the download link and the sha256 hash by querying PyPI.</p>
<p>It doesn’t currently handle package dependencies, so you will need to specify
those yourself in the <code class="docutils literal notranslate"><span class="pre">requirements</span></code> section of the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Dependencies that are needed to build the package</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cffi</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Dependencies that are needed to run the package</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cffi</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To determine build and runtime dependencies, including for non Python
libraries, it is often useful to check if the package was already built on
<a class="reference external" href="https://conda-forge.org/">conda-forge</a> look at the corresponding <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>
file. This can be done either by checking if the URL
<code class="docutils literal notranslate"><span class="pre">https://github.com/conda-forge/&lt;package-name&gt;-feedstock/blob/master/recipe/meta.yaml</span></code>
exists, or by searching the <a class="reference external" href="https://github.com/conda-forge/">conda-forge GitHub
org</a> for the package name.</p>
<p>The Pyodide <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file format was inspired by the one in conda, however it is
not strictly compatible.</p>
</div>
</section>
<section id="building-the-package">
<h6>Building the package<a class="headerlink" href="#building-the-package" title="Link to this heading">#</a></h6>
<p>Once the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file is ready, build the package with the following
command</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build-recipes<span class="w"> </span>&lt;package-name&gt;<span class="w"> </span>--install
</pre></div>
</div>
<p>and see if there are any errors.</p>
</section>
<section id="loading-the-package">
<h6>Loading the package<a class="headerlink" href="#loading-the-package" title="Link to this heading">#</a></h6>
<p>If the build succeeds you can try to load the package:</p>
<ol class="arabic simple">
<li><p>Build pyodide via <code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES=tag:core</span> <span class="pre">make</span></code>.</p></li>
<li><p>Serve the dist directory with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">http.server</span> <span class="pre">--directory</span> <span class="pre">./dist</span></code>.
If you use docker, you can execute this either outside of the docker container or
make sure to forward a port by setting the environment variable
PYODIDE_SYSTEM_PORT or starting docker with <code class="docutils literal notranslate"><span class="pre">./run_docker</span> <span class="pre">-p</span> <span class="pre">&lt;port&gt;</span></code>.</p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">localhost:8000/console.html</span></code> and try to import the package.</p></li>
<li><p>You can test the package in the repl.</p></li>
</ol>
</section>
<section id="fixing-build-issues">
<h6>Fixing build issues<a class="headerlink" href="#fixing-build-issues" title="Link to this heading">#</a></h6>
<p>If there are errors you might need to add a build script to set You can add
extra build commands to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build</span><span class="p">:</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">wget https://example.com/file.tar.gz</span>
<span class="w">    </span><span class="no">export MY_ENV_VARIABLE=FOO</span>
</pre></div>
</div>
<p>You can also inject extra compile and link flags with the <code class="docutils literal notranslate"><span class="pre">cflags</span></code> and <code class="docutils literal notranslate"><span class="pre">ldflags</span></code>
keys. You can modify the wheel after it is built with the <code class="docutils literal notranslate"><span class="pre">post:</span></code> key.</p>
<p>If you need to patch the package’s source to fix build issues, see the section
on Generating patches below.</p>
</section>
<section id="writing-tests-for-your-package">
<h6>Writing tests for your package<a class="headerlink" href="#writing-tests-for-your-package" title="Link to this heading">#</a></h6>
<p>The tests should go in one or more files like
<code class="docutils literal notranslate"><span class="pre">packages/&lt;package-name&gt;/test_xxx.py</span></code>. Most packages have one test file named
<code class="docutils literal notranslate"><span class="pre">test_&lt;package-name&gt;.py</span></code>. The tests should look like:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytest_pyodide</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_in_pyodide</span>

<span class="nd">@run_in_pyodide</span><span class="p">(</span><span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;package-name&gt;&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_mytestname</span><span class="p">(</span><span class="n">selenium</span><span class="p">):</span>
  <span class="kn">import</span><span class="w"> </span><span class="o">&lt;</span><span class="n">package</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="k">assert</span> <span class="n">package</span><span class="o">.</span><span class="n">do_something</span><span class="p">()</span> <span class="o">==</span> <span class="mi">5</span>
  <span class="c1"># ...</span>
</pre></div>
</div>
<p>If you want to run your package’s full pytest test suite and your package
vendors tests you can do it like:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytest_pyodide</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_in_pyodide</span>

<span class="nd">@run_in_pyodide</span><span class="p">(</span><span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;package-name&gt;-tests&quot;</span><span class="p">,</span> <span class="s2">&quot;pytest&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_mytestname</span><span class="p">(</span><span class="n">selenium</span><span class="p">):</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
  <span class="k">assert</span> <span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">([</span><span class="s2">&quot;--pyargs&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;package-name&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;-k&quot;</span><span class="p">,</span> <span class="s2">&quot;some_filter&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>you can put whatever command line arguments you would pass to <code class="docutils literal notranslate"><span class="pre">pytest</span></code> as
separate entries in the list. For more info on <code class="docutils literal notranslate"><span class="pre">run_in_pyodide</span></code> see
<a class="reference external" href="https://github.com/pyodide/pytest-pyodide">pytest-pyodide</a>.</p>
</section>
<section id="generating-patches">
<h6>Generating patches<a class="headerlink" href="#generating-patches" title="Link to this heading">#</a></h6>
<p>If the package has a git repository, the easiest way to make a patch is usually:</p>
<ol class="arabic simple">
<li><p>Clone the git repository of the package. You might want to use the options
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">--depth</span> <span class="pre">1</span> <span class="pre">--branch</span> <span class="pre">&lt;version&gt;</span></code>. Find the appropriate tag given the
version of the package you are trying to modify.</p></li>
<li><p>Make a new branch with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">pyodide-version</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">pyodide-1.21.4</span></code>).</p></li>
<li><p>Make whatever changes you want. Commit them. Please split your changes up
into focused commits. Write detailed commit messages! People will read them
in the future, particularly when migrating patches or trying to decide if
they are no longer needed. The first line of each commit message will also be
used in the patch file name.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">format-patch</span> <span class="pre">&lt;version&gt;</span> <span class="pre">-o</span> <span class="pre">&lt;pyodide-root&gt;/packages/&lt;package-name&gt;/patches/</span></code>
to generate a patch file for your changes and store it directly into the
patches folder.</p></li>
<li><p>You also need to add the patches to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file:</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://files.pythonhosted.org/packages/somehash/some-pkg-1.2.3.tar.gz</span>
<span class="w">  </span><span class="nt">sha256</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">somehash</span>
<span class="w">  </span><span class="nt">patches</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0001-patch-some-thing.patch</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0002-patch-some-other-thing.patch</span>
</pre></div>
</div>
<p>The following command will write out the properly formatted file list to use in
the <code class="docutils literal notranslate"><span class="pre">patches</span></code> key:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>find<span class="w"> </span>patches/<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/^/    - /g&#39;</span>
</pre></div>
</div>
</section>
<section id="upgrading-a-package">
<h6>Upgrading a package<a class="headerlink" href="#upgrading-a-package" title="Link to this heading">#</a></h6>
<p>To upgrade a package’s version to the latest one available on PyPI, do</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide</span> <span class="n">skeleton</span> <span class="n">pypi</span> <span class="o">&lt;</span><span class="n">package</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">update</span>
</pre></div>
</div>
<p>Because this does not handle package dependencies, you have to manually check
whether the <code class="docutils literal notranslate"><span class="pre">requirements</span></code> section of the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file needs to be updated
for updated dependencies.</p>
<p>Upgrading a package’s version may lead to new build issues that need to be resolved
(see above) and any patches need to be checked and potentially migrated (see below).</p>
</section>
<section id="migrating-patches">
<h6>Migrating Patches<a class="headerlink" href="#migrating-patches" title="Link to this heading">#</a></h6>
<p>When you want to upgrade the version of a package, you will need to migrate the
patches. To do this:</p>
<ol class="arabic simple">
<li><p>Clone the git repository of the package. You might want to use the options
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">--depth</span> <span class="pre">1</span> <span class="pre">--branch</span> <span class="pre">&lt;version-tag&gt;</span></code>.</p></li>
<li><p>Make a new branch with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">pyodide-old-version</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">pyodide-1.21.4</span></code>).</p></li>
<li><p>Apply the current patches with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">am</span> <span class="pre">&lt;pyodide-root&gt;/packages/&lt;package-name&gt;/patches/*</span></code>.</p></li>
<li><p>Make a new branch <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">pyodide-new-version</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">pyodide-1.22.0</span></code>)</p></li>
<li><p>Rebase the patches with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">old-version</span> <span class="pre">--onto</span> <span class="pre">new-version</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">pyodide-1.21.4</span> <span class="pre">--onto</span> <span class="pre">pyodide-1.22.0</span></code>). Resolve any rebase
conflicts. If a patch has been upstreamed, you can drop it with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">--skip</span></code>.</p></li>
<li><p>Remove old patches with <code class="docutils literal notranslate"><span class="pre">rm</span> <span class="pre">&lt;pyodide-root&gt;/packages/&lt;package-name&gt;/patches/*</span></code>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">format-patch</span> <span class="pre">&lt;version-tag&gt;</span> <span class="pre">-o</span> <span class="pre">&lt;pyodide-root&gt;/packages/&lt;package-name&gt;/patches/</span></code>
to generate new patch files.</p></li>
</ol>
</section>
<section id="upstream-your-patches">
<h6>Upstream your patches!<a class="headerlink" href="#upstream-your-patches" title="Link to this heading">#</a></h6>
<p>Please create PRs or issues to discuss with the package maintainers to try to
find ways to include your patches into the package. Many package maintainers are
very receptive to including Pyodide-related patches and they reduce future
maintenance work for us.</p>
</section>
<section id="the-package-build-pipeline">
<h6>The package build pipeline<a class="headerlink" href="#the-package-build-pipeline" title="Link to this heading">#</a></h6>
<p>Pyodide includes a toolchain to add new third-party Python libraries to the
build. We automate the following steps:</p>
<ul class="simple">
<li><p>If source is a url (not in-tree):</p>
<ul>
<li><p>Download a source archive or a pure python wheel (usually from PyPI)</p></li>
<li><p>Confirm integrity of the package by comparing it to a checksum</p></li>
<li><p>If building from source (not from a wheel):</p>
<ul>
<li><p>Apply patches, if any, to the source distribution</p></li>
<li><p>Add extra files, if any, to the source distribution</p></li>
</ul>
</li>
</ul>
</li>
<li><p>If the source is not a wheel (building from a source archive or an in-tree
source):</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">build/script</span></code> if present</p></li>
<li><p>Modify the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> to point to wrappers for <code class="docutils literal notranslate"><span class="pre">gfortran</span></code>, <code class="docutils literal notranslate"><span class="pre">gcc</span></code>, <code class="docutils literal notranslate"><span class="pre">g++</span></code>, <code class="docutils literal notranslate"><span class="pre">ar</span></code>,
and <code class="docutils literal notranslate"><span class="pre">ld</span></code> that preempt compiler calls, rewrite the arguments, and pass them
to the appropriate emscripten compiler tools.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">pypa/build</span></code>:</p>
<ul>
<li><p>Create an isolated build environment. Install symbolic links from this
isolated environment to “host” copies of certain unisolated packages.</p></li>
<li><p>Install the build dependencies requested in the package <code class="docutils literal notranslate"><span class="pre">build-requires</span></code>.
(We ignore all version constraints on the unisolated packages, but version
constraints on other packages are respected.</p></li>
<li><p>Run the <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0517/"><strong>PEP 517</strong></a> build backend associated to the project to generate a wheel.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Unpack the wheel with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">wheel</span> <span class="pre">unpack</span></code>.</p></li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">build/post</span></code> script in the unpacked wheel directory if it’s present.</p></li>
<li><p>Unvendor unit tests included in the installation folder to a separate zip file
<code class="docutils literal notranslate"><span class="pre">&lt;package</span> <span class="pre">name&gt;-tests.zip</span></code></p></li>
<li><p>Repack the wheel with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">wheel</span> <span class="pre">pack</span></code></p></li>
</ul>
<p>Lastly, a <code class="docutils literal notranslate"><span class="pre">pyodide-lock.json</span></code> file is created containing the dependency tree of all
packages, so <a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a> can load a package’s dependencies
automatically.</p>
</section>
<section id="partial-rebuilds">
<h6>Partial Rebuilds<a class="headerlink" href="#partial-rebuilds" title="Link to this heading">#</a></h6>
<p>By default, each time you run <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code>, it will delete the entire
source directory and replace it with a fresh copy from the download url. This is
to ensure build repeatability. For debugging purposes, this is likely to be
undesirable. If you want to try out a modified source tree, you can pass the
flag <code class="docutils literal notranslate"><span class="pre">--continue</span></code> and <code class="docutils literal notranslate"><span class="pre">build-recipes</span></code> will try to build from the existing source
tree. This can cause various issues, but if it works it is much more convenient.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">--continue</span></code> flag, you can modify the sources in tree to fix the
build, then when it works, copy the modified sources into your checked out copy
of the package source repository and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">format-patch</span></code> to generate the
patch.</p>
</section>
<section id="c-library-dependencies">
<h6>C library dependencies<a class="headerlink" href="#c-library-dependencies" title="Link to this heading">#</a></h6>
<p>Some Python packages depend on certain C libraries, e.g. <code class="docutils literal notranslate"><span class="pre">lxml</span></code> depends on
<code class="docutils literal notranslate"><span class="pre">libxml</span></code>.</p>
<p>To package a C library, create a directory in <code class="docutils literal notranslate"><span class="pre">packages/</span></code> for the C library. In
the directory, you should write <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> that specifies metadata about the
library. See <a class="reference internal" href="#meta-yaml-spec"><span class="std std-ref">The meta.yaml specification</span></a> for more details.</p>
<p>The minimal example of <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> for a C library is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;name&gt;</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;version&gt;</span>

<span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;url&gt;</span>
<span class="w">  </span><span class="nt">sha256</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;sha256&gt;</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;requirement&gt;</span>

<span class="nt">build</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static_library</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">emconfigure ./configure</span>
<span class="w">    </span><span class="no">emmake make -j ${PYODIDE_JOBS:-3}</span>
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> of other C libraries such as
<a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/packages/libxml/meta.yaml">libxml</a>
as a starting point.</p>
<p>After packaging a C library, it can be added as a dependency of a Python package
like a normal dependency. See <code class="docutils literal notranslate"><span class="pre">lxml</span></code> and <code class="docutils literal notranslate"><span class="pre">libxml</span></code> for an example (and also
<code class="docutils literal notranslate"><span class="pre">scipy</span></code> and <code class="docutils literal notranslate"><span class="pre">OpenBLAS</span></code>).</p>
<p><em>Remark:</em> Certain C libraries come as emscripten ports, and do not have to be
built manually. They can be used by adding e.g. <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">USE_ZLIB</span></code> in the <code class="docutils literal notranslate"><span class="pre">cflags</span></code> of
the Python package. See e.g. <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> for an example. <a class="reference external" href="https://github.com/orgs/emscripten-ports/repositories?type=all">The full list of
libraries with Emscripten ports is
here.</a></p>
</section>
<section id="structure-of-a-pyodide-package">
<h6>Structure of a Pyodide package<a class="headerlink" href="#structure-of-a-pyodide-package" title="Link to this heading">#</a></h6>
<p>Pyodide is obtained by compiling CPython into WebAssembly. As such, it loads
packages the same way as CPython — it looks for relevant files <code class="docutils literal notranslate"><span class="pre">.py</span></code> and <code class="docutils literal notranslate"><span class="pre">.so</span></code>
files in the directories in <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>. When installing a package, our job is to
install our <code class="docutils literal notranslate"><span class="pre">.py</span></code> and <code class="docutils literal notranslate"><span class="pre">.so</span></code> files in the right location in emscripten’s virtual
filesystem.</p>
<p>Wheels are just zip archives, and to install them we unzip them into the
<code class="docutils literal notranslate"><span class="pre">site-packages</span></code> directory. If there are any <code class="docutils literal notranslate"><span class="pre">.so</span></code> files, we also need to load
them at install time: WebAssembly must be loaded asynchronously, but Python
imports are synchronous so it is impossible to load <code class="docutils literal notranslate"><span class="pre">.so</span></code> files lazily.</p>
<div class="toctree-wrapper compound">
<span id="document-development/meta-yaml"></span><section id="the-meta-yaml-specification">
<span id="meta-yaml-spec"></span><h6 aria-level="7">The meta.yaml specification<a class="headerlink" href="#the-meta-yaml-specification" title="Link to this heading">#</a></h6>
<p>Packages are defined by writing a <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file. The format of these files is
based on the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> files used to build <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/resources/define-metadata.html">Conda
packages</a>,
though it is much more limited. The most important limitation is that Pyodide
assumes there will only be one version of a given library available, whereas
Conda allows the user to specify the versions of each package that they want to
install. Despite the limitations, it is recommended to use existing conda
package definitions as a starting point to create Pyodide packages. In general,
however, one should not expect Conda packages to “just work” with Pyodide, see
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/795">#795</a></p>
<div class="warning admonition">
<p class="admonition-title">This is unstable</p>
<p>The Pyodide build system is under fairly active development (as of 2022/03/13).
The next couple of releases are likely to include breaking changes.</p>
</div>
<p>The supported keys in the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file are described below.</p>
<section id="package">
<h6 aria-level="8"><code class="docutils literal notranslate"><span class="pre">package</span></code><a class="headerlink" href="#package" title="Link to this heading">#</a></h6>
<section id="package-name">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">package/name</span></code><a class="headerlink" href="#package-name" title="Link to this heading">#</a></h6>
<p>The name of the package. It must match the name of the package used when
expanding the tarball, which is sometimes different from the name of the package
in the Python namespace when installed. It must also match the name of the
directory in which the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file is placed. It can only contain
alphanumeric characters, <code class="docutils literal notranslate"><span class="pre">-</span></code>, and <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p>
</section>
<section id="package-version">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">package/version</span></code><a class="headerlink" href="#package-version" title="Link to this heading">#</a></h6>
<p>The version of the package.</p>
</section>
<section id="package-top-level">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">package/top-level</span></code><a class="headerlink" href="#package-top-level" title="Link to this heading">#</a></h6>
<p>The list of top-level import name for the package.
This key is used in <a class="reference internal" href="#pyodide.loadPackagesFromImports" title="pyodide.loadPackagesFromImports"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports()</span></code></a>.
For example, the top-level import name for the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> is <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.
Some packages may have multiple top-level import names.
For instance, <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> exposes <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and <code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code>
as a top-level import names.</p>
</section>
<section id="package-tag">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">package/tag</span></code><a class="headerlink" href="#package-tag" title="Link to this heading">#</a></h6>
<p>The list of tags of the package. This is meta information used to group
packages by functionality. Normally this is not needed.
The following tags are currently used in Pyodide:</p>
<ul class="simple">
<li><p>always: This package is always built.</p></li>
<li><p>core: This package is used in the Pyodide core test suite.</p></li>
<li><p>min-scipy-stack: This package is part of the minimal scipy stack.</p></li>
</ul>
</section>
</section>
<section id="source">
<h6 aria-level="8"><code class="docutils literal notranslate"><span class="pre">source</span></code><a class="headerlink" href="#source" title="Link to this heading">#</a></h6>
<section id="source-url">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/url</span></code><a class="headerlink" href="#source-url" title="Link to this heading">#</a></h6>
<p>The URL of the source tarball.</p>
<p>The tarball may be in any of the formats supported by Python’s
<a class="reference external" href="https://docs.python.org/3.12/library/shutil.html#shutil.unpack_archive" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.unpack_archive()</span></code></a>: <code class="docutils literal notranslate"><span class="pre">tar</span></code>, <code class="docutils literal notranslate"><span class="pre">gztar</span></code>, <code class="docutils literal notranslate"><span class="pre">bztar</span></code>, <code class="docutils literal notranslate"><span class="pre">xztar</span></code>, and <code class="docutils literal notranslate"><span class="pre">zip</span></code>.</p>
</section>
<section id="source-extract-dir">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/extract_dir</span></code><a class="headerlink" href="#source-extract-dir" title="Link to this heading">#</a></h6>
<p>The top level directory name of the contents of the source tarball (i.e. once
you extract the tarball, all the contents are in the directory named
<code class="docutils literal notranslate"><span class="pre">source/extract_dir</span></code>). This defaults to the tarball name (sans extension).</p>
</section>
<section id="source-path">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/path</span></code><a class="headerlink" href="#source-path" title="Link to this heading">#</a></h6>
<p>Alternatively to <code class="docutils literal notranslate"><span class="pre">source/url</span></code>, a relative or absolute path can be specified
as package source. This is useful for local testing or building packages which
are not available online in the required format.</p>
<p>If a path is specified, any provided checksums are ignored.</p>
</section>
<section id="source-sha256">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/sha256</span></code><a class="headerlink" href="#source-sha256" title="Link to this heading">#</a></h6>
<p>The SHA256 checksum of the tarball. It is recommended to use SHA256 instead of MD5.
At most one checksum entry should be provided per package.</p>
</section>
<section id="source-patches">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/patches</span></code><a class="headerlink" href="#source-patches" title="Link to this heading">#</a></h6>
<p>A list of patch files to apply after expanding the tarball. These are applied
using <code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">-p1</span></code> from the root of the source tree.</p>
</section>
<section id="source-extras">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">source/extras</span></code><a class="headerlink" href="#source-extras" title="Link to this heading">#</a></h6>
<p>Extra files to add to the source tree. This should be a list where each entry is
a pair of the form <code class="docutils literal notranslate"><span class="pre">(src,</span> <span class="pre">dst)</span></code>. The <code class="docutils literal notranslate"><span class="pre">src</span></code> path is relative to the directory in
which the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file resides. The <code class="docutils literal notranslate"><span class="pre">dst</span></code> path is relative to the root of
source tree (the expanded tarball).</p>
</section>
</section>
<section id="build">
<h6 aria-level="8"><code class="docutils literal notranslate"><span class="pre">build</span></code><a class="headerlink" href="#build" title="Link to this heading">#</a></h6>
<section id="build-cflags">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/cflags</span></code><a class="headerlink" href="#build-cflags" title="Link to this heading">#</a></h6>
<p>Extra arguments to pass to the compiler when building for WebAssembly.</p>
<p>(This key is not in the Conda spec).</p>
</section>
<section id="build-cxxflags">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/cxxflags</span></code><a class="headerlink" href="#build-cxxflags" title="Link to this heading">#</a></h6>
<p>Extra arguments to pass to the compiler when building C++ files for WebAssembly.
Note that both <code class="docutils literal notranslate"><span class="pre">cflags</span></code> and <code class="docutils literal notranslate"><span class="pre">cxxflags</span></code> will be used when compiling C++ files. A
common example would be to use <code class="docutils literal notranslate"><span class="pre">-std=c++11</span></code> for code that makes use of C++11
features.</p>
<p>(This key is not in the Conda spec).</p>
</section>
<section id="build-ldflags">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/ldflags</span></code><a class="headerlink" href="#build-ldflags" title="Link to this heading">#</a></h6>
<p>Extra arguments to pass to the linker when building for WebAssembly.</p>
<p>(This key is not in the Conda spec).</p>
</section>
<section id="build-exports">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/exports</span></code><a class="headerlink" href="#build-exports" title="Link to this heading">#</a></h6>
<p>Which symbols should be exported from the shared object files. Possible values
are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pyinit</span></code>: The default. Only export Python module initialization symbols of the
form <code class="docutils literal notranslate"><span class="pre">PyInit_some_module</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requested</span></code>: Export the functions that are marked as exported in the object
files. Switch to this if <code class="docutils literal notranslate"><span class="pre">pyinit</span></code> doesn’t work. Useful for packages that use
<code class="docutils literal notranslate"><span class="pre">ctypes</span></code> or <code class="docutils literal notranslate"><span class="pre">dlsym</span></code> to access symbols.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">whole_archive</span></code>: Uses <code class="docutils literal notranslate"><span class="pre">-Wl,--whole-archive</span></code> to force inclusion of all symbols.
Use this when neither <code class="docutils literal notranslate"><span class="pre">pyinit</span></code> nor <code class="docutils literal notranslate"><span class="pre">explicit</span></code> work.</p></li>
</ul>
</section>
<section id="build-backend-flags">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/backend-flags</span></code><a class="headerlink" href="#build-backend-flags" title="Link to this heading">#</a></h6>
<p>Extra flags to pass to the build backend (e.g., <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, <code class="docutils literal notranslate"><span class="pre">flit</span></code>, etc).</p>
</section>
<section id="build-type">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/type</span></code><a class="headerlink" href="#build-type" title="Link to this heading">#</a></h6>
<p>Type of the package. Possible values are:</p>
<ul class="simple">
<li><p>package (default): A normal Python package, built to a wheel file.</p></li>
<li><p>static_library: A static library.</p></li>
<li><p>shared_library: A shared library.</p></li>
<li><p>cpython_module: A CPython stdlib extension module.
This is used for unvendoring CPython modules, and should not be used
for other purposes.</p></li>
</ul>
<p>If you are building ordinary Python package, you don’t need to set this key.
But if you are building a static or shared library,
you need to set this to <code class="docutils literal notranslate"><span class="pre">static_library</span></code> or <code class="docutils literal notranslate"><span class="pre">shared_library</span></code> respectively.</p>
<p>Static and shared libraries are not Python packages themselves,
but are needed for other python packages. For libraries,
the script specified in the <code class="docutils literal notranslate"><span class="pre">build/script</span></code> section is run to
compile the library.</p>
<p>The difference between <code class="docutils literal notranslate"><span class="pre">static_library</span></code> and <code class="docutils literal notranslate"><span class="pre">shared_library</span></code> is that
<code class="docutils literal notranslate"><span class="pre">static_library</span></code> is statically linked into the other packages,
so it is required only in the build time, while <code class="docutils literal notranslate"><span class="pre">shared_library</span></code> is
dynamically linked, so it is required in the runtime. When building
a shared library, you should copy the built libraries into the <code class="docutils literal notranslate"><span class="pre">$DISTDIR</span></code>.
Files or folders in this folder will be packaged to make the Pyodide package.</p>
<p>See the <a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/packages/zlib/meta.yaml">zlib
meta.yaml</a>
for an example of a static library specification, and the <a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/packages/openblas/meta.yaml">OpenBLAS
meta.yaml</a>
for an example of a shared library specification.</p>
</section>
<section id="build-script">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/script</span></code><a class="headerlink" href="#build-script" title="Link to this heading">#</a></h6>
<p>The script section is required for a library package (<code class="docutils literal notranslate"><span class="pre">build/library</span></code> set to
true). For a Python package this section is optional. If it is specified for a
Python package, the script section will be run before the build system runs
<code class="docutils literal notranslate"><span class="pre">setup.py</span></code>. This script is run by <code class="docutils literal notranslate"><span class="pre">bash</span></code> in the directory where the tarball was
extracted.</p>
<p>There are special environment variables defined:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$PKGDIR</span></code>: The directory in which the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file resides.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$PKG_VESRION</span></code>: The version of the package</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$PKG_BUILD_DIR</span></code>: The directory where the tarball was extracted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$DISTDIR</span></code>: The directory where the built wheel or library should be placed.
If you are building a shared library, you should copy the built libraries into this
directory.</p></li>
</ul>
<p>(These keys are not in the Conda spec).</p>
</section>
<section id="build-cross-script">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/cross-script</span></code><a class="headerlink" href="#build-cross-script" title="Link to this heading">#</a></h6>
<p>This script will run <em>after</em> <code class="docutils literal notranslate"><span class="pre">build/script</span></code>. The difference is that it runs with
the target environment variables and <code class="docutils literal notranslate"><span class="pre">sysconfigdata</span></code> and with the <code class="docutils literal notranslate"><span class="pre">pywasmcross</span></code>
compiler symlinks. Any changes to the environment will persist to the main build
step but will not be seen in the <code class="docutils literal notranslate"><span class="pre">build/post</span></code> step (or anything else done
outside of the cross build environment). The working directory for this script
is the source directory.</p>
</section>
<section id="build-post">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/post</span></code><a class="headerlink" href="#build-post" title="Link to this heading">#</a></h6>
<p>Shell commands to run after building the package. This command runs
in the directory which contains the built wheel unpacked with
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">wheel</span> <span class="pre">unpack</span></code>. So it’s possible to manually add, delete, change, move files etc.
See the [setuptools meta.yaml](https://github.com/pyodide/pyodide/
blob/main/packages/setuptools/meta.yaml)
for an example of the usage of this key.</p>
</section>
<section id="build-unvendor-tests">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/unvendor-tests</span></code><a class="headerlink" href="#build-unvendor-tests" title="Link to this heading">#</a></h6>
<p>Whether to unvendor tests found in the installation folder to a separate package
<code class="docutils literal notranslate"><span class="pre">&lt;package-name&gt;-tests</span></code>. If this option is true and no tests are found, the test
package will not be created. Default: true.</p>
</section>
<section id="build-vendor-sharedlib">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">build/vendor-sharedlib</span></code><a class="headerlink" href="#build-vendor-sharedlib" title="Link to this heading">#</a></h6>
<p>If set to true, shared libraries that are required by the package
will be vendored into the package after the build. This is similar to
what <a class="reference external" href="https://github.com/pypa/auditwheel"><code class="docutils literal notranslate"><span class="pre">auditwheel</span> <span class="pre">repair</span></code></a> does,
but it is done in a way that is compatible with Pyodide and Emscripten
dynamic linking. Default: false.</p>
</section>
</section>
<section id="requirements">
<h6 aria-level="8"><code class="docutils literal notranslate"><span class="pre">requirements</span></code><a class="headerlink" href="#requirements" title="Link to this heading">#</a></h6>
<section id="requirements-run">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">requirements/run</span></code><a class="headerlink" href="#requirements-run" title="Link to this heading">#</a></h6>
<p>A list of required packages at runtime.</p>
<p>(Unlike conda, this only supports package names, not versions).</p>
</section>
<section id="requirements-host">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">requirements/host</span></code><a class="headerlink" href="#requirements-host" title="Link to this heading">#</a></h6>
<p>A list of Pyodide packages that are required when building a package. It represents packages that need to be specific to the target platform.</p>
<p>For instance, when building <code class="docutils literal notranslate"><span class="pre">libxml</span></code>, <code class="docutils literal notranslate"><span class="pre">zlib</span></code> needs to be built for WASM first, and so it’s a host dependency. This is unrelated to the fact that
the build system might already have <code class="docutils literal notranslate"><span class="pre">zlib</span></code> present.</p>
</section>
<section id="requirements-executable">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">requirements/executable</span></code><a class="headerlink" href="#requirements-executable" title="Link to this heading">#</a></h6>
<p>A list of executables that are required when building a package.</p>
<p>Note that unlike conda, specifying executables in this key
doesn’t actually install any of them. This key exists to
halt build earlier if required executables are not available.</p>
</section>
</section>
<section id="test">
<h6 aria-level="8"><code class="docutils literal notranslate"><span class="pre">test</span></code><a class="headerlink" href="#test" title="Link to this heading">#</a></h6>
<section id="test-imports">
<h6 aria-level="9"><code class="docutils literal notranslate"><span class="pre">test/imports</span></code><a class="headerlink" href="#test-imports" title="Link to this heading">#</a></h6>
<p>List of imports to test after the package is built.</p>
</section>
</section>
<section id="supported-environment-variables">
<h6 aria-level="8">Supported Environment Variables<a class="headerlink" href="#supported-environment-variables" title="Link to this heading">#</a></h6>
<p>The following environment variables can be used in the scripts in the meta.yaml
files:</p>
<ul class="simple">
<li><p>PYODIDE_ROOT: The path to the base Pyodide directory</p></li>
<li><p>PYMAJOR: Current major Python version</p></li>
<li><p>PYMINOR: Current minor Python version</p></li>
<li><p>PYMICRO: Current micro Python version</p></li>
<li><p>SIDE_MODULE_CFLAGS: The standard CFLAGS for a side module. Use when compiling
libraries or shared libraries.</p></li>
<li><p>SIDE_MODULE_LDFLAGS: The standard LDFLAGS for a side module. Use when linking
a shared library.</p></li>
<li><p>NUMPY_LIB: Use <code class="docutils literal notranslate"><span class="pre">-L$NUMPY_LIB</span></code> as a ldflag when linking <code class="docutils literal notranslate"><span class="pre">-lnpymath</span></code> or
<code class="docutils literal notranslate"><span class="pre">-lnpyrandom</span></code>.</p></li>
</ul>
</section>
</section>
</div>
</section>
<section id="rust-pyo3-packages">
<h6>Rust/PyO3 Packages<a class="headerlink" href="#rust-pyo3-packages" title="Link to this heading">#</a></h6>
<p>We currently build <code class="docutils literal notranslate"><span class="pre">cryptography</span></code> which is a Rust extension built with PyO3 and
<code class="docutils literal notranslate"><span class="pre">setuptools-rust</span></code>. It should be reasonably easy to build other Rust extensions.
If you want to build a package with Rust extension, you will need Rust &gt;= 1.41,
and you need to set the rustup toolchain to <code class="docutils literal notranslate"><span class="pre">nightly</span></code>, and the target to
<code class="docutils literal notranslate"><span class="pre">wasm32-unknown-emscripten</span></code> in the build script
<a class="reference external" href="https://github.com/pyodide/pyodide/blob/main/packages/cryptography/meta.yaml">as shown here</a>,
but other than that there may be no other issues if you are lucky.</p>
<p>As mentioned <a class="reference external" href="https://github.com/pyodide/pyodide/issues/2706#issuecomment-1154655224">here</a>,
by default certain wasm-related <code class="docutils literal notranslate"><span class="pre">RUSTFLAGS</span></code> are set during <code class="docutils literal notranslate"><span class="pre">build.script</span></code>
and can be removed with <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">RUSTFLAGS=&quot;&quot;</span></code>.</p>
<p>If your project builds using maturin, you need to use maturin 0.14.14 or later. It is pretty easy to patch an existing project (see <code class="docutils literal notranslate"><span class="pre">projects/fastparquet/meta.yaml</span></code> for an example)</p>
</section>
</section>
</section>
<span id="document-development/building-and-testing-packages"></span><section id="building-and-testing-python-packages-out-of-tree">
<span id="building-and-testing-packages-out-of-tree"></span><h4>Building and testing Python packages out of tree<a class="headerlink" href="#building-and-testing-python-packages-out-of-tree" title="Link to this heading">#</a></h4>
<p>This is some information about how to build and test Python packages against
Pyodide out of tree (for instance in your package’s CI or for use with private
packages).</p>
<p>Pyodide currently only supports Linux for out of tree builds, though there is a
good change it will work in MacOS too. If you are using Windows, try Windows
Subsystem for Linux.</p>
<section id="building-binary-packages-for-pyodide">
<h5>Building binary packages for Pyodide<a class="headerlink" href="#building-binary-packages-for-pyodide" title="Link to this heading">#</a></h5>
<p>If your package is a pure Python package (i.e., if the wheel ends in
<code class="docutils literal notranslate"><span class="pre">py3-none-any.whl</span></code>) then follow the official PyPA documentation on building
<a class="reference external" href="https://packaging.python.org/en/latest/tutorials/packaging-projects/#generating-distribution-archives">wheels</a>
For binary packages, the manual steps are detailed below. In addition,
<a class="reference external" href="https://cibuildwheel.pypa.io/en/stable/">cibuildwheel</a> 2.19 or later provides
support for building binary wheels with Pyodide as a target.</p>
<section id="install-pyodide-build">
<h6>Install pyodide-build<a class="headerlink" href="#install-pyodide-build" title="Link to this heading">#</a></h6>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pyodide-build
</pre></div>
</div>
</section>
<section id="set-up-emscripten">
<h6>Set up Emscripten<a class="headerlink" href="#set-up-emscripten" title="Link to this heading">#</a></h6>
<p>You need to download the Emscripten developer toolkit:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/emscripten-core/emsdk.git
<span class="nb">cd</span><span class="w"> </span>emsdk
</pre></div>
</div>
<p>then you can install the appropriate version of Emscripten:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">PYODIDE_EMSCRIPTEN_VERSION</span><span class="o">=</span><span class="k">$(</span>pyodide<span class="w"> </span>config<span class="w"> </span>get<span class="w"> </span>emscripten_version<span class="k">)</span>
./emsdk<span class="w"> </span>install<span class="w"> </span><span class="si">${</span><span class="nv">PYODIDE_EMSCRIPTEN_VERSION</span><span class="si">}</span>
./emsdk<span class="w"> </span>activate<span class="w"> </span><span class="si">${</span><span class="nv">PYODIDE_EMSCRIPTEN_VERSION</span><span class="si">}</span>
<span class="nb">source</span><span class="w"> </span>emsdk_env.sh
</pre></div>
</div>
<p>If you restart your shell, you will need to run <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">emsdk_env.sh</span></code> again.</p>
</section>
<section id="build-the-wasm-emscripten-wheel">
<h6>Build the WASM/Emscripten wheel<a class="headerlink" href="#build-the-wasm-emscripten-wheel" title="Link to this heading">#</a></h6>
<p>Change directory into the package folder where the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> or
<code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file is located. You should be in a shell session where you ran
<code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">emsdk_env.sh</span></code>. Then run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build
</pre></div>
</div>
<p>in the package folder . This command produces a wheel in the <code class="docutils literal notranslate"><span class="pre">dist/</span></code> folder,
similarly to the <a class="reference external" href="https://pypa-build.readthedocs.io/en/latest/">PyPA build</a>
command.</p>
<p>If you need to add custom compiler / linker flags to the compiler invocations,
you can set the <code class="docutils literal notranslate"><span class="pre">CFLAGS</span></code>, <code class="docutils literal notranslate"><span class="pre">CXXFLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">LDFLAGS</span></code> environment variables. For instance, to
make a debug build, you can use: <code class="docutils literal notranslate"><span class="pre">CFLAGS=-g2</span> <span class="pre">LDFLAGS=g2</span> <span class="pre">pyodide</span> <span class="pre">build</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> invokes a slightly modified version of the <code class="docutils literal notranslate"><span class="pre">pypa/build</span></code> build
frontend so the behavior should be similar to what happens if you do:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>build
python<span class="w"> </span>-m<span class="w"> </span>build
</pre></div>
</div>
<p>If you run into problems, make sure that building a native wheel with
<code class="docutils literal notranslate"><span class="pre">pypa/build</span></code> works. If it does, then please open an issue about it.</p>
</section>
<section id="serve-the-wheel">
<h6>Serve the wheel<a class="headerlink" href="#serve-the-wheel" title="Link to this heading">#</a></h6>
<p>Serve the wheel via a file server e.g., <code class="docutils literal notranslate"><span class="pre">python3.10</span> <span class="pre">-m</span> <span class="pre">http.server</span> <span class="pre">--directory</span> <span class="pre">dist</span></code>.
Then you can install it with <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code> by URL.</p>
</section>
<section id="notes">
<h6>Notes<a class="headerlink" href="#notes" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>the resulting package wheels have a file name of the form
<code class="docutils literal notranslate"><span class="pre">*-cp310-cp310-emscripten_3_1_27_wasm32.whl</span></code> and are compatible only for a
given Python and Emscripten versions. In the Pyodide distribution, Python and
Emscripten are updated simultaneously.</p></li>
<li><p>for now, PyPi does not support emscripten/wasm32 wheels so you will not be able to upload
them there.</p></li>
</ul>
</section>
</section>
<section id="testing-packages-against-pyodide">
<h5>Testing packages against Pyodide<a class="headerlink" href="#testing-packages-against-pyodide" title="Link to this heading">#</a></h5>
<p>Pyodide provides an experimental command line runner for testing packages
against Pyodide. Using it requires nodejs version 14 or newer.</p>
<p>The way it works is simple: you can create a virtual environment with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>venv<span class="w"> </span>.venv-pyodide
</pre></div>
</div>
<p>Activate it just like a normal virtual environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>.venv-pyodide/bin/activate
</pre></div>
</div>
<p>As a warning, things are pretty weird inside of the Pyodide virtual environment
because <code class="docutils literal notranslate"><span class="pre">python</span></code> points to the Pyodide Python runtime. Any program that uses
Python and is sensitive to the current virtual environment will probably break.</p>
<p>You can install whatever dependencies you need with pip. For a pure Python
package, the following will work:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<p>For a binary package, you will need to build a wheel with <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> and
then point <code class="docutils literal notranslate"><span class="pre">pip</span></code> directly to the built wheel. For now, editable installs won’t
work with binary packages.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build the binary package</span>
pyodide<span class="w"> </span>build
<span class="c1"># Install it</span>
pip<span class="w"> </span>install<span class="w"> </span>dist/the_wheel-cp310-cp310-emscripten_3_1_20_wasm32.whl<span class="o">[</span>tests<span class="o">]</span>
</pre></div>
</div>
<p>To test, you can generally run the same script as you would usually do. For many
packages this will be:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pytest
</pre></div>
</div>
<p>but for instance <code class="docutils literal notranslate"><span class="pre">numpy</span></code> uses a file called <code class="docutils literal notranslate"><span class="pre">runtests.py</span></code>; the following works:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>runtests.py
</pre></div>
</div>
<p>and you can pass options to it just like normal. Currently <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> doesn’t
work, so if you have a test runner that uses <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> then it cannot be
used.</p>
</section>
<section id="github-actions-build-examples">
<h5>Github Actions build examples<a class="headerlink" href="#github-actions-build-examples" title="Link to this heading">#</a></h5>
<p>This is a complete example for building a Pyodide wheel out of tree using
<code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> directly:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-22.04</span><span class="w"> </span><span class="c1"># or ubuntu-latest</span>
<span class="w">  </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span>
<span class="w">       </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">pip install pyodide-build&gt;=0.28.0</span>
<span class="w">      </span><span class="no">echo EMSCRIPTEN_VERSION=$(pyodide config get emscripten_version) &gt;&gt; $GITHUB_ENV</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mymindstorm/setup-emsdk@v14</span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span>
<span class="w">       </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ env.EMSCRIPTEN_VERSION }}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyodide build</span>
</pre></div>
</div>
<p>And this is an example using <code class="docutils literal notranslate"><span class="pre">cibuildwheel</span></code> to build a Pyodide wheel out of tree:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-22.04</span><span class="w"> </span><span class="c1"># or ubuntu-latest</span>
<span class="w">  </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/cibuildwheel@v2.20.0</span>
<span class="w">    </span><span class="nt">env</span><span class="p">:</span>
<span class="w">       </span><span class="nt">CIBW_PLATFORM</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyodide</span>
</pre></div>
</div>
<p>For an example “in the wild” of a github action to build and test a wheel
against Pyodide, see
<a class="reference external" href="https://github.com/numpy/numpy/blob/main/.github/workflows/emscripten.yml">the numpy CI</a></p>
</section>
</section>
<span id="document-development/contributing"></span><section id="how-to-contribute">
<span id="id1"></span><h4>How to Contribute<a class="headerlink" href="#how-to-contribute" title="Link to this heading">#</a></h4>
<p>Thank you for your interest in contributing to Pyodide! There are many ways to
contribute, and we appreciate all of them. Here are some guidelines &amp; pointers
for diving into it.</p>
<section id="development-workflow">
<h5>Development Workflow<a class="headerlink" href="#development-workflow" title="Link to this heading">#</a></h5>
<p>To contribute code, see the following steps,</p>
<ol class="arabic">
<li><p>Fork the Pyodide repository <a class="github reference external" href="https://github.com/pyodide/pyodide">pyodide/pyodide</a> on Github.</p></li>
<li><p>If you are on Linux, you can skip this step. On Windows and MacOS you have a
choice. The first option is to manually install Docker:</p>
<ul class="simple">
<li><p>on MacOS follow <a class="reference external" href="https://docs.docker.com/desktop/mac/install/">these instructions</a></p></li>
<li><p>on Windows, <a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/install">install WSL
2</a>, then Docker.
Note that Windows filesystem access from WSL2 is very slow and should
be avoided when building Pyodide.</p></li>
</ul>
<p>The second option is to use a service that provides a Linux
development environment, such as</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/features/codespaces">Github Codespaces</a></p></li>
<li><p><a class="reference external" href="https://gitpod.io">gitpod.io</a></p></li>
<li><p>or a remote Linux VM with SSH connection.</p></li>
</ul>
</li>
<li><p>Clone your fork of Pyodide</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">recursive</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">username</span><span class="o">&gt;/</span><span class="n">pyodide</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>and add the upstream remote,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">upstream</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pyodide</span><span class="o">/</span><span class="n">pyodide</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>While the build will happen inside Docker you still need a development
environment with Python 3.11 and ideally Node.js. These can be installed
for instance with,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">environment</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">pyodide</span><span class="o">-</span><span class="n">env</span>
</pre></div>
</div>
<p>or via your system package manager.</p>
</li>
<li><p>Install requirements (it’s recommended to use a virtualenv or a conda env),</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</li>
<li><p>Enable <a class="reference external" href="https://pre-commit.com/">pre-commit</a> for code style,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">install</span>
</pre></div>
</div>
<p>This will run a set of linters for each commit.</p>
</li>
<li><p>Follow <a class="reference internal" href="#building-from-sources"><span class="std std-ref">Building from sources</span></a> instructions.</p></li>
<li><p>See <a class="reference internal" href="#testing"><span class="std std-ref">Testing and benchmarking</span></a> documentation.</p></li>
</ol>
</section>
<section id="code-of-conduct">
<h5>Code of Conduct<a class="headerlink" href="#code-of-conduct" title="Link to this heading">#</a></h5>
<p>Pyodide has adopted a <a class="reference internal" href="#code-of-conduct"><span class="std std-ref">Code of Conduct</span></a> that we expect all contributors and
core members to adhere to.</p>
</section>
<section id="development">
<h5>Development<a class="headerlink" href="#development" title="Link to this heading">#</a></h5>
<p>Work on Pyodide happens on GitHub. Core members and contributors can make Pull
Requests to fix issues and add features, which all go through the same review
process. We’ll detail how you can start making PRs below.</p>
<p>We’ll do our best to keep <code class="docutils literal notranslate"><span class="pre">main</span></code> in a non-breaking state, ideally with tests
always passing. The unfortunate reality of software development is sometimes
things break. As such, <code class="docutils literal notranslate"><span class="pre">main</span></code> cannot be expected to remain reliable at all
times. We recommend using the latest stable version of Pyodide.</p>
<p>Pyodide follows <a class="reference external" href="http://semver.org/">semantic versioning</a> - major versions for
breaking changes (x.0.0), minor versions for new features (0.x.0), and patches
for bug fixes (0.0.x).</p>
<p>We keep a file, <a class="reference internal" href="#changelog"><span class="std std-ref">docs/project/changelog.md</span></a>, outlining changes
to Pyodide in each release. We like to think of the audience for changelogs
as non-developers who primarily run the latest stable. So the change log will
primarily outline user-visible changes such as new features and deprecations,
and will exclude things that might otherwise be inconsequential to the end user
experience, such as infrastructure or refactoring.</p>
</section>
<section id="bugs-issues">
<h5>Bugs &amp; Issues<a class="headerlink" href="#bugs-issues" title="Link to this heading">#</a></h5>
<p>We use <a class="reference external" href="https://github.com/pyodide/pyodide/issues">Github Issues</a> for
announcing and discussing bugs and features. Use
<a class="reference external" href="https://github.com/pyodide/pyodide/issues/new">this link</a> to report a
bug or issue. We provide a template to give you a guide for how to file
optimally. If you have the chance, please search the existing issues before
reporting a bug. It’s possible that someone else has already reported your
error. This doesn’t always work, and sometimes it’s hard to know what to search
for, so consider this extra credit. We won’t mind if you accidentally file a
duplicate report.</p>
<p>Core contributors are monitoring new issues &amp; comments all the time, and will
label &amp; organize issues to align with development priorities.</p>
</section>
<section id="id2">
<h5>How to Contribute<a class="headerlink" href="#id2" title="Link to this heading">#</a></h5>
<p>Pull requests are the primary mechanism we use to change Pyodide. GitHub itself
has some
<a class="reference external" href="https://help.github.com/articles/about-pull-requests/">great documentation</a>
on using the Pull Request feature. We use the “fork and pull” model
<a class="reference external" href="https://help.github.com/articles/about-pull-requests/">described here</a>,
where contributors push changes to their personal fork and create pull requests
to bring those changes into the source repository.</p>
<p>Please make pull requests against the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
<p>If you’re looking for a way to jump in and contribute, our list of
<a class="reference external" href="https://github.com/pyodide/pyodide/labels/good%20first%20issue">good first issues</a>
is a great place to start.</p>
<p>If you’d like to fix a currently-filed issue, please take a look at the comment
thread on the issue to ensure no one is already working on it. If no one has
claimed the issue, make a comment stating you’d like to tackle it in a PR. If
someone has claimed the issue but has not worked on it in a few weeks, make a
comment asking if you can take over, and we’ll figure it out from there.</p>
<p>We use <a class="reference external" href="https://pytest.org">pytest</a>, driving
<a class="reference external" href="https://www.seleniumhq.org">Selenium</a> as our testing framework. Every PR will
automatically run through our tests, and our test framework will alert you on
GitHub if your PR doesn’t pass all of them. If your PR fails a test, try to
figure out whether or not you can update your code to make the test pass again,
or ask for help. As a policy we will not accept a PR that fails any of our
tests, and will likely ask you to add tests if your PR adds new functionality.
Writing tests can be scary, but they make open-source contributions easier for
everyone to assess. Take a moment and look through how we’ve written our tests,
and try to make your tests match. If you are having trouble, we can help you get
started on our test-writing journey.</p>
<p>All code submissions should pass <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">lint</span></code>. Python is checked with <code class="docutils literal notranslate"><span class="pre">flake8</span></code>,
<code class="docutils literal notranslate"><span class="pre">black</span></code> and <code class="docutils literal notranslate"><span class="pre">mypy</span></code>. JavaScript is checked with <code class="docutils literal notranslate"><span class="pre">prettier</span></code>.
C is checked against the Mozilla style in <code class="docutils literal notranslate"><span class="pre">clang-format</span></code>.</p>
<section id="contributing-to-the-core-c-code">
<h6>Contributing to the “core” C Code<a class="headerlink" href="#contributing-to-the-core-c-code" title="Link to this heading">#</a></h6>
<p>See <a class="reference internal" href="#contributing-core"><span class="std std-ref">Contributing to the “core” C Code</span></a>.</p>
</section>
</section>
<section id="documentation">
<h5>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">#</a></h5>
<p>Documentation is a critical part of any open source project, and we are very
welcome to any documentation improvements. Pyodide has a documentation written
in Markdown in the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> folder. We use the
<a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/using/syntax.html#targets-and-cross-referencing">MyST</a>
for parsing Markdown in sphinx. You may want to have a look at the
<a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/using/syntax.html#the-myst-syntax-guide">MyST syntax guide</a>
when contributing, in particular regarding
<a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/using/syntax.html#targets-and-cross-referencing">cross-referencing sections</a>.</p>
<section id="building-the-docs">
<h6>Building the docs<a class="headerlink" href="#building-the-docs" title="Link to this heading">#</a></h6>
<p>From the directory <code class="docutils literal notranslate"><span class="pre">docs</span></code>, first install the Python dependencies with
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements-doc.txt</span></code>. You also need to install JsDoc, which is a
<code class="docutils literal notranslate"><span class="pre">node</span></code> dependency. Install it with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">npm</span> <span class="pre">install</span> <span class="pre">-g</span> <span class="pre">jsdoc</span></code>. Then to
build the docs run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>. The built documentation will be in the
subdirectory <code class="docutils literal notranslate"><span class="pre">docs/_build/html</span></code>. To view them, cd into <code class="docutils literal notranslate"><span class="pre">_build/html</span></code> and
start a file server, for instance <code class="docutils literal notranslate"><span class="pre">http-server</span></code>.</p>
</section>
</section>
<section id="migrating-patches">
<h5>Migrating patches<a class="headerlink" href="#migrating-patches" title="Link to this heading">#</a></h5>
<p>It often happens that patches need to be migrated between different versions of
upstream packages.</p>
<p>If patches fail to apply automatically, one solution can be to</p>
<ol class="arabic">
<li><p>Checkout the initial version of the upstream package in a separate repo, and
create a branch from it.</p></li>
<li><p>Add existing patches with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">apply</span> <span class="pre">&lt;path.path&gt;</span></code></p></li>
<li><p>Checkout the new version of the upstream package and create a branch from it.</p></li>
<li><p>Cherry-pick patches to the new version,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">cherry</span><span class="o">-</span><span class="n">pick</span> <span class="o">&lt;</span><span class="n">commit</span><span class="o">-</span><span class="nb">hash</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and resolve conflicts.</p>
</li>
<li><p>Re-export last <code class="docutils literal notranslate"><span class="pre">N</span></code> commits as patches e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="nb">format</span><span class="o">-</span><span class="n">patch</span> <span class="o">-&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">N</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">stat</span> <span class="n">HEAD</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out_dir</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="maintainer-information">
<h5>Maintainer information<a class="headerlink" href="#maintainer-information" title="Link to this heading">#</a></h5>
<p>For information about making releases see <a class="reference internal" href="#maintainer-information"><span class="std std-ref">Maintainer information</span></a>.</p>
</section>
<section id="license">
<h5>License<a class="headerlink" href="#license" title="Link to this heading">#</a></h5>
<p>All contributions to Pyodide will be licensed under the
<a class="reference external" href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License 2.0 (MPL 2.0)</a>.
This is considered a “weak copyleft” license. Check out the <a class="reference external" href="https://tldrlegal.com/license/mozilla-public-license-2.0-(mpl-2)">tl;drLegal entry</a> for more
information, as well as Mozilla’s
<a class="reference external" href="https://www.mozilla.org/en-US/MPL/2.0/FAQ/">MPL 2.0 FAQ</a> if you need further
clarification on what is and isn’t permitted.</p>
<div class="toctree-wrapper compound">
<span id="document-development/core"></span><section id="contributing-to-the-core-c-code">
<span id="contributing-core"></span><h6>Contributing to the “core” C Code<a class="headerlink" href="#contributing-to-the-core-c-code" title="Link to this heading">#</a></h6>
<p>This file is intended as guidelines to help contributors trying to modify the C source files in <code class="docutils literal notranslate"><span class="pre">src/core</span></code>.</p>
<section id="what-the-files-do">
<h6 aria-level="7">What the files do<a class="headerlink" href="#what-the-files-do" title="Link to this heading">#</a></h6>
<p>The primary purpose of <code class="docutils literal notranslate"><span class="pre">core</span></code> is to implement <a class="reference internal" href="#type-translations"><span class="std std-ref">type translations</span></a> between Python and JavaScript. Here is a breakdown of the purposes of the files.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">main</span></code> – responsible for configuring and initializing the Python interpreter, initializing the other source files, and creating the <code class="docutils literal notranslate"><span class="pre">_pyodide_core</span></code> module which is used to expose Python objects to <code class="docutils literal notranslate"><span class="pre">pyodide_py</span></code>. <code class="docutils literal notranslate"><span class="pre">main.c</span></code> also tries to generate fatal initialization error messages to help with debugging when there is a mistake in the initialization code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyboard_interrupt</span></code> – This sets up the keyboard interrupts system for using Pyodide with a webworker.</p></li>
</ul>
<section id="backend-utilities">
<h6 aria-level="8">Backend utilities<a class="headerlink" href="#backend-utilities" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hiwire</span></code> – A helper framework. It is impossible for wasm to directly hold owning references to JavaScript objects. The primary purpose of hiwire is to act as a surrogate owner for JavaScript references by holding the references in a JavaScript <code class="docutils literal notranslate"><span class="pre">Map</span></code>. <code class="docutils literal notranslate"><span class="pre">hiwire</span></code> also defines a wide variety of <code class="docutils literal notranslate"><span class="pre">EM_JS</span></code> helper functions to do JavaScript operations on the held objects. The primary type that hiwire exports is <code class="docutils literal notranslate"><span class="pre">JsRef</span></code>. References are created with <code class="docutils literal notranslate"><span class="pre">Hiwire.new_value</span></code> (only can be done from JavaScript) and must be destroyed from C with <code class="docutils literal notranslate"><span class="pre">hiwire_decref</span></code> or <code class="docutils literal notranslate"><span class="pre">hiwire_CLEAR</span></code>, or from JavaScript with <code class="docutils literal notranslate"><span class="pre">Hiwire.decref</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_handling</span></code> – defines macros useful for error propagation and for adapting JavaScript functions to the CPython calling convention. See more in the <a class="reference internal" href="#error-handling-macros"><span class="std std-ref">Error Handling Macros</span></a> section.</p></li>
</ul>
</section>
<section id="type-conversion-from-javascript-to-python">
<h6 aria-level="8">Type conversion from JavaScript to Python<a class="headerlink" href="#type-conversion-from-javascript-to-python" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">js2python</span></code> – Translates basic types from JavaScript to Python, leaves more complicated stuff to jsproxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jsproxy</span></code> – Defines Python classes to proxy complex JavaScript types into Python. A complex file responsible for many of the core behaviors of Pyodide.</p></li>
</ul>
</section>
<section id="type-conversion-from-python-to-javascript">
<h6 aria-level="8">Type conversion from Python to JavaScript<a class="headerlink" href="#type-conversion-from-python-to-javascript" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">python2js</span></code> – Translates types from Python to JavaScript, implicitly converting basic types and creating pyproxies for others. It also implements explicit conversion from Python to JavaScript (the <code class="docutils literal notranslate"><span class="pre">toJs</span></code> method).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python2js_buffer</span></code> – Attempts to convert Python objects that implement the Python <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">Buffer Protocol</a>. This includes <code class="docutils literal notranslate"><span class="pre">bytes</span></code> objects, <code class="docutils literal notranslate"><span class="pre">memoryview</span></code>s, <code class="docutils literal notranslate"><span class="pre">array.array</span></code> and a wide variety of types exposed by extension modules like <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. If the data is a 1d array in a contiguous block it can be sliced directly out of the wasm heap to produce a JavaScript <code class="docutils literal notranslate"><span class="pre">TypedArray</span></code>, but JavaScript does not have native support for pointers, so higher dimensional arrays are more complicated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyproxy</span></code> – Defines a JavaScript <code class="docutils literal notranslate"><span class="pre">Proxy</span></code> object that passes calls through to a Python object. Another important core file, <code class="docutils literal notranslate"><span class="pre">PyProxy.apply</span></code> is the primary entrypoint into Python code. <code class="docutils literal notranslate"><span class="pre">pyproxy.c</span></code> is much simpler than <code class="docutils literal notranslate"><span class="pre">jsproxy.c</span></code> though.</p></li>
</ul>
</section>
</section>
<section id="cpython-apis">
<h6 aria-level="7">CPython APIs<a class="headerlink" href="#cpython-apis" title="Link to this heading">#</a></h6>
<section id="conventions-for-indicating-errors">
<h6 aria-level="8">Conventions for indicating errors<a class="headerlink" href="#conventions-for-indicating-errors" title="Link to this heading">#</a></h6>
<p>The two main ways to indicate errors:</p>
<ol class="arabic simple">
<li><p>If the function returns a pointer, (most often <code class="docutils literal notranslate"><span class="pre">PyObject*</span></code>, <code class="docutils literal notranslate"><span class="pre">char*</span></code>, or <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char*</span></code>) then to indicate an error set an exception and return <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></li>
<li><p>If the function returns <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> and a correct output must be nonnegative, to indicate an error set an exception and return <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
</ol>
<p>Certain functions have “successful errors” like <code class="docutils literal notranslate"><span class="pre">PyIter_Next</span></code> (successful error is <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>) and <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemWithError</span></code> (successful error is <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>). These functions will return <code class="docutils literal notranslate"><span class="pre">NULL</span></code> without setting an exception to indicate the “successful error” occurred. Check what happened with <code class="docutils literal notranslate"><span class="pre">PyErr_Occurred</span></code>. Also, functions that return <code class="docutils literal notranslate"><span class="pre">int</span></code> for which <code class="docutils literal notranslate"><span class="pre">-1</span></code> is a valid return value will return <code class="docutils literal notranslate"><span class="pre">-1</span></code> with no error set to indicate that the result is <code class="docutils literal notranslate"><span class="pre">-1</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code> with an error set if an error did occur. The simplest way to handle this is to always check <code class="docutils literal notranslate"><span class="pre">PyErr_Occurred</span></code>.</p>
<p>Lastly, the argument parsing functions <code class="docutils literal notranslate"><span class="pre">PyArg_ParseTuple</span></code>, <code class="docutils literal notranslate"><span class="pre">PyArg_Parse</span></code>, etc are edge cases. These return <code class="docutils literal notranslate"><span class="pre">true</span></code> on success and return <code class="docutils literal notranslate"><span class="pre">false</span></code> and set an error on failure.</p>
</section>
<section id="python-apis-to-avoid">
<h6 aria-level="8">Python APIs to avoid:<a class="headerlink" href="#python-apis-to-avoid" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PyDict_GetItem</span></code>, <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemString</span></code>, and <code class="docutils literal notranslate"><span class="pre">_PyDict_GetItemId</span></code>
These APIs do not do correct error reporting and there is talk in the Python community of deprecating them going forward. Instead, use <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemWithError</span></code> and <code class="docutils literal notranslate"><span class="pre">_PyDict_GetItemIdWithError</span></code> (there is no <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemStringWithError</span></code> API because use of <code class="docutils literal notranslate"><span class="pre">GetXString</span></code> APIs is also discouraged).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PyObject_HasAttrString</span></code>, <code class="docutils literal notranslate"><span class="pre">PyObject_GetAttrString</span></code>, <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemString</span></code>, <code class="docutils literal notranslate"><span class="pre">PyDict_SetItemString</span></code>, <code class="docutils literal notranslate"><span class="pre">PyMapping_HasKeyString</span></code> etc, etc.
These APIs cause wasteful repeated string conversion.
If the string you are using is a constant, e.g., <code class="docutils literal notranslate"><span class="pre">PyDict_GetItemString(dict,</span> <span class="pre">&quot;identifier&quot;)</span></code>, then make an id with <code class="docutils literal notranslate"><span class="pre">Py_Identifier(identifier)</span></code> and then use <code class="docutils literal notranslate"><span class="pre">_PyDict_GetItemId(&amp;PyId_identifier)</span></code>. If the string is not constant, convert it to a Python object with <code class="docutils literal notranslate"><span class="pre">PyUnicode_FromString()</span></code> and then use e.g., <code class="docutils literal notranslate"><span class="pre">PyDict_GetItem</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PyModule_AddObject</span></code>. This steals a reference on success but not on failure and requires unique cleanup code. Instead, use <code class="docutils literal notranslate"><span class="pre">PyObject_SetAttr</span></code>.</p></li>
</ul>
</section>
</section>
<section id="error-handling-macros">
<span id="id1"></span><h6 aria-level="7">Error Handling Macros<a class="headerlink" href="#error-handling-macros" title="Link to this heading">#</a></h6>
<p>The file <code class="docutils literal notranslate"><span class="pre">error_handling.h</span></code> defines several macros to help make error handling as simple and uniform as possible.</p>
<section id="error-propagation-macros">
<h6 aria-level="8">Error Propagation Macros<a class="headerlink" href="#error-propagation-macros" title="Link to this heading">#</a></h6>
<p>In a language with exception handling as a feature, error propagation requires no explicit code, it is only if you want to prevent an error from propagating that you use a <code class="docutils literal notranslate"><span class="pre">try</span></code>/<code class="docutils literal notranslate"><span class="pre">catch</span></code> block. On the other hand, in C all error propagation must be done explicitly.</p>
<p>We define macros to help make error propagation look as simple and uniform as possible.
They can only be used in a function with a <code class="docutils literal notranslate"><span class="pre">finally:</span></code> label which should handle resource cleanup for both the success branch and all the failing branches (see structure of functions section below). When compiled with <code class="docutils literal notranslate"><span class="pre">DEBUG_F</span></code>, these commands will write a message to <code class="docutils literal notranslate"><span class="pre">console.error</span></code> reporting the line, function, and file where the error occurred.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL()</span></code> – unconditionally <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_IF_NULL(ptr)</span></code> – <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code> if <code class="docutils literal notranslate"><span class="pre">ptr</span> <span class="pre">==</span> <span class="pre">NULL</span></code>. This should be used with any function that returns a pointer and follows the standard Python calling convention.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_IF_MINUS_ONE(num)</span></code> – <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code> if <code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">==</span> <span class="pre">-1</span></code>. This should be used with any function that returns a number and follows the standard Python calling convention.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_IF_NONZERO(num)</span></code> – <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code> if <code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">!=</span> <span class="pre">0</span></code>. Can be used with functions that return any nonzero error code on failure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_IF_ERR_OCCURRED()</span></code> – <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code> if the Python error indicator is set (in other words if <code class="docutils literal notranslate"><span class="pre">PyErr_Occurred()</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_IF_ERR_MATCHES(python_err_type)</span></code> – <code class="docutils literal notranslate"><span class="pre">goto</span> <span class="pre">finally;</span></code> if <code class="docutils literal notranslate"><span class="pre">PyErr_ExceptionMatches(python_err_type)</span></code>, for example <code class="docutils literal notranslate"><span class="pre">FAIL_IF_ERR_MATCHES(PyExc_AttributeError);</span></code></p></li>
</ul>
</section>
<section id="javascript-to-cpython-calling-convention-adaptors">
<h6 aria-level="8">JavaScript to CPython calling convention adaptors<a class="headerlink" href="#javascript-to-cpython-calling-convention-adaptors" title="Link to this heading">#</a></h6>
<p>If we call a JavaScript function from C and that JavaScript function throws an error, it is impossible to catch it in C. We define two <code class="docutils literal notranslate"><span class="pre">EM_JS</span></code> adaptors to convert from the JavaScript calling convention to the CPython calling convention. The point of this is to ensure that errors that occur in <code class="docutils literal notranslate"><span class="pre">EM_JS</span></code> functions can be handled in C code using the <code class="docutils literal notranslate"><span class="pre">FAIL_*``</span> <span class="pre">macros.</span> <span class="pre">When</span> <span class="pre">compiled</span> <span class="pre">with</span> </code>DEBUG_F<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">JavaScript</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">thrown</span> <span class="pre">a</span> <span class="pre">message</span> <span class="pre">will</span> <span class="pre">also</span> <span class="pre">be</span> <span class="pre">written</span> <span class="pre">to</span> </code>console.error`. The wrappers do roughly the following:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// body of function here</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// wrap e in a Python exception and set the Python error indicator</span>
<span class="w">  </span><span class="c1">// return error code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are two variants: <code class="docutils literal notranslate"><span class="pre">EM_JS_NUM</span></code> returns <code class="docutils literal notranslate"><span class="pre">-1</span></code> as the error code, <code class="docutils literal notranslate"><span class="pre">EM_JS_REF</span></code> returns <code class="docutils literal notranslate"><span class="pre">NULL</span> <span class="pre">==</span> <span class="pre">0</span></code> as the error code. A couple of simple examples:
Use <code class="docutils literal notranslate"><span class="pre">EM_JS_REF</span></code> when return value is a <code class="docutils literal notranslate"><span class="pre">JsRef</span></code>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">EM_JS_REF</span><span class="p">(</span><span class="nx">JsRef</span><span class="p">,</span><span class="w"> </span><span class="nx">hiwire_call</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">idfunc</span><span class="p">,</span><span class="w"> </span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">idargs</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">jsfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">get_value</span><span class="p">(</span><span class="nx">idfunc</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">jsargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">get_value</span><span class="p">(</span><span class="nx">idargs</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">new_value</span><span class="p">(</span><span class="nx">jsfunc</span><span class="p">(...</span><span class="w"> </span><span class="nx">jsargs</span><span class="p">));</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">EM_JS_REF</span></code> when return value is a <code class="docutils literal notranslate"><span class="pre">PyObject</span></code>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">EM_JS_REF</span><span class="p">(</span><span class="nx">PyObject</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nx">__js2python</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">id</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// body here</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If the function returns <code class="docutils literal notranslate"><span class="pre">void</span></code>, use <code class="docutils literal notranslate"><span class="pre">EM_JS_NUM</span></code> with return type <code class="docutils literal notranslate"><span class="pre">errcode</span></code>. <code class="docutils literal notranslate"><span class="pre">errcode</span></code> is a typedef for <code class="docutils literal notranslate"><span class="pre">int</span></code>. <code class="docutils literal notranslate"><span class="pre">EM_JS_NUM</span></code> will automatically return <code class="docutils literal notranslate"><span class="pre">-1</span></code> if an error occurs and <code class="docutils literal notranslate"><span class="pre">0</span></code> if not:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">EM_JS_NUM</span><span class="p">(</span><span class="nx">errcode</span><span class="p">,</span><span class="w"> </span><span class="nx">hiwire_set_member_int</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">idobj</span><span class="p">,</span><span class="w"> </span><span class="kr">int</span><span class="w"> </span><span class="nx">idx</span><span class="p">,</span><span class="w"> </span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">idval</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">get_value</span><span class="p">(</span><span class="nx">idobj</span><span class="p">)[</span><span class="nx">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">get_value</span><span class="p">(</span><span class="nx">idval</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If the function returns <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">bool</span></code> use <code class="docutils literal notranslate"><span class="pre">EM_JS_NUM</span></code>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">EM_JS_NUM</span><span class="p">(</span><span class="kr">int</span><span class="p">,</span><span class="w"> </span><span class="nx">hiwire_get_length</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">JsRef</span><span class="w"> </span><span class="nx">idobj</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">Hiwire</span><span class="p">.</span><span class="nx">get_value</span><span class="p">(</span><span class="nx">idobj</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p>These wrappers enable the following sort of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">jsfunc</span><span class="p">()</span>
<span class="k">except</span> <span class="n">JsException</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Caught an exception thrown in JavaScript!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="structure-of-functions">
<h6 aria-level="7">Structure of functions<a class="headerlink" href="#structure-of-functions" title="Link to this heading">#</a></h6>
<p>In C it takes special care to correctly and cleanly handle both reference counting and exception propagation. In Python (or other higher level languages), all references are released in an implicit finally block at the end of the function. Implicitly, it is as if you wrote:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span> <span class="c1"># implicit</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">do_something</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">do_something_else</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">some_func</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
  <span class="k">finally</span><span class="p">:</span>
    <span class="c1"># implicit, free references both on successful exit and on exception</span>
    <span class="n">decref</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">decref</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">decref</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>Freeing all references at the end of the function allows us to separate reference counting boilerplate from the “actual logic” of the function definition. When a function does correct error propagation, there will be many different execution paths, roughly linearly many in the length of the function. For example, the above pseudocode could exit in five different ways: <code class="docutils literal notranslate"><span class="pre">do_something</span></code> could raise an exception, <code class="docutils literal notranslate"><span class="pre">do_something_else</span></code> could raise an exception, <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code> could raise an exception, <code class="docutils literal notranslate"><span class="pre">some_func</span></code> could raise an exception, or the function could return successfully. (Even a Python function like <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">f(a,b,c,d):</span> <span class="pre">return</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)</span> <span class="pre">*</span> <span class="pre">c</span> <span class="pre">-</span> <span class="pre">d</span></code> has four execution paths.) The point of the <code class="docutils literal notranslate"><span class="pre">try</span></code>/<code class="docutils literal notranslate"><span class="pre">finally</span></code> block is that we know the resources are freed correctly without checking once for each execution path.</p>
<p>To do this, we divide any function that produces more than a couple of owned <code class="docutils literal notranslate"><span class="pre">PyObject*</span></code>s or <code class="docutils literal notranslate"><span class="pre">JsRef</span></code>s into several “segments”.
The more owned references there are in a function and the longer it is, the more important it becomes to follow this style carefully.
By being as consistent as possible, we reduce the burden on people reading the code to double-check that you are not leaking memory or errors. In short functions it is fine to do something ad hoc.</p>
<ol class="arabic simple">
<li><p>The guard block. The first block of a function does sanity checks on the inputs and argument parsing, but only to the extent possible without creating any owned references. If you check more complicated invariants on the inputs in a way that requires creating owned references, this logic belongs in the body block.</p></li>
</ol>
<p>Here’s an example of a <code class="docutils literal notranslate"><span class="pre">METH_VARARGS</span></code> function:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span><span class="o">*</span>
<span class="nf">JsImport_CreateModule</span><span class="p">(</span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// Guard</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">jsproxy</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// PyArg_UnpackTuple uses an unusual calling convention:</span>
<span class="w">  </span><span class="c1">// It returns `false` on failure...</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyArg_UnpackTuple</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;create_module&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">spec</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">jsproxy</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">JsProxy_Check</span><span class="p">(</span><span class="n">jsproxy</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_TypeError</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;package is not an instance of jsproxy&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Forward declaration of owned references. This starts by declaring a success flag <code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">success</span> <span class="pre">=</span> <span class="pre">false</span></code>. This will be used in the finally block to decide whether the finally block was entered after a successful execution or after an error. Then declare every reference counted variable that we will create during execution of the function. Finally, declare the variable that we are planning to return.
Typically, this will be called <code class="docutils literal notranslate"><span class="pre">result</span></code>, but in this case the function is named <code class="docutils literal notranslate"><span class="pre">CreateModule</span></code> so we name the return variable <code class="docutils literal notranslate"><span class="pre">module</span></code>.</p></li>
</ol>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Note: these are all the objects that we will own. If a function returns</span>
<span class="w">  </span><span class="c1">// a borrow, we XINCREF the result so that we can CLEAR it in the finally block.</span>
<span class="w">  </span><span class="c1">// Reference counting is hard, so it&#39;s good to be as explicit and consistent</span>
<span class="w">  </span><span class="c1">// as possible!</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">sys_modules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">importlib_machinery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">ModuleSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">__dir__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">module_dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// result</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>The body of the function. The vast majority of API calls can return error codes. You MUST check every fallible API for an error. Also, as you are writing the code, you should look up every Python API you use that returns a reference to determine whether it returns a borrowed reference or a new one. If it returns a borrowed reference, immediately <code class="docutils literal notranslate"><span class="pre">Py_XINCREF()</span></code> the result to convert it into an owned reference (before <code class="docutils literal notranslate"><span class="pre">FAIL_IF_NULL</span></code>, to be consistent with the case where you use custom error handling).</p></li>
</ol>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyUnicode_FromString</span><span class="p">(</span><span class="n">name_utf8</span><span class="p">);</span>
<span class="w">  </span><span class="n">FAIL_IF_NULL</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">  </span><span class="n">sys_modules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyImport_GetModuleDict</span><span class="p">();</span><span class="w"> </span><span class="c1">// returns borrow</span>
<span class="w">  </span><span class="n">Py_XINCREF</span><span class="p">(</span><span class="n">sys_modules</span><span class="p">);</span>
<span class="w">  </span><span class="n">FAIL_IF_NULL</span><span class="p">(</span><span class="n">sys_modules</span><span class="p">);</span>
<span class="w">  </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyDict_GetItemWithError</span><span class="p">(</span><span class="n">sys_modules</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span><span class="w"> </span><span class="c1">// returns borrow</span>
<span class="w">  </span><span class="n">Py_XINCREF</span><span class="p">(</span><span class="n">module</span><span class="p">);</span>
<span class="w">  </span><span class="n">FAIL_IF_NULL</span><span class="p">(</span><span class="n">module</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">module</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">JsImport_Check</span><span class="p">(</span><span class="n">module</span><span class="p">)){</span>
<span class="w">    </span><span class="n">PyErr_Format</span><span class="p">(</span><span class="n">PyExc_KeyError</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;Cannot mount with name &#39;%s&#39;: there is an existing module by this name that was not mounted with &#39;pyodide.mountPackage&#39;.&quot;</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="n">name</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="n">FAIL</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="c1">// ... [SNIP]</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>The <code class="docutils literal notranslate"><span class="pre">finally</span></code> block. Here we will clear all the variables we declared at the top in exactly the same order. Do not clear the arguments! They are borrowed. According to the standard Python function calling convention, they are the responsibility of the calling code.</p></li>
</ol>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="nl">finally</span><span class="p">:</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">sys_modules</span><span class="p">);</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">importlib_machinery</span><span class="p">);</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">ModuleSpec</span><span class="p">);</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">spec</span><span class="p">);</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">__dir__</span><span class="p">);</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">module_dict</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">success</span><span class="p">){</span>
<span class="w">    </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>One case where you do need to <code class="docutils literal notranslate"><span class="pre">Py_CLEAR</span></code> a variable in the body of a function is if that variable is allocated in a loop:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// refcounted variable declarations</span>
<span class="w">  </span><span class="n">PyObject</span><span class="o">*</span><span class="w"> </span><span class="n">pyentry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// ... other stuff</span>
<span class="w">  </span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PySequence_Length</span><span class="p">(</span><span class="n">pylist</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pyentry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PySequence_GetItem</span><span class="p">(</span><span class="n">pydir</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">FAIL_IF_MINUS_ONE</span><span class="p">(</span><span class="n">do_something</span><span class="p">(</span><span class="n">pyentry</span><span class="p">));</span>
<span class="w">    </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">pyentry</span><span class="p">);</span><span class="w"> </span><span class="c1">// important to use Py_CLEAR and not Py_decref.</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span>
<span class="nl">finally</span><span class="p">:</span>
<span class="w">  </span><span class="c1">// have to clear pyentry at end too in case do_something failed in the loop body</span>
<span class="w">  </span><span class="n">Py_CLEAR</span><span class="p">(</span><span class="n">pyentry</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="testing">
<h6 aria-level="7">Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h6>
<p>Any nonstatic C function called <code class="docutils literal notranslate"><span class="pre">some_name</span></code> defined not using <code class="docutils literal notranslate"><span class="pre">EM_JS</span></code> will be exposed as <code class="docutils literal notranslate"><span class="pre">pyodide._module._some_name</span></code>, and this can be used in tests to good effect. If the arguments / return value are not just numbers and booleans, it may take some effort to set up the function call.</p>
<p>If you want to test an <code class="docutils literal notranslate"><span class="pre">EM_JS</span></code> function, consider moving the body of the function to an API defined on <code class="docutils literal notranslate"><span class="pre">Module</span></code>. You should still wrap the function with <code class="docutils literal notranslate"><span class="pre">EM_JS_REF</span></code> or <code class="docutils literal notranslate"><span class="pre">EM_JS_NUM</span></code> in order to get a function with the CPython calling convention.</p>
</section>
</section>
<span id="document-development/maintainers"></span><section id="maintainer-information">
<span id="id1"></span><h6>Maintainer information<a class="headerlink" href="#maintainer-information" title="Link to this heading">#</a></h6>
<section id="making-a-release">
<h6 aria-level="7">Making a release<a class="headerlink" href="#making-a-release" title="Link to this heading">#</a></h6>
<p>For branch organization we use a variation of the <a class="reference external" href="https://guides.github.com/introduction/flow/">GitHub
Flow</a> with
the latest release branch named <code class="docutils literal notranslate"><span class="pre">stable</span></code> (due to ReadTheDocs constraints).</p>
<section id="preparation-for-making-a-major-release">
<h6 aria-level="8">Preparation for making a major release<a class="headerlink" href="#preparation-for-making-a-major-release" title="Link to this heading">#</a></h6>
<p>Generally we make a tracking issue with a title like “0.25.0 release planning”.</p>
<p>Follow the steps in <a class="reference internal" href="#updating-packages"><span class="std std-ref">Updating packages</span></a>.</p>
<p>Read the changelog and tidy it up by adding subsections and proof reading it.</p>
<p>Generate the list of contributors for the release at the end of the
changelog entry with</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>shortlog<span class="w"> </span>-s<span class="w"> </span>LAST_TAG..<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f2-<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;\[bot\]&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>--ignore-case<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/;/, /g;s/, $//&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>fold<span class="w"> </span>-s
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">LAST_TAG</span></code> is the tag for the last release.</p>
<p>Make a pull request with these changes titled “Rearrange changelog for 0.25.0
release” and merge it.</p>
</section>
<section id="preparation-for-making-a-minor-release">
<h6 aria-level="8">Preparation for making a minor release<a class="headerlink" href="#preparation-for-making-a-minor-release" title="Link to this heading">#</a></h6>
<p>Make a branch called <code class="docutils literal notranslate"><span class="pre">backports-for-v.vv.v</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>stable
git<span class="w"> </span>pull<span class="w"> </span>upstream
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>backports-for-0.23.1
</pre></div>
</div>
<p>Locate the commits you want to backport in the main branch and cherry pick them:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>cherry-pick<span class="w"> </span>&lt;commit-hash&gt;
</pre></div>
</div>
<p>Make a pull request from <code class="docutils literal notranslate"><span class="pre">backports-for-0.23.1</span></code> targeting the stable branch. If
you’re using the github cli this can be done with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>gh<span class="w"> </span>pr<span class="w"> </span>create<span class="w"> </span>-w<span class="w"> </span>-B<span class="w"> </span>stable
</pre></div>
</div>
<p>In the pull request description add a task:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="k">- [ ]</span> Merge don&#39;t squash
</pre></div>
</div>
<p>This pull request is a good place to &#64;mention various people to ask if they have
opinions about what should be backported.</p>
<p>Add an extra commit organizing the changelog into sections and editing changelog
messages. Generate the list of contributors for the release at the end of the
changelog entry with</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>shortlog<span class="w"> </span>-s<span class="w"> </span>LAST_TAG..<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f2-<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;\[bot\]&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>--ignore-case<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/;/, /g;s/, $//&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>fold<span class="w"> </span>-s
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">LAST_TAG</span></code> is the tag for the last release. Make a branch from main called
<code class="docutils literal notranslate"><span class="pre">changelog-for-v.vv.v</span></code> and apply the same changelog rearrangements there.</p>
<p>Merge <code class="docutils literal notranslate"><span class="pre">changelog-for-v.vv.v</span></code> and <code class="docutils literal notranslate"><span class="pre">backports-for-v.vv.v</span></code> and then follow the
relevant steps from <a class="reference internal" href="#release-instructions"><span class="std std-ref">Release Instructions</span></a>.</p>
</section>
<section id="preparation-for-making-an-alpha-release">
<h6 aria-level="8">Preparation for making an alpha release<a class="headerlink" href="#preparation-for-making-an-alpha-release" title="Link to this heading">#</a></h6>
<p>Name the first alpha release <code class="docutils literal notranslate"><span class="pre">x.x.xa1</span></code> and in subsequent alphas increment the
final number. No prepration is necessary. Don’t update anything in the
changelog. Follow the relevant steps from <a class="reference internal" href="#release-instructions"><span class="std std-ref">Release Instructions</span></a>.</p>
</section>
<section id="release-instructions">
<span id="id2"></span><h6 aria-level="8">Release Instructions<a class="headerlink" href="#release-instructions" title="Link to this heading">#</a></h6>
<ol class="arabic">
<li><p>From the root directory of the repository run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./tools/bump_version.py<span class="w"> </span>--new-version<span class="w"> </span>&lt;new_version&gt;
<span class="c1"># ./tools/bump_version.py --new_version &lt;new_version&gt; --dry-run</span>
</pre></div>
</div>
<p>and check that the diff is correct with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>. Try using <code class="docutils literal notranslate"><span class="pre">ripgrep</span></code> to
make sure there are no extra old versions lying around e.g., <code class="docutils literal notranslate"><span class="pre">rg</span> <span class="pre">-F</span> <span class="pre">&quot;0.18&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">rg</span> <span class="pre">-F</span> <span class="pre">dev0</span></code>, <code class="docutils literal notranslate"><span class="pre">rg</span> <span class="pre">-F</span> <span class="pre">dev.0</span></code>.</p>
</li>
<li><p>(Skip for alpha release.) Add a heading to the changelog indicating version
and release date</p></li>
<li><p>Make a PR with the updates from steps 1 and 2. Merge the PR.</p></li>
<li><p>(Major release only.) Rename the <code class="docutils literal notranslate"><span class="pre">stable</span></code> branch to a release branch for the
previous major version. For instance if last release was, <code class="docutils literal notranslate"><span class="pre">0.20.0</span></code>, the
corresponding release branch would be <code class="docutils literal notranslate"><span class="pre">0.20.X</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>fetch<span class="w"> </span>upstream<span class="w"> </span>stable:stable
git<span class="w"> </span>branch<span class="w"> </span><span class="m">0</span>.20.X<span class="w"> </span>stable
git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>upstream<span class="w"> </span><span class="m">0</span>.20.X
</pre></div>
</div>
</li>
<li><p>Create a tag <code class="docutils literal notranslate"><span class="pre">X.Y.Z</span></code> (without leading <code class="docutils literal notranslate"><span class="pre">v</span></code>) and push
it to upstream,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>main
git<span class="w"> </span>pull<span class="w"> </span>upstream
git<span class="w"> </span>tag<span class="w"> </span>X.Y.Z
git<span class="w"> </span>push<span class="w"> </span>upstream<span class="w"> </span>X.Y.Z
</pre></div>
</div>
<p>Wait for the CI to pass and create the release on GitHub.</p>
</li>
<li><p>(Major release only). Create a new <code class="docutils literal notranslate"><span class="pre">stable</span></code> branch from this tag,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>main
git<span class="w"> </span>checkout<span class="w"> </span>-B<span class="w"> </span>stable
git<span class="w"> </span>push<span class="w"> </span>upstream<span class="w"> </span>stable<span class="w"> </span>--force
</pre></div>
</div>
</li>
<li><p>(Major or alpha but not minor release.) Set the version number back to the
development version. If you just released <code class="docutils literal notranslate"><span class="pre">0.22.0</span></code>, set the version to
<code class="docutils literal notranslate"><span class="pre">0.23.0.dev0</span></code>. If you just released <code class="docutils literal notranslate"><span class="pre">0.22.0a1</span></code> then you’ll set the version to
<code class="docutils literal notranslate"><span class="pre">0.22.0.dev0</span></code>. Make a new commit from this and push it to upstream.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>main
./tools/bump_version.py<span class="w"> </span>--new-version<span class="w"> </span><span class="m">0</span>.23.0.dev0
git<span class="w"> </span>add<span class="w"> </span>-u
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;0.23.0.dev0&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>upstream<span class="w"> </span>main
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="fixing-documentation-for-a-released-version">
<h6 aria-level="7">Fixing documentation for a released version<a class="headerlink" href="#fixing-documentation-for-a-released-version" title="Link to this heading">#</a></h6>
<p>Cherry pick the corresponding documentation commits to the <code class="docutils literal notranslate"><span class="pre">stable</span></code> branch. Use
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code> to add <code class="docutils literal notranslate"><span class="pre">[skip</span> <span class="pre">ci]</span></code> to the commit message.</p>
</section>
<section id="updating-the-docker-image">
<h6 aria-level="7">Updating the Docker image<a class="headerlink" href="#updating-the-docker-image" title="Link to this heading">#</a></h6>
<p>Anyone with an account on hub.docker.com can follow the following steps:</p>
<ol class="arabic">
<li><p>Make whatever changes are needed to the Dockerfile.</p></li>
<li><p>Build the docker image with <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">build</span> <span class="pre">.</span></code> in the Pyodide root directory.
If the build succeeds, docker will give you a hash for the built image.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">./tools/docker_image_tag.py</span></code> to find out what the new image tag
should be. Tag the image with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>image<span class="w"> </span>tag<span class="w"> </span>&lt;image-hash&gt;<span class="w"> </span>&lt;your-docker-username&gt;/pyodide-env:&lt;image-tag&gt;
</pre></div>
</div>
</li>
<li><p>Push the image with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>image<span class="w"> </span>push<span class="w"> </span>&lt;your-docker-username&gt;/pyodide-env:&lt;image-tag&gt;
</pre></div>
</div>
</li>
<li><p>Replace the image in <code class="docutils literal notranslate"><span class="pre">.circleci/config.yml</span></code> with your newly created image.
Open a pull request with your changes to <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> and <code class="docutils literal notranslate"><span class="pre">.circleci/config.yml</span></code>.</p></li>
<li><p>When the tests pass and the pull request is approved, a maintainer must copy
the new image into the <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> dockerhub account.</p></li>
<li><p>Then replace the image tag in <code class="docutils literal notranslate"><span class="pre">.circleci/config.yml</span></code>,
<code class="docutils literal notranslate"><span class="pre">.devcontainer/devcontainer.json</span></code>, and <code class="docutils literal notranslate"><span class="pre">run_docker</span></code> with the new image under
the <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> dockerhub account.</p></li>
</ol>
<p>It’s also possible to update the docker image by pushing your changes to the
<code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> to a branch in the <code class="docutils literal notranslate"><span class="pre">pyodide/pyodide</span></code> repo (not on a fork) and
clicking <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">workflow</span></code> on
https://github.com/pyodide/pyodide/actions/workflows/docker_image.yml.</p>
</section>
<section id="updating-packages">
<span id="id3"></span><h6 aria-level="7">Updating packages<a class="headerlink" href="#updating-packages" title="Link to this heading">#</a></h6>
<p>Before updating the Python version and before making a major Pyodide release, we
try to update all packages that are not too much trouble. Run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>packages<span class="w"> </span>update-all
</pre></div>
</div>
<p>to update all packages and make a pull request with these changes. There will be
build/test failures, revert the packages that fail the build or tests and make a
note to update them independently.</p>
</section>
<section id="updating-pyodide-build">
<h6 aria-level="7">Updating pyodide-build<a class="headerlink" href="#updating-pyodide-build" title="Link to this heading">#</a></h6>
<p>to change the version of pyodide-build, change the commit of the pyodide-build submodule.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>pyodide-build
git<span class="w"> </span>checkout<span class="w"> </span><span class="s2">&quot;&lt;COMMIT HASH&gt;&quot;</span>
</pre></div>
</div>
<p>to test with the fork of pyodide-build, change the <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> file to point to your fork and update the commit hash</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># .gitmodules</span>
<span class="k">[submodule &quot;pyodide-build&quot;]</span>
<span class="w">	</span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">pyodide-build</span>
<span class="w">	</span><span class="na">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">https://github.com/&lt;yourfork&gt;/pyodide-build</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>submodule<span class="w"> </span>sync
<span class="nb">cd</span><span class="w"> </span>pyodide-build
git<span class="w"> </span>checkout<span class="w"> </span><span class="s2">&quot;&lt;COMMIT HASH&quot;</span>
</pre></div>
</div>
</section>
<section id="upgrading-pyodide-to-a-new-version-of-cpython">
<h6 aria-level="7">Upgrading pyodide to a new version of CPython<a class="headerlink" href="#upgrading-pyodide-to-a-new-version-of-cpython" title="Link to this heading">#</a></h6>
<section id="prerequisites">
<h6 aria-level="8">Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h6>
<p>The desired version of CPython must be available at:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">specific</span> <span class="pre">release</span></code> section of https://www.python.org/downloads</p></li>
<li><p>https://hub.docker.com/_/python</p></li>
<li><p>https://github.com/actions/python-versions/releases</p></li>
</ol>
<p>If doing a major version update, save time by <a class="reference internal" href="#updating-packages"><span class="std std-ref">Updating packages</span></a> first.</p>
</section>
<section id="steps">
<h6 aria-level="8">Steps<a class="headerlink" href="#steps" title="Link to this heading">#</a></h6>
<ol class="arabic">
<li><p>Follow the steps in “Updating the Docker image” to create a docker image for
the new Python version.</p></li>
<li><p>Make sure you are in a Python virtual environment with the new version of
Python and with <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> installed. (It is also possible to work in
the docker image as an alternative.)</p></li>
<li><p>Update the Python version in Makefile.envs</p></li>
<li><p>Update the Python version in the following locations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.github/workflows/main.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs/development/contributing.md</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs/development/building-and-testing-packages.md</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">environment.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></p></li>
</ul>
<p>(TODO: make this list shorter.)</p>
</li>
<li><p>Rebase the patches:</p>
<ul>
<li><p>Clone cpython and cd into it. Checkout the Python version you are upgrading
from. For instance, if the old version is 3.11.3, use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">v3.11.3</span></code>
(Python tags have a leading v.) Run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>am<span class="w"> </span>~/path/to/pyodide/cpython/patches/*
</pre></div>
</div>
</li>
<li><p>Rebase the patches onto the new version of Python. For instance if updating
from Python v3.11.3 to Python 3.12.1:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>v3.11.3<span class="w"> </span>--onto<span class="w"> </span>v3.12.1
</pre></div>
</div>
</li>
<li><p>Resolve conflicts / drop patches that have been upstreamed. If you have
conflicts, make sure you are using diff3:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>merge.conflictstyle<span class="w"> </span>diff3
</pre></div>
</div>
</li>
<li><p>Generate the new patches:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>~/path/to/pyodide/cpython/patches/*
git<span class="w"> </span>format-patch<span class="w"> </span>v3.12.1<span class="w"> </span>-o<span class="w"> </span>~/path/to/pyodide/cpython/patches/
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Try to build Python with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">-C</span> <span class="pre">cpython</span></code>. Fix any build errors. If you
modify the Python source in tree after a failed build it may be useful to run
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">rebuild</span></code>.</p></li>
<li><p>Try to finish the build with a top level <code class="docutils literal notranslate"><span class="pre">make</span></code>. Fix compile errors in
<code class="docutils literal notranslate"><span class="pre">src/core</span></code> and any link errors. It may be useful to apply
<code class="docutils literal notranslate"><span class="pre">upgrade_pythoncapi.py</span> <span class="pre">--no-compat</span></code> to the C extension in <code class="docutils literal notranslate"><span class="pre">src/code</span></code>.
https://github.com/python/pythoncapi-compat/blob/main/upgrade_pythoncapi.py</p>
<p>The file most tightly coupled to the CPython version is
<code class="docutils literal notranslate"><span class="pre">src/core/stack_switching/pystate.c</span></code>. Consult the following greenlet file to
figure out how to fix it:
https://github.com/python-greenlet/greenlet/blob/master/src/greenlet/TPythonState.cpp</p>
</li>
<li><p>In the virtual environment with the new Python version, run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>src/tests/make_test_list.py
</pre></div>
</div>
<p>Then run the core tests <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">src/tests/test_core_python.py</span></code> and either fix
the failures or update <code class="docutils literal notranslate"><span class="pre">src/tests/python_tests.yaml</span></code> to skip or xfail them.</p>
</li>
<li><p>Try to build packages with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pyodide<span class="w"> </span>build-recipes<span class="w"> </span><span class="s1">&#39;*&#39;</span>
</pre></div>
</div>
<p>Disable packages until the build succeeds. Then fix the build failures. In
many cases, this just requires updating to the most recent version of the
package. If you have trouble, try searching on the package’s issue tracker
for “python 3.12” (or whatever the new version is). It’s best to create
separate PRs for tricky package upgrades.</p>
</li>
<li><p>Fix failing package tests.</p></li>
</ol>
</section>
<section id="old-major-python-upgrades">
<h6 aria-level="8">Old major Python upgrades<a class="headerlink" href="#old-major-python-upgrades" title="Link to this heading">#</a></h6>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>version</p></th>
<th class="head"><p>pr</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.12</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/4435">#4435</a></p></td>
</tr>
<tr class="row-odd"><td><p>3.11</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/3252">#3252</a></p></td>
</tr>
<tr class="row-even"><td><p>3.10</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/2225">#2225</a></p></td>
</tr>
<tr class="row-odd"><td><p>3.9</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/1637">#1637</a></p></td>
</tr>
<tr class="row-even"><td><p>3.8</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/712">#712</a></p></td>
</tr>
<tr class="row-odd"><td><p>3.7</p></td>
<td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/77">#77</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
</div>
</section>
</section>
<span id="document-development/testing"></span><section id="testing-and-benchmarking">
<span id="testing"></span><h4>Testing and benchmarking<a class="headerlink" href="#testing-and-benchmarking" title="Link to this heading">#</a></h4>
<section id="id1">
<h5>Testing<a class="headerlink" href="#id1" title="Link to this heading">#</a></h5>
<section id="running-the-python-test-suite">
<h6>Running the Python test suite<a class="headerlink" href="#running-the-python-test-suite" title="Link to this heading">#</a></h6>
<ol class="arabic simple">
<li><p>Install the following dependencies into the default Python installation:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pytest-pyodide<span class="w"> </span>pytest-httpserver
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pytest-pyodide</span></code> is a pytest plugin for testing Pyodide
and third-party applications that use Pyodide.</p>
<blockquote>
<div><p>See: <a class="reference external" href="https://github.com/pyodide/pytest-pyodide">pytest-pyodide</a> for more information.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Install <a class="reference external" href="https://github.com/mozilla/geckodriver/releases">geckodriver</a> or
<a class="reference external" href="https://sites.google.com/a/chromium.org/chromedriver/downloads">chromedriver</a>
and check that they are in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
<li><p>To run the test suite, run <code class="docutils literal notranslate"><span class="pre">pytest</span></code> from the root directory of Pyodide:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
<p>There are 2 test locations that are collected by pytest,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src/tests/</span></code>: general Pyodide tests and tests running the CPython test suite</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">packages/*/test_*</span></code>: package specific tests.</p></li>
</ul>
<p>You can run the tests from a specific file with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>path/to/test/file.py
</pre></div>
</div>
<p>Some browsers sometimes produce informative errors than others
so if you are getting confusing errors it is worth rerunning the test on each
browser. You can use <code class="docutils literal notranslate"><span class="pre">--runtime</span></code> commandline option to specify the browser runtime.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--runtime<span class="w"> </span>firefox
pytest<span class="w"> </span>--runtime<span class="w"> </span>chrome
pytest<span class="w"> </span>--runtime<span class="w"> </span>node
</pre></div>
</div>
<section id="custom-test-marks">
<h6 aria-level="7">Custom test marks<a class="headerlink" href="#custom-test-marks" title="Link to this heading">#</a></h6>
<p>We support custom test marks:</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip_refcount_check</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.mark.skip_pyproxy_check</span></code> disable
respectively the check for JavaScript references and the check for PyProxies.
If a test creates JavaScript references or PyProxies and does not clean them up,
by default the tests will fail. If a test is known to leak objects, it is
possible to disable these checks with these markers.</p>
</section>
</section>
<section id="running-the-javascript-test-suite">
<h6>Running the JavaScript test suite<a class="headerlink" href="#running-the-javascript-test-suite" title="Link to this heading">#</a></h6>
<p>To run tests on the JavaScript Pyodide package using Mocha, run the following
commands,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>src/js
npm<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<p>To check TypeScript type definitions run,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>npx<span class="w"> </span>tsd
</pre></div>
</div>
</section>
<section id="manual-interactive-testing">
<span id="manual-testing"></span><h6>Manual interactive testing<a class="headerlink" href="#manual-interactive-testing" title="Link to this heading">#</a></h6>
<p>To run tests manually:</p>
<ol class="arabic simple">
<li><p>Build Pyodide, perhaps in the docker image</p></li>
<li><p>From outside of the docker image, <code class="docutils literal notranslate"><span class="pre">cd</span></code> into the <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory and run
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">http.server</span></code>.</p></li>
<li><p>Once the webserver is running, simple interactive testing can be run by
visiting the URL: <code class="docutils literal notranslate"><span class="pre">http://localhost:&lt;PORT&gt;/console.html</span></code>. It’s recommended to
use <code class="docutils literal notranslate"><span class="pre">pyodide.runPython</span></code> in the browser console rather than using the repl.</p></li>
</ol>
</section>
</section>
<section id="benchmarking">
<h5>Benchmarking<a class="headerlink" href="#benchmarking" title="Link to this heading">#</a></h5>
<p>To run common benchmarks to understand Pyodide’s performance, begin by
installing the same prerequisites as for testing. Then run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PYODIDE_PACKAGES</span><span class="o">=</span><span class="s2">&quot;numpy,matplotlib&quot;</span><span class="w"> </span>make<span class="w"> </span>benchmark
</pre></div>
</div>
</section>
<section id="linting">
<h5>Linting<a class="headerlink" href="#linting" title="Link to this heading">#</a></h5>
<p>We lint with <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code>.</p>
<p>Python is linted with <code class="docutils literal notranslate"><span class="pre">ruff</span></code>, <code class="docutils literal notranslate"><span class="pre">black</span></code> and <code class="docutils literal notranslate"><span class="pre">mypy</span></code>.
JavaScript, markdown, yaml, and html are linted with <code class="docutils literal notranslate"><span class="pre">prettier</span></code>.
C is linted with <code class="docutils literal notranslate"><span class="pre">clang-format</span></code>.</p>
<p>To lint the code, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>run<span class="w"> </span>-a
</pre></div>
</div>
<p>You can have the linter automatically run whenever you commit by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pre-commit
pre-commit<span class="w"> </span>install
</pre></div>
</div>
<p>and this can later be disabled with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>uninstall
</pre></div>
</div>
<p>If you don’t lint your code, certain lint errors will be fixed automatically by
<code class="docutils literal notranslate"><span class="pre">pre-commit.ci</span></code> which will push fixes to your branch. If you want to push more
commits, you will either have to pull in the remote changes or force push.</p>
</section>
</section>
<span id="document-development/debugging"></span><section id="debugging-tips">
<span id="debugging"></span><h4>Debugging tips<a class="headerlink" href="#debugging-tips" title="Link to this heading">#</a></h4>
<p>See <a class="reference external" href="https://emscripten.org/docs/porting/Debugging.html">Emscripten’s page about
debugging</a> which has
extensive info about the various debugging options available. The <a class="reference external" href="https://github.com/WebAssembly/wabt">Wasm Binary
Toolkit</a> is super helpful for analyzing
<code class="docutils literal notranslate"><span class="pre">.wasm</span></code>, <code class="docutils literal notranslate"><span class="pre">.so</span></code>, <code class="docutils literal notranslate"><span class="pre">.a</span></code>, and <code class="docutils literal notranslate"><span class="pre">.o</span></code> files.</p>
<p>Also whenever you can reproduce a bug in chromium make sure to use a
chromium-based browser (e.g., chrome) for debugging. They are better at it.</p>
<section id="run-prettier-on-pyodide-asm-js">
<h5>Run <code class="docutils literal notranslate"><span class="pre">prettier</span></code> on <code class="docutils literal notranslate"><span class="pre">pyodide.asm.js</span></code><a class="headerlink" href="#run-prettier-on-pyodide-asm-js" title="Link to this heading">#</a></h5>
<p>Before doing any debugger I strongly recommend running
<code class="docutils literal notranslate"><span class="pre">npx</span> <span class="pre">prettier</span> <span class="pre">-w</span> <span class="pre">pyodide.asm.js</span></code>. This makes everything much easier.</p>
</section>
<section id="building-with-symbols-or-source-maps">
<span id="build-with-symbols"></span><h5>Building with symbols or source maps<a class="headerlink" href="#building-with-symbols-or-source-maps" title="Link to this heading">#</a></h5>
<p>Building with symbols retains the names of all internal functions, but will not
prevent function calls from being inlined away and does not retain a source map
to the original C code. Symbols do not cause much of a slowdown and only cause a
minor increase in code size. Building with source maps disables many
optimizations such as inlining and slows down execution by quite a lot.</p>
<p>To rebuild with symbols you can use the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>src/core/jsproxy.h
<span class="nv">PYODIDE_SYMBOLS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>make<span class="w"> </span>-C<span class="w"> </span>cpython<span class="w"> </span>rebuild-all
<span class="nv">PYODIDE_SYMBOLS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>make<span class="w"> </span>all-but-packages
</pre></div>
</div>
<p>To use source maps, use <code class="docutils literal notranslate"><span class="pre">PYODIDE_SOURCEMAPS=1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">PYODIDE_SYMBOLS=1</span></code>.
To get the benefits of source maps, you need the
<a class="reference external" href="https://chromewebstore.google.com/detail/cc++-devtools-support-dwa/pdcpmagijalfljmkmjngeonclgbbannb?pli=1">C/C++ devtoools support Chrome extension</a>.</p>
<p>When source maps are present and the devtools extension is enabled, you will not
be able to see the raw disassembly, which makes it hard to inspect the state of
the program in the debugger because there is no support for executing C
expressions. The extension provides no way to see the raw assembly without
disabling the extension and refreshing the page.</p>
</section>
<section id="linker-error-function-signature-mismatch">
<h5>Linker error: function signature mismatch<a class="headerlink" href="#linker-error-function-signature-mismatch" title="Link to this heading">#</a></h5>
<p>You may get linker errors as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wasm</span><span class="o">-</span><span class="n">ld</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">function</span> <span class="n">signature</span> <span class="n">mismatch</span><span class="p">:</span> <span class="n">some_func</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">defined</span> <span class="k">as</span> <span class="p">(</span><span class="n">i32</span><span class="p">,</span> <span class="n">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">i32</span> <span class="ow">in</span> <span class="n">some_static_lib</span><span class="o">.</span><span class="n">a</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">o</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">defined</span> <span class="k">as</span> <span class="p">(</span><span class="n">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">i32</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">o</span>
</pre></div>
</div>
<p>This is especially common in Scipy. Oftentimes it isn’t too hard to figure out
what is going wrong because it told you the both the symbol name (<code class="docutils literal notranslate"><span class="pre">some_func</span></code>)
and the object files involved (this is much easier than the runtime version of
this error!). If you can’t tell what is going on from looking at the source
files, it’s time to pull out <code class="docutils literal notranslate"><span class="pre">wasm-objdump</span></code>. In this case <code class="docutils literal notranslate"><span class="pre">a.o</span></code> is part of
<code class="docutils literal notranslate"><span class="pre">some_static_lib.a</span></code> so you first need to get it out with
<code class="docutils literal notranslate"><span class="pre">ar</span> <span class="pre">-x</span> <span class="pre">some_static_lib.a</span> <span class="pre">a.o</span></code>.
Now we can check if <code class="docutils literal notranslate"><span class="pre">a.o</span></code> imports or defines <code class="docutils literal notranslate"><span class="pre">some_func</span></code>.
To check for imports, use <code class="docutils literal notranslate"><span class="pre">wasm-objdump</span> <span class="pre">a.o</span> <span class="pre">-j</span> <span class="pre">Import</span> <span class="pre">-x</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">some_func</span></code>.
If <code class="docutils literal notranslate"><span class="pre">a.o</span></code> is importing <code class="docutils literal notranslate"><span class="pre">some_func</span></code> you should see a line like:
<code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">func[0]</span> <span class="pre">sig=1</span> <span class="pre">&lt;env.some_func&gt;</span> <span class="pre">&lt;-</span> <span class="pre">env.some_func</span></code> in the output.</p>
<p>If not, you will see nothing or things like <code class="docutils literal notranslate"><span class="pre">some_func2</span></code>. To check if <code class="docutils literal notranslate"><span class="pre">a.o</span></code>
defines <code class="docutils literal notranslate"><span class="pre">some_func</span></code> (this is a bit redundant because you can conclude whether or
not does from whether it imports it) we can use:
<code class="docutils literal notranslate"><span class="pre">wasm-objdump</span> <span class="pre">a.o</span> <span class="pre">-j</span> <span class="pre">Function</span> <span class="pre">-x</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">some_func</span></code>, if
<code class="docutils literal notranslate"><span class="pre">a.o</span></code> defines <code class="docutils literal notranslate"><span class="pre">some_func</span></code> you will see something like:
<code class="docutils literal notranslate"> <span class="pre">-</span> <span class="pre">func[0]</span> <span class="pre">sig=0</span> <span class="pre">&lt;some_func&gt;</span></code>.</p>
<p>Now the question is what these signatures mean (though we already know this from
the linker error). To find out what signature 0 is, you can use
<code class="docutils literal notranslate"><span class="pre">wasm-objdump</span> <span class="pre">a.o</span> <span class="pre">-j</span> <span class="pre">Type</span> <span class="pre">-x</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">&quot;type\[0\]&quot;</span></code>.</p>
<p>Using this, we can verify that <code class="docutils literal notranslate"><span class="pre">a.o</span></code> imports <code class="docutils literal notranslate"><span class="pre">some_func</span></code> with signature
<code class="docutils literal notranslate"><span class="pre">(i32,</span> <span class="pre">i32)</span> <span class="pre">-&gt;</span> <span class="pre">i32</span></code> but <code class="docutils literal notranslate"><span class="pre">b.o</span></code> exports it with signature <code class="docutils literal notranslate"><span class="pre">(i32)</span> <span class="pre">-&gt;</span> <span class="pre">i32</span></code>,
hence the linker error.</p>
<p>This process works in basically the same way for already-linked <code class="docutils literal notranslate"><span class="pre">.so</span></code> and
<code class="docutils literal notranslate"><span class="pre">.wasm</span></code> files, which can help if you get the load-time version of this linker
error.</p>
</section>
<section id="misencoded-wasm">
<h5>Misencoded Wasm<a class="headerlink" href="#misencoded-wasm" title="Link to this heading">#</a></h5>
<p>On a very rare occasion you may run into a misencoded object file. This can
cause different tools to crash, <code class="docutils literal notranslate"><span class="pre">wasm-ld</span></code> may panic, etc. <code class="docutils literal notranslate"><span class="pre">wasm-objdump</span></code> will
just generate a useless error message. In this case, I recommend
<code class="docutils literal notranslate"><span class="pre">wasm-objdump</span> <span class="pre">-s</span> <span class="pre">--debug</span> <span class="pre">2&gt;&amp;1</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-i</span> <span class="pre">error</span> <span class="pre">-C</span> <span class="pre">20</span></code> (or pipe to <code class="docutils literal notranslate"><span class="pre">less</span></code>), which will result in
more diagnostic information. Sometimes the crash happens quite a lot later than the actual error,
look for suspiciously large constants, these are often the first sign of something gone haywire.</p>
<p>After this, you can get out a hex editor and consult the
<a class="reference external" href="https://webassembly.github.io/spec/core/binary/index.html">WebAssembly binary specification</a>
Cross reference against the hex addresses appearing in <code class="docutils literal notranslate"><span class="pre">wasm-objdump</span> <span class="pre">--debug</span></code>.
With enough diligence you can locate the problem.</p>
</section>
<section id="debugging-runtimeerror-function-signature-mismatch">
<h5>Debugging RuntimeError: function signature mismatch<a class="headerlink" href="#debugging-runtimeerror-function-signature-mismatch" title="Link to this heading">#</a></h5>
<p>First recompile with a source map as suggested in <a class="reference internal" href="#build-with-symbols"><span class="std std-ref">Building with symbols or source maps</span></a>, and
disable the C/C++ DevTools extension (if it’s enabled).</p>
<p>The browser console will show something like the following. Click on the
innermost stack trace:</p>
<p><img alt="fpcast stack trace" src="_images/signature-mismatch1.png" /></p>
<p>Clicking the offset will (hopefully) take you to the corresponding wasm
instruction, which should be a <code class="docutils literal notranslate"><span class="pre">call_indirect</span></code>. If the offset is too large
(somewhere between <code class="docutils literal notranslate"><span class="pre">0x0200000</span></code> and <code class="docutils literal notranslate"><span class="pre">0x0300000</span></code>) you will instead see
<code class="docutils literal notranslate"><span class="pre">;;</span> <span class="pre">text</span> <span class="pre">is</span> <span class="pre">truncated</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">size</span></code>, see <a class="reference internal" href="#text-truncated-due-to-size"><span class="std std-ref">Dealing with ;; text is truncated due to size</span></a>. In
this example we see the following:</p>
<p><img alt="wasm bad call_indirect instruction" src="_images/signature-mismatch2.png" /></p>
<p>So we think we are calling a function pointer with signature
<code class="docutils literal notranslate"><span class="pre">(param</span> <span class="pre">i32</span> <span class="pre">i32)</span> <span class="pre">(result</span> <span class="pre">i32)</span></code>
meaning that it takes two <code class="docutils literal notranslate"><span class="pre">i32</span></code> inputs and returns one <code class="docutils literal notranslate"><span class="pre">i32</span></code> output. Set a
breakpoint by clicking on the address, then refresh the page and run the
reproduction again. Sometimes these are on really hot code paths (as in the
present example) so you probably only want to set the breakpoint once Pyodide is
finished loading. If your reproduction passes through the breakpoint multiple
times before crashing you can do the usual chore of counting how many times you
have to press “Resume” before the crash. Suppose you’ve done all this, and we’ve
got the vm stopped at the bad instruction just before crashing:</p>
<p><img alt="wasm bad function pointer" src="_images/signature-mismatch3.png" /></p>
<p>The bottom value on the stack is the function pointer. In this case it’s the
fourth item on the stack, so you can type the following into the console:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">pyodide</span><span class="p">.</span><span class="nx">_module</span><span class="p">.</span><span class="nx">wasmTable</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">stack</span><span class="p">[</span><span class="mf">4</span><span class="p">].</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="c1">// stack[4].value === 13109</span>
<span class="o">&lt;</span><span class="w"> </span><span class="nx">ƒ</span><span class="w"> </span><span class="nx">$one</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="kr">native</span><span class="w"> </span><span class="nx">code</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>So the bad function pointer’s symbol is <code class="docutils literal notranslate"><span class="pre">one</span></code>! Now clicking on <code class="docutils literal notranslate"><span class="pre">$one</span></code> brings you
to the source for it:</p>
<p><img alt="function pointer signature" src="_images/signature-mismatch4.png" /></p>
<p>and we see the function pointer has signature <code class="docutils literal notranslate"><span class="pre">(param</span> <span class="pre">$var0</span> <span class="pre">i32)</span> <span class="pre">(result</span> <span class="pre">i32)</span></code>,
meaning it takes one <code class="docutils literal notranslate"><span class="pre">i32</span></code> input and returns one <code class="docutils literal notranslate"><span class="pre">i32</span></code> output. Note that if the
function had <code class="docutils literal notranslate"><span class="pre">void</span></code> return type it might look like <code class="docutils literal notranslate"><span class="pre">(param</span> <span class="pre">$var0</span> <span class="pre">i32</span> <span class="pre">$var1</span> <span class="pre">i32)</span></code>
(with no <code class="docutils literal notranslate"><span class="pre">result</span></code>). Confusion between <code class="docutils literal notranslate"><span class="pre">i32</span></code> and <code class="docutils literal notranslate"><span class="pre">void</span></code> return type is the single
most common cause of this error.</p>
<p>Now we basically know the cause of the trouble. You can look up <code class="docutils literal notranslate"><span class="pre">cfunction_call</span></code>
in the CPython source code with the help of ripgrep and locate the line that
generates this call, and look up <code class="docutils literal notranslate"><span class="pre">one</span></code> in the appropriate source and find the
signature. Another approach to locate the call site would be to recompile with
<code class="docutils literal notranslate"><span class="pre">-g3</span></code> and use source maps <a class="reference internal" href="#build-with-symbols"><span class="std std-ref">Building with symbols or source maps</span></a> to locate the problematic
source code. With the same process of reproduce crash ==&gt; click innermost stack
frame ==&gt; see source file and line where the error occurs. In this case we see
that the crash is on the line:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_PyCFunction_TrampolineCall</span><span class="p">(</span><span class="n">meth</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</pre></div>
</div>
<p>in the file <code class="docutils literal notranslate"><span class="pre">/src/cpython/build/Python-3.11.0dev0/Objects/methodobject.c</span></code>.
Unfortunately, source maps are useless for the harder problem of finding the
callee because compiling with <code class="docutils literal notranslate"><span class="pre">-g3</span></code> increases the number of function pointers so
the function pointer we are calling is in a different spot. I know of no way to
determine the bad function pointer when compiling with <code class="docutils literal notranslate"><span class="pre">-g3</span></code>.</p>
<p>Sometimes (particularly with Scipy/OpenBLAS/libf2c) the issue will be a
mismatch between
<code class="docutils literal notranslate"><span class="pre">(param</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32)</span> <span class="pre">(result</span> <span class="pre">i32)</span></code> and
<code class="docutils literal notranslate"><span class="pre">(param</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32</span> <span class="pre">i32)</span> <span class="pre">(result</span> <span class="pre">i32)</span></code></p>
<p>(14 vs 15 parameters) which might be a little hard to discern. I copy the
signature into the Javascript console and run <code class="docutils literal notranslate"><span class="pre">&quot;i32</span> <span class="pre">...</span> <span class="pre">i32&quot;.split(&quot;</span> <span class="pre">&quot;).length</span></code>
in this case.</p>
</section>
<section id="dealing-with-text-is-truncated-due-to-size">
<span id="text-truncated-due-to-size"></span><h5>Dealing with <code class="docutils literal notranslate"><span class="pre">;;</span> <span class="pre">text</span> <span class="pre">is</span> <span class="pre">truncated</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">size</span></code><a class="headerlink" href="#dealing-with-text-is-truncated-due-to-size" title="Link to this heading">#</a></h5>
<p>If you are debugging and run into the dreaded <code class="docutils literal notranslate"><span class="pre">;;</span> <span class="pre">text</span> <span class="pre">is</span> <span class="pre">truncated</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">size</span></code>
error message, the solution is to compile a modified version of Chrome devtools
with a larger wasm size cap. Surprisingly, this is not actually all that hard.</p>
<p>These instructions are adapted from here:
https://www.diverto.hr/en/blog/2020-08-15-WebAssembly-limit/</p>
<p>In short,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">chromium</span><span class="o">.</span><span class="n">googlesource</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">chromium</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">depot_tools</span><span class="o">.</span><span class="n">git</span>
<span class="o">./</span><span class="n">fetch</span> <span class="n">devtools</span><span class="o">-</span><span class="n">frontend</span>
<span class="n">cd</span> <span class="n">devtools</span><span class="o">-</span><span class="n">frontend</span>
</pre></div>
</div>
<p>Apply the following change:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- a/front_end/entrypoints/wasmparser_worker/WasmParserWorker.ts</span>
<span class="gi">+++ b/front_end/entrypoints/wasmparser_worker/WasmParserWorker.ts</span>
<span class="gu">@@ -55,7 +55,7 @@ export function dissambleWASM(</span>
<span class="w"> </span>    const lines = [];
<span class="w"> </span>    const offsets = [];
<span class="w"> </span>    const functionBodyOffsets = [];
<span class="gd">-    const MAX_LINES = 1000 * 1000;</span>
<span class="gi">+    const MAX_LINES = 12 * 1000 * 1000;</span>
<span class="w"> </span>    let chunkSize: number = 128 * 1024;
<span class="w"> </span>    let buffer: Uint8Array = new Uint8Array(chunkSize);
<span class="w"> </span>    let pendingSize = 0;
</pre></div>
</div>
<p>Then build with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gn</span> <span class="n">gen</span> <span class="n">out</span><span class="o">/</span><span class="n">Default</span>
<span class="n">autoninja</span> <span class="o">-</span><span class="n">C</span> <span class="n">out</span><span class="o">/</span><span class="n">Default</span>
</pre></div>
</div>
<p>then</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">out</span><span class="o">/</span><span class="n">Default</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">inspector_overlay</span><span class="o">/</span>
<span class="n">python</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">&lt;</span><span class="n">some_port</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and then you can start a version of chrome using the modified devtools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chrome</span> <span class="o">--</span><span class="n">custom</span><span class="o">-</span><span class="n">devtools</span><span class="o">-</span><span class="n">frontend</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="o">&lt;</span><span class="n">some_port</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
</section>
</div>
</section>
<section id="project">
<h3>Project<a class="headerlink" href="#project" title="Link to this heading">#</a></h3>
<p>The Project section gives additional information about the project’s
organization and latest releases.</p>
<div class="toctree-wrapper compound">
<span id="document-project/about"></span><section id="what-is-pyodide">
<h4>What is Pyodide?<a class="headerlink" href="#what-is-pyodide" title="Link to this heading">#</a></h4>
<p>Pyodide is a Python distribution for the browser and Node.js based on WebAssembly/<a class="reference external" href="https://emscripten.org/">Emscripten</a>.</p>
<p>Pyodide makes it possible to install and run Python packages in the browser with
<a class="reference external" href="https://pyodide.org/en/stable/usage/api/micropip-api.html">micropip</a>. Any pure
Python package with a wheel available on PyPI is supported. Many packages with C
extensions have also been ported for use with Pyodide. These include many
general-purpose packages such as regex, PyYAML, lxml and scientific Python
packages including NumPy, pandas, SciPy, Matplotlib, and scikit-learn.</p>
<p>Pyodide comes with a robust Javascript 🡘 Python foreign function interface so
that you can freely mix these two languages in your code with minimal
friction. This includes full support for error handling (throw an error in one
language, catch it in the other), async/await, and much more.</p>
<p>When used inside a browser, Python has full access to the Web APIs.</p>
<section id="history">
<h5>History<a class="headerlink" href="#history" title="Link to this heading">#</a></h5>
<p>Pyodide was created in 2018 by <a class="reference external" href="https://github.com/mdboom">Michael Droettboom</a>
at Mozilla as part of the <a class="reference external" href="https://github.com/iodide-project/iodide">Iodide
project</a>. Iodide is an experimental
web-based notebook environment for literate scientific computing and
communication.</p>
</section>
<section id="contributing">
<h5>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">#</a></h5>
<p>See the <a class="reference internal" href="#how-to-contribute"><span class="std std-ref">contributing guide</span></a> for tips on filing issues,
making changes, and submitting pull requests. Pyodide is an independent and
community-driven open-source project. The decision-making process is outlined in
<a class="reference internal" href="#project-governance"><span class="std std-ref">Governance and Decision-making</span></a>.</p>
</section>
<section id="citing">
<h5>Citing<a class="headerlink" href="#citing" title="Link to this heading">#</a></h5>
<p>If you use Pyodide for a scientific publication, we would appreciate citations.
Please find us <a class="reference external" href="https://zenodo.org/record/5156931">on Zenodo</a> and use the citation
for the version you are using. You can replace the full author
list from there with “The Pyodide development team” like in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@software</span><span class="p">{</span><span class="n">pyodide_2021</span><span class="p">,</span>
  <span class="n">author</span>       <span class="o">=</span> <span class="p">{</span><span class="n">The</span> <span class="n">Pyodide</span> <span class="n">development</span> <span class="n">team</span><span class="p">},</span>
  <span class="n">title</span>        <span class="o">=</span> <span class="p">{</span><span class="n">pyodide</span><span class="o">/</span><span class="n">pyodide</span><span class="p">},</span>
  <span class="n">month</span>        <span class="o">=</span> <span class="n">aug</span><span class="p">,</span>
  <span class="n">year</span>         <span class="o">=</span> <span class="mi">2021</span><span class="p">,</span>
  <span class="n">publisher</span>    <span class="o">=</span> <span class="p">{</span><span class="n">Zenodo</span><span class="p">},</span>
  <span class="n">version</span>      <span class="o">=</span> <span class="p">{</span><span class="mf">0.27.1</span><span class="p">},</span>
  <span class="n">doi</span>          <span class="o">=</span> <span class="p">{</span><span class="mf">10.5281</span><span class="o">/</span><span class="n">zenodo</span><span class="mf">.5156931</span><span class="p">},</span>
  <span class="n">url</span>          <span class="o">=</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.5281</span><span class="o">/</span><span class="n">zenodo</span><span class="mf">.5156931</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="communication">
<h5>Communication<a class="headerlink" href="#communication" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>Blog: <a class="reference external" href="https://blog.pyodide.org/">blog.pyodide.org</a></p></li>
<li><p>Mailing list: <a class="reference external" href="https://mail.python.org/mailman3/lists/pyodide.python.org/">mail.python.org/mailman3/lists/pyodide.python.org/</a></p></li>
<li><p>Twitter: <a class="reference external" href="https://twitter.com/pyodide">twitter.com/pyodide</a></p></li>
<li><p>Stack Overflow: <a class="reference external" href="https://stackoverflow.com/questions/tagged/pyodide">stackoverflow.com/questions/tagged/pyodide</a></p></li>
<li><p>Discord: <a class="reference external" href="https://dsc.gg/pyodide">Pyodide Discord</a></p></li>
</ul>
</section>
<section id="donations">
<h5>Donations<a class="headerlink" href="#donations" title="Link to this heading">#</a></h5>
<p>We accept donations to the Pyodide project at
<a class="reference external" href="https://opencollective.com/pyodide">opencollective.com/pyodide</a>. All donations
are processed by the <a class="reference external" href="https://www.oscollective.org/">Open Source Collective</a> – a
nonprofit organization that acts as our fiscal host.</p>
<p>Funds will be mostly spent to organize in-person code sprints and to cover
infrastructure costs for distributing packages built with Pyodide.</p>
</section>
<section id="license">
<h5>License<a class="headerlink" href="#license" title="Link to this heading">#</a></h5>
<p>Pyodide uses the <a class="reference external" href="https://choosealicense.com/licenses/mpl-2.0/">Mozilla Public License Version
2.0</a>.</p>
</section>
<section id="infrastructure-support">
<h5>Infrastructure support<a class="headerlink" href="#infrastructure-support" title="Link to this heading">#</a></h5>
<p>We would like to thank,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.mozilla.org/en-US/">Mozilla</a> and
<a class="reference external" href="https://circleci.com/">CircleCl</a> for Continuous Integration resources</p></li>
<li><p><a class="reference external" href="https://www.jsdelivr.com/">JsDelivr</a> for providing a CDN for Pyodide
packages</p></li>
<li><p><a class="reference external" href="https://readthedocs.org/">ReadTheDocs</a> for hosting the documentation.</p></li>
</ul>
</section>
</section>
<span id="document-project/roadmap"></span><section id="roadmap">
<h4>Roadmap<a class="headerlink" href="#roadmap" title="Link to this heading">#</a></h4>
<p>This document lists general directions that core developers are interested to
see developed in Pyodide. The fact that an item is listed here is in no way a
promise that it will happen, as resources are limited. Rather, it is an
indication that help is welcomed on this topic.</p>
<section id="improve-documentation">
<h5>Improve documentation<a class="headerlink" href="#improve-documentation" title="Link to this heading">#</a></h5>
<p>Our API documentation is fairly detailed, but they need more introductory
information like tutorials. We also want to add more information to the FAQ and
improve the organization. It would also be good to find some way to include
interactive code pens in the documentation.</p>
</section>
<section id="reducing-download-sizes-and-initialization-times">
<h5>Reducing download sizes and initialization times<a class="headerlink" href="#reducing-download-sizes-and-initialization-times" title="Link to this heading">#</a></h5>
<p>At present a first load of Pyodide requires a 6.4 MB download, and the
environment initialization takes 4 to 5 seconds. Subsequent page loads are
faster since assets are cached in the browser. Both of these indicators can
likely be improved, by optimizing compilation parameters, minifying the Python
standard library and packages, reducing the number of exported symbols. To
figure out where to devote the effort, we need a better profiling system for the
load process.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/646">#646</a>.</p>
</section>
<section id="improve-performance-of-python-code-in-pyodide">
<h5>Improve performance of Python code in Pyodide<a class="headerlink" href="#improve-performance-of-python-code-in-pyodide" title="Link to this heading">#</a></h5>
<p>Across <a class="reference external" href="https://github.com/pyodide/pyodide/tree/main/benchmark">benchmarks</a>
Pyodide is currently around 3x to 5x slower than native Python.</p>
<p>At the same time, C code compiled to WebAssembly typically runs between near
native speed and 2x to 2.5x times slower (Jangda et al. 2019
<a class="reference external" href="https://www.usenix.org/system/files/atc19-jangda.pdf">PDF</a>). It is therefore
very likely that the performance of Python code in Pyodide can be improved with
some focused effort.</p>
<p>In addition, scientific Python code would benefit from packaging a high
performance BLAS library such as BLIS.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1120">#1120</a>.</p>
</section>
<section id="find-a-better-way-to-compile-fortran">
<h5>Find a better way to compile Fortran<a class="headerlink" href="#find-a-better-way-to-compile-fortran" title="Link to this heading">#</a></h5>
<p>Currently, we use f2c to cross compile Fortran to C. This does not work very
well because f2c only fully supports Fortran 77 code. LAPACK has used more
modern Fortran features since 2008 and Scipy has adopted more recent Fortran as
well. f2c still successfully generates code for all but 6 functions in Scipy +
LAPACK, but much of the generated code is slightly wrong and requires extensive
patching. There are still a large number of fatal errors due to call signature
incompatibilities.</p>
<p>If we could use an LLVM-based Fortran compiler as a part of the Emscripten
toolchain, most of these problems would be solved. There are several promising
projects heading in that direction including flang and lfortran.</p>
<p>See <a class="reference external" href="https://github.com/scipy/scipy/issues/15290">scipy/scipy#15290</a>.</p>
</section>
<section id="better-project-sustainability">
<h5>Better project sustainability<a class="headerlink" href="#better-project-sustainability" title="Link to this heading">#</a></h5>
<p>Some of the challenges that Pyodide faces, such as maintaining a collection of
build recipes, dependency resolution from PyPI, etc are already solved in either
Python or JavaScript ecosystems. We should therefore strive to better reuse
existing tooling, and seeking synergies with existing initiatives in this space,
such as conda-forge.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/795">#795</a>.</p>
</section>
<section id="improve-support-for-webworkers">
<h5>Improve support for WebWorkers<a class="headerlink" href="#improve-support-for-webworkers" title="Link to this heading">#</a></h5>
<p>WebWorkers are necessary in order to run computational tasks in the browser
without hanging the user interface. Currently, Pyodide can run in a WebWorker,
however the user experience and reliability can be improved.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1504">#1504</a>.</p>
</section>
<section id="synchronous-io">
<h5>Synchronous IO<a class="headerlink" href="#synchronous-io" title="Link to this heading">#</a></h5>
<p>The majority of existing I/O APIs are synchronous. Unless we can support
synchronous IO, much of the existing Python ecosystem cannot be ported. There
are several different approaches to this, we would like to support at least one
method.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1503">#1503</a>.</p>
</section>
<section id="write-http-client-in-terms-of-web-apis">
<span id="http-client-limit"></span><h5>Write http.client in terms of Web APIs<a class="headerlink" href="#write-http-client-in-terms-of-web-apis" title="Link to this heading">#</a></h5>
<p>Python packages make an extensive use of packages such as <code class="docutils literal notranslate"><span class="pre">requests</span></code> to
synchronously fetch data. We currently can’t use such packages since sockets
are not available in Pyodide. We could however try to re-implement some
stdlib libraries with Web APIs, potentially making this possible.</p>
<p>Because http.client is a synchronous API, we first need support for synchronous
IO.</p>
<p>See issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/140">#140</a>.</p>
</section>
</section>
<span id="document-project/code-of-conduct"></span><section id="code-of-conduct">
<span id="id1"></span><h4>Code of Conduct<a class="headerlink" href="#code-of-conduct" title="Link to this heading">#</a></h4>
<section id="conduct">
<h5>Conduct<a class="headerlink" href="#conduct" title="Link to this heading">#</a></h5>
<p>We are committed to providing a friendly, safe and welcoming environment for all, regardless of level of experience, gender identity and expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion, nationality, or other similar characteristic.</p>
<ul class="simple">
<li><p>Please be kind and courteous. There’s no need to be mean or rude.</p></li>
<li><p>Please avoid using usernames that are overtly sexual or otherwise might detract from a friendly, safe, and welcoming environment for all.</p></li>
<li><p>Respect that people have differences of opinion and that every design or implementation choice carries trade-offs. There is seldom a single right answer.</p></li>
<li><p>We borrow the Recurse Center’s <a class="reference external" href="https://www.recurse.com/manual#sub-sec-social-rules">“social rules”</a>: no feigning surprise, no well-actually’s, no backseat driving, and no subtle -isms.</p></li>
<li><p>Please keep unstructured critique to a minimum. If you have solid ideas you want to experiment with, make a fork and see how it works. All feedback should be constructive in nature. If you need more detailed guidance around giving feedback, consult <a class="reference external" href="https://github.com/digitalocean/engineering-code-of-conduct#giving-and-receiving-feedback">Digital Ocean’s Code of Conduct</a></p></li>
<li><p>It is unacceptable to insult, demean, or harass anyone. We interpret the term “harassment” as defined in the <a class="reference external" href="https://github.com/stumpsyn/policies/blob/master/citizen_code_of_conduct.md#4-unacceptable-behavior">Citizen Code of Conduct</a>; if you are not sure about what harassment entails, please read their definition. In particular, we don’t tolerate behavior that excludes people in socially marginalized groups.</p></li>
<li><p>Private harassment is also unacceptable. No matter who you are, please contact any of the Pyodide core team members immediately if you are being harassed or made uncomfortable by a community member. Whether you are a regular contributor or a newcomer, we care about making this community a safe place for you and we’ve got your back.</p></li>
<li><p>Likewise spamming, trolling, flaming, baiting or other attention-stealing behavior is not welcome.</p></li>
</ul>
</section>
<section id="moderation">
<h5>Moderation<a class="headerlink" href="#moderation" title="Link to this heading">#</a></h5>
<p>These are the policies for upholding our community’s standards of conduct. If you feel that a thread needs moderation, please contact the Pyodide core team.</p>
<ol class="arabic simple">
<li><p>Remarks that violate the Pyodide standards of conduct are not allowed. This includes hateful, hurtful, oppressive, or exclusionary remarks. (Cursing is allowed, but never targeting another community member, and never in a hateful manner.)</p></li>
<li><p>Remarks that moderators find inappropriate are not allowed, even if they do not break a rule explicitly listed in the code of conduct.</p></li>
<li><p>Moderators will first respond to such remarks with a warning.</p></li>
<li><p>If the warning is unheeded, the offending community member will be temporarily banned.</p></li>
<li><p>If the community member comes back and continues to make trouble, they will be permanently banned.</p></li>
<li><p>Moderators may choose at their discretion to un-ban the community member if they offer the offended party a genuine apology.</p></li>
<li><p>If a moderator bans someone and you think it was unjustified, please take it up with that moderator, or with a different moderator, in private. Complaints about bans in-channel are not allowed.</p></li>
<li><p>Moderators are held to a higher standard than other community members. If a moderator creates an inappropriate situation, they should expect less leeway than others.</p></li>
<li><p>In the Pyodide community we strive to go the extra mile to look out for each other. Don’t just aim to be technically unimpeachable, try to be your best self. In particular, avoid flirting with offensive or sensitive issues, particularly if they’re off-topic; this all too often leads to unnecessary fights, hurt feelings, and damaged trust; worse, it can drive people away from the community entirely.</p></li>
<li><p>If someone takes issue with something you said or did, resist the urge to be defensive. Just stop doing what it was they complained about and apologize. Even if you feel you were misinterpreted or unfairly accused, chances are good there was something you could have communicated better — remember that it’s your responsibility to make your fellow Pyodide community members comfortable. Everyone wants to get along and we are all here first and foremost because we want to talk about science and cool technology. You will find that people will be eager to assume good intent and forgive as long as you earn their trust.</p></li>
<li><p>The enforcement policies listed above apply to all official Pyodide venues. If you wish to use this code of conduct for your own project, consider making a copy with your own moderation policy so as to avoid confusion.</p></li>
</ol>
<p>Adapted from the the <a class="reference external" href="https://www.rust-lang.org/en-US/conduct.html">Rust Code of Conduct</a>, with further reference from <a class="reference external" href="https://github.com/digitalocean/engineering-code-of-conduct#giving-and-receiving-feedback">Digital Ocean Code of Conduct</a>, the <a class="reference external" href="https://www.recurse.com/code-of-conduct">Recurse Center</a>, the <a class="reference external" href="http://citizencodeofconduct.org/">Citizen Code of Conduct</a>, and the <a class="reference external" href="https://www.contributor-covenant.org/version/1/4/code-of-conduct.html">Contributor Covenant</a>.</p>
</section>
</section>
<span id="document-project/governance"></span><section id="governance-and-decision-making">
<span id="project-governance"></span><h4>Governance and Decision-making<a class="headerlink" href="#governance-and-decision-making" title="Link to this heading">#</a></h4>
<p>The purpose of this document is to formalize the governance process used by the
Pyodide project, to clarify how decisions are made and how the various members
of our community interact. This document establishes a decision-making structure
that takes into account feedback from all members of the community and strives
to find consensus, while avoiding deadlocks.</p>
<p>Anyone with an interest in the project can join the community, contribute to the
project design and participate in the decision making process. This document
describes how to participate and earn merit in the Pyodide community.</p>
<section id="roles-and-responsibilities">
<h5>Roles And Responsibilities<a class="headerlink" href="#roles-and-responsibilities" title="Link to this heading">#</a></h5>
<section id="contributors">
<h6>Contributors<a class="headerlink" href="#contributors" title="Link to this heading">#</a></h6>
<p>Contributors are community members who contribute in concrete ways to the
project. Anyone can become a contributor, and contributions can take many forms,
for instance, answering user questions – not only code – as detailed in
<a class="reference internal" href="#how-to-contribute"><span class="std std-ref">How to Contribute</span></a>.</p>
</section>
<section id="community-members-team">
<h6>Community members team<a class="headerlink" href="#community-members-team" title="Link to this heading">#</a></h6>
<p>The community members team is composed of community members who have permission
on Github to label and close issues. Their work is crucial to improve the
communication in the project.</p>
<p>After participating in Pyodide development with pull requests and reviews for a
period of time, any contributor may become a member of the team. The process for
adding team members is modeled on the
<a class="reference external" href="https://devguide.python.org/triaging/#becoming-a-member-of-the-python-triage-team">CPython project</a>.
Any core developer is welcome to propose a Pyodide contributor to join the
community members team. Other core developers are then consulted: while it is
expected that most acceptances will be unanimous, a two-thirds majority is
enough.</p>
</section>
<section id="core-developers">
<h6>Core developers<a class="headerlink" href="#core-developers" title="Link to this heading">#</a></h6>
<p>Core developers are community members who have shown that they are dedicated to
the continued development of the project through ongoing engagement with the
community. They have shown they can be trusted to maintain Pyodide with care.
Being a core developer allows contributors to more easily carry on with their
project related activities by giving them direct access to the project’s
repository and is represented as being a member of the core team on the Pyodide
<a class="reference external" href="https://github.com/orgs/Pyodide/teams/core/members">GitHub organization</a>. Core
developers are expected to review code contributions, can merge approved pull
requests, can cast votes for and against merging a pull-request, and can make
decisions about major changes to the API (all contributors are welcome to
participate in the discussion).</p>
<p>New core developers can be nominated by any existing core developers. Once they
have been nominated, there will be a vote by the current core developers. Voting
on new core developers is one of the few activities that takes place on the
project’s private communication channels. While it is expected that most votes
will be unanimous, a two-thirds majority of the cast votes is enough. The vote
needs to be open for at least one week.</p>
<p>Core developers that have not contributed to the project (commits or GitHub
comments) in the past two years will be asked if they want to become emeritus
core developers and recant their commit and voting rights until they become
active again.</p>
</section>
</section>
<section id="decision-making-process">
<h5>Decision Making Process<a class="headerlink" href="#decision-making-process" title="Link to this heading">#</a></h5>
<p>Decisions about the future of the project are made through discussion with all
members of the community. All non-sensitive project management discussion takes
place on the project contributors’
<a class="reference external" href="https://github.com/Pyodide/Pyodide/issues">issue tracker</a> and on
<a class="reference external" href="https://github.com/Pyodide/Pyodide/discussions">Github discussion</a>. Occasionally,
sensitive discussion occurs on a private communication channels.</p>
<p>Pyodide uses a “consensus seeking” process for making decisions. The group tries
to find a resolution that has no open objections among core developers. At any
point during the discussion, any core-developer can call for a vote, which will
conclude two weeks from the call for the vote. This is what we hereafter may
refer to as “the decision making process”.</p>
<p>Decisions (in addition to adding core developers as above) are made according to
the following rules:</p>
<ul class="simple">
<li><p><strong>Maintenance changes</strong>, include for instance improving the wording in the
documentation, updating CI or dependencies. Core developers are expected to
give “reasonable time” to others to give their opinion on the Pull Request in
case they’re not confident that others would agree. If no further review on
the Pull Request is received within this time, it can be merged. If a review
is received, then the consensus rules from the following section apply.</p></li>
<li><p><strong>Code changes in general, and especially those impacting user facing APIs</strong>,
as well as more significant documentation changes, require review and approval
by a core developer and no objections raised by any core developer (lazy
consensus). This process happens on the pull-request page.</p></li>
<li><p><strong>Changes to the governance model</strong> use the same decision process outlined
above.</p></li>
</ul>
</section>
</section>
<span id="document-project/changelog"></span><section id="change-log">
<span id="changelog"></span><h4>Change Log<a class="headerlink" href="#change-log" title="Link to this heading">#</a></h4>
<section id="version-0-27-1">
<h5>Version 0.27.1<a class="headerlink" href="#version-0-27-1" title="Link to this heading">#</a></h5>
<p><em>January 15, 2025</em></p>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Improve stack switching performance by using a wasm-gc based
function signature adaptor when it is available. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5310">#5310</a></p></li>
</ul>
<section id="packages">
<h6>Packages<a class="headerlink" href="#packages" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> PyArrow was accidentally missing from 0.27.0. Now it’s really
available. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5300">#5300</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> to 5.29.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5298">#5298</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">css_inline</span></code> 0.14.6 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5304">#5304</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">nlopt</span></code> to 2.9.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5305">#5305</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">zengl</span></code> to 2.7.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5258">#5258</a></p></li>
</ul>
</section>
</section>
<section id="version-0-27-0">
<h5>Version 0.27.0<a class="headerlink" href="#version-0-27-0" title="Link to this heading">#</a></h5>
<p><em>January 1, 2025</em></p>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Upgrade to Python 3.12.7.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5149">#5149</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Add unix-timezones module, which installs Unix compatible
timezone data in /usr/share/zoneinfo, for use with C/C++ libraries which do
timezone handling.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4889">#4889</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">HttpStatusError</span></code> now store their the corresponding request
<code class="docutils literal notranslate"><span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">status_message</span></code> and <code class="docutils literal notranslate"><span class="pre">url</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4974">#4974</a>.</p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Shared libraries are now loaded locally. This means that packages that
depend on shared libraries link to the shared libraries explicitly.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4876">#4876</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added implementation to abort <code class="docutils literal notranslate"><span class="pre">pyfetch</span></code> and <code class="docutils literal notranslate"><span class="pre">FetchResponse</span></code>
manually or automatically.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4846">#4846</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Unvendored stdlibs are now packaged in a wheel format
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4902">#4902</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Prebuilt third-party libraries like <code class="docutils literal notranslate"><span class="pre">openblas</span></code>, <code class="docutils literal notranslate"><span class="pre">openssl</span></code>, <code class="docutils literal notranslate"><span class="pre">zlib</span></code> are
not included in the cross-build env anymore.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4995">#4995</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">JsProxy.as_py_json</span></code> method to adapt from JavaScript
JSON (Arrays and Objects). to Python JSON (lists and dicts).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4666">#4666</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> will now install data files inside the wheel.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5034">#5034</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">find_imports(&quot;import</span> <span class="pre">pkg.module.submodule&quot;)</span></code> will now
return <code class="docutils literal notranslate"><span class="pre">[&quot;pkg&quot;,</span> <span class="pre">&quot;pkg.module&quot;,</span> <span class="pre">&quot;pkg.module.submodule&quot;]</span></code>. This improves support
for namespace packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5039">#5039</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Removed <code class="docutils literal notranslate"><span class="pre">webworker.js</span></code> from the distribution files. It was a
pretty small file, if someone is using it for something they can just copy it into
their own code.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5114">#5114</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Enabled <code class="docutils literal notranslate"><span class="pre">pyodide.FS.trackingDelegate</span></code> which can be used to track
file system operations. See
<a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#FS.trackingDelegate%5Bcallback%20name%5D">Emscripten docs</a>
for more information.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5100">#5100</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> When using the Pyodide console, the standard streams inherit
<code class="docutils literal notranslate"><span class="pre">TextIOBase</span></code> and behave more like normal IO streams. In particular, they have
methods like <code class="docutils literal notranslate"><span class="pre">writelines()</span></code> and <code class="docutils literal notranslate"><span class="pre">readlines()</span></code>. They still don’t have file
descriptors though.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5056">#5056</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The WASM backend is now the default backend for <code class="docutils literal notranslate"><span class="pre">matplotlib-pyodide</span></code> and
the HTML5 backend has been disabled, temporarily redirecting to it. Power users
might see minor incompatibilities and subtle differences. Please see
https://github.com/pyodide/matplotlib-pyodide/issues/64 and
https://github.com/pyodide/matplotlib-pyodide/issues/65
for more information and if you wish to contribute to the discussion.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4510">#4510</a></p></li>
</ul>
<section id="id1">
<h6>Packages<a class="headerlink" href="#id1" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to 2.0.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">RobotRaconteur</span></code> to 1.2.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">gsw</span></code> to 3.6.19 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">opencv-python</span></code> to 4.10.0.84 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">yt</span></code> to 4.3.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">xgboost</span></code> to 2.1.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">autograd</span></code> to 1.7.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">sisl</span></code> to 0.15.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> to 0.24.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">astropy</span></code> to 7.0.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">biopython</span></code> to 1.84 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">fastparquet</span></code> to 2024.5.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> to 1.0.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">imageio</span></code> to 2.36.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">lightgbm</span></code> to 4.5.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">netcdf4</span></code> to 1.7.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">networkx</span></code> to 3.4.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">numcodecs</span></code> to 0.13.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to 2.2.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4893">#4893</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pywavelets</span></code> to 1.7.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">shapely</span></code> to 2.0.6 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">threadpoolctl</span></code> to 3.5.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">unyt</span></code> to 3.0.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">xarray</span></code> to 2024.10.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">zarr</span></code> to 2.18.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">h5py</span></code> to 3.12.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">cftime</span></code> to 1.6.4.post1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">clarabel</span></code> to 0.9.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">ewah_bool_utils</span></code> to 1.2.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">galpy</span></code> to 1.10.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">mne-python</span></code> to 1.8.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pyxirr</span></code> to 0.10.6 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">regex</span></code> to 2024.9.11 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">crc32c</span></code> to 2.7.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5169">#5169</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">rebound</span></code> to 4.4.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5163">#5163</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">reboundx</span></code> to 4.3.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5163">#5163</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">msprime</span></code> to 1.3.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5159">#5159</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tskit</span></code> to 0.6.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5157">#5157</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pydantic_core</span></code> to 2.25.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5151">#5151</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pydantic</span></code> to 2.9.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5151">#5151</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">msgpack</span></code> to 1.1.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5144">#5144</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> to 5.28.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5136">#5136</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> to 1.5.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4823">#4823</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5016">#5016</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5072">#5072</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">libcst</span></code> to 1.4.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4856">#4856</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">lakers</span></code> to 0.3.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4885">#4885</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">certifi</span></code> to 2024.12.14 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5257">#5257</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">bokeh</span></code> to 3.6.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4888">#4888</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5047">#5047</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5118">#5118</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">awkward-cpp</span></code> to 43 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5214">#5214</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5247">#5247</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">zengl</span></code> to 2.7.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5258">#5258</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> to 5.29.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5257">#5257</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">sourmash</span></code> to 4.8.11 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4980">#4980</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">scipy</span></code> to 1.14.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4719">#4719</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5011">#5011</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5012">#5012</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5031">#5031</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code> to 0.24.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5003">#5003</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to 0.14.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5058">#5058</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">contourpy</span></code> to 1.3.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5048">#5048</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">boost-histogram</span></code> to 1.5.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5074">#5074</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">duckdb</span></code> to 1.1.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5078">#5078</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">sympy</span></code> to 1.13.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5098">#5098</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tree-sitter</span></code> to 0.23.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5110">#5110</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">altair</span></code> to 5.4.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5124">#5124</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">PyYAML</span></code> to 6.0.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5137">#5137</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">duckdb</span></code> to 1.1.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5142">#5142</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to 3.8.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4510">#4510</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">matplotlib-pyodide</span></code> to 0.2.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4510">#4510</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">cysignals</span></code> to 1.12.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5267">#5267</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">soxr</span></code> 0.5.0.post1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5150">#5150</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">tiktoken</span></code> v0.8.0 in <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5147">#5147</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">casadi</span></code> 3.6.7 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4936">#4936</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5057">#5057</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> 18.1.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4950">#4950</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5266">#5266</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">polars</span></code> 1.18.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5282">#5282</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> 1.4.2, <code class="docutils literal notranslate"><span class="pre">affine</span></code> 2.4.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4983">#4983</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">iminuit</span></code> 2.30.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4767">#4767</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5072">#5072</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4925">#4925</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">rateslib</span></code> 1.6.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5146">#5146</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5235">#5235</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">arro3-core</span></code>, <code class="docutils literal notranslate"><span class="pre">arro3-io</span></code>, and <code class="docutils literal notranslate"><span class="pre">arro3-compute</span></code> 0.3.0, 0.4.0, 0.4.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5020">#5020</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5095">#5095</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5104">#5104</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">tree-sitter</span></code> 0.23.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5099">#5099</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">tree-sitter-go</span></code> 0.23.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5102">#5102</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">tree-sitter-java</span></code> 0.23.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5102">#5102</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">tree-sitter-python</span></code> 0.23.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5102">#5102</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">Narwhals</span></code> 1.9.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5121">#5121</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">libzfp</span></code> and <code class="docutils literal notranslate"><span class="pre">zfpy</span></code> 1.0.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5172">#5172</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">vega-datasets</span></code> 0.9.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5183">#5183</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">clingo</span></code> 5.7.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5184">#5184</a></p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">argon2-cffi</span></code> <code class="docutils literal notranslate"><span class="pre">argon2-cffi-bindings</span></code> 23.1.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5281">#5281</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tree-sitter</span></code> to 0.23.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5185">#5185</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tree-sitter-go</span></code> to 0.23.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5185">#5185</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tree-sitter-java</span></code> to 0.23.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5185">#5185</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">tree-sitter-python</span></code> to 0.23.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5185">#5185</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">xarray</span></code> to 2024.11.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5224">#5224</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">lakers-python</span></code> to 0.4.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5225">#5225</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pure-eval</span></code> to 0.2.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5086">#5086</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5244">#5244</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">cffi</span></code> to 1.17.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5261">#5261</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">pillow-heif</span></code> to 0.20.0 and <code class="docutils literal notranslate"><span class="pre">pyheif</span></code> 0.8.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/5178">#5178</a></p></li>
</ul>
</section>
</section>
<section id="version-0-26-4">
<h5>Version 0.26.4<a class="headerlink" href="#version-0-26-4" title="Link to this heading">#</a></h5>
<p><em>November 15, 2024</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> JSPI support now works with support for new JSPI and no WebAssembly type reflection.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5129">#5129</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix sessionStorage-related crash when running in sandboxed iframe.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5186">#5186</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">JsFinder.find_spec()</span></code> no longer crashes when called during pytest test collection.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5170">#5170</a></p></li>
</ul>
</section>
<section id="version-0-26-3">
<h5>Version 0.26.3<a class="headerlink" href="#version-0-26-3" title="Link to this heading">#</a></h5>
<p><em>October 19, 2024</em></p>
<ul class="simple">
<li><p><span class='badge badge-info'>Performance</span> Attribute lookup on a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> is now about 40% faster.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4961">#4961</a></p></li>
<li><p><span class='badge badge-info'>Performance</span> Method calls on a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> are now much faster. If the
method has no arguments and no return value, it is about 80% faster. The
speedup for methods with arguments is less drastic but still quite a lot.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4963">#4963</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Updated stack switching support to handle new JSPI.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4982">#4982</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyimport(&quot;a.b&quot;)</span></code> won’t fail when <code class="docutils literal notranslate"><span class="pre">a</span></code> is removed by <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">sys.modules[&quot;a&quot;]</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4993">#4993</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> It now works to convert a 0d Python buffer to JavaScript.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5092">#5092</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> It now works to convert buffers of 64 bit signed or unsigned integers to JavaScript.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/5092">#5092</a></p></li>
</ul>
</section>
<section id="version-0-26-2">
<h5>Version 0.26.2<a class="headerlink" href="#version-0-26-2" title="Link to this heading">#</a></h5>
<p><em>July 26, 2024</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Don’t leak the values in a dictionary when applying <code class="docutils literal notranslate"><span class="pre">to_js</span></code> to it.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4853">#4853</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Loading of dynamic libraries now works slightly better in the cli
runner. Resolved <a class="reference external" href="https://github.com/pyodide/pyodide/issues/3865">#3865</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4871">#4871</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Restored the pre-0.26.0 behavior of calling <code class="docutils literal notranslate"><span class="pre">exit()</span></code> or raising
<code class="docutils literal notranslate"><span class="pre">SystemExit</span></code>. In 0.26.0 and 0.26.1, <code class="docutils literal notranslate"><span class="pre">exit()</span></code> shuts down the Python
interpreter. In all other versions of Pyodide it does not.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4867">#4867</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a weird regression occurring in difficult to describe
circumstances introduced by <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4837">#4837</a>. See <a class="reference external" href="https://github.com/pyodide/pyodide/issues/4861">#4861</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4861">#4861</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Recursive fortran functions now work correctly in scipy <a class="reference external" href="https://github.com/pyodide/pyodide/issues/4818">#4818</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4822">#4822</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Allow setting <code class="docutils literal notranslate"><span class="pre">dont_inherit</span></code> and <code class="docutils literal notranslate"><span class="pre">optimize</span></code> for <code class="docutils literal notranslate"><span class="pre">compile</span></code>
in <code class="docutils literal notranslate"><span class="pre">CodeRunner</span></code> and <code class="docutils literal notranslate"><span class="pre">Console</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4897">#4897</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that caused <code class="docutils literal notranslate"><span class="pre">Console</span></code>’s <code class="docutils literal notranslate"><span class="pre">formatted_traceback</span></code> being truncated
unexpectedly when <code class="docutils literal notranslate"><span class="pre">filename</span></code> is specified.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4905">#4905</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Locked <code class="docutils literal notranslate"><span class="pre">PyodideConsole.runcode</span></code> to block <code class="docutils literal notranslate"><span class="pre">loadPackagesFromImports</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4905">#4905</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">checkAPIVersion</span></code> option to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> to allow
bootstrapping pyodide with a different version.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4907">#4907</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">can_run_sync</span></code> to test whether or not <code class="docutils literal notranslate"><span class="pre">run_sync</span></code>
should work.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4913">#4913</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug with the JSPI that made it interact incorrectly with
JavaScript code that iterates a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4919">#4919</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide now loads correctly when <code class="docutils literal notranslate"><span class="pre">define</span></code> and <code class="docutils literal notranslate"><span class="pre">define.amd</span></code> are
defined in the global scope.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4866">#4866</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed keyboard input handling in SDL-based packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4865">#4865</a></p></li>
</ul>
<section id="id2">
<h6>Packages<a class="headerlink" href="#id2" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">duckdb</span></code> 1.0.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4684">#4684</a></p></li>
</ul>
</section>
</section>
<section id="version-0-26-1">
<h5>Version 0.26.1<a class="headerlink" href="#version-0-26-1" title="Link to this heading">#</a></h5>
<p><em>June 7, 2024</em></p>
<section id="build-system">
<h6>Build system<a class="headerlink" href="#build-system" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fix <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">config</span></code> command printing extra output.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4814">#4814</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added implementation to read build settings from <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4831">#4831</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> In the Pyodide virtual environment, pip sees <code class="docutils literal notranslate"><span class="pre">platform.system()</span></code> as
“Emscripten” and not as “emscripten”.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4812">#4812</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Resolution of JavaScript symbols in dynamic libraries doesn’t fail
anymore in the command line runner.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4836">#4836</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide virtual environments now work correctly in Fedora and other
platforms with platlibdir not equal to “lib”.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4844">#4844</a></p></li>
</ul>
</section>
<section id="runtime-ffi">
<h6>Runtime / FFI<a class="headerlink" href="#runtime-ffi" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">enableRunUntilComplete</span></code> option to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>
which makes <code class="docutils literal notranslate"><span class="pre">run_until_complete</span></code> block using stack switching, or crash if
stack switching is disabled.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4817">#4817</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Resolved an issue where string keys in <code class="docutils literal notranslate"><span class="pre">PyProxyJsonAdaptor</span></code> were
unexpectedly cast to numbers.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4825">#4825</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> When a <code class="docutils literal notranslate"><span class="pre">Future</span></code> connected to a <code class="docutils literal notranslate"><span class="pre">Promise</span></code> is cancelled, don’t raise
<code class="docutils literal notranslate"><span class="pre">InvalidStateError</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4837">#4837</a></p></li>
</ul>
</section>
<section id="id3">
<h6>Packages<a class="headerlink" href="#id3" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New Packages: <code class="docutils literal notranslate"><span class="pre">pytest-asyncio</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4819">#4819</a></p></li>
</ul>
</section>
</section>
<section id="version-0-26-0">
<h5>Version 0.26.0<a class="headerlink" href="#version-0-26-0" title="Link to this heading">#</a></h5>
<p><em>May 27, 2024</em></p>
<section id="general">
<h6>General<a class="headerlink" href="#general" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> Upgraded Python to v3.12.1
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4431">#4431</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4435">#4435</a></p></li>
<li><p><span class='badge badge-success'>Update</span> The wheel tag for Pyodide wheels has changed to pyodide_2024_0_wasm32.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4777">#4777</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4780">#4780</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> ABI Break: Updated Emscripten to version 3.1.58
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4399">#4399</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4715">#4715</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Pyodide will not fallback to <code class="docutils literal notranslate"><span class="pre">node-fetch</span></code> anymore when <code class="docutils literal notranslate"><span class="pre">fetch</span></code>
is not available in the Node.js &lt; 18 environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4417">#4417</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Improved support for stack switching.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4532">#4532</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4547">#4547</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4615">#4615</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4639">#4639</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The experimental <code class="docutils literal notranslate"><span class="pre">callSyncifying</span></code> method was renamed to
<code class="docutils literal notranslate"><span class="pre">callPromising</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4608">#4608</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">dup</span></code> now works correctly in the Node filesystem.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4554">#4554</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">asyncio.sleep(0)</span></code> now runs the next task a lot faster.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4590">#4590</a></p></li>
</ul>
</section>
<section id="javascript-apis">
<h6>JavaScript APIs<a class="headerlink" href="#javascript-apis" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> now checks if the cache directory
exists and calls <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> only when it doesn’t to avoid an error on read-only
file systems in Node.js environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4738">#4738</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide.mountNativeFS</span></code> will no longer silently overwrite an
existing nonempty directory. Also it throws much clearer error messages when
it fails.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4559">#4559</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a new API <code class="docutils literal notranslate"><span class="pre">pyodide.mountNodeFS</span></code> which mounts a host
directory into the Pyodide file system when running in node.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4561">#4561</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Updated <code class="docutils literal notranslate"><span class="pre">pyimport</span></code> to support <code class="docutils literal notranslate"><span class="pre">pyimport(&quot;module.attribute&quot;)</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4395">#4395</a></p></li>
</ul>
</section>
<section id="ffi">
<h6>FFI<a class="headerlink" href="#ffi" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">str(jsproxy)</span></code> has been adjusted to not raise an error if
<code class="docutils literal notranslate"><span class="pre">jsproxy.toString</span></code> is undefined. Instead, it will use
<code class="docutils literal notranslate"><span class="pre">Object.prototype.toString</span></code> in this case. If <code class="docutils literal notranslate"><span class="pre">jsproxy.toString</span></code> is defined and
throws or is not defined but <code class="docutils literal notranslate"><span class="pre">jsproxy[Symbol.toStringTag]</span></code> is defined and
throws, then <code class="docutils literal notranslate"><span class="pre">str</span></code> will still raise.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4574">#4574</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Fixed a memory leak when iterating over a PyProxy.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4546">#4546</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> When a dictionary is converted to JavaScript with <code class="docutils literal notranslate"><span class="pre">toJs</span></code> the
result is now a <code class="docutils literal notranslate"><span class="pre">LiteralMap</span></code>. String keys are accessible via direct property
access unless they match a function on the <code class="docutils literal notranslate"><span class="pre">Map</span></code> prototype.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4576">#4576</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">toJs</span></code> now works as expected on subclasses of <code class="docutils literal notranslate"><span class="pre">dict</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4637">#4637</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">PyProxy.asJsJson</span></code> method to adapt between Python JSON
(lists and dicts) and JavaScript JSON (Arrays and Objects).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4666">#4666</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a new <code class="docutils literal notranslate"><span class="pre">callRelaxed</span></code> to PyProxies of callables that
discards extra arguments rather than raising a <code class="docutils literal notranslate"><span class="pre">TypeError``.</span> <span class="pre">{pr}</span></code>4392`</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> A new <code class="docutils literal notranslate"><span class="pre">callWithOptions</span></code> method was added to PyProxies of
callables.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4608">#4608</a></p></li>
</ul>
</section>
<section id="build">
<h6>Build<a class="headerlink" href="#build" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> pyodide-build now use response file when passing list of exported symbols to <code class="docutils literal notranslate"><span class="pre">emcc</span></code>.
This fixes “Argument list too long” error.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4717">#4717</a>`</p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pass through <code class="docutils literal notranslate"><span class="pre">-E</span></code> (command mode) arguments in CMake wrapper
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4705">#4705</a>.</p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix exception handling in dynamic linking of int64 functions
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4698">#4698</a>.</p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">pyodide-build</span></code> entrypoint is removed in favor of <code class="docutils literal notranslate"><span class="pre">pyodide</span></code>.
This entrypoint was deprecated since 0.22.0.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4368">#4368</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The <code class="docutils literal notranslate"><span class="pre">--no-deps</span></code> option to <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> has been
replaced with a separate subcommand <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes-no-deps</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4443">#4443</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The <code class="docutils literal notranslate"><span class="pre">build/post</span></code> script now runs under the directory
where the built wheel is unpacked.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4481">#4481</a></p></li>
</ul>
</section>
<section id="id4">
<h6>Packages<a class="headerlink" href="#id4" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New Packages: <code class="docutils literal notranslate"><span class="pre">cysignals</span></code>, <code class="docutils literal notranslate"><span class="pre">ppl</span></code>, <code class="docutils literal notranslate"><span class="pre">pplpy</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4407">#4407</a>, <code class="docutils literal notranslate"><span class="pre">flint</span></code>, <code class="docutils literal notranslate"><span class="pre">python-flint</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4410">#4410</a>,
<code class="docutils literal notranslate"><span class="pre">memory_allocator</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4393">#4393</a>, <code class="docutils literal notranslate"><span class="pre">primesieve</span></code>, <code class="docutils literal notranslate"><span class="pre">primecount</span></code>, <code class="docutils literal notranslate"><span class="pre">primecountpy</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4477">#4477</a>,
<code class="docutils literal notranslate"><span class="pre">pyxirr</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4513">#4513</a>, <code class="docutils literal notranslate"><span class="pre">ipython</span></code>, <code class="docutils literal notranslate"><span class="pre">asttokens</span></code>, <code class="docutils literal notranslate"><span class="pre">executing</span></code>, <code class="docutils literal notranslate"><span class="pre">prompt_toolkit</span></code>,
<code class="docutils literal notranslate"><span class="pre">pure_eval</span></code>, <code class="docutils literal notranslate"><span class="pre">stack_data</span></code>, <code class="docutils literal notranslate"><span class="pre">traitlets</span></code>, <code class="docutils literal notranslate"><span class="pre">wcwidth</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4452">#4452</a>, <code class="docutils literal notranslate"><span class="pre">altair</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4580">#4580</a>,
<code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4587">#4587</a>, <code class="docutils literal notranslate"><span class="pre">clarabel</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4587">#4587</a>, <code class="docutils literal notranslate"><span class="pre">matplotlib-inline</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4626">#4626</a>,
<code class="docutils literal notranslate"><span class="pre">pygame-ce</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4602">#4602</a>, <code class="docutils literal notranslate"><span class="pre">libcst</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4665">#4665</a>, <code class="docutils literal notranslate"><span class="pre">mmh3</span></code>, <code class="docutils literal notranslate"><span class="pre">pyiceberg</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4648">#4648</a>,
<code class="docutils literal notranslate"><span class="pre">lakers-python</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4763">#4763</a>, <code class="docutils literal notranslate"><span class="pre">crc32c</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4789">#4789</a>, <code class="docutils literal notranslate"><span class="pre">zstandard</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4792">#4792</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">contourpy</span></code> to 1.2.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4680">#4680</a></p></li>
<li><p>Upgraded <code class="docutils literal notranslate"><span class="pre">sourmash</span></code> to 4.8.8 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4683">#4683</a></p></li>
</ul>
</section>
</section>
<section id="version-0-25-1">
<h5>Version 0.25.1<a class="headerlink" href="#version-0-25-1" title="Link to this heading">#</a></h5>
<p><em>March 31, 2024</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fixed pyodide-build to work with pypa/build&gt;=1.2.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4653">#4653</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that pyodide-build setting <code class="docutils literal notranslate"><span class="pre">MESON</span></code> env variable,
which overwrites the binary path of meson.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4502">#4502</a></p></li>
</ul>
</section>
<section id="version-0-25-0">
<h5>Version 0.25.0<a class="headerlink" href="#version-0-25-0" title="Link to this heading">#</a></h5>
<p><em>January 18, 2024</em></p>
<section id="id5">
<h6>General<a class="headerlink" href="#id5" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> ABI Break: Updated Emscripten to version 3.1.46
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4359">#4359</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Node.js &lt; 18 is no longer officially supported. Older versions
of Node.js might still work, but they are not tested or guaranteed to work.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4269">#4269</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added experimental support for stack switching.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3957">#3957</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3964">#3964</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3987">#3987</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3990">#3990</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3210">#3210</a></p></li>
</ul>
</section>
<section id="javascript-api">
<h6>JavaScript API<a class="headerlink" href="#javascript-api" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide.setStdin</span></code> now does not consider an empty string as EOF.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4327">#4327</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> does not accept <code class="docutils literal notranslate"><span class="pre">homedir</span></code> option anymore, use
<code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">{HOME:</span> <span class="pre">&quot;/the/home/directory&quot;}</span></code> instead. This have been deprecated since
Pyodide 0.24.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4342">#4342</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> now returns an object with metadata
about the loaded packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4306">#4306</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed default indexURL calculation in Node.js environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4288">#4288</a></p></li>
</ul>
</section>
<section id="python-api">
<h6>Python API<a class="headerlink" href="#python-api" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> The <code class="docutils literal notranslate"><span class="pre">pyodide-py</span></code> package on <code class="docutils literal notranslate"><span class="pre">pypi</span></code> now includes <code class="docutils literal notranslate"><span class="pre">py.typed</span></code>
markers so mypy will use the types.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4321">#4321</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that micropip would fail to install packages from
pyodide-lock.json if the package’s name differs from its normalized name.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4319">#4319</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a no-op <code class="docutils literal notranslate"><span class="pre">WebLoop.close</span></code> method so that attempts to
close the event loop will not raise an exception.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4329">#4329</a></p></li>
</ul>
</section>
<section id="python-javascript-foreign-function-interface">
<h6>Python / JavaScript Foreign Function Interface<a class="headerlink" href="#python-javascript-foreign-function-interface" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">jsarray.pop</span></code> now works correctly. It previously returned the wrong
value and leaked memory.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4236">#4236</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">PyProxy.toString</span></code> now calls <code class="docutils literal notranslate"><span class="pre">str</span></code> instead of <code class="docutils literal notranslate"><span class="pre">repr</span></code>. For now
you can opt into the old behavior by passing <code class="docutils literal notranslate"><span class="pre">pyproxyToStringRepr:</span> <span class="pre">true</span></code> to
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>, but this may be removed in the future.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4247">#4247</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> when accessing a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> attribute invokes a getter and the getter
throws an error, that error is propagated instead of being turned into an
<code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4254">#4254</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">type</span> <span class="pre">{</span> <span class="pre">PyProxy</span> <span class="pre">}</span> <span class="pre">from</span> <span class="pre">&quot;pyodide/ffi&quot;</span></code> now works with the
<code class="docutils literal notranslate"><span class="pre">NodeNext</span></code> typescript target.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4256">#4256</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that occurs when using <code class="docutils literal notranslate"><span class="pre">toJs</span></code> with both <code class="docutils literal notranslate"><span class="pre">dictConverter</span></code>
and <code class="docutils literal notranslate"><span class="pre">defaultConverter</span></code> arguments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4263">#4263</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">JsArray.remove</span></code> and <code class="docutils literal notranslate"><span class="pre">JsArray.insert</span></code> methods.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4326">#4326</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Type exports of <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> subtypes have been moved from
<code class="docutils literal notranslate"><span class="pre">pyodide</span></code> to <code class="docutils literal notranslate"><span class="pre">pyodide/ffi</span></code> and many of them have changed names.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4342">#4342</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The methods for checking <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> capabilities (e.g.,
<code class="docutils literal notranslate"><span class="pre">supportsHas</span></code>, <code class="docutils literal notranslate"><span class="pre">isCallable</span></code>) are now removed. Use e.g.,
<code class="docutils literal notranslate"><span class="pre">instanceof</span> <span class="pre">pyodide.ffi.PyCallable</span></code> instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4342">#4342</a></p></li>
</ul>
</section>
<section id="pyodide-cli">
<h6>Pyodide CLI<a class="headerlink" href="#pyodide-cli" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">config</span></code> command now show additional config
variables: <code class="docutils literal notranslate"><span class="pre">rustflags</span></code>, <code class="docutils literal notranslate"><span class="pre">cmake_toolchain_file</span></code>, <code class="docutils literal notranslate"><span class="pre">pyo3_config_file</span></code>,
<code class="docutils literal notranslate"><span class="pre">rust_toolchain</span></code>, <code class="docutils literal notranslate"><span class="pre">cflags</span></code> <code class="docutils literal notranslate"><span class="pre">cxxflags</span></code>, <code class="docutils literal notranslate"><span class="pre">ldflags</span></code>, <code class="docutils literal notranslate"><span class="pre">meson_cross_file</span></code>. These
variables can be used in out-of-tree build to set the same variables as
in-tree build.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4241">#4241</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> command now accepts <code class="docutils literal notranslate"><span class="pre">--config-setting</span></code>
(<code class="docutils literal notranslate"><span class="pre">-C</span></code>) option to pass flags to the build backend, just like <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">build</span></code>
command.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4308">#4308</a></p></li>
</ul>
</section>
<section id="load-time-size-optimizations">
<h6>Load time &amp; size optimizations<a class="headerlink" href="#load-time-size-optimizations" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Performance</span> Do not use <code class="docutils literal notranslate"><span class="pre">importlib.metadata</span></code> when identifying installed
packages, which reduces the time to load Pyodide.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4147">#4147</a></p></li>
</ul>
</section>
<section id="id6">
<h6>Build system<a class="headerlink" href="#id6" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fixed <code class="docutils literal notranslate"><span class="pre">Emscripten.cmake</span></code> not vendored in pyodide-build since 0.24.0.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4223">#4223</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> pyodide-build now does not override <code class="docutils literal notranslate"><span class="pre">CMAKE_CONFIG_FILE</span></code> and
<code class="docutils literal notranslate"><span class="pre">PYO3_CONFIG_FILE</span></code> env variables if provided by user.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4223">#4223</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that webpack messes up dynamic import of <code class="docutils literal notranslate"><span class="pre">pyodide.asm.js</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4294">#4294</a></p></li>
</ul>
</section>
<section id="id7">
<h6>Packages<a class="headerlink" href="#id7" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New Packages: <code class="docutils literal notranslate"><span class="pre">river</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4197">#4197</a>, <code class="docutils literal notranslate"><span class="pre">sisl</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4210">#4210</a>, <code class="docutils literal notranslate"><span class="pre">frozenlist</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4231">#4231</a>,
<code class="docutils literal notranslate"><span class="pre">zengl</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4208">#4208</a>, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4265">#4265</a>, <code class="docutils literal notranslate"><span class="pre">aiohttp</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4282">#4282</a>, <code class="docutils literal notranslate"><span class="pre">pysam</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4268">#4268</a>,
<code class="docutils literal notranslate"><span class="pre">requests</span></code>, <code class="docutils literal notranslate"><span class="pre">urllib3</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4332">#4332</a>, <code class="docutils literal notranslate"><span class="pre">nh3</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4387">#4387</a></p></li>
<li><p>Upgraded zengl to 2.2.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4364">#4364</a></p></li>
</ul>
</section>
</section>
<section id="version-0-24-1">
<h5>Version 0.24.1<a class="headerlink" href="#version-0-24-1" title="Link to this heading">#</a></h5>
<p><em>September 25, 2023</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fixed <code class="docutils literal notranslate"><span class="pre">LONG_BIT</span> <span class="pre">definition</span> <span class="pre">appears</span> <span class="pre">wrong</span> <span class="pre">for</span> <span class="pre">platform</span></code> error happened in out-of-tree build.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4136">#4136</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed an Emscripten bug that broke some matplotlib functionality.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4163">#4163</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide.checkInterrupt</span></code> works when there is no interrupt buffer and
the gil is not held.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4164">#4164</a></p></li>
</ul>
<section id="id8">
<h6>Packages<a class="headerlink" href="#id8" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Upgraded scipy to 1.11.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4156">#4156</a></p></li>
<li><p>Upgraded sourmash to 4.8.4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4154">#4154</a></p></li>
<li><p>Upgraded scikit-learn to 1.3.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4161">#4161</a></p></li>
<li><p>Upgraded micropip to 0.5.0 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4167">#4167</a></p></li>
</ul>
</section>
</section>
<section id="version-0-24-0">
<h5>Version 0.24.0<a class="headerlink" href="#version-0-24-0" title="Link to this heading">#</a></h5>
<p><em>September 13, 2023</em></p>
<section id="id9">
<h6>General<a class="headerlink" href="#id9" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> Pyodide now runs Python 3.11.3.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3741">#3741</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> ABI Break: Updated Emscripten to version 3.1.45 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3665">#3665</a>,
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3659">#3659</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3822">#3822</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3889">#3889</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3890">#3890</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3888">#3888</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4055">#4055</a>,
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4056">#4056</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4073">#4073</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4094">#4094</a></p></li>
</ul>
</section>
<section id="id10">
<h6>JavaScript API<a class="headerlink" href="#id10" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Performance</span> Added a <code class="docutils literal notranslate"><span class="pre">packages</span></code> optional argument to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>.
Passing packages here saves time by downloading them during the Pyodide
bootstrap.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4100">#4100</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">runPython</span></code> and <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code> now accept a <code class="docutils literal notranslate"><span class="pre">filename</span></code>
optional argument which is passed as the <code class="docutils literal notranslate"><span class="pre">filename</span></code> argument to <code class="docutils literal notranslate"><span class="pre">eval_code</span></code>
(resp. <code class="docutils literal notranslate"><span class="pre">eval_code_async</span></code>). Also, if a <code class="docutils literal notranslate"><span class="pre">filename</span></code> is passed to <code class="docutils literal notranslate"><span class="pre">eval_code</span></code>
which does not start with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and end with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, Pyodide now uses the
<code class="docutils literal notranslate"><span class="pre">linecache</span></code> module to ensure that source lines can appear in tracebacks.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3993">#3993</a></p></li>
<li><p><span class='badge badge-info'>Performance</span> For performance reasons, don’t render extra information in
PyProxy destroyed message by default. By using <code class="docutils literal notranslate"><span class="pre">pyodide.setDebug(true)</span></code>, you
can opt into worse performance and better error messages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4027">#4027</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to pass environment variables to
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> via the <code class="docutils literal notranslate"><span class="pre">env</span></code> argument. <code class="docutils literal notranslate"><span class="pre">homedir</span></code> is deprecated in favor of
<code class="docutils literal notranslate"><span class="pre">{env:</span> <span class="pre">{HOME:</span> <span class="pre">whatever_directory}}</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3870">#3870</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The <code class="docutils literal notranslate"><span class="pre">setStdin</span></code>, <code class="docutils literal notranslate"><span class="pre">setStdout</span></code> and <code class="docutils literal notranslate"><span class="pre">setStderr</span></code> APIs have been
improved with extra control and better performance.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4035">#4035</a></p></li>
</ul>
</section>
<section id="id11">
<h6>Python API<a class="headerlink" href="#id11" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">headers</span></code> property to <code class="docutils literal notranslate"><span class="pre">pyodide.http.FetchResponse</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2078">#2078</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">FetchResponse.text()</span></code> as a synonym to
<code class="docutils literal notranslate"><span class="pre">FetchResponse.string()</span></code> for better compatibility with other requests APIs.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4052">#4052</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Changed the <code class="docutils literal notranslate"><span class="pre">FetchResponse</span></code> body getter methods to no longer
throw an <code class="docutils literal notranslate"><span class="pre">OSError</span></code> exception for 400 and above response status codes. Added
<code class="docutils literal notranslate"><span class="pre">FetchResponse.raise_for_status</span></code> to raise an <code class="docutils literal notranslate"><span class="pre">OSError</span></code> for error status codes.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3986">#3986</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4053">#4053</a></p></li>
</ul>
</section>
<section id="id12">
<h6>Python / JavaScript Foreign Function Interface<a class="headerlink" href="#id12" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Performance</span> Improved performance of PyProxy creation.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4096">#4096</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed adding getters/setters to a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> with
<code class="docutils literal notranslate"><span class="pre">Object.defineProperty</span></code> and improved compliance with JavaScript rules around
Proxy traps.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4033">#4033</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The promise methods <code class="docutils literal notranslate"><span class="pre">then</span></code>, <code class="docutils literal notranslate"><span class="pre">catch</span></code> and <code class="docutils literal notranslate"><span class="pre">finally_</span></code> are now
present also on <code class="docutils literal notranslate"><span class="pre">Task</span></code>s as well as <code class="docutils literal notranslate"><span class="pre">Future</span></code>s.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3748">#3748</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added methods to a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a <code class="docutils literal notranslate"><span class="pre">list</span></code> to make these work
as drop-in replacements for JavaScript Arrays.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3853">#3853</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> When a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of an array is passed to Python builtin
functions that use the <code class="docutils literal notranslate"><span class="pre">PySequence_*</span></code> APIs, it now works as expected. Also
<code class="docutils literal notranslate"><span class="pre">jsarray</span> <span class="pre">*</span> <span class="pre">n</span></code> repeats the array <code class="docutils literal notranslate"><span class="pre">n</span></code> times and <code class="docutils literal notranslate"><span class="pre">jsarray</span> <span class="pre">+</span> <span class="pre">iterable</span></code> returns a
new array with the result values from the iterable appended.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3904">#3904</a></p></li>
</ul>
</section>
<section id="deployment">
<h6>Deployment<a class="headerlink" href="#deployment" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> Changed the name of the default lockfile from <code class="docutils literal notranslate"><span class="pre">repodata.json</span></code> to
<code class="docutils literal notranslate"><span class="pre">pyodide-lock.json</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3824">#3824</a></p></li>
</ul>
</section>
<section id="id13">
<h6>Build System<a class="headerlink" href="#id13" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> The docker image now has node v20 instead of node v14.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3819">#3819</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">check_wasm_magic_number</span></code> function to validate <code class="docutils literal notranslate"><span class="pre">.so</span></code>
files for WebAssembly (WASM) compatibility.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4018">#4018</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> In pyodide build, automatically skip building package
dependencies that are already included in the pyodide distribution.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4058">#4058</a></p></li>
</ul>
</section>
<section id="id14">
<h6>Packages<a class="headerlink" href="#id14" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New packages: sourmash <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3635">#3635</a>, screed <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3635">#3635</a>, bitstring <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3635">#3635</a>,
deprecation <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3635">#3635</a>, cachetools <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3635">#3635</a>, xyzservices <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3786">#3786</a>,
simplejson <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3801">#3801</a>, protobuf <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3813">#3813</a>, peewee <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3897">#3897</a>, Cartopy
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3909">#3909</a>, pyshp <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3909">#3909</a>, netCDF4 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3910">#3910</a>, igraph <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3991">#3991</a>, CoolProp
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/4028">#4028</a>, contourpy <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4102">#4102</a>, awkward-cpp <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4101">#4101</a>, orjson <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4036">#4036</a>.</p></li>
<li><p>Upgraded numpy to 1.25.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/4125">#4125</a></p></li>
<li><p>Upgraded scipy to 1.11.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3794">#3794</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3996">#3996</a></p></li>
<li><p>OpenBLAS has been added and scipy now uses OpenBLAS rather than CLAPACK
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3331">#3331</a>.</p></li>
</ul>
</section>
<section id="id15">
<h6>Pyodide CLI<a class="headerlink" href="#id15" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> now accepts a <code class="docutils literal notranslate"><span class="pre">--metadata-files</span></code>
option to install <code class="docutils literal notranslate"><span class="pre">*.whl.metadata</span></code> files as specified in
<a class="reference external" href="https://peps.python.org/pep-0658/">PEP 658</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3981">#3981</a></p></li>
</ul>
</section>
<section id="misc">
<h6>Misc<a class="headerlink" href="#misc" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Add an example for <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> and <code class="docutils literal notranslate"><span class="pre">pyodide.runPython</span> <span class="pre">{pr}</span></code>4012<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">{pr}</span></code>4011`</p></li>
</ul>
</section>
</section>
<section id="version-0-23-4">
<h5>Version 0.23.4<a class="headerlink" href="#version-0-23-4" title="Link to this heading">#</a></h5>
<p><em>July 6, 2023</em></p>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> The environment variable <code class="docutils literal notranslate"><span class="pre">PYODIDE_BUILD_EXPORTS</span></code> can now be
used instead of the <code class="docutils literal notranslate"><span class="pre">--exports</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> to specify <code class="docutils literal notranslate"><span class="pre">.so</span></code>
file exports of packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3973">#3973</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pin <code class="docutils literal notranslate"><span class="pre">pydantic</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;2</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3971">#3971</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Allow customizing cache location for packages when running in Node
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3967">#3967</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Re-enabled sparseqr, freesasa, lightgbm, opencv-python, and wordcloud
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3783">#3783</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3970">#3970</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> A <code class="docutils literal notranslate"><span class="pre">JSProxy</span></code> of a <code class="docutils literal notranslate"><span class="pre">DOMException</span></code> will now inherit from exception so
it can be raised in Python.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3868">#3868</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The feature detection for <code class="docutils literal notranslate"><span class="pre">JSProxy</span></code> has been improved so that it
should never fail even when handling strange or ill-behaved JavaScript proxy
objects.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3740">#3740</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3750">#3750</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> A <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a callable is now an <code class="docutils literal notranslate"><span class="pre">instanceof</span> <span class="pre">Function</span></code>. (If you
are trying to feature detect whether something is callable or not in
JavaScript, the correct way is to use <code class="docutils literal notranslate"><span class="pre">typeof</span> <span class="pre">o</span> <span class="pre">===</span> <span class="pre">&quot;function&quot;</span></code>. But you may
have dependencies that don’t do this correctly.)
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3925">#3925</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">jsmodule</span> <span class="pre">import</span> <span class="pre">*</span></code> now works.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3903">#3903</a></p></li>
</ul>
</section>
<section id="version-0-23-3">
<h5>Version 0.23.3<a class="headerlink" href="#version-0-23-3" title="Link to this heading">#</a></h5>
<p><em>June 17, 2023</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">getattr(jsproxy,</span> <span class="pre">'python_reserved_word')</span></code> works as expected again
(as well as <code class="docutils literal notranslate"><span class="pre">hasattr</span></code> and <code class="docutils literal notranslate"><span class="pre">setattr</span></code>). This fixes a regression introduced in
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3617">#3617</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3926">#3926</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> now replaces native <code class="docutils literal notranslate"><span class="pre">.so</span></code> slugs with Emscripten
slugs. Usually <code class="docutils literal notranslate"><span class="pre">.so</span></code>s in the generated wheels are actually Emscripten <code class="docutils literal notranslate"><span class="pre">.so</span></code>s
so this is good. If they are actually native <code class="docutils literal notranslate"><span class="pre">.so</span></code>s then there is a problem
either way.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3903">#3903</a></p></li>
</ul>
</section>
<section id="version-0-23-2">
<h5>Version 0.23.2<a class="headerlink" href="#version-0-23-2" title="Link to this heading">#</a></h5>
<p><em>May 2, 2023</em></p>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Changed the name of the <code class="docutils literal notranslate"><span class="pre">--output-directory</span></code> argument to
<code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> to <code class="docutils literal notranslate"><span class="pre">--outdir</span></code> to match pypa/build. <code class="docutils literal notranslate"><span class="pre">--output-directory</span></code> is
still accepted for backwards compatibility.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3811">#3811</a></p></li>
</ul>
</section>
<section id="version-0-23-1">
<h5>Version 0.23.1<a class="headerlink" href="#version-0-23-1" title="Link to this heading">#</a></h5>
<p><em>April 13, 2023</em></p>
<section id="id16">
<h6>Deployment<a class="headerlink" href="#id16" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Export <code class="docutils literal notranslate"><span class="pre">python_stdlib.zip</span></code> in <code class="docutils literal notranslate"><span class="pre">package.json</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3723">#3723</a></p></li>
</ul>
</section>
<section id="cli">
<h6>CLI<a class="headerlink" href="#cli" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> now accepts an <code class="docutils literal notranslate"><span class="pre">--output-directory</span></code> argument.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3746">#3746</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">py-compile</span></code> not to ignore the <code class="docutils literal notranslate"><span class="pre">--compression-level</span></code>
option when applied on a single file.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3727">#3727</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix an issue where the <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">venv</span></code> command did not work correctly in pyodide-build
version 0.23.0 because of missing <code class="docutils literal notranslate"><span class="pre">python_stdlib.zip</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3760">#3760</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span></code> works correctly in the Pyodide venv now.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3761">#3761</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Executables installed in a Pyodide virtual environment now run in
Pyodide not in the host Python.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3752">#3752</a></p></li>
</ul>
</section>
<section id="id17">
<h6>Build System<a class="headerlink" href="#id17" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fix <code class="docutils literal notranslate"><span class="pre">PYODIDE_ROOT</span></code> to point the correct directory when running out-of-tree build.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3751">#3751</a></p></li>
</ul>
</section>
</section>
<section id="version-0-23-0">
<h5>Version 0.23.0<a class="headerlink" href="#version-0-23-0" title="Link to this heading">#</a></h5>
<p><em>March 30, 2023</em></p>
<section id="id18">
<h6>General<a class="headerlink" href="#id18" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> Pyodide now runs Python 3.11.2 which officially supports
WebAssembly as a <a class="reference external" href="https://peps.python.org/pep-0011/#tier-3">PEP11 Tier 3</a> platform.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3252">#3252</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3614">#3614</a></p></li>
<li><p><span class='badge badge-success'>Update</span> We now build libpyodide.a so the Pyodide foreign function
interface can be experimentally linked into other Emscripten builds of Python.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3335">#3335</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Updated Emscripten to version 3.1.32
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3471">#3471</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3517">#3517</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3599">#3599</a></p></li>
</ul>
</section>
<section id="id19">
<h6>JavaScript API<a class="headerlink" href="#id19" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Type exports of <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> subtypes have been moved from
<code class="docutils literal notranslate"><span class="pre">pyodide</span></code> to <code class="docutils literal notranslate"><span class="pre">pyodide/ffi</span></code> and many of them have changed names. The original
exports are still available but they are deprecated.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3523">#3523</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The methods for checking <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> capabilities (e.g.,
<code class="docutils literal notranslate"><span class="pre">supportsHas</span></code>, <code class="docutils literal notranslate"><span class="pre">isCallable</span></code>) are now deprecated. Use e.g.,
<code class="docutils literal notranslate"><span class="pre">instanceof</span> <span class="pre">pyodide.ffi.PyCallable</span></code> instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3523">#3523</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added subclasses of <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> for each mixin. These can be
used to check whether a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> supports a given set of methods with
<code class="docutils literal notranslate"><span class="pre">instanceof</span></code> e.g., <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">instanceof</span> <span class="pre">pyodide.ffi.PyDict</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3523">#3523</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">stdLibURL</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> allowing to customize
the URL from which the Python standard library is loaded.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3670">#3670</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Checking whether an object is an instance of a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> now
only recognizes a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> generated from the same Python interpreter. This
means that creating multiple interpreters and importing a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> from one
into another no longer causes a fatal error.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3545">#3545</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">as_object_map</span></code> now accepts a keyword argument <code class="docutils literal notranslate"><span class="pre">hereditary</span></code>.
If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> and indexing the object returns a plain-old-object, then the
return value will be automatically mapped in <code class="docutils literal notranslate"><span class="pre">as_object_map</span></code> as well.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3638">#3638</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> A <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of a JavaScript error object can be directly
thrown as Python exceptions. Previously Pyodide automatically wrapped them in
a <code class="docutils literal notranslate"><span class="pre">JsException</span></code> but that is no longer needed – now <code class="docutils literal notranslate"><span class="pre">JsException</span></code> inherits
from both <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> and <code class="docutils literal notranslate"><span class="pre">Exception</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3455">#3455</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">runPython</span></code> and <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code> now accept a <code class="docutils literal notranslate"><span class="pre">locals</span></code>
argument.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3618">#3618</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Calling <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> repeatedly in Node no longer results in
<code class="docutils literal notranslate"><span class="pre">MaxListenersExceededWarning</span></code>. Also, calling <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> in Node v14 no
longer changes unhandled rejections in promises.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3542">#3542</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> If the <code class="docutils literal notranslate"><span class="pre">locals</span></code> argument to <code class="docutils literal notranslate"><span class="pre">eval_code</span></code> or <code class="docutils literal notranslate"><span class="pre">eval_code_async</span></code> is
<code class="docutils literal notranslate"><span class="pre">None</span></code> it now uses <code class="docutils literal notranslate"><span class="pre">locals=globals</span></code> as the documentation says.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3580">#3580</a></p></li>
</ul>
</section>
<section id="python-standard-library">
<h6>Python standard library<a class="headerlink" href="#python-standard-library" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Unvendored <code class="docutils literal notranslate"><span class="pre">_pydecimal</span></code> and <code class="docutils literal notranslate"><span class="pre">pydoc_data</span></code> from the standard
library. Now these modules need to be loaded with <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> or
<code class="docutils literal notranslate"><span class="pre">micropip.install</span></code>, or auto-loaded via imports in <code class="docutils literal notranslate"><span class="pre">pyodide.runPythonAsync</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3525">#3525</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Test files of stdlib <code class="docutils literal notranslate"><span class="pre">ctypes</span></code> and <code class="docutils literal notranslate"><span class="pre">unittest</span></code> are now moved to
<code class="docutils literal notranslate"><span class="pre">test/ctypes</span></code> and <code class="docutils literal notranslate"><span class="pre">test/unittest</span></code> respectively. This change is adapted from
<a class="reference external" href="https://github.com/python/cpython/issues/93839">CPython 3.12</a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3507">#3507</a></p></li>
</ul>
</section>
<section id="id20">
<h6>Deployment<a class="headerlink" href="#id20" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Pyodide no longer uses Emscripten preload plugin, hence
<code class="docutils literal notranslate"><span class="pre">pyodide.asm.data</span></code> is removed, in favor of <code class="docutils literal notranslate"><span class="pre">python_stdlib.zip</span></code>. This change
normally shouldn’t affect users, but if you were using this file in a
bundler, you will need to remove it. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3584">#3584</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">pyodide_py.tar</span></code> file is removed. This change normally
shouldn’t affect users, but if you were using this file in a bundler,
you will need to remove it.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3621">#3621</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Python standard libraries are now vendored in a zipfile:
<code class="docutils literal notranslate"><span class="pre">/lib/python{version}.zip</span></code> in the in-browser MEMFS file system. If you need
to access the standard library source code, you need to unpack the zip file.
For example:
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">shutil;</span> <span class="pre">shutil.unpack_archive('/lib/python311.zip',</span> <span class="pre">'/lib/python3.11',</span> <span class="pre">'zip)</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3584">#3584</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Improves the compression of wheel files with the JsDelivr CDN. For
browsers that support the Brotli compression (most modern ones) this should
result in a size reduction of 20-30%. Also most many <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> CLI
sub-commands now support <code class="docutils literal notranslate"><span class="pre">--compression-level</span></code> as an optional parameter.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3655">#3655</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Following libraries are now not linked to the Pyodide main module:
<code class="docutils literal notranslate"><span class="pre">libgl</span></code>, <code class="docutils literal notranslate"><span class="pre">libal</span></code>, <code class="docutils literal notranslate"><span class="pre">libhtml5</span></code>. This normally shouldn’t affect users, but if you
are using these libraries in a package that are built out-of-tree, you will
need to link them to the package manually.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3505">#3505</a></p></li>
</ul>
</section>
<section id="id21">
<h6>Python / JavaScript Foreign Function Interface<a class="headerlink" href="#id21" title="Link to this heading">#</a></h6>
<ul>
<li><p><span class='badge badge-danger'>Fix</span> PyProxies of Async iterators are now async iterable JavaScript
objects. The code:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">async_iterator_pyproxy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>would previously fail with <code class="docutils literal notranslate"><span class="pre">TypeError:</span> <span class="pre">async_iterator_pyproxy</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">async</span> <span class="pre">iterable</span></code>. (Python async <em>iterables</em> that were not also iterators were already
async iterable, the problem was only with Python objects that are both async
<em>iterable</em> and an async iterator.)
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3708">#3708</a></p>
</li>
<li><p><span class='badge badge-info'>Enhancement</span> A py-compiled build which has smaller and faster-to-load
packages is now deployed under
<code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide/v0.23.0/pyc/</span></code> (also for future
versions). The exceptions obtained with this builds will not include code
snippets however. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3701">#3701</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Removed support for calling functions from the root of <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> package
directly. This has been deprecated since v0.21.0. Now all functions are only available
under submodules.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3677">#3677</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Removed support for passing the “message” argument to <code class="docutils literal notranslate"><span class="pre">PyProxy.destroy</span></code>
in a positional argument. This has been deprecated since v0.22.0.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3677">#3677</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Python does not allow reserved words to be used as attributes.
For instance, <code class="docutils literal notranslate"><span class="pre">Array.from</span></code> is a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>. (JavaScript has a more robust
parser which can handle this.) To handle this, if an attribute to a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code>
consists of a Python reserved word followed by one or more underscores, we remove
a single underscore from the end of the attribute. For instance, <code class="docutils literal notranslate"><span class="pre">Array.from_</span></code>
would access <code class="docutils literal notranslate"><span class="pre">from</span></code> on the underlying JavaScript object, whereas <code class="docutils literal notranslate"><span class="pre">o.from__</span></code>
accesses the <code class="docutils literal notranslate"><span class="pre">from_</span></code> attribute.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3617">#3617</a></p></li>
</ul>
</section>
<section id="id22">
<h6>Build System<a class="headerlink" href="#id22" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> When building meta-packages (<code class="docutils literal notranslate"><span class="pre">core</span></code> and <code class="docutils literal notranslate"><span class="pre">min-scipy-stack</span></code>),
you must prefix <code class="docutils literal notranslate"><span class="pre">tag:</span></code> to the meta-package name. For example, to build the
<code class="docutils literal notranslate"><span class="pre">core</span></code> meta-package, you must run <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span> <span class="pre">tag:core</span></code>, or
<code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES=&quot;tag:core&quot;</span> <span class="pre">make</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3444">#3444</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Add <code class="docutils literal notranslate"><span class="pre">--build-dependencies</span></code> to <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> command
to fetch and build dependencies of a package being built.
Also adds <code class="docutils literal notranslate"><span class="pre">--skip-dependency</span></code> to ignore selected dependencies.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3310">#3310</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> support for building a list of packages
from a requirements.txt file with <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span> <span class="pre">-r</span> <span class="pre">&lt;requirements.txt&gt;</span></code>. Also
can output a list of chosen dependencies in the same format when building a
package and dependencies using the <code class="docutils literal notranslate"><span class="pre">--output-lockfile</span> <span class="pre">&lt;lockfile.txt&gt;</span></code>
argument. This enables repeatable builds of packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3469">#3469</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">package/tag</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec to group
packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3444">#3444</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> now autodetects the number of
CPU cores in the system and uses them for parallel builds.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3559">#3559</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3598">#3598</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed pip install error when installing cross build environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3562">#3562</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Response files are now correctly handled when
calculating exported symbols.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3645">#3645</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix occasional build failure when building rust packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3607">#3607</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Improved logging in <code class="docutils literal notranslate"><span class="pre">pyodide-build</span></code> with rich.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3442">#3442</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> now accepts <code class="docutils literal notranslate"><span class="pre">--no-deps</span></code> parameter, which skips
building dependencies of the package. This replaces <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">buildpkg</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3520">#3520</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> now works out-of-tree.</p></li>
</ul>
</section>
<section id="id23">
<h6>Pyodide CLI<a class="headerlink" href="#id23" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Removed deprecated CLI entrypoints <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">buildall</span></code> which is
replaced by <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code>, and <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">mkpkg</span></code> which is
replaced by <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">skeleton</span> <span class="pre">pypi</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3668">#3668</a>.</p></li>
<li><p><span class='badge badge-success'>Feature</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">py-compile</span></code> CLI command that py compiles a wheel or a zip
file, converting .py files to .pyc files. It can also be applied to a folder
with wheels / zip files. If the input folder contains the
<code class="docutils literal notranslate"><span class="pre">repodata.json</span></code> the paths and checksums it contains will also be updated
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3253">#3253</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3700">#3700</a></p></li>
<li><p><span class='badge badge-success'>Feature</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">create-zipfile</span></code> CLI command that creates a zip file of a
directory. This command is hidden by default since it is not intended for use
by end users.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3411">#3411</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3463">#3463</a></p></li>
</ul>
</section>
<section id="repl">
<h6>REPL<a class="headerlink" href="#repl" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Non-breaking space characters are now automatically converted to
regular spaces in pyodide REPL.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3558">#3558</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Allow changing the build type used in the REPL by passing the
<code class="docutils literal notranslate"><span class="pre">build</span></code> argument to the REPL URL. For instance,
<code class="docutils literal notranslate"><span class="pre">https://pyodide.org/en/latest/console.html?build=debug</span></code> will load debug dev build.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3671">#3671</a></p></li>
</ul>
</section>
<section id="id24">
<h6>Packages<a class="headerlink" href="#id24" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New packages: fastparquet <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3590">#3590</a>, cramjam <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3590">#3590</a>, pynacl <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3500">#3500</a>,
pyxel <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3508">#3508</a>.
mypy <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3504">#3504</a>, multidict <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3581">#3581</a>, yarl <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3702">#3702</a>, idna <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3702">#3702</a>,
cbor-diag <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3581">#3581</a>.</p></li>
<li><p>Upgraded to micropip 0.3.0 (see
<a class="reference external" href="https://github.com/pyodide/micropip/blob/main/CHANGELOG.md">changelog</a>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3709">#3709</a></p></li>
<li><p>Added experimental <a class="reference internal" href="#using-sdl"><span class="std std-ref">support for SDL based packages</span></a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3508">#3508</a></p></li>
<li><p>Upgraded packages: see the list of packages versions in this release in
<a class="reference internal" href="#packages-in-pyodide"><span class="std std-ref">Packages built in Pyodide</span></a>.</p></li>
</ul>
</section>
<section id="list-of-contributors">
<h6>List of Contributors<a class="headerlink" href="#list-of-contributors" title="Link to this heading">#</a></h6>
<p>Alexey Ignatiev, Andrea Giammarchi, Arpit, Christian Clauss, Deepak Cherian,
Eli Lamb, Feodor Fitsner, Gyeongjae Choi, Hood Chatham, Jeff Glass, Jo Bovy,
Joe Marshall, josephrocca, Loïc Estève, martinRenou, messense, Nicholas
Bollweg, Roman Yurchak, TheOnlyWayUp, Victor Blomqvist, Ye Joo Park</p>
</section>
</section>
<section id="version-0-22-1">
<h5>Version 0.22.1<a class="headerlink" href="#version-0-22-1" title="Link to this heading">#</a></h5>
<p><em>January 25, 2023</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">setStdin</span></code> now accepts an extra <code class="docutils literal notranslate"><span class="pre">autoEOF</span></code> parameter. If <code class="docutils literal notranslate"><span class="pre">true</span></code>,
it will insert an EOF automatically after each string or buffer. Defaults to
<code class="docutils literal notranslate"><span class="pre">true</span></code>. This also affects the behavior of the <code class="docutils literal notranslate"><span class="pre">stdin</span></code> argument to
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3488">#3488</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pyodide.ffi</span> <span class="pre">import</span> <span class="pre">*</span></code> doesn’t raise an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> anymore.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3484">#3484</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide displays a better message when someone calls posix
<code class="docutils literal notranslate"><span class="pre">exit</span></code> or <code class="docutils literal notranslate"><span class="pre">os._exit</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3496">#3496</a></p></li>
</ul>
<section id="package-loading">
<h6>Package Loading<a class="headerlink" href="#package-loading" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Fix incorrect error message when loading a package
include in Pyodide fails.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3435">#3435</a></p></li>
</ul>
</section>
<section id="id25">
<h6>Build system<a class="headerlink" href="#id25" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Emscripten is no longer required to create a Pyodide virtual
environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3485">#3485</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug where <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> would fail on package that use
CMake, when run multiple times.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3445">#3445</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> pyodide build: Don’t pass the directory to the build backend args,
only pass the arguments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3490">#3490</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">config</span></code> won’t print extra messages anymore.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3483">#3483</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pass the same environment variables for out of tree builds as for in
tree builds.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3495">#3495</a></p></li>
</ul>
</section>
</section>
<section id="version-0-22-0">
<h5>Version 0.22.0<a class="headerlink" href="#version-0-22-0" title="Link to this heading">#</a></h5>
<p><em>January 3, 2023</em></p>
<p><a class="reference external" href="https://blog.pyodide.org/posts/0.22-release/">See the release notes for a summary.</a></p>
<section id="deployment-and-testing">
<h6>Deployment and testing<a class="headerlink" href="#deployment-and-testing" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">pyodide-cdn2.iodide.io</span></code> is not available anymore. Please use
<code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide</span></code> instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3150">#3150</a>.</p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> We don’t publish pre-built Pyodide docker images anymore. Note
that <code class="docutils literal notranslate"><span class="pre">./run_docker</span> <span class="pre">--pre-built</span></code> was not working for a while and it was
actually equivalent to <code class="docutils literal notranslate"><span class="pre">./run_docker</span></code>. If you need to build a single Python
wheel out of tree, you can use the <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> command instead. See
<a class="reference external" href="https://blog.pyodide.org/posts/0.21-release/#building-binary-wheels-for-pyodide">our blog post</a>
for more information.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3342">#3342</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The releases are now called <code class="docutils literal notranslate"><span class="pre">pyodide-{version}.tar.gz</span></code>
rather than <code class="docutils literal notranslate"><span class="pre">pyodide-build-{version}.tar.gz</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2996">#2996</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a new release file called
<code class="docutils literal notranslate"><span class="pre">pyodide-core-{version}.tar.gz</span></code> intended for use in Node. It contains the
files needed to start Pyodide and no additional packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2999">#2999</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The full test suite is now run in Safari
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2578">#2578</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3095">#3095</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added Gitpod configuration to the repository.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3201">#3201</a></p></li>
</ul>
</section>
<section id="foreign-function-interface">
<h6>Foreign function interface<a class="headerlink" href="#foreign-function-interface" title="Link to this heading">#</a></h6>
<section id="jsproxy-javascript-from-python">
<h6 aria-level="7">JsProxy / JavaScript from Python<a class="headerlink" href="#jsproxy-javascript-from-python" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Implemented <code class="docutils literal notranslate"><span class="pre">reverse</span></code>, <code class="docutils literal notranslate"><span class="pre">__reversed__</span></code>, <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>,
<code class="docutils literal notranslate"><span class="pre">append</span></code>, and <code class="docutils literal notranslate"><span class="pre">pop</span></code> for <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of Javascript arrays so that they implement
the <code class="docutils literal notranslate"><span class="pre">collections.abc.MutableSequence</span></code> API.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2970">#2970</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Implemented methods <code class="docutils literal notranslate"><span class="pre">keys</span></code>, <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code>,
<code class="docutils literal notranslate"><span class="pre">setdefault</span></code>, <code class="docutils literal notranslate"><span class="pre">popitem</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, and <code class="docutils literal notranslate"><span class="pre">clear</span></code> for <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of map-like
objects so that they implement the <code class="docutils literal notranslate"><span class="pre">collections.abc.MutableMapping</span></code> API.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3275">#3275</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It’s now possible to destructure a JavaScript array, map, or
object returned by <code class="docutils literal notranslate"><span class="pre">as_object_map</span></code> with a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2906">#2906</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">then</span></code>, <code class="docutils literal notranslate"><span class="pre">catch</span></code>, and <code class="docutils literal notranslate"><span class="pre">finally_</span></code> methods to the
<code class="docutils literal notranslate"><span class="pre">Future</span></code>s used by Pyodide’s event loop so they can be used like <code class="docutils literal notranslate"><span class="pre">Promise</span></code>s.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2997">#2997</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">create_proxy</span></code> now takes an optional <code class="docutils literal notranslate"><span class="pre">roundtrip</span></code> parameter.
If this is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then when the proxy is converted back to Python, it
is converted back to the same double proxy. This allows the proxy to be
destroyed from Python even if no reference is retained.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3163">#3163</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3369">#3369</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> A <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of a function now has a <code class="docutils literal notranslate"><span class="pre">__get__</span></code> descriptor
method, so it’s possible to use a JavaScript function as a Python method. When
the method is called, <code class="docutils literal notranslate"><span class="pre">this</span></code> will be a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> pointing to the Python object
the method is called on.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3130">#3130</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> A <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> now has an <code class="docutils literal notranslate"><span class="pre">as_object_map</span></code> method. This will
treat the object as a mapping over its <code class="docutils literal notranslate"><span class="pre">ownKeys</span></code> so for instance:
<code class="docutils literal notranslate"><span class="pre">run_js(&quot;({a:2,</span> <span class="pre">b:3})&quot;).as_object_map()[&quot;a&quot;]</span></code> will return 2. These implement
<code class="docutils literal notranslate"><span class="pre">collections.abc.MutableMapping</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3273">#3273</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3295">#3295</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3297">#3297</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Split up the <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> documentation class into several
classes, e.g., <code class="docutils literal notranslate"><span class="pre">JsBuffer</span></code>, <code class="docutils literal notranslate"><span class="pre">JsPromise</span></code>, etc. Implemented <code class="docutils literal notranslate"><span class="pre">issubclass</span></code> and
<code class="docutils literal notranslate"><span class="pre">isinstance</span></code> on the various synthetic and real <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> classes so that they
behave the way one might naively expect them to (or at least closer to that
than it was before).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3277">#3277</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added type parameters to many of the <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> subtypes.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3387">#3387</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">JsGenerator</span></code> and <code class="docutils literal notranslate"><span class="pre">JsIterator</span></code> types to <code class="docutils literal notranslate"><span class="pre">pyodide.ffi</span></code>.
Added <code class="docutils literal notranslate"><span class="pre">send</span></code> method to <code class="docutils literal notranslate"><span class="pre">JsIterator</span></code>s and <code class="docutils literal notranslate"><span class="pre">throw</span></code>, and <code class="docutils literal notranslate"><span class="pre">close</span></code> methods to
<code class="docutils literal notranslate"><span class="pre">JsGenerator</span></code>s.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3294">#3294</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to use asynchronous JavaScript iterables,
iterators and generators from Python. This includes support for <code class="docutils literal notranslate"><span class="pre">aiter</span></code> for
async interables, <code class="docutils literal notranslate"><span class="pre">anext</span></code> and <code class="docutils literal notranslate"><span class="pre">asend</span></code> for async iterators, and <code class="docutils literal notranslate"><span class="pre">athrow</span></code> and
<code class="docutils literal notranslate"><span class="pre">aclose</span></code> for async generators.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3285">#3285</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3299">#3299</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3339">#3339</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> JavaScript generators and async generators that are created
from Python now are wrapped so that Python objects sent to them as arguments
or from <code class="docutils literal notranslate"><span class="pre">.send</span></code> / <code class="docutils literal notranslate"><span class="pre">.asend</span></code> are kept alive until the generator is exhausted or
<code class="docutils literal notranslate"><span class="pre">.close</span></code>d. This makes generators significantly more ergonomic to use, at the
cost of making memory leaks more likely if the generator is never finalized.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3317">#3317</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a mypy typeshed for some common functionality for the
<code class="docutils literal notranslate"><span class="pre">js</span></code> module.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3298">#3298</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> mypy understands the types of more things now.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3385">#3385</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed bug in <code class="docutils literal notranslate"><span class="pre">split</span></code> argument of <code class="docutils literal notranslate"><span class="pre">pyodide.console.repr_shorten</span></code>.
Added <code class="docutils literal notranslate"><span class="pre">shorten</span></code> function.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3178">#3178</a></p></li>
</ul>
</section>
<section id="pyproxy-using-python-from-javascript">
<h6 aria-level="7">PyProxy / Using Python from JavaScript<a class="headerlink" href="#pyproxy-using-python-from-javascript" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Added a type field to <code class="docutils literal notranslate"><span class="pre">PythonError</span></code> (e.g., a StopIteration
error would have <code class="docutils literal notranslate"><span class="pre">e.type</span> <span class="pre">===</span> <span class="pre">&quot;StopIteration&quot;</span></code>)
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3289">#3289</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to use asynchronous Python generators
from JavaScript.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3290">#3290</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> PyProxies of synchronous and asynchronous Python generators
now support <code class="docutils literal notranslate"><span class="pre">return</span></code> and <code class="docutils literal notranslate"><span class="pre">throw</span></code> APIs that behave like the ones on JavaScript
generators.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3346">#3346</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is possible to make a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> that takes <code class="docutils literal notranslate"><span class="pre">this</span></code> as the
first argument using the <code class="docutils literal notranslate"><span class="pre">PyProxy.captureThis</span></code> method. The <code class="docutils literal notranslate"><span class="pre">create_proxy</span></code>
method also has a <code class="docutils literal notranslate"><span class="pre">capture_this</span></code> argument which causes the <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> to
receive <code class="docutils literal notranslate"><span class="pre">this</span></code> as the first argument if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3103">#3103</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3145">#3145</a></p></li>
</ul>
</section>
</section>
<section id="id26">
<h6>JavaScript API<a class="headerlink" href="#id26" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Users can do a static import of <code class="docutils literal notranslate"><span class="pre">pyodide/pyodide.asm.js</span></code> to
avoid issues with dynamic imports. This allows the use of Pyodide with
module-type service workers.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3070">#3070</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a new API <code class="docutils literal notranslate"><span class="pre">pyodide.mountNativeFS</span></code> which mounts a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryHandle" title="(in MDN docs)"><code class="xref js js-class docutils literal notranslate"><span class="pre">FileSystemDirectoryHandle</span></code></a> into the Pyodide file system.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2987">#2987</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> has a new option called <code class="docutils literal notranslate"><span class="pre">args</span></code>. This list will
be passed as command line arguments to the Python interpreter at start up.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3021">#3021</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3282">#3282</a></p></li>
<li><p>Removed “Python initialization complete” message printed when loading is
finished.
{pr}`3247</p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The messageCallback and errorCallback argument to <code class="docutils literal notranslate"><span class="pre">loadPackage</span></code>
and <code class="docutils literal notranslate"><span class="pre">loadPackagesFromImports</span></code> is now passed as named arguments. The old usage
still works with a deprecation warning.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3149">#3149</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">loadPackage</span></code> and <code class="docutils literal notranslate"><span class="pre">loadPackagesFromImports</span></code> now accepts a
new option <code class="docutils literal notranslate"><span class="pre">checkIntegrity</span></code>. If set to False, integrity check for Python
Packages will be disabled.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added APIs <code class="docutils literal notranslate"><span class="pre">pyodide.setStdin</span></code>, <code class="docutils literal notranslate"><span class="pre">pyodide.setStdout</span></code>,
<code class="docutils literal notranslate"><span class="pre">pyodide.setStderr</span></code> for changing the stream handlers after loading Pyodide.
Also added more careful control over whether <code class="docutils literal notranslate"><span class="pre">isatty</span></code> returns true or false on
stdin, stdout, and stderr.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3268">#3268</a></p></li>
</ul>
</section>
<section id="id27">
<h6>Package Loading<a class="headerlink" href="#id27" title="Link to this heading">#</a></h6>
<ul>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now shows more helpful error messages when importing
packages that are included in Pyodide fails.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3137">#3137</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3263">#3263</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Shared libraries with version suffixes are now handled correctly.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3154">#3154</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Unvendored the sqlite3 module from the standard library. Before
<code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> was included by default. Now it needs to be loaded with
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2946">#2946</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The Pyodide Python package is installed into <code class="docutils literal notranslate"><span class="pre">/lib/python3.10</span></code>
rather than <code class="docutils literal notranslate"><span class="pre">/lib/python3.10/site-packages</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3022">#3022</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The matplotlib HTML5 backends are now available as part of the
<a class="reference external" href="https://github.com/pyodide/matplotlib-pyodide"><code class="docutils literal notranslate"><span class="pre">matplotlib-pyodide</span></code></a> package.
If you use the default backend from Pyodide, no changes are necessary.
However, if you previously specified the backend with <code class="docutils literal notranslate"><span class="pre">matplotlib.use</span></code>, the
URL is now different. See <a class="reference external" href="https://github.com/pyodide/matplotlib-pyodide">package
readme</a> for more details.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3061">#3061</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The micropip package was moved to a separate repository
<a class="reference external" href="https://github.com/pyodide/micropip">pyodide/micropip</a>. In addion to
installing the version shipped with a given Pyodide release, you can also
install a different micropip version from
<a class="reference external" href="https://pypi.org/project/micropip/">PyPi</a> with,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">loadPackage</span><span class="p">(</span><span class="s1">&#39;packaging&#39;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">loadPackage</span><span class="p">(</span><span class="s1">&#39;&lt;URL of the micropip wheel on PyPI&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>from Javascript. From Python you can import the Javascript Pyodide package,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyodide_js</span>
</pre></div>
</div>
<p>and call the same functions as above.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3122">#3122</a></p>
</li>
<li><p><span class='badge badge-info'>Enhancement</span> The parsing and validation of <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> according to the
specification is now done more rigorously with Pydantic.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3079">#3079</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The <code class="docutils literal notranslate"><span class="pre">source/md5</span></code> checksum field is not longer supported in
<code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> files, use <code class="docutils literal notranslate"><span class="pre">source/sha256</span></code> instead
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3079">#3079</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">pyodide_build.io.parse_package_config</span></code> function is removed in
favor of <code class="docutils literal notranslate"><span class="pre">pyodide_build.MetaConfig.from_yaml</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3079">#3079</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">ctypes.util.find_library</span></code> will now search WASM modules from
LD_LIBRARY_PATH.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3353">#3353</a></p></li>
</ul>
</section>
<section id="id28">
<h6>Build System<a class="headerlink" href="#id28" title="Link to this heading">#</a></h6>
<ul>
<li><p><span class='badge badge-info'>Enhancement</span> Updated Emscripten to version 3.1.27
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2958">#2958</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2950">#2950</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3027">#3027</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3107">#3107</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3148">#3148</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3236">#3236</a>,
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3239">#3239</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3280">#3280</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3314">#3314</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">requirements/host</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec to
allow host dependencies that are required for building packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2132">#2132</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">package/top-level</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec to
calculate top-level import names for the package. Previously <code class="docutils literal notranslate"><span class="pre">test/imports</span></code>
key was used for this purpose.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3006">#3006</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">build/vendor-sharedlib</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec
which vendors shared libraries into the wheel after building.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3234">#3234</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3264">#3264</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">build/type</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec which
specifies the type of the package.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3238">#3238</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">requirements/executable</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec
which specifies the list of executables required for building a package.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3300">#3300</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">build/library</span></code> and <code class="docutils literal notranslate"><span class="pre">build/sharedlibrary</span></code> key in the
<code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec are removed. Use <code class="docutils literal notranslate"><span class="pre">build/type</span></code> instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3238">#3238</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that <code class="docutils literal notranslate"><span class="pre">backend-flags</span></code> propagated to dependencies.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3153">#3153</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug that shared libraries are not copied into distribution
directory when it is already built.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3212">#3212</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a system for making Pyodide virtual environments. This
is for testing out of tree builds. For more information, see <a class="reference internal" href="#building-and-testing-packages-out-of-tree"><span class="std std-ref">the
documentation</span></a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2976">#2976</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3039">#3039</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3040">#3040</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3044">#3044</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3096">#3096</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3098">#3098</a>,
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3108">#3108</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3109">#3109</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3241">#3241</a></p></li>
<li><p>Added a new CLI command <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">skeleton</span></code> which creates a package build recipe.
<code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">mkpkg</span></code> will be replaced by <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">skeleton</span> <span class="pre">pypi</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3175">#3175</a></p></li>
<li><p>Added a new CLI command <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build-recipes</span></code> which build packages from
recipe folder. It replaces <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">buildall</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3196">#3196</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3279">#3279</a></p></li>
<li><p>Added a new CLI command <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">config</span></code> which shows config variables used in
Pyodide.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3376">#3376</a></p></li>
<li><p>Added subcommands for <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> which builds packages from various sources.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span> <span class="pre">pypi</span></code></p></td>
<td><p>build or fetch a single package from pypi</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span> <span class="pre">source</span></code></p></td>
<td><p>build the current source folder (same as pyodide build)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span> <span class="pre">url</span></code></p></td>
<td><p>build or fetch a package from a url either tgz, tar.gz zip or wheel</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/3196">#3196</a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</section>
<section id="id29">
<h6>Packages<a class="headerlink" href="#id29" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New packages: pycryptodome <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2965">#2965</a>, coverage-py <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3053">#3053</a>, bcrypt
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3125">#3125</a>, lightgbm <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3138">#3138</a>, pyheif, pillow_heif, libheif, libde265
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3161">#3161</a>, wordcloud <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3173">#3173</a>, gdal, fiona, geopandas <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3213">#3213</a>, the
standard library _hashlib module <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3206">#3206</a> , pyinstrument <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3258">#3258</a>, gensim
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3326">#3326</a>, smart_open <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3326">#3326</a>, pyodide-http <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3355">#3355</a>.</p></li>
<li><p><span class='badge badge-danger'>Fix</span> Scipy CSR data is now handled correctly in XGBoost.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3194">#3194</a></p></li>
<li><p><span class='badge badge-success'>Update</span> Upgraded packages: SciPy 1.9.1 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3043">#3043</a>, pandas 1.5.0
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3134">#3134</a>, numpy 1.23.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3284">#3284</a>, scikit-learn 1.1.3 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3324">#3324</a> as well as
most of the other packages <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3348">#3348</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/3365">#3365</a>. See
<a class="reference internal" href="#packages-in-pyodide"><span class="std std-ref">Packages built in Pyodide</span></a> for more details.</p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix scipy handling of exceptions that are raised from C++ code.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3384">#3384</a>.</p></li>
</ul>
</section>
<section id="id30">
<h6>List of Contributors<a class="headerlink" href="#id30" title="Link to this heading">#</a></h6>
<p>Aierie, dataxerik, David Lechner, Deepak Cherian, Filipe, Gyeongjae Choi, Hood
Chatham, H.Yamada, Jacques Boscq, Jeremy Tuloup, Joe Marshall, John Wason,
Loïc Estève, partev, Patrick Arminio, Péter Ferenc Gyarmati, Prete, Qijia
Liu, Roman Yurchak, ryanking13, skelsec, Starz0r, Will Lachance, YeonWoo, Yizhi
Liu</p>
</section>
</section>
<section id="version-0-21-3">
<h5>Version 0.21.3<a class="headerlink" href="#version-0-21-3" title="Link to this heading">#</a></h5>
<p><em>September 15, 2022</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> When loading <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code>, <code class="docutils literal notranslate"><span class="pre">loadPackage</span></code> no longer also loads <code class="docutils literal notranslate"><span class="pre">nltk</span></code>
and <code class="docutils literal notranslate"><span class="pre">regex</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/issues/3001">#3001</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Packages are now loaded in a topologically sorted order regarding
their dependencies.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3020">#3020</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Loading the <code class="docutils literal notranslate"><span class="pre">soupsieve</span></code> package will not automatically load
<code class="docutils literal notranslate"><span class="pre">beautifulsoup4</span></code> together.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3020">#3020</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix the incorrect package name <code class="docutils literal notranslate"><span class="pre">ruamel</span></code> to <code class="docutils literal notranslate"><span class="pre">ruamel.yaml</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3036">#3036</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> will now raise error when the version of
JavaScript and Python Pyodide package does not match.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3074">#3074</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now works with a content security policy that
doesn’t include <code class="docutils literal notranslate"><span class="pre">unsafe-eval</span></code>. It is still necessary to include
<code class="docutils literal notranslate"><span class="pre">wasm-unsafe-eval</span></code> (and probably always will be). Since current Safari
versions have no support for <code class="docutils literal notranslate"><span class="pre">wasm-unsafe-eval</span></code>, it is necessary to include
<code class="docutils literal notranslate"><span class="pre">unsafe-eval</span></code> in order to work in Safari. This will likely be fixed in the
next Safari release: https://bugs.webkit.org/show_bug.cgi?id=235408
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3075">#3075</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> It works again to use <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> with a relative URL as
<code class="docutils literal notranslate"><span class="pre">indexURL</span></code> (this was a regression in v0.21.2).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3077">#3077</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Add <code class="docutils literal notranslate"><span class="pre">url</span></code> to list of pollyfilled packages for webpack compatibility.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3080">#3080</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed warnings like
<code class="docutils literal notranslate"><span class="pre">Critical</span> <span class="pre">dependency:</span> <span class="pre">the</span> <span class="pre">request</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">dependency</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">expression.</span></code>
when using Pyodide with webpack.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3080">#3080</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Add binary files to exports in JavaScript package
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3085">#3085</a>.</p></li>
<li><p><span class='badge badge-danger'>Fix</span> Source maps are included in the distribution again (reverting
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3015">#3015</a> included in 0.21.2) and if there is a variable in top level scope
called <code class="docutils literal notranslate"><span class="pre">__dirname</span></code> we use that for the <code class="docutils literal notranslate"><span class="pre">indexURL</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3088">#3088</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">PyProxy.apply</span></code> now correctly handles the case when something
unexpected is passed as the second argument.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3101">#3101</a></p></li>
</ul>
</section>
<section id="version-0-21-2">
<h5>Version 0.21.2<a class="headerlink" href="#version-0-21-2" title="Link to this heading">#</a></h5>
<p><em>August 29, 2022</em></p>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> The standard library packages <code class="docutils literal notranslate"><span class="pre">ssl</span></code> and <code class="docutils literal notranslate"><span class="pre">lzma</span></code> can now be installed
with <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage(&quot;ssl&quot;)</span></code> or <code class="docutils literal notranslate"><span class="pre">micropip.install(&quot;ssl&quot;)</span></code> (previously
they had a leading underscore and it was only possible to load them with
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>).
<a class="reference external" href="https://github.com/pyodide/pyodide/issues/3003">#3003</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> If a wheel path is passed to <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>, it will now be
resolved relative to <code class="docutils literal notranslate"><span class="pre">document.location</span></code> (in browser) or relative to the
current working directory (in Node) rather than relative to <code class="docutils literal notranslate"><span class="pre">indexURL</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3013">#3013</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/issues/3011">#3011</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug in Emscripten that caused Pyodide to fail in Jest.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3014">#3014</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> It now works to pass a relative url to <code class="docutils literal notranslate"><span class="pre">indexURL</span></code>. Also, the
calculated index URL now works even if <code class="docutils literal notranslate"><span class="pre">node</span></code> is run with
<code class="docutils literal notranslate"><span class="pre">--enable-source-maps</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/3015">#3015</a></p></li>
</ul>
</section>
<section id="version-0-21-1">
<h5>Version 0.21.1<a class="headerlink" href="#version-0-21-1" title="Link to this heading">#</a></h5>
<p><em>August 22, 2022</em></p>
<ul class="simple">
<li><p>New packages: the standard library lzma module <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2939">#2939</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now shows more helpful error messages when importing
unvendored or removed stdlib modules fails.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2973">#2973</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The default value of <code class="docutils literal notranslate"><span class="pre">fullStdLib</span></code> in <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> has been
changed to <code class="docutils literal notranslate"><span class="pre">false</span></code>. This means Pyodide now will not load some stdlib modules
like distutils, ssl, and sqlite3 by default. See <a class="reference external" href="https://pyodide.org/en/stable/usage/wasm-constraints.html">Pyodide Python
compatibility</a> for
detail. If <code class="docutils literal notranslate"><span class="pre">fullStdLib</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, it will load all unvendored stdlib
modules. However, setting <code class="docutils literal notranslate"><span class="pre">fullStdLib</span></code> to true will increase the initial
Pyodide load time. So it is preferable to explicitly load the required module.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2998">#2998</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> now checks that the correct version of the
Emscripten compiler is used.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2975">#2975</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2990">#2990</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide works in Safari v14 again. It was broken in v0.21.0
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2994">#2994</a></p></li>
</ul>
</section>
<section id="version-0-21-0">
<h5>Version 0.21.0<a class="headerlink" href="#version-0-21-0" title="Link to this heading">#</a></h5>
<p><em>August 9, 2022</em></p>
<p><a class="reference external" href="https://blog.pyodide.org/posts/0.21-release/">See the release notes for a summary.</a></p>
<section id="id31">
<h6>Build system<a class="headerlink" href="#id31" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Emscripten was updated to Version 3.1.14
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2775">#2775</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2679">#2679</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2672">#2672</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix building on macOS <a class="reference external" href="https://github.com/pyodide/pyodide/issues/2360">#2360</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2554">#2554</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Update Typescript target to ES2017 to generate more modern
Javascript code.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2471">#2471</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> We now put our built files into the <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory rather
than the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2387">#2387</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The build will error out earlier if <code class="docutils literal notranslate"><span class="pre">cmake</span></code> or <code class="docutils literal notranslate"><span class="pre">libtool</span></code> are not
installed.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2423">#2423</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The platform tags of wheels now include the Emscripten
version in them. This should help ensure ABI compatibility if Emscripten
wheels are distributed outside of the main Pyodide distribution.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2610">#2610</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The build system now uses the sysconfigdata from the target
Python rather than the host Python.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2516">#2516</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now builds with <code class="docutils literal notranslate"><span class="pre">-sWASM_BIGINT</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2643">#2643</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">cross-script</span></code> key to the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> spec to allow
executing custom logic in the cross build environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2734">#2734</a></p></li>
</ul>
</section>
<section id="pyodide-module-and-type-conversions">
<h6>Pyodide Module and type conversions<a class="headerlink" href="#pyodide-module-and-type-conversions" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> All functions were moved out of the root <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> package into
various submodules. For backwards compatibility, they will be available from
the root package (raising a <code class="docutils literal notranslate"><span class="pre">FutureWarning</span></code>) until v0.23.0.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2787">#2787</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2790">#2790</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> no longer uses any global state, so it can be
used more than once in the same thread. This is recommended if a network
request causes a loading failure, if there is a fatal error, if you damage the
state of the runtime so badly that it is no longer usable, or for certain
testing purposes. It is not recommended for creating multiple execution
environments, for which you should use
<code class="docutils literal notranslate"><span class="pre">pyodide.runPython(code,</span> <span class="pre">{</span> <span class="pre">globals</span> <span class="pre">:</span> <span class="pre">some_dict})</span></code>;
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2391">#2391</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide.unpackArchive</span></code> now accepts any <code class="docutils literal notranslate"><span class="pre">ArrayBufferView</span></code> or
<code class="docutils literal notranslate"><span class="pre">ArrayBuffer</span></code> as first argument, rather than only a <code class="docutils literal notranslate"><span class="pre">Uint8Array</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2451">#2451</a></p></li>
<li><p><span class='badge badge-success'>Feature</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide.code.run_js</span></code> API.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2426">#2426</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> BigInt’s between 2^{32*n - 1} and 2^{32*n} no longer get
translated to negative Python ints.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2484">#2484</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide now correctly handles JavaScript objects with <code class="docutils literal notranslate"><span class="pre">null</span></code>
constructor.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2520">#2520</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix garbage collection of <code class="docutils literal notranslate"><span class="pre">once_callable</span></code> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2401">#2401</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">js_id</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> to allow using
JavaScript object identity as a dictionary key.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2515">#2515</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a bug with <code class="docutils literal notranslate"><span class="pre">toJs</span></code> when used with recursive structures and the
<code class="docutils literal notranslate"><span class="pre">dictConverter</span></code> argument.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2533">#2533</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added Python wrappers <code class="docutils literal notranslate"><span class="pre">set_timeout</span></code>, <code class="docutils literal notranslate"><span class="pre">clear_timeout</span></code>,
<code class="docutils literal notranslate"><span class="pre">set_interval</span></code>, <code class="docutils literal notranslate"><span class="pre">clear_interval</span></code>, <code class="docutils literal notranslate"><span class="pre">add_event_listener</span></code> and
<code class="docutils literal notranslate"><span class="pre">remove_event_listener</span></code> for the corresponding JavaScript functions.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2456">#2456</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> If a request fails due to CORS, <code class="docutils literal notranslate"><span class="pre">pyfetch</span></code> now raises an <code class="docutils literal notranslate"><span class="pre">OSError</span></code>
not a <code class="docutils literal notranslate"><span class="pre">JSException</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2598">#2598</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now directly exposes the Emscripten <code class="docutils literal notranslate"><span class="pre">PATH</span></code> and
<code class="docutils literal notranslate"><span class="pre">ERRNO_CODES</span></code> APIs.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2582">#2582</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The <code class="docutils literal notranslate"><span class="pre">bool</span></code> operator on a <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> now behaves more consistently: it
returns <code class="docutils literal notranslate"><span class="pre">False</span></code> if JavaScript would say that <code class="docutils literal notranslate"><span class="pre">!!x</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>, or if <code class="docutils literal notranslate"><span class="pre">x</span></code> is an
empty container. Otherwise it returns <code class="docutils literal notranslate"><span class="pre">True</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2803">#2803</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> errors for the Windows Node environment.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2888">#2888</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Implemented slice subscripting, <code class="docutils literal notranslate"><span class="pre">+=</span></code>, and <code class="docutils literal notranslate"><span class="pre">extend</span></code> for
<code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of Javascript arrays.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2907">#2907</a></p></li>
</ul>
</section>
<section id="id32">
<h6>REPL<a class="headerlink" href="#id32" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Add a spinner while the REPL is loading
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2635">#2635</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Cursor blinking in the REPL can be disabled by setting
<code class="docutils literal notranslate"><span class="pre">noblink</span></code> in URL search params.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2666">#2666</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix a REPL error in printing high-dimensional lists.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2517">#2517</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2919">#2919</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix output bug with using <code class="docutils literal notranslate"><span class="pre">input()</span></code> on online console
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2509">#2509</a></p></li>
</ul>
</section>
<section id="micropip-and-package-loading">
<h6>micropip and package loading<a class="headerlink" href="#micropip-and-package-loading" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">packages.json</span></code> which contains the dependency graph for packages
was renamed to <code class="docutils literal notranslate"><span class="pre">repodata.json</span></code> to avoid confusion with <code class="docutils literal notranslate"><span class="pre">package.json</span></code> used
in JavaScript packages.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added SHA-256 hash of package to entries in <code class="docutils literal notranslate"><span class="pre">repodata.json</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2455">#2455</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Integrity of Pyodide packages is now verified before
loading them. This is for now limited to browser environments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2513">#2513</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> supports loading wheels from the Emscripten file
system using the <code class="docutils literal notranslate"><span class="pre">emfs:</span></code> protocol now.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2767">#2767</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to use an alternate <code class="docutils literal notranslate"><span class="pre">repodata.json</span></code>
lockfile by passing the <code class="docutils literal notranslate"><span class="pre">lockFileURL</span></code> option to <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>. This is
particularly intended to be used with <code class="docutils literal notranslate"><span class="pre">micropip.freeze</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2645">#2645</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> micropip now correctly handles package names that include dashes
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2414">#2414</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Allow passing <code class="docutils literal notranslate"><span class="pre">credentials</span></code> to <code class="docutils literal notranslate"><span class="pre">micropip.install()</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2458">#2458</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> now accepts a <code class="docutils literal notranslate"><span class="pre">deps</span></code> parameter.
If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, micropip will not install dependencies of the package.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2433">#2433</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> micropip now correctly compares packages with prerelease version
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2532">#2532</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> now accepts a <code class="docutils literal notranslate"><span class="pre">pre</span></code> parameter.
If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, micropip will include pre-release and development versions.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2542">#2542</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> was refactored to improve readability and ease of
maintenance.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2561">#2561</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2563">#2563</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2564">#2564</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2565">#2565</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2568">#2568</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Various error messages were fine tuned and improved.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2562">#2562</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2558">#2558</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> was adjusted to keep its state in the wheel
<code class="docutils literal notranslate"><span class="pre">.dist-info</span></code> directories which improves consistenency with the Python standard
library and other tools used to install packages.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2572">#2572</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> can now be used to install Emscripten binary wheels.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2591">#2591</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">micropip.freeze</span></code> to record the current set of loaded
packages into a <code class="docutils literal notranslate"><span class="pre">repodata.json</span></code> file.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2581">#2581</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">micropip.list</span></code> now works correctly when there are packages
that are installed via <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code> from a custom URL.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2743">#2743</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> micropip now skips package versions which do not follow PEP440.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2754">#2754</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> supports extra markers in packages correctly now.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2584">#2584</a></p></li>
</ul>
</section>
<section id="id33">
<h6>Packages<a class="headerlink" href="#id33" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Update sqlite version to latest stable release
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2477">#2477</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2518">#2518</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pillow now supports WEBP image format <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2407">#2407</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pillow and opencv-python now support the TIFF image format.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2762">#2762</a></p></li>
<li><p>Pandas is now compiled with <code class="docutils literal notranslate"><span class="pre">-Oz</span></code>, which significantly speeds up loading the library
on Chrome <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2457">#2457</a></p></li>
<li><p>New packages: opencv-python <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2305">#2305</a>, ffmpeg <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2305">#2305</a>, libwebp <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2305">#2305</a>,
h5py, pkgconfig and libhdf5 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2411">#2411</a>, bitarray <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2459">#2459</a>, gsw <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2511">#2511</a>,
cftime <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2504">#2504</a>, svgwrite, jsonschema, tskit <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2506">#2506</a>, xarray <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2538">#2538</a>,
demes, libgsl, newick, ruamel, msprime <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2548">#2548</a>, gmpy2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2665">#2665</a>,
xgboost <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2537">#2537</a>, galpy <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2676">#2676</a>, shapely, geos <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2725">#2725</a>, suitesparse,
sparseqr <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2685">#2685</a>, libtiff <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2762">#2762</a>, pytest-benchmark <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2799">#2799</a>,
termcolor <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2809">#2809</a>, sqlite3, libproj, pyproj, certifi <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2555">#2555</a>,
rebound <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2868">#2868</a>, reboundx <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2909">#2909</a>, pyclipper <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2886">#2886</a>,
brotli <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2925">#2925</a>, python-magic <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2941">#2941</a></p></li>
</ul>
</section>
<section id="miscellaneous">
<h6>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> We now tell packagers (e.g., Webpack) to ignore npm-specific imports
when packing files for the browser.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2468">#2468</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">run_in_pyodide</span></code> now has support for pytest assertion
rewriting and decorators such as <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> and hypothesis.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2510">#2510</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2541">#2541</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> <code class="docutils literal notranslate"><span class="pre">pyodide_build.testing</span></code> is removed. <code class="docutils literal notranslate"><span class="pre">run_in_pyodide</span></code>
decorator can now be accessed through
<a class="reference external" href="https://github.com/pyodide/pytest-pyodide"><code class="docutils literal notranslate"><span class="pre">pytest-pyodide</span></code></a> package.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2418">#2418</a></p></li>
</ul>
</section>
<section id="id34">
<h6>List of contributors<a class="headerlink" href="#id34" title="Link to this heading">#</a></h6>
<p>Alexey Ignatiev, Andrey Smelter, andrzej, Antonio Cuni, Ben Jeffery, Brian
Benjamin Maranville, David Lechner, dragoncoder047, echorand (Amit Saha),
Filipe, Frank, Gyeongjae Choi, Hanno Rein, haoran1062, Henry Schreiner, Hood
Chatham, Jason Grout, jmdyck, Jo Bovy, John Wason, josephrocca, Kyle Cutler,
Lester Fan, Liumeo, lukemarsden, Mario Gersbach, Matt Toad, Michael Droettboom,
Michael Gilbert, Michael Neil, Mu-Tsun Tsai, Nicholas Bollweg, pysathq, Ricardo
Prins, Rob Gries, Roman Yurchak, Ryan May, Ryan Russell, stonebig, Szymswiat,
Tobias Megies, Vic Kumar, Victor, Wei Ji, Will Lachance</p>
</section>
</section>
<section id="version-0-20-0">
<h5>Version 0.20.0<a class="headerlink" href="#version-0-20-0" title="Link to this heading">#</a></h5>
<p><em>April 9th, 2022</em></p>
<p><a class="reference external" href="https://blog.pyodide.org/posts/0.20-release/">See the release notes for a summary.</a></p>
<section id="cpython-and-stdlib">
<h6>CPython and stdlib<a class="headerlink" href="#cpython-and-stdlib" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> Pyodide now runs Python 3.10.2.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2225">#2225</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> All <code class="docutils literal notranslate"><span class="pre">ctypes</span></code> tests pass now except for
<code class="docutils literal notranslate"><span class="pre">test_callback_too_many_args</span></code> (and we have a plan to fix
<code class="docutils literal notranslate"><span class="pre">test_callback_too_many_args</span></code> upstream). <code class="docutils literal notranslate"><span class="pre">libffi-emscripten</span></code> now also passes
all libffi tests.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2350">#2350</a></p></li>
</ul>
</section>
<section id="id35">
<h6>Packages<a class="headerlink" href="#id35" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> matplotlib now loads multiple fonts correctly <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2271">#2271</a></p></li>
<li><p>New packages: boost-histogram <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2174">#2174</a>, cryptography v3.3.2 <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2263">#2263</a>, the
standard library ssl module <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2263">#2263</a>, python-solvespace v3.0.7,
lazy-object-proxy <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2320">#2320</a>.</p></li>
<li><p>Many more scipy linking errors were fixed, mostly related to the Fortran f2c
ABI for string arguments. There are still some fatal errors in the Scipy test
suite, but none seem to be simple linker errors.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2289">#2289</a></p></li>
<li><p>Removed pyodide-interrupts. If you were using this for some reason, use
<code class="docutils literal notranslate"><span class="pre">pyodide.setInterruptBuffer</span></code> instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2309">#2309</a></p></li>
<li><p>Most included packages were updated to the latest version. See
<a class="reference internal" href="#packages-in-pyodide"><span class="std std-ref">Packages built in Pyodide</span></a> for a full list.</p></li>
</ul>
</section>
<section id="type-translations">
<h6>Type translations<a class="headerlink" href="#type-translations" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Python tracebacks now include Javascript frames when Python calls a
Javascript function.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2123">#2123</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> argument to <code class="docutils literal notranslate"><span class="pre">JsProxy.to_py</span></code>
and <code class="docutils literal notranslate"><span class="pre">pyodide.toPy</span></code> which is used to process any object that doesn’t have
a built-in conversion to Python. Also added a <code class="docutils literal notranslate"><span class="pre">default_converter</span></code> argument to
<code class="docutils literal notranslate"><span class="pre">PyProxy.toJs</span></code> and <code class="docutils literal notranslate"><span class="pre">pyodide.ffi.to_js</span></code> to convert.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2170">#2170</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2208">#2208</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Async Python functions called from Javascript now have the
resulting coroutine automatically scheduled. For instance, this makes it
possible to use an async Python function as a Javascript event handler.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2319">#2319</a></p></li>
</ul>
</section>
<section id="javascript-package">
<h6>Javascript package<a class="headerlink" href="#javascript-package" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> It is no longer necessary to provide <code class="docutils literal notranslate"><span class="pre">indexURL</span></code> to
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2292">#2292</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The <code class="docutils literal notranslate"><span class="pre">globals</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pyodide.runPython</span></code> and
<code class="docutils literal notranslate"><span class="pre">pyodide.runPythonAsync</span></code> is now passed as a named argument. The old usage
still works with a deprecation warning.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2300">#2300</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> The Javascript package was migrated to Typescript.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2130">#2130</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2133">#2133</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix importing pyodide with ESM syntax in a module type web worker.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2220">#2220</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> When Pyodide is loaded as an ES6 module, no global
<code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> variable is created (instead, it should be accessed as an
attribute on the module).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2249">#2249</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The type <code class="docutils literal notranslate"><span class="pre">Py2JsResult</span></code> has been replaced with <code class="docutils literal notranslate"><span class="pre">any</span></code> which is more
accurate. For backwards compatibility, we still export <code class="docutils literal notranslate"><span class="pre">Py2JsResult</span></code> as an
alias for <code class="docutils literal notranslate"><span class="pre">any</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2277">#2277</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide now loads correctly even if requirejs is included.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2283">#2283</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added robust handling for non-<code class="docutils literal notranslate"><span class="pre">Error</span></code> objects thrown by
Javascript code. This mostly should never happen since well behaved Javascript
code ought to throw errors. But it’s better not to completely crash if it
throws something else.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2294">#2294</a></p></li>
</ul>
</section>
<section id="pyodide-build">
<h6>pyodide_build<a class="headerlink" href="#pyodide-build" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now uses Python wheel files to distribute packages
rather than the emscripten <code class="docutils literal notranslate"><span class="pre">file_packager.py</span></code> format.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2027">#2027</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now uses <code class="docutils literal notranslate"><span class="pre">pypa/build</span></code> to build packages. We (mostly)
use build isolation, so we can build packages that require conflicting
versions of setuptools or alternative build backends.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2272">#2272</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Most pure Python packages were switched to use the wheels
directly from PyPI rather than rebuilding them.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2126">#2126</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added support for C++ exceptions in packages. Now C++
extensions compiled and linked with <code class="docutils literal notranslate"><span class="pre">-fexceptions</span></code> can catch C++ exceptions.
Furthermore, uncaught C++ exceptions will be formatted in a human-readable
way.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2178">#2178</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Removed the <code class="docutils literal notranslate"><span class="pre">skip-host</span></code> key from the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> format. If
needed, install a host copy of the package with pip instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2256">#2256</a></p></li>
</ul>
</section>
<section id="uncategorized">
<h6>Uncategorized<a class="headerlink" href="#uncategorized" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> The interrupt buffer can be used to raise all 64 signals
now, not just <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code>. Write a number between <code class="docutils literal notranslate"><span class="pre">1&lt;=</span> <span class="pre">signum</span> <span class="pre">&lt;=</span> <span class="pre">64</span></code> into the
interrupt buffer to trigger the corresponding signal. By default everything
but <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> will be ignored. Any value written into the interrupt buffer
outside of the range from 1 to 64 will be silently discarded.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2301">#2301</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Updated to Emscripten 2.0.27.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2295">#2295</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The <code class="docutils literal notranslate"><span class="pre">extractDir</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pyodide.unpackArchive</span></code> is now
passed as a named argument. The old usage still works with a deprecation
warning.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2300">#2300</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Support ANSI escape codes in the Pyodide console.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2345">#2345</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide_build</span></code> can now be installed in non-editable ways.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2351">#2351</a></p></li>
</ul>
</section>
<section id="id36">
<h6>List of contributors<a class="headerlink" href="#id36" title="Link to this heading">#</a></h6>
<p>Boris Feld, Christian Staudt, Gabriel Fougeron, Gyeongjae Choi, Henry Schreiner,
Hood Chatham, Jo Bovy, Karthikeyan Singaravelan, Leo Psidom, Liumeo, Luka
Mamukashvili, Madhur Tandon, Paul Korzhyk, Roman Yurchak, Seungmin Kim, Thorsten
Beier, Tom White, and Will Lachance</p>
</section>
</section>
<section id="version-0-19-1">
<h5>Version 0.19.1<a class="headerlink" href="#version-0-19-1" title="Link to this heading">#</a></h5>
<p><em>February 19, 2022</em></p>
<section id="id37">
<h6>Packages<a class="headerlink" href="#id37" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>New packages: sqlalchemy <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2112">#2112</a>, pydantic <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2117">#2117</a>, wrapt <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2165">#2165</a></p></li>
<li><p><span class='badge badge-success'>Update</span> Upgraded packages: pyb2d (0.7.2), <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2117">#2117</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> A fatal error in <code class="docutils literal notranslate"><span class="pre">scipy.stats.binom.ppf</span></code> has been fixed.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2109">#2109</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Type signature mismatches in some numpy comparators have been fixed.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2110">#2110</a></p></li>
</ul>
</section>
<section id="id38">
<h6>Type translations<a class="headerlink" href="#id38" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> The “PyProxy has already been destroyed” error message has been
improved with some context information.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2121">#2121</a></p></li>
</ul>
</section>
<section id="id39">
<h6>REPL<a class="headerlink" href="#id39" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Pressing TAB in REPL no longer triggers completion when input
is whitespace. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2125">#2125</a></p></li>
</ul>
</section>
<section id="id40">
<h6>List of contributors<a class="headerlink" href="#id40" title="Link to this heading">#</a></h6>
<p>Christian Staudt, Gyeongjae Choi, Hood Chatham, Liumeo, Paul Korzhyk, Roman
Yurchak, Seungmin Kim, Thorsten Beier</p>
</section>
</section>
<section id="version-0-19-0">
<h5>Version 0.19.0<a class="headerlink" href="#version-0-19-0" title="Link to this heading">#</a></h5>
<p><em>January 10, 2021</em></p>
<p><a class="reference external" href="https://blog.pyodide.org/posts/0.19-release/">See the release notes for a summary.</a></p>
<section id="python-package">
<h6>Python package<a class="headerlink" href="#python-package" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> If <code class="docutils literal notranslate"><span class="pre">find_imports</span></code> is used on code that contains a syntax
error, it will return an empty list instead of raising a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1819">#1819</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">pyodide.http.pyfetch</span></code> API which provides a
convenience wrapper for the Javascript <code class="docutils literal notranslate"><span class="pre">fetch</span></code> API. The API returns a response
object with various methods that convert the data into various types while
minimizing the number of times the data is copied.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1865">#1865</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">unpack_archive</span></code> API to the <code class="docutils literal notranslate"><span class="pre">pyodide.http.FetchResponse</span></code>
object which treats the response body as an archive and uses <code class="docutils literal notranslate"><span class="pre">shutil</span></code> to
unpack it. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1935">#1935</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The Pyodide event loop now works correctly with cancelled handles. In
particular, <code class="docutils literal notranslate"><span class="pre">asyncio.wait_for</span></code> now functions as expected.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2022">#2022</a></p></li>
</ul>
</section>
<section id="id41">
<h6>JavaScript package<a class="headerlink" href="#id41" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> no longer fails in the
presence of a user-defined global named <code class="docutils literal notranslate"><span class="pre">process</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1849">#1849</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Various webpack buildtime and runtime compatibility issues were fixed.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1900">#1900</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">pyodide.pyimport</span></code> API to import a Python module and
return it as a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>. Warning: this is different from the original
<code class="docutils literal notranslate"><span class="pre">pyimport</span></code> API which was removed in this version.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1944">#1944</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">pyodide.unpackArchive</span></code> API which unpacks an archive
represented as an ArrayBuffer into the working directory. This is intended as
a way to install packages from a local application.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1944">#1944</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> now accepts a <code class="docutils literal notranslate"><span class="pre">homedir</span></code> parameter which sets home
directory of Pyodide virtual file system.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1936">#1936</a></p></li>
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> The default working directory(home directory) inside the Pyodide
virtual file system has been changed from <code class="docutils literal notranslate"><span class="pre">/</span></code> to <code class="docutils literal notranslate"><span class="pre">/home/pyodide</span></code>. To get the
previous behavior, you can</p>
<ul>
<li><p>call <code class="docutils literal notranslate"><span class="pre">os.chdir(&quot;/&quot;)</span></code> in Python to change working directory or</p></li>
<li><p>call <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> with the <code class="docutils literal notranslate"><span class="pre">homedir=&quot;/&quot;</span></code>
argument
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1936">#1936</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="python-javascript-type-conversions">
<h6>Python / JavaScript type conversions<a class="headerlink" href="#python-javascript-type-conversions" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>BREAKING CHANGE</span> Updated the calling convention when a JavaScript function is
called from Python to improve memory management of PyProxies. PyProxy
arguments and return values are automatically destroyed when the function is
finished.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1573">#1573</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">JsProxy.to_string</span></code>, <code class="docutils literal notranslate"><span class="pre">JsProxy.to_bytes</span></code>, and
<code class="docutils literal notranslate"><span class="pre">JsProxy.to_memoryview</span></code> to allow for conversion of <code class="docutils literal notranslate"><span class="pre">TypedArray</span></code> to standard
Python types without unneeded copies.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1864">#1864</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">JsProxy.to_file</span></code> and <code class="docutils literal notranslate"><span class="pre">JsProxy.from_file</span></code> to allow
reading and writing Javascript buffers to files as a byte stream without
unneeded copies.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1864">#1864</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> It is now possible to destroy a borrowed attribute <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a
<code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> (as introduced by <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1636">#1636</a>) before destroying the root <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1854">#1854</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> If <code class="docutils literal notranslate"><span class="pre">__iter__()</span></code> raises an error, it is now handled correctly by the
<code class="docutils literal notranslate"><span class="pre">PyProxy[Symbol.iterator()]</span></code> method.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1871">#1871</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Borrowed attribute <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>s are no longer destroyed when the root
<code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> is garbage collected (because it was leaked). Doing so has no
benefit to nonleaky code and turns some leaky code into broken code (see
<a class="reference external" href="https://github.com/pyodide/pyodide/issues/1855">#1855</a> for an example).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1870">#1870</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Improved the way that <code class="docutils literal notranslate"><span class="pre">pyodide.globals.get(&quot;builtin_name&quot;)</span></code> works.
Before we used <code class="docutils literal notranslate"><span class="pre">__main__.__dict__.update(builtins.__dict__)</span></code> which led to
several undesirable effects such as <code class="docutils literal notranslate"><span class="pre">__name__</span></code> being equal to <code class="docutils literal notranslate"><span class="pre">&quot;builtins&quot;</span></code>.
Now we use a proxy wrapper to replace <code class="docutils literal notranslate"><span class="pre">pyodide.globals.get</span></code> with a function
that looks up the name on <code class="docutils literal notranslate"><span class="pre">builtins</span></code> if lookup on <code class="docutils literal notranslate"><span class="pre">globals</span></code> fails.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1905">#1905</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Coroutines have their memory managed in a more convenient way.
In particular, now it is only necessary to either <code class="docutils literal notranslate"><span class="pre">await</span></code> the coroutine or
call one of <code class="docutils literal notranslate"><span class="pre">.then</span></code>, <code class="docutils literal notranslate"><span class="pre">.except</span></code> or <code class="docutils literal notranslate"><span class="pre">.finally</span></code> to prevent a leak. It is no
longer necessary to manually destroy the coroutine. Example: before:</p></li>
</ul>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">globals</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">coroutine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Module</span><span class="p">.</span><span class="nx">pyodide_py</span><span class="p">.</span><span class="nx">eval_code_async</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">globals</span><span class="p">);</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">coroutine</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">coroutine</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">runPythonAsync</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">globals</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Module</span><span class="p">.</span><span class="nx">pyodide_py</span><span class="p">.</span><span class="nx">eval_code_async</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span><span class="w"> </span><span class="nx">globals</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/pyodide/pyodide/pull/2030">#2030</a></p>
</section>
<section id="id42">
<h6>pyodide-build<a class="headerlink" href="#id42" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> By default only a minimal set of packages is built. To build all
packages set <code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES='*'</span></code> In addition, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">minimal</span></code> was removed,
since it is now equivalent to <code class="docutils literal notranslate"><span class="pre">make</span></code> without extra arguments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1801">#1801</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to use <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">buildall</span></code> and
<code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">buildpkg</span></code> directly.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2063">#2063</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a <code class="docutils literal notranslate"><span class="pre">--force-rebuild</span></code> flag to <code class="docutils literal notranslate"><span class="pre">buildall</span></code> and <code class="docutils literal notranslate"><span class="pre">buildpkg</span></code>
which rebuilds the package even if it looks like it doesn’t need to be
rebuilt. Added a <code class="docutils literal notranslate"><span class="pre">--continue</span></code> flag which keeps the same source tree for the
package and can continue from the middle of a build.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2069">#2069</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Changes to environment variables in the build script are now
seen in the compile and post build scripts.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1706">#1706</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix usability issues with <code class="docutils literal notranslate"><span class="pre">pyodide-build</span> <span class="pre">mkpkg</span></code> CLI.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1828">#1828</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Better support for ccache when building Pyodide
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1805">#1805</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix compile error <code class="docutils literal notranslate"><span class="pre">wasm-ld:</span> <span class="pre">error:</span> <span class="pre">unknown</span> <span class="pre">argument:</span> <span class="pre">--sort-common</span></code>
and <code class="docutils literal notranslate"><span class="pre">wasm-ld:</span> <span class="pre">error:</span> <span class="pre">unknown</span> <span class="pre">argument:</span> <span class="pre">--as-needed</span></code> in ArchLinux.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1965">#1965</a></p></li>
</ul>
</section>
<section id="micropip">
<h6>micropip<a class="headerlink" href="#micropip" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> micropip now raises an error when installing a non-pure python wheel
directly from a url.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1859">#1859</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.install" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.install()</span></code></a> now accepts a <code class="docutils literal notranslate"><span class="pre">keep_going</span></code> parameter.
If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, micropip reports all identifiable dependencies that don’t
have pure Python wheels, instead of failing after processing the first one.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1976">#1976</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added a new API <a class="reference external" href="https://micropip.pyodide.org/en/v0.7.1/project/api.html#micropip.list" title="(in micropip v0.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropip.list()</span></code></a> which returns the list
of installed packages by micropip.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2012">#2012</a></p></li>
</ul>
</section>
<section id="id43">
<h6>Packages<a class="headerlink" href="#id43" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Unit tests are now unvendored from Python packages and
included in a separate package <code class="docutils literal notranslate"><span class="pre">&lt;package</span> <span class="pre">name&gt;-tests</span></code>. This results in a
20% size reduction on average for packages that vendor tests (e.g. numpy,
pandas, scipy).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1832">#1832</a></p></li>
<li><p><span class='badge badge-success'>Update</span> Upgraded SciPy to 1.7.3. There are known issues with some SciPy
components, the current status of the scipy test suite is
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2065#issuecomment-1004243045">here</a>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2065">#2065</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The built-in pwd module of Python, which provides a Unix specific
feature, is now unvendored.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1883">#1883</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> pillow and imageio now correctly encode/decode grayscale and
black-and-white JPEG images.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2028">#2028</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The numpy fft module now works correctly.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2028">#2028</a></p></li>
<li><p>New packages: logbook <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1920">#1920</a>, pyb2d <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1968">#1968</a>, and threadpoolctl (a
dependency of scikit-learn) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2065">#2065</a></p></li>
<li><p>Upgraded packages: numpy (1.21.4) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1934">#1934</a>, scikit-learn (1.0.2) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2065">#2065</a>,
scikit-image (0.19.1) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2005">#2005</a>, msgpack (1.0.3) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2071">#2071</a>, astropy (5.0.3)
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2086">#2086</a>, statsmodels (0.13.1) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2073">#2073</a>, pillow (9.0.0) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/2085">#2085</a>. This
list is not exhaustive, refer to <code class="docutils literal notranslate"><span class="pre">packages.json</span></code> for the full list.</p></li>
</ul>
</section>
<section id="id44">
<h6>Uncategorized<a class="headerlink" href="#id44" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">PyErr_CheckSignals</span></code> now works with the keyboard interrupt
system so that cooperative C extensions can be interrupted. Also, added the
<code class="docutils literal notranslate"><span class="pre">pyodide.checkInterrupt</span></code> function so Javascript code can opt to be
interrupted.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1294">#1294</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The <code class="docutils literal notranslate"><span class="pre">_</span></code> variable is now set by the Pyodide repl just like it is set in
the native Python repl.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1904">#1904</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">pyodide-env</span></code> and <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> Docker images are now available from both
the <a class="reference external" href="https://hub.docker.com/repository/docker/pyodide/pyodide-env">Docker Hub</a> and
from the <a class="reference external" href="https://github.com/orgs/pyodide/packages">Github Package registry</a>. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1995">#1995</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The console now correctly handles it when an object’s <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> function raises an exception.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2021">#2021</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Removed the <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">EMULATE_FUNCTION_POINTER_CASTS</span></code> flag,
yielding large benefits in speed, stack usage, and code size.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/2019">#2019</a></p></li>
</ul>
</section>
<section id="id45">
<h6>List of contributors<a class="headerlink" href="#id45" title="Link to this heading">#</a></h6>
<p>Alexey Ignatiev, Alex Hall, Bart Broere, Cyrille Bogaert, etienne, Grimmer,
Grimmer Kang, Gyeongjae Choi, Hao Zhang, Hood Chatham, Ian Clester, Jan Max
Meyer, LeoPsidom, Liumeo, Michael Christensen, Owen Ou, Roman Yurchak, Seungmin
Kim, Sylvain, Thorsten Beier, Wei Ouyang, Will Lachance</p>
</section>
</section>
<section id="version-0-18-1">
<h5>Version 0.18.1<a class="headerlink" href="#version-0-18-1" title="Link to this heading">#</a></h5>
<p><em>September 16, 2021</em></p>
<section id="console">
<h6>Console<a class="headerlink" href="#console" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Ctrl+C handling in console now works correctly with multiline input.
New behavior more closely approximates the behavior of the native Python
console.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1790">#1790</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fix the repr of Python objects (including lists and dicts) in console <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1780">#1780</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The “long output truncated” message now appears on a separate line as intended.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1814">#1814</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> The streams that are used to redirect stdin and stdout in the console now define
<code class="docutils literal notranslate"><span class="pre">isatty</span></code> to return <code class="docutils literal notranslate"><span class="pre">True</span></code>. This fixes pytest.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1822">#1822</a></p></li>
</ul>
</section>
<section id="id46">
<h6>Python package<a class="headerlink" href="#id46" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Avoid circular references when runsource raises SyntaxError
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1758">#1758</a></p></li>
</ul>
</section>
<section id="id47">
<h6>JavaScript package<a class="headerlink" href="#id47" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> The <code class="docutils literal notranslate"><span class="pre">pyodide.setInterruptBuffer</span></code> command is now publicly exposed
again, as it was in v0.17.0. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1797">#1797</a></p></li>
</ul>
</section>
<section id="id48">
<h6>Python / JavaScript type conversions<a class="headerlink" href="#id48" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Conversion of very large strings from JavaScript to Python works
again. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1806">#1806</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Fixed a use after free bug in the error handling code.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1816">#1816</a></p></li>
</ul>
</section>
<section id="id49">
<h6>Packages<a class="headerlink" href="#id49" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> pillow now correctly encodes/decodes RGB JPEG image format. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1818">#1818</a></p></li>
</ul>
</section>
<section id="micellaneous">
<h6>Micellaneous<a class="headerlink" href="#micellaneous" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> Patched emscripten to make the system calls to duplicate file
descriptors closer to posix-compliant. In particular, this fixes the use of
<code class="docutils literal notranslate"><span class="pre">dup</span></code> on pipes and temporary files, as needed by <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1823">#1823</a></p></li>
</ul>
</section>
</section>
<section id="version-0-18-0">
<h5>Version 0.18.0<a class="headerlink" href="#version-0-18-0" title="Link to this heading">#</a></h5>
<p><em>August 3rd, 2021</em></p>
<section id="id50">
<h6>General<a class="headerlink" href="#id50" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Update</span> Pyodide now runs Python 3.9.5.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1637">#1637</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide can experimentally be used in Node.js <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1689">#1689</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now directly exposes the <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html">Emscripten filesystem
API</a>, allowing
for direct manipulation of the in-memory filesystem
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1692">#1692</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide’s support of <a class="reference external" href="https://emscripten.org/docs/api_reference/Filesystem-API.html#file-systems">emscripten file
systems</a>
is expanded from the default <code class="docutils literal notranslate"><span class="pre">MEMFS</span></code> to include <code class="docutils literal notranslate"><span class="pre">IDBFS</span></code>, <code class="docutils literal notranslate"><span class="pre">NODEFS</span></code>, <code class="docutils literal notranslate"><span class="pre">PROXYFS</span></code>,
and <code class="docutils literal notranslate"><span class="pre">WORKERFS</span></code>, allowing for custom persistence strategies depending on
execution environment <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1596">#1596</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> The <code class="docutils literal notranslate"><span class="pre">packages.json</span></code> schema for Pyodide was redesigned for better
compatibility with conda. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1700">#1700</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">run_docker</span></code> no longer binds any port to the docker image by default.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1750">#1750</a></p></li>
</ul>
</section>
<section id="standard-library">
<h6>Standard library<a class="headerlink" href="#standard-library" title="Link to this heading">#</a></h6>
<ul>
<li><p><span class='badge badge-warning'>API Change</span> The following standard library modules are now available as standalone packages</p>
<ul class="simple">
<li><p>distlib</p></li>
</ul>
<p>They are loaded by default in <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code>, however this behavior
can be disabled with the <code class="docutils literal notranslate"><span class="pre">fullStdLib</span></code> parameter set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.
All optional stdlib modules can then be loaded as needed with
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1543">#1543</a></p>
</li>
<li><p><span class='badge badge-info'>Enhancement</span> The standard library module <code class="docutils literal notranslate"><span class="pre">audioop</span></code> is now included, making the <code class="docutils literal notranslate"><span class="pre">wave</span></code>,
<code class="docutils literal notranslate"><span class="pre">sndhdr</span></code>, <code class="docutils literal notranslate"><span class="pre">aifc</span></code>, and <code class="docutils literal notranslate"><span class="pre">sunau</span></code> modules usable. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1623">#1623</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added support for <code class="docutils literal notranslate"><span class="pre">ctypes</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1656">#1656</a></p></li>
</ul>
</section>
<section id="id51">
<h6>JavaScript package<a class="headerlink" href="#id51" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> The Pyodide JavaScript package is released to npm under <a class="reference external" href="https://www.npmjs.com/package/pyodide">npmjs.com/package/pyodide</a>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1762">#1762</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> no longer automatically
stores the API into a global variable called <code class="docutils literal notranslate"><span class="pre">pyodide</span></code>. To get old behavior,
say <code class="docutils literal notranslate"><span class="pre">globalThis.pyodide</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">loadPyodide({...})</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1597">#1597</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> now accepts callback functions for
<code class="docutils literal notranslate"><span class="pre">stdin</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">stderr</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1728">#1728</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Pyodide now ships with first party typescript types for the entire
JavaScript API (though no typings are available for <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> fields).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1601">#1601</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> It is now possible to import <code class="docutils literal notranslate"><span class="pre">Comlink</span></code> objects into Pyodide after
using <code class="docutils literal notranslate"><span class="pre">pyodide.registerComlink</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1642">#1642</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> If a Python error occurs in a reentrant <code class="docutils literal notranslate"><span class="pre">runPython</span></code> call, the error
will be propagated into the outer <code class="docutils literal notranslate"><span class="pre">runPython</span></code> context as the original error
type. This is particularly important if the error is a <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1447">#1447</a></p></li>
</ul>
</section>
<section id="id52">
<h6>Python package<a class="headerlink" href="#id52" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Added a new <code class="docutils literal notranslate"><span class="pre">pyodide.code.CodeRunner</span></code> API for finer control than
<code class="docutils literal notranslate"><span class="pre">eval_code</span></code> and <code class="docutils literal notranslate"><span class="pre">eval_code_async</span></code>. Designed with
the needs of REPL implementations in mind.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1563">#1563</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide.console.Console</span></code> class closely based on the Python standard
library <code class="docutils literal notranslate"><span class="pre">code.InteractiveConsole</span></code> but with support for top level await and
stream redirection. Also added the subclass <code class="docutils literal notranslate"><span class="pre">pyodide.console.PyodideConsole</span></code> which
automatically uses <code class="docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports</span></code> on the code before running
it.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1125">#1125</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1155">#1155</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1635">#1635</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">pyodide.code.eval_code_async</span></code> no longer automatically awaits a returned
coroutine or attempts to await a returned generator object (which triggered an
error).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1563">#1563</a></p></li>
</ul>
</section>
<section id="id53">
<h6>Python / JavaScript type conversions<a class="headerlink" href="#id53" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">pyodide.runPythonAsync</span></code> no longer automatically calls
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImports</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1538">#1538</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">PyProxy.callKwargs</span></code> method to allow using
Python functions with keyword arguments from JavaScript.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1539">#1539</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Added the <code class="docutils literal notranslate"><span class="pre">PyProxy.copy</span></code> method.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1549">#1549</a> <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1630">#1630</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Updated the method resolution order on <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>. Performing a
lookup on a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> will prefer to pick a method from the <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> api, if
no such method is found, it will use <code class="docutils literal notranslate"><span class="pre">getattr</span></code> on the proxied object.
Prefixing a name with <code class="docutils literal notranslate"><span class="pre">$</span></code> forces <code class="docutils literal notranslate"><span class="pre">getattr</span></code>. For instance, <code class="docutils literal notranslate"><span class="pre">PyProxy.destroy</span></code>
now always refers to the method that destroys the proxy, whereas
<code class="docutils literal notranslate"><span class="pre">PyProxy.$destroy</span></code> refers to an attribute or method called <code class="docutils literal notranslate"><span class="pre">destroy</span></code> on the
proxied object.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1604">#1604</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> It is now possible to use <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> keys with PyProxies. These
<code class="docutils literal notranslate"><span class="pre">Symbol</span></code> keys put markers on the PyProxy that can be used by external code.
They will not currently be copied by <code class="docutils literal notranslate"><span class="pre">PyProxy.copy</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1696">#1696</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Memory management of <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> fields has been changed so
that fields looked up on a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> are “borrowed” and have their lifetime
attached to the base <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>. This is intended to allow for more idiomatic
usage.
(See <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1617">#1617</a>.) <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1636">#1636</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> The depth argument to <code class="docutils literal notranslate"><span class="pre">toJs</span></code> is now passed as an option, so
<code class="docutils literal notranslate"><span class="pre">toJs(n)</span></code> in v0.17 changed to <code class="docutils literal notranslate"><span class="pre">toJs({depth</span> <span class="pre">:</span> <span class="pre">n})</span></code>. Similarly, <code class="docutils literal notranslate"><span class="pre">pyodide.toPy</span></code>
now takes <code class="docutils literal notranslate"><span class="pre">depth</span></code> as a named argument. Also <code class="docutils literal notranslate"><span class="pre">to_js</span></code> and <code class="docutils literal notranslate"><span class="pre">to_py</span></code> only take
depth as a keyword argument.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1721">#1721</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">PyProxy.toJs</span></code> and <code class="docutils literal notranslate"><span class="pre">pyodide.ffi.to_js</span></code> now
take an option <code class="docutils literal notranslate"><span class="pre">pyproxies</span></code>, if a JavaScript Array is passed for this, then
any proxies created during conversion will be placed into this array. This
allows easy cleanup later. The <code class="docutils literal notranslate"><span class="pre">create_pyproxies</span></code> option can be used to
disable creation of pyproxies during conversion (instead a <code class="docutils literal notranslate"><span class="pre">ConversionError</span></code>
is raised). <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1726">#1726</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">toJs</span></code> and <code class="docutils literal notranslate"><span class="pre">to_js</span></code> now take an option <code class="docutils literal notranslate"><span class="pre">dict_converter</span></code> which will be
called on a JavaScript iterable of two-element Arrays as the final step of
converting dictionaries. For instance, pass <code class="docutils literal notranslate"><span class="pre">Object.fromEntries</span></code> to convert to
an object or <code class="docutils literal notranslate"><span class="pre">Array.from</span></code> to convert to an array of pairs.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1742">#1742</a></p></li>
</ul>
</section>
<section id="id54">
<h6>pyodide-build<a class="headerlink" href="#id54" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> pyodide-build is now an installable Python package, with an
identically named CLI entrypoint that replaces <code class="docutils literal notranslate"><span class="pre">bin/pyodide</span></code> which is removed
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1566">#1566</a></p></li>
</ul>
</section>
<section id="id55">
<h6>micropip<a class="headerlink" href="#id55" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> micropip now correctly handles packages that have mixed case names.
(See <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1614">#1614</a>).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1615">#1615</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> micropip now resolves dependencies correctly for old
versions of packages (it used to always use the dependencies from the most
recent version, see <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1619">#1619</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1745">#1745</a>). micropip also will
resolve dependencies for wheels loaded from custom urls.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1753">#1753</a></p></li>
</ul>
</section>
<section id="id56">
<h6>Packages<a class="headerlink" href="#id56" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> matplotlib now comes with a new renderer based on the html5 canvas element. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1579">#1579</a>
It is optional and the current default backend is still the agg backend compiled to wasm.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Updated a number of packages included in Pyodide.</p></li>
</ul>
</section>
<section id="id57">
<h6>List of contributors<a class="headerlink" href="#id57" title="Link to this heading">#</a></h6>
<p>Albertas Gimbutas, Andreas Klostermann, Arfy Slowy, daoxian,
Devin Neal, fuyutarow, Grimmer, Guido Zuidhof, Gyeongjae Choi, Hood
Chatham, Ian Clester, Itay Dafna, Jeremy Tuloup, jmsmdy, LinasNas, Madhur
Tandon, Michael Christensen, Nicholas Bollweg, Ondřej Staněk, Paul m. p. P,
Piet Brömmel, Roman Yurchak, stefnotch, Syrus Akbary, Teon L Brooks, Waldir</p>
</section>
</section>
<section id="version-0-17-0">
<h5>Version 0.17.0<a class="headerlink" href="#version-0-17-0" title="Link to this heading">#</a></h5>
<p><em>April 21, 2021</em></p>
<p>See the <a class="reference internal" href="#release-notes"><span class="std std-ref">Version 0.17.0 Release Notes</span></a> for more information.</p>
<section id="improvements-to-package-loading-and-dynamic-linking">
<h6>Improvements to package loading and dynamic linking<a class="headerlink" href="#improvements-to-package-loading-and-dynamic-linking" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-info'>Enhancement</span> Uses the emscripten preload plugin system to preload .so files in packages</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Support for shared library packages. This is used for CLAPACK which makes scipy a lot smaller.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1236">#1236</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Pyodide and included packages can now be used with Safari v14+.
Safari v13 has also been observed to work on some (but not all) devices.</p></li>
</ul>
</section>
<section id="python-js-type-conversions">
<h6>Python / JS type conversions<a class="headerlink" href="#python-js-type-conversions" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Feature</span> A <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> of a JavaScript <code class="docutils literal notranslate"><span class="pre">Promise</span></code> or other awaitable object is now a
Python awaitable.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/880">#880</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Instead of automatically converting Python lists and dicts into
JavaScript, they are now wrapped in <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>. Added a new <code class="docutils literal notranslate"><span class="pre">PyProxy.toJs</span></code>
API to request the conversion behavior that used to be implicit.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1167">#1167</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Added <code class="docutils literal notranslate"><span class="pre">JsProxy.to_py</span></code> API to convert a JavaScript object to Python.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1244">#1244</a></p></li>
<li><p><span class='badge badge-success'>Feature</span> Flexible jsimports: it now possible to add custom Python
“packages” backed by JavaScript code, like the <code class="docutils literal notranslate"><span class="pre">js</span></code> package. The <code class="docutils literal notranslate"><span class="pre">js</span></code> package
is now implemented using this system.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1146">#1146</a></p></li>
<li><p><span class='badge badge-success'>Feature</span> A <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a Python coroutine or awaitable is now an
awaitable JavaScript object. Awaiting a coroutine will schedule it to run on
the Python event loop using <code class="docutils literal notranslate"><span class="pre">asyncio.ensure_future</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1170">#1170</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Made <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of an iterable Python object an iterable Js
object: defined the <code class="docutils literal notranslate"><span class="pre">[Symbol.iterator]</span></code> method, can be used like <code class="docutils literal notranslate"><span class="pre">for(let</span> <span class="pre">x</span> <span class="pre">of</span> <span class="pre">proxy)</span></code>.
Made a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a Python iterator an iterator: <code class="docutils literal notranslate"><span class="pre">proxy.next()</span></code> is
translated to <code class="docutils literal notranslate"><span class="pre">next(it)</span></code>. Made a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> of a Python generator into a
JavaScript generator: <code class="docutils literal notranslate"><span class="pre">proxy.next(val)</span></code> is translated to <code class="docutils literal notranslate"><span class="pre">gen.send(val)</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1180">#1180</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Updated <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> so that if the wrapped Python object supports <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
access, then the wrapper has <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">has</span></code>, and <code class="docutils literal notranslate"><span class="pre">delete</span></code> methods which do
<code class="docutils literal notranslate"><span class="pre">obj[key]</span></code>, <code class="docutils literal notranslate"><span class="pre">obj[key]</span> <span class="pre">=</span> <span class="pre">val</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">in</span> <span class="pre">obj</span></code> and <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">obj[key]</span></code> respectively.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1175">#1175</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> The <code class="docutils literal notranslate"><span class="pre">pyodide.pyimport</span></code> function is deprecated in favor of using
<code class="docutils literal notranslate"><span class="pre">pyodide.globals.get('key')</span></code>. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1367">#1367</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Added <code class="docutils literal notranslate"><span class="pre">PyProxy.getBuffer</span></code> API to allow direct access to Python
buffers as JavaScript TypedArrays.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1215">#1215</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> The innermost level of a buffer converted to JavaScript used to be a
TypedArray if the buffer was contiguous and otherwise an Array. Now the
innermost level will be a TypedArray unless the buffer format code is a ‘?’ in
which case it will be an Array of booleans, or if the format code is a “s” in
which case the innermost level will be converted to a string.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1376">#1376</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> JavaScript <code class="docutils literal notranslate"><span class="pre">BigInt</span></code>s are converted into Python <code class="docutils literal notranslate"><span class="pre">int</span></code> and
Python <code class="docutils literal notranslate"><span class="pre">int</span></code>s larger than 2^53 are converted into <code class="docutils literal notranslate"><span class="pre">BigInt</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1407">#1407</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Added <code class="docutils literal notranslate"><span class="pre">pyodide.isPyProxy</span></code> to test if an object is a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1456">#1456</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> and <code class="docutils literal notranslate"><span class="pre">PyBuffer</span></code> objects are now garbage collected
if the browser supports <code class="docutils literal notranslate"><span class="pre">FinalizationRegistry</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1306">#1306</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Automatic conversion of JavaScript functions to CPython
calling conventions.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1051">#1051</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1080">#1080</a></p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Automatic detection of fatal errors. In this case Pyodide
will produce both a JavaScript and a Python stack trace with explicit
instruction to open a bug report.
pr<code class="docutils literal notranslate"><span class="pre">{1151}</span></code>, pr<code class="docutils literal notranslate"><span class="pre">{1390}</span></code>, pr<code class="docutils literal notranslate"><span class="pre">{1478}</span></code>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Systematic memory leak detection in the test suite and a
large number of fixed to memory leaks.
pr<code class="docutils literal notranslate"><span class="pre">{1340}</span></code></p></li>
<li><p><span class='badge badge-danger'>Fix</span> getattr and dir on JsProxy now report consistent results and include all
names defined on the Python dictionary backing JsProxy.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1017">#1017</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">JsProxy.__bool__</span></code> now produces more consistent results: both
<code class="docutils literal notranslate"><span class="pre">bool(window)</span></code> and <code class="docutils literal notranslate"><span class="pre">bool(zero-arg-callback)</span></code> were <code class="docutils literal notranslate"><span class="pre">False</span></code> but now are <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Conversely, <code class="docutils literal notranslate"><span class="pre">bool(empty_js_set)</span></code> and <code class="docutils literal notranslate"><span class="pre">bool(empty_js_map)</span></code> were <code class="docutils literal notranslate"><span class="pre">True</span></code> but now
are <code class="docutils literal notranslate"><span class="pre">False</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1061">#1061</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> When calling a JavaScript function from Python without keyword
arguments, Pyodide no longer passes a <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code>-wrapped <code class="docutils literal notranslate"><span class="pre">NULL</span></code> pointer as the
last argument. <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1033">#1033</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> JsBoundMethod is now a subclass of JsProxy, which fixes nested
attribute access and various other strange bugs.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1124">#1124</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> JavaScript functions imported like <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">js</span> <span class="pre">import</span> <span class="pre">fetch</span></code> no longer
trigger “invalid invocation” errors (issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/461">#461</a>) and
<code class="docutils literal notranslate"><span class="pre">js.fetch(&quot;some_url&quot;)</span></code> also works now (issue <a class="reference external" href="https://github.com/pyodide/pyodide/issues/768">#768</a>).
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1126">#1126</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> JavaScript bound method calls now work correctly with keyword arguments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1138">#1138</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> JavaScript constructor calls now work correctly with keyword
arguments.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1433">#1433</a></p></li>
</ul>
</section>
<section id="pyodide-py-package">
<h6>pyodide-py package<a class="headerlink" href="#pyodide-py-package" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Feature</span> Added a Python event loop to support asyncio by scheduling
coroutines to run as jobs on the browser event loop. This event loop is
available by default and automatically enabled by any relevant asyncio API,
so for instance <code class="docutils literal notranslate"><span class="pre">asyncio.ensure_future</span></code> works without any configuration.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1158">#1158</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Removed <code class="docutils literal notranslate"><span class="pre">as_nested_list</span></code> API in favor of <code class="docutils literal notranslate"><span class="pre">JsProxy.to_py</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1345">#1345</a></p></li>
</ul>
</section>
<section id="pyodide-js">
<h6>pyodide-js<a class="headerlink" href="#pyodide-js" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-warning'>API Change</span> Removed iodide-specific code in <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code>. This breaks compatibility with
iodide.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/878">#878</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/981">#981</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Removed the <code class="docutils literal notranslate"><span class="pre">pyodide.autocomplete</span></code> API, use Jedi directly instead.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1066">#1066</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Removed <code class="docutils literal notranslate"><span class="pre">pyodide.repr</span></code> API.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1067">#1067</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> If <code class="docutils literal notranslate"><span class="pre">messageCallback</span></code> and <code class="docutils literal notranslate"><span class="pre">errorCallback</span></code> are supplied to
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>, <code class="docutils literal notranslate"><span class="pre">pyodide.runPythonAsync</span></code> and
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackagesFromImport</span></code>, then the messages are no longer
automatically logged to the console.</p></li>
<li><p><span class='badge badge-success'>Feature</span> <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code> now runs the code with <code class="docutils literal notranslate"><span class="pre">eval_code_async</span></code>. In
particular, it is possible to use top-level await inside of <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eval_code</span></code> now accepts separate <code class="docutils literal notranslate"><span class="pre">globals</span></code> and <code class="docutils literal notranslate"><span class="pre">locals</span></code> parameters.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1083">#1083</a></p></li>
<li><p>Added the <code class="docutils literal notranslate"><span class="pre">pyodide.setInterruptBuffer</span></code> API. This can be used to set a
<code class="docutils literal notranslate"><span class="pre">SharedArrayBuffer</span></code> to be the keyboard interrupt buffer. If Pyodide is running
on a webworker, the main thread can signal to the webworker that it should
raise a <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> by writing to the interrupt buffer.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1148">#1148</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1173">#1173</a></p></li>
<li><p>Changed the loading method: added an async function <code class="docutils literal notranslate"><span class="pre">loadPyodide</span></code> to load
Pyodide to use instead of <code class="docutils literal notranslate"><span class="pre">languagePluginURL</span></code> and <code class="docutils literal notranslate"><span class="pre">languagePluginLoader</span></code>. The
change is currently backwards compatible, but the old approach is deprecated.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1363">#1363</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code> now accepts <code class="docutils literal notranslate"><span class="pre">globals</span></code> parameter.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1914">#1914</a></p></li>
</ul>
</section>
<section id="id58">
<h6>micropip<a class="headerlink" href="#id58" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-success'>Feature</span> <code class="docutils literal notranslate"><span class="pre">micropip</span></code> now supports installing wheels from relative URLs.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/872">#872</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code> now returns a Python <code class="docutils literal notranslate"><span class="pre">Future</span></code> instead of a JavaScript <code class="docutils literal notranslate"><span class="pre">Promise</span></code>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1324">#1324</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code> now interacts correctly with
<a class="reference internal" href="#pyodide.loadPackage" title="pyodide.loadPackage"><code class="xref js js-func docutils literal notranslate"><span class="pre">pyodide.loadPackage()</span></code></a>.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1457">#1457</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> <code class="docutils literal notranslate"><span class="pre">micropip.install</span></code> now handles version constraints correctly
even if there is a version of the package available from the Pyodide <code class="docutils literal notranslate"><span class="pre">indexURL</span></code>.</p></li>
</ul>
</section>
<section id="id59">
<h6>Build system<a class="headerlink" href="#id59" title="Link to this heading">#</a></h6>
<ul>
<li><p><span class='badge badge-info'>Enhancement</span> Updated to latest emscripten 2.0.13 with the upstream LLVM backend
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1102">#1102</a></p></li>
<li><p><span class='badge badge-warning'>API Change</span> Use upstream <code class="docutils literal notranslate"><span class="pre">file_packager.py</span></code>, and stop checking package abi versions.
The <code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGE_ABI</span></code> environment variable is no longer used, but is
still set as some packages use it to detect whether it is being built for
Pyodide. This usage is deprecated, and a new environment variable <code class="docutils literal notranslate"><span class="pre">PYODIDE</span></code>
is introduced for this purpose.</p>
<p>As part of the change, Module.checkABI is no longer present.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/991">#991</a></p>
</li>
<li><p>uglifyjs and lessc no longer need to be installed in the system during build
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/878">#878</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Reduce the size of the core Pyodide package
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/987">#987</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Optionally to disable docker port binding
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1423">#1423</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Run arbitrary command in docker
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1424">#1424</a></p></li>
<li><p>Docker images for Pyodide are now accessible at
<a class="reference external" href="https://hub.docker.com/repository/docker/pyodide/pyodide-env">pyodide/pyodide-env</a>
and
<a class="reference external" href="https://hub.docker.com/repository/docker/pyodide/pyodide">pyodide/pyodide</a>.</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Option to run docker in non-interactive mode
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1641">#1641</a></p></li>
</ul>
</section>
<section id="id60">
<h6>REPL<a class="headerlink" href="#id60" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p><span class='badge badge-danger'>Fix</span> In console.html: sync behavior, full stdout/stderr support, clean namespace,
bigger font, correct result representation, clean traceback
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1125">#1125</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1141">#1141</a></p></li>
<li><p><span class='badge badge-danger'>Fix</span> Switched from ̀Jedi to rlcompleter for completion in
<code class="docutils literal notranslate"><span class="pre">pyodide.console.InteractiveConsole</span></code> and so in <code class="docutils literal notranslate"><span class="pre">console.html</span></code>. This fixes
some completion issues (see <a class="reference external" href="https://github.com/pyodide/pyodide/issues/821">#821</a> and <a class="reference external" href="https://github.com/pyodide/pyodide/issues/1160">#1160</a>)</p></li>
<li><p><span class='badge badge-info'>Enhancement</span> Support top-level await in the console
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1459">#1459</a></p></li>
</ul>
</section>
<section id="id61">
<h6>Packages<a class="headerlink" href="#id61" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>six, jedi and parso are no longer vendored in the main Pyodide package, and
need to be loaded explicitly
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1010">#1010</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/987">#987</a>.</p></li>
<li><p>Updated packages <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1021">#1021</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1338">#1338</a>, <a class="reference external" href="https://github.com/pyodide/pyodide/pull/1460">#1460</a>.</p></li>
<li><p>Added Plotly version 4.14.3 and retrying dependency
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/1419">#1419</a></p></li>
</ul>
</section>
<section id="id62">
<h6>List of contributors<a class="headerlink" href="#id62" title="Link to this heading">#</a></h6>
<p>(in alphabetic order)</p>
<p>Aditya Shankar, casatir, Dexter Chua, dmondev, Frederik Braun, Hood Chatham,
Jan Max Meyer, Jeremy Tuloup, joemarshall, leafjolt, Michael Greminger,
Mireille Raad, Ondřej Staněk, Paul m. p. P, rdb, Roman Yurchak, Rudolfs</p>
</section>
</section>
<section id="version-0-16-1">
<h5>Version 0.16.1<a class="headerlink" href="#version-0-16-1" title="Link to this heading">#</a></h5>
<p><em>December 25, 2020</em></p>
<p>Note: due to a CI deployment issue the 0.16.0 release was skipped and replaced
by 0.16.1 with identical contents.</p>
<ul class="simple">
<li><p>Pyodide files are distributed by <a class="reference external" href="https://www.jsdelivr.com/">JsDelivr</a>,
<code class="docutils literal notranslate"><span class="pre">https://cdn.jsdelivr.net/pyodide/v0.16.1/full/pyodide.js</span></code>
The previous CDN <code class="docutils literal notranslate"><span class="pre">pyodide-cdn2.iodide.io</span></code> still works and there
are no plans for deprecating it. However please use
JsDelivr as a more sustainable solution, including for earlier Pyodide
versions.</p></li>
</ul>
<section id="python-and-the-standard-library">
<h6>Python and the standard library<a class="headerlink" href="#python-and-the-standard-library" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Pyodide includes CPython 3.8.2
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/712">#712</a></p></li>
<li><p>ENH Patches for the threading module were removed in all packages. Importing
the module, and a subset of functionality (e.g. locks) works, while starting
a new thread will produce an exception, as expected.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/796">#796</a>.
See <a class="reference external" href="https://github.com/pyodide/pyodide/issues/237">#237</a> for the current status of the threading support.</p></li>
<li><p>ENH The multiprocessing module is now included, and will not fail at import,
thus avoiding the necessity to patch included packages. Starting a new
process will produce an exception due to the limitation of the WebAssembly VM
with the following message: <code class="docutils literal notranslate"><span class="pre">Resource</span> <span class="pre">temporarily</span> <span class="pre">unavailable</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/796">#796</a>.</p></li>
</ul>
</section>
<section id="id63">
<h6>Python / JS type conversions<a class="headerlink" href="#id63" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>FIX Only call <code class="docutils literal notranslate"><span class="pre">Py_INCREF()</span></code> once when proxied by PyProxy
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/708">#708</a></p></li>
<li><p>JavaScript exceptions can now be raised and caught in Python. They are
wrapped in pyodide.JsException.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/891">#891</a></p></li>
</ul>
</section>
<section id="pyodide-py-package-and-micropip">
<h6>pyodide-py package and micropip<a class="headerlink" href="#pyodide-py-package-and-micropip" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">pyodide.py</span></code> file was transformed to a pyodide-py package. The imports
remain the same so this change is transparent to the users
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/909">#909</a>.</p></li>
<li><p>FIX Get last version from PyPI when installing a module via micropip
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/846">#846</a>.</p></li>
<li><p>Suppress REPL results returned by <code class="docutils literal notranslate"><span class="pre">pyodide.eval_code</span></code> by adding a semicolon
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/876">#876</a>.</p></li>
<li><p>Enable monkey patching of <code class="docutils literal notranslate"><span class="pre">eval_code</span></code> and <code class="docutils literal notranslate"><span class="pre">find_imports</span></code> to customize
behavior of <code class="docutils literal notranslate"><span class="pre">runPython</span></code> and <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/941">#941</a>.</p></li>
</ul>
</section>
<section id="id64">
<h6>Build system<a class="headerlink" href="#id64" title="Link to this heading">#</a></h6>
<ul>
<li><p>Updated docker image to Debian buster, resulting in smaller images.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/815">#815</a></p></li>
<li><p>Pre-built docker images are now available as
<a class="reference external" href="https://hub.docker.com/r/iodide/pyodide"><code class="docutils literal notranslate"><span class="pre">iodide-project/pyodide</span></code></a>
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/787">#787</a></p></li>
<li><p>Host Python is no longer compiled, reducing compilation time. This also
implies that Python 3.8 is now required to build Pyodide. It can for instance
be installed with conda.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/830">#830</a></p></li>
<li><p>FIX Infer package tarball directory from source URL
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/687">#687</a></p></li>
<li><p>Updated to emscripten 1.38.44 and binaryen v86 (see related
<a class="reference external" href="https://github.com/pyodide/pyodide/search?q=emscripten&amp;amp;type=commits">commits</a>)</p></li>
<li><p>Updated default <code class="docutils literal notranslate"><span class="pre">--ldflags</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pyodide_build</span></code> scripts to equal what
Pyodide actually uses.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/817">#817</a></p></li>
<li><p>Replace C lz4 implementation with the (upstream) JavaScript implementation.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/851">#851</a></p></li>
<li><p>Pyodide deployment URL can now be specified with the <code class="docutils literal notranslate"><span class="pre">PYODIDE_BASE_URL</span></code>
environment variable during build. The <code class="docutils literal notranslate"><span class="pre">pyodide_dev.js</span></code> is no longer
distributed. To get an equivalent behavior with <code class="docutils literal notranslate"><span class="pre">pyodide.js</span></code>, set</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nb">window</span><span class="p">.</span><span class="nx">languagePluginUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>before loading it.
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/855">#855</a></p>
</li>
<li><p>Build runtime C libraries (e.g. libxml) via package build system with correct
dependency resolution
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/927">#927</a></p></li>
<li><p>Pyodide can now be built in a conda virtual environment
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/835">#835</a></p></li>
</ul>
</section>
<section id="other-improvements">
<h6>Other improvements<a class="headerlink" href="#other-improvements" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Modify MEMFS timestamp handling to support better caching. This in
particular allows to import newly created Python modules without invalidating
import caches <a class="reference external" href="https://github.com/pyodide/pyodide/pull/893">#893</a></p></li>
</ul>
</section>
<section id="id65">
<h6>Packages<a class="headerlink" href="#id65" title="Link to this heading">#</a></h6>
<ul>
<li><p>New packages: freesasa, lxml, python-sat, traits, astropy, pillow,
scikit-image, imageio, numcodecs, msgpack, asciitree, zarr</p>
<p>Note that due to the large size and the experimental state of the scipy
package, packages that depend on scipy (including scikit-image, scikit-learn)
will take longer to load, use a lot of memory and may experience failures.</p>
</li>
<li><p>Updated packages: numpy 1.15.4, pandas 1.0.5, matplotlib 3.3.3 among others.</p></li>
<li><p>New package
<a class="reference external" href="https://pypi.org/project/pyodide-interrupts/">pyodide-interrupt</a>, useful for
handling interrupts in Pyodide (see project description for details).</p></li>
</ul>
</section>
<section id="backward-incompatible-changes">
<h6>Backward incompatible changes<a class="headerlink" href="#backward-incompatible-changes" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Dropped support for loading .wasm files with incorrect MIME type, following
<a class="reference external" href="https://github.com/pyodide/pyodide/pull/851">#851</a></p></li>
</ul>
</section>
<section id="id66">
<h6>List of contributors<a class="headerlink" href="#id66" title="Link to this heading">#</a></h6>
<p>abolger, Aditya Shankar, Akshay Philar, Alexey Ignatiev, Aray Karjauv, casatir,
chigozienri, Christian glacet, Dexter Chua, Frithjof, Hood Chatham, Jan Max
Meyer, Jay Harris, jcaesar, Joseph D. Long, Matthew Turk, Michael Greminger,
Michael Panchenko, mojighahar, Nicolas Ollinger, Ram Rachum, Roman Yurchak,
Sergio, Seungmin Kim, Shyam Saladi, smkm, Wei Ouyang</p>
</section>
</section>
<section id="version-0-15-0">
<h5>Version 0.15.0<a class="headerlink" href="#version-0-15-0" title="Link to this heading">#</a></h5>
<p><em>May 19, 2020</em></p>
<ul class="simple">
<li><p>Upgrades Pyodide to CPython 3.7.4.</p></li>
<li><p>micropip no longer uses a CORS proxy to install pure Python packages from
PyPI. Packages are now installed from PyPI directly.</p></li>
<li><p>micropip can now be used from web workers.</p></li>
<li><p>Adds support for installing pure Python wheels from arbitrary URLs with
micropip.</p></li>
<li><p>The CDN URL for Pyodide changed to
https://pyodide-cdn2.iodide.io/v0.15.0/full/pyodide.js
It now supports versioning and should provide faster downloads.
The latest release can be accessed via
https://pyodide-cdn2.iodide.io/latest/full/</p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">messageCallback</span></code> and <code class="docutils literal notranslate"><span class="pre">errorCallback</span></code> to
<code class="docutils literal notranslate"><span class="pre">pyodide.loadPackage</span></code>.</p></li>
<li><p>Reduces the initial memory footprint (<code class="docutils literal notranslate"><span class="pre">TOTAL_MEMORY</span></code>) from 1 GiB to 5 MiB.
More memory will be allocated as needed.</p></li>
<li><p>When building from source, only a subset of packages can be built by setting
the <code class="docutils literal notranslate"><span class="pre">PYODIDE_PACKAGES</span></code> environment variable. See
<a class="reference internal" href="#partial-builds"><span class="std std-ref">partial builds documentation</span></a> for more details.</p></li>
<li><p>New packages: future, autograd</p></li>
</ul>
</section>
<section id="version-0-14-3">
<h5>Version 0.14.3<a class="headerlink" href="#version-0-14-3" title="Link to this heading">#</a></h5>
<p><em>Dec 11, 2019</em></p>
<ul class="simple">
<li><p>Convert JavaScript numbers containing integers, e.g. <code class="docutils literal notranslate"><span class="pre">3.0</span></code>, to a real Python
long (e.g. <code class="docutils literal notranslate"><span class="pre">3</span></code>).</p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">__bool__</span></code> method to for <code class="docutils literal notranslate"><span class="pre">JsProxy</span></code> objects.</p></li>
<li><p>Adds a JavaScript-side auto completion function for Iodide that uses jedi.</p></li>
<li><p>New packages: nltk, jeudi, statsmodels, regex, cytoolz, xlrd, uncertainties</p></li>
</ul>
</section>
<section id="version-0-14-0">
<h5>Version 0.14.0<a class="headerlink" href="#version-0-14-0" title="Link to this heading">#</a></h5>
<p><em>Aug 14, 2019</em></p>
<ul class="simple">
<li><p>The built-in <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> and <code class="docutils literal notranslate"><span class="pre">bz2</span></code> modules of Python are now enabled.</p></li>
<li><p>Adds support for auto-completion based on jedi when used in iodide</p></li>
</ul>
</section>
<section id="version-0-13-0">
<h5>Version 0.13.0<a class="headerlink" href="#version-0-13-0" title="Link to this heading">#</a></h5>
<p><em>May 31, 2019</em></p>
<ul class="simple">
<li><p>Tagged versions of Pyodide are now deployed to Netlify.</p></li>
</ul>
</section>
<section id="version-0-12-0">
<h5>Version 0.12.0<a class="headerlink" href="#version-0-12-0" title="Link to this heading">#</a></h5>
<p><em>May 3, 2019</em></p>
<p><strong>User improvements:</strong></p>
<ul class="simple">
<li><p>Packages with pure Python wheels can now be loaded directly from PyPI. See
<code class="docutils literal notranslate"><span class="pre">micropip</span></code> for more information.</p></li>
<li><p>Thanks to PEP 562, you can now <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">js</span></code> from Python and use it to access
anything in the global JavaScript namespace.</p></li>
<li><p>Passing a Python object to JavaScript always creates the same object in
JavaScript. This makes APIs like <code class="docutils literal notranslate"><span class="pre">removeEventListener</span></code> usable.</p></li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">dir()</span></code> in Python on a JavaScript proxy now works.</p></li>
<li><p>Passing an <code class="docutils literal notranslate"><span class="pre">ArrayBuffer</span></code> from JavaScript to Python now correctly creates a
<code class="docutils literal notranslate"><span class="pre">memoryview</span></code> object.</p></li>
<li><p>Pyodide now works on Safari.</p></li>
</ul>
</section>
<section id="version-0-11-0">
<h5>Version 0.11.0<a class="headerlink" href="#version-0-11-0" title="Link to this heading">#</a></h5>
<p><em>Apr 12, 2019</em></p>
<p><strong>User improvements:</strong></p>
<ul class="simple">
<li><p>Support for built-in modules:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite</span></code>, <code class="docutils literal notranslate"><span class="pre">crypt</span></code></p></li>
</ul>
</li>
<li><p>New packages: <code class="docutils literal notranslate"><span class="pre">mne</span></code></p></li>
</ul>
<p><strong>Developer improvements:</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">mkpkg</span></code> command will now select an appropriate archive to use, rather
than just using the first.</p></li>
<li><p>The included version of emscripten has been upgraded to 1.38.30 (plus a
bugfix).</p></li>
<li><p>New packages: <code class="docutils literal notranslate"><span class="pre">jinja2</span></code>, <code class="docutils literal notranslate"><span class="pre">MarkupSafe</span></code></p></li>
</ul>
</section>
<section id="version-0-10-0">
<h5>Version 0.10.0<a class="headerlink" href="#version-0-10-0" title="Link to this heading">#</a></h5>
<p><em>Mar 21, 2019</em></p>
<p><strong>User improvements:</strong></p>
<ul class="simple">
<li><p>New packages: <code class="docutils literal notranslate"><span class="pre">html5lib</span></code>, <code class="docutils literal notranslate"><span class="pre">pygments</span></code>, <code class="docutils literal notranslate"><span class="pre">beautifulsoup4</span></code>, <code class="docutils literal notranslate"><span class="pre">soupsieve</span></code>,
<code class="docutils literal notranslate"><span class="pre">docutils</span></code>, <code class="docutils literal notranslate"><span class="pre">bleach</span></code>, <code class="docutils literal notranslate"><span class="pre">mne</span></code></p></li>
</ul>
<p><strong>Developer improvements:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">console.html</span></code> provides a simple text-only interactive console to test local
changes to Pyodide. The existing notebooks based on legacy versions of Iodide
have been removed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">run_docker</span></code> script can now be configured with environment variables.</p></li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-project/deprecation-timeline"></span><section id="pyodide-deprecation-timeline">
<span id="deprecation-timeline"></span><h6>Pyodide Deprecation Timeline<a class="headerlink" href="#pyodide-deprecation-timeline" title="Link to this heading">#</a></h6>
<p>Each Pyodide release may deprecate certain features from previous releases in a
backward incompatible way. If a feature is deprecated, it will continue to work
until its removal, but raise warnings. We try to ensure deprecations are done
over at least two minor(feature) releases, however, as Pyodide is still in beta
state, this list is subject to change and some features can be removed without
deprecation warnings. More details about each item can often be found in the
<a class="reference internal" href="#changelog"><span class="std std-ref">Change Log</span></a>.</p>
<section id="id1">
<h6 aria-level="7">0.25.0<a class="headerlink" href="#id1" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Typescript type imports for <code class="docutils literal notranslate"><span class="pre">PyProxy</span></code> subtypes from <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> will be removed.</p></li>
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">PyProxy.supportsHas</span></code>, <code class="docutils literal notranslate"><span class="pre">PyProxy.isCallable</span></code>, etc will be removed.</p></li>
<li><p>Support for the <code class="docutils literal notranslate"><span class="pre">homedir</span></code> argument will be removed in favor of
<code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">{HOME:</span> <span class="pre">&quot;/the/home/directory&quot;}</span></code>.</p></li>
</ul>
</section>
<section id="id2">
<h6 aria-level="7">0.24.0<a class="headerlink" href="#id2" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">messageCallback</span></code> and <code class="docutils literal notranslate"><span class="pre">errorCallback</span></code> argument to <code class="docutils literal notranslate"><span class="pre">loadPackage</span></code> and
<code class="docutils literal notranslate"><span class="pre">loadPackagesFromImports</span></code> will be passed as a named argument only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py2JsResult</span></code> will be removed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--output-directory</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> will be removed.</p></li>
</ul>
</section>
<section id="id3">
<h6 aria-level="7">0.23.0<a class="headerlink" href="#id3" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>Names that used to be in the root <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> module and were moved to submodules
will no longer be available in the root module.</p></li>
<li><p>The “message” argument to <code class="docutils literal notranslate"><span class="pre">PyProxy.destroy</span></code> method will no longer be accepted
as a positional argument.</p></li>
</ul>
</section>
<section id="id4">
<h6 aria-level="7">0.21.0<a class="headerlink" href="#id4" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">globals</span></code> argument to <code class="docutils literal notranslate"><span class="pre">runPython</span></code> and <code class="docutils literal notranslate"><span class="pre">runPythonAsync</span></code> will be passed as a
named argument only.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">extractDir</span></code> argument to <code class="docutils literal notranslate"><span class="pre">unpackArchive</span></code> will be passed as a named
argument only.</p></li>
</ul>
</section>
<section id="id5">
<h6 aria-level="7">0.20.0<a class="headerlink" href="#id5" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>The skip-host key will be removed from the meta.yaml format. If needed,
install a host copy of the package with pip instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyodide-interrupts</span></code> module will be removed. If you were using this for some
reason, use <a class="reference internal" href="#pyodide.setInterruptBuffer" title="pyodide.setInterruptBuffer"><code class="xref js js-func docutils literal notranslate"><span class="pre">setInterruptBuffer()</span></code></a> instead.</p></li>
</ul>
</section>
<section id="id6">
<h6 aria-level="7">0.19.0<a class="headerlink" href="#id6" title="Link to this heading">#</a></h6>
<ul class="simple">
<li><p>The default working directory (home directory) inside the Pyodide virtual file
system has been changed from <code class="docutils literal notranslate"><span class="pre">/</span></code> to <code class="docutils literal notranslate"><span class="pre">/home/pyodide</span></code>. To get the previous
behavior, you can</p>
<ul>
<li><p>call <code class="docutils literal notranslate"><span class="pre">os.chdir(&quot;/&quot;)</span></code> in Python to change working directory or</p></li>
<li><p>call <a class="reference internal" href="#globalThis.loadPyodide" title="globalThis.loadPyodide"><code class="xref js js-func docutils literal notranslate"><span class="pre">loadPyodide()</span></code></a> with the <code class="docutils literal notranslate"><span class="pre">homedir=&quot;/&quot;</span></code>
argument</p></li>
</ul>
</li>
<li><p>When a JavaScript function is called from Python, PyProxy arguments and return
values will be automatically destroyed when the function is finished.</p></li>
</ul>
</section>
</section>
</div>
</section>
</section>
<span id="document-project/related-projects"></span><section id="related-projects">
<h4>Related Projects<a class="headerlink" href="#related-projects" title="Link to this heading">#</a></h4>
<section id="webassembly-ecosystem">
<h5>WebAssembly ecosystem<a class="headerlink" href="#webassembly-ecosystem" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://emscripten.org/">emscripten</a> is the compiler toolchain for WebAssembly
that made Pyodide possible.</p></li>
</ul>
</section>
<section id="notebook-environments-ides-and-repls">
<h5>Notebook environments, IDEs, and REPLs<a class="headerlink" href="#notebook-environments-ides-and-repls" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/iodide-project/iodide">Iodide</a> is a notebook-like
environment for literate scientific computing and communication for the
web. It is no longer actively maintained. Historically, Pyodide started
as plugin for iodide.</p></li>
<li><p><a class="reference external" href="https://github.com/gzuidhof/starboard-notebook">Starboard notebook</a> is an
in-browser literal notebook runtime that uses Pyodide for Python.</p></li>
<li><p><a class="reference external" href="https://notebook.basthon.fr/">Basthon notebook</a> is a static fork of Jupyter
notebook with a Pyodide kernel (currently in French).</p></li>
<li><p><a class="reference external" href="https://github.com/jupyterlite/jupyterlite">JupyterLite</a> is a JupyterLab
distribution that runs entirely in the browser, based on Pyodide.</p></li>
<li><p><a class="reference external" href="https://futurecoder.io/">futurecoder</a> is an interactive Python
course running on Pyodide. It includes an
<a class="reference external" href="https://futurecoder.io/course/#ide">IDE</a> with a REPL,
debuggers, and automatic installation of
any imported packages supported by Pyodide’s <code class="docutils literal notranslate"><span class="pre">micropip</span></code>.</p></li>
<li><p><a class="reference external" href="https://elilambnz.github.io/react-py/playground">react-py Playground</a> uses Pyodide as part of the <code class="docutils literal notranslate"><span class="pre">react-py</span></code> package documentation. Try out code snippets and packages directly in your browser without logging in.</p></li>
<li><p><a class="reference external" href="https://github.com/marimo-team/marimo">marimo</a> is a reactive notebook that is compatible with Pyodide with an <a class="reference external" href="https://marimo.app/">online editor</a> that runs entirely in the browser. These notebooks can also run as standalone applications or embedded in blogs.</p></li>
<li><p><a class="reference external" href="https://github.com/coatless-quarto/pyodide">quarto-pyodide</a> uses Pyodide
to create interactive code cells and documents within a variety of
<a class="reference external" href="https://quarto.org/">Quarto</a> document formats like
HTML Documents, RevealJS, Books, and Websites.</p></li>
<li><p><a class="reference external" href="https://py.cafe">PyCafe</a> lets you host, edit, and share Python apps in your browser with a single click.</p></li>
<li><p><a class="reference external" href="https://github.com/r-wasm/quarto-live">quarto-live</a> uses Pyodide
to create interactive Python code cells and exercises in <a class="reference external" href="https://quarto.org/">Quarto</a> documents.</p></li>
<li><p><a class="reference external" href="https://github.com/climet-eu/lab">Online Laboratory for Climate Science and Meteorology</a> is a
JupyterLite-based environment that comes with additional packages from the weather and climate
community, and patches to support loading and working with large (remote) datasets.</p></li>
</ul>
</section>
<section id="workarounds-for-common-wasm-and-browser-limitations">
<h5>Workarounds for common WASM and browser limitations<a class="headerlink" href="#workarounds-for-common-wasm-and-browser-limitations" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/koenvo/pyodide-http">pyodide-http</a> Provides patches for
widely used http libraries to make them work in Pyodide environments like
JupyterLite.</p></li>
</ul>
</section>
<section id="dashboards-and-visualization">
<h5>Dashboards and visualization<a class="headerlink" href="#dashboards-and-visualization" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ibdafna/webdash">WebDash</a> is a Plotly Dash distribution
that runs entirely in the browser, using Pyodide.</p></li>
<li><p><a class="reference external" href="https://flet.dev">Flet</a> is a UI framework for your Pyodide apps based on Flutter.</p></li>
<li><p><a class="reference external" href="https://github.com/whitphx/stlite">stlite</a> is a serverless version of <a class="reference external" href="https://streamlit.io/">Streamlit</a> running on Pyodide.</p></li>
<li><p><a class="reference external" href="https://www.gradio.app/guides/gradio-lite">Gradio-Lite</a> is a serverless version of <a class="reference external" href="https://www.gradio.app/">Gradio</a> running on Pyodide.</p></li>
</ul>
</section>
<section id="other-projects">
<h5>Other projects<a class="headerlink" href="#other-projects" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/vanillawc/wc-code">wc-code</a> is a library to run
JavaScript, Python, and Theme in the browser with inline code blocks.
It uses Pyodide to execute Python code.</p></li>
<li><p><a class="reference external" href="https://github.com/eagleoflqj/sympy_beta">SymPy Beta</a> is a fork of SymPy
Gamma. It’s an in-browser answer engine with a Pyodide backend.</p></li>
<li><p><a class="reference external" href="https://github.com/elilambnz/react-py">react-py</a> is a library that allows for easy integration of Pyodide in React applications. It provides convenient hooks for running Python code.</p></li>
<li><p><a class="reference external" href="https://wordpress.org/plugins/inseri-core/">inseri core</a> is a WordPress plugin that introduces scientific and interactive Gutenberg blocks to facilitate open science. The <a class="reference external" href="https://docs.inseri.swiss/blocks/python/">Python Code block</a> allows to run Python code in the browser using Pyodide.</p></li>
</ul>
</section>
</section>
</div>
</section>
</section>
<section id="communication">
<h2>Communication<a class="headerlink" href="#communication" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Blog: <a class="reference external" href="https://blog.pyodide.org/">blog.pyodide.org</a></p></li>
<li><p>Mailing list: <a class="reference external" href="https://mail.python.org/mailman3/lists/pyodide.python.org/">mail.python.org/mailman3/lists/pyodide.python.org/</a></p></li>
<li><p>Gitter: <a class="reference external" href="https://gitter.im/pyodide/community">gitter.im/pyodide/community</a></p></li>
<li><p>Twitter: <a class="reference external" href="https://twitter.com/pyodide">twitter.com/pyodide</a></p></li>
<li><p>Stack Overflow: <a class="reference external" href="https://stackoverflow.com/questions/tagged/pyodide">stackoverflow.com/questions/tagged/pyodide</a></p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/quickstart">Getting started</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/downloading-and-deploying">Downloading and deploying Pyodide</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/index">Using Pyodide</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/loading-packages">Loading packages</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/accessing-files">Accessing Files Quick Reference</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/wasm-constraints">Pyodide Python compatibility</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/type-conversions">Type translations</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/keyboard-interrupts">Interrupting execution</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/streams">Redirecting standard streams</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/api-reference">API Reference</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/faq">Frequently Asked Questions</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-usage/examples">Community Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/building-from-sources">Building from sources</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/new-packages">Creating a Pyodide package</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/building-and-testing-packages">Building and testing Python packages out of tree</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/contributing">How to Contribute</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/testing">Testing and benchmarking</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-development/debugging">Debugging tips</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/about">What is Pyodide?</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/roadmap">Roadmap</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/governance">Governance and Decision-making</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/changelog">Change Log</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="#document-project/related-projects">Related Projects</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pyodide contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2019-2024, Pyodide contributors and Mozilla.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>